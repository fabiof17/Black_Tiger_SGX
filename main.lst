                             #[1]   "main.s"
   27                        	
   28               0010     	CORE_VERSION	=	$10			; Version 1.0
   29                        	
   30                        			; Get the user program's configuration settings, this will
   31                        			; be read from the current directory, if it exists, or the
   32                        			; "../include/" directory if not.
   33                        	
                             #[4]   "..\..\..\include\hucc\core-config.inc"
   34                        			include	"core-config.inc"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; core-config.inc
    5                        	;
    6                        	; Configuration settings for the "CORE(not TM)" PC Engine library code.
    7                        	;
    8                        	; Copyright John Brandwood 2021-2024.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	;
   17                        	; The idea is that you, a PCE developer, copy this file from the ../include/
   18                        	; directory and into your project's directory, and then customize the values
   19                        	; to suit your particular project.
   20                        	;
   21                        	; Because PCEAS searches the current (i.e. project) directory for an include
   22                        	; file first, then it will find your customized copy of the file rather than
   23                        	; the original copy in the ../include/ directory.
   24                        	;
   25                        	; That means that all of the different overlay programs in your project will
   26                        	; share the same overall library configuration for your game.
   27                        	;
   28                        	; ***************************************************************************
   29                        	; ***************************************************************************
   30                        	
   31                        	;
   32                        	; Are we going to take over MPR7?
   33                        	;
   34                        	; While this is the default for the "CORE(not TM)" library, it is definitely
   35                        	; possible to use the library to build CD-ROM code that runs with the System
   36                        	; Card in MPR7, and with the 1st bank remaining in MPR2.
   37                        	;
   38                        	; N.B. The CD-ROM Stage1 loader runs the library with USING_MPR7=0 while it
   39                        	;      installs the kernel into PCE RAM in MPR1.
   40                        	;
   41                        	
   42               0000     		.ifndef	USING_MPR7
   44                        		.endif
   45                        	
   46                        	;
   47                        	; Are we building a CD-ROM overlay that uses an already-built CD-ROM Stage1
   48                        	; loader to install the library's kernel code into PCE RAM in MPR1?
   49                        	;
   50                        	; If this is set, the library's kernel code will be excluded from the build,
   51                        	; which will save about 1KB-3KB of code space in every overlay program!
   52                        	;
   53                        	; N.B. The CD-ROM Stage1 loader sets USING_STAGE1=0 so it builds correctly.
   54                        	;
   55                        	
   56               0000     		.ifndef	USING_STAGE1
   58                        		.endif
   59                        	
   60                        	;
   61                        	; Are we currently building the CD-ROM Stage1 loader?
   62                        	;
   63                        	; If this is set, the library's startup code does not call the __sound_init
   64                        	; macro because the sound driver code is not usually a part of the kernel.
   65                        	;
   66                        	; N.B. The CD-ROM Stage1 loader sets BUILDING_STAGE1=1 so it builds correctly.
   67                        	;
   68                        	
   69               0000     		.ifndef	BUILDING_STAGE1
   71                        		.endif
   72                        	
   73                        	;
   74                        	; Is the last track of the CD a duplicate of the main ISO data track?
   75                        	;
   76                        	; Most CD games put two copies of the same ISO track on the CD, so that data
   77                        	; can be read from the secondary track if the drive has a problem reading it
   78                        	; it from the primary location.
   79                        	;
   80                        	; If set, the secondary track will be enabled when the library first starts.
   81                        	;
   82                        	
   83               0000     		.ifndef	SUPPORT_2ISO
   85                        		.endif
   86                        	
   87                        	;
   88                        	; Maximum number of directory entries to use from the ISO.
   89                        	;
   90                        	; The fewer that we choose, the less RAM memory we need. A setting of 64 is
   91                        	; a good compromise to use until you are putting lots of files on the ISO.
   92                        	;
   93                        	
   94               0000     		.ifndef	MAX_DIRSIZE
   96                        		.endif
   97                        	
   98                        	;
   99                        	; Use the System Card's PSG driver code instead of a modern alternative
  100                        	; sound driver like a DefleMask or Furnace player?
  101                        	;
  102                        	
  103               0000     		.ifndef	USING_PSGDRIVER
  105                        		.endif
  106                        	
  107                        	;
  108                        	; Support development for the Turbo EverDrive v2?
  109                        	;
  110                        	; This only applies to HuCard programs, but when chosen, the "CORE(not TM)"
  111                        	; kernel is moved from bank 0 to bank 2, and a minimal set of startup code
  112                        	; is put in bank 0.
  113                        	;
  114                        	; This is because the TED2 hardware occupies the whole of bank 0 when it is
  115                        	; activated, and so we need to run with a different bank in MPR7.
  116                        	;
  117                        	
  118               0000     		.ifndef	SUPPORT_TED2
  120                        		.endif
  121                        	
  122                        	;
  123                        	; Support development for the SuperGRAFX?
  124                        	;
  125                        	; This enables SuperGRAFX support in certain library functions.
  126                        	;
  127                        	
  128               0000     		.ifndef	SUPPORT_SGX
  130                        		.endif
  131                        	
  132                        	;
  133                        	; Choose SuperGRAFX VPC initialization mode.
  134                        	;
  135                        	; SGX_PARALLAX=0 (useful when VDC #1 is a fullscreen HUD)
  136                        	;
  137                        	;  FRONT
  138                        	;   SP1 = VDC #1 (pce) sprite pixels
  139                        	;   BG1 = VDC #1 (pce) background pixels
  140                        	;   SP2 = VDC #2 (sgx) sprite pixels
  141                        	;   BG2 = VDC #2 (sgx) background pixels
  142                        	;  BACK
  143                        	;
  144                        	; SGX_PARALLAX=1
  145                        	;
  146                        	;  FRONT
  147                        	;   SP1 = VDC #1 (pce) sprite pixels
  148                        	;   SP2 = VDC #2 (sgx) sprite pixels
  149                        	;   BG1 = VDC #1 (pce) background pixels
  150                        	;   BG2 = VDC #2 (sgx) background pixels
  151                        	;  BACK
  152                        	;
  153                        	
  154               0000     		.ifndef	SGX_PARALLAX
  156                        		.endif
  157                        	
  158                        	;
  159                        	; Support development for the ArcadeCard?
  160                        	;
  161                        	; This enables ArcadeCard support in certain library functions.
  162                        	;
  163                        	
  164               0000     		.ifndef	SUPPORT_ACD
  166                        		.endif
  167                        	
  168                        	;
  169                        	; Support development for the IFU's ADPCM hardware?
  170                        	;
  171                        	; Developers would normally just use the System Card functions for ADPCM, but
  172                        	; enabling this adds alternative functions, and allows ADPCM use on a HuCARD.
  173                        	;
  174                        	
  175               0000     		.ifndef	SUPPORT_ADPCM
  177                        		.endif
  178                        	
  179                        	;
  180                        	; Select which version of the joystick library code to include, only one of
  181                        	; these can be set to '1' ...
  182                        	;
  183                        	; SUPPORT_2BUTTON : Only returns buttons I and II.
  184                        	; SUPPORT_6BUTTON : Read buttons III-VI, but ignore a mouse.
  185                        	; SUPPORT_MOUSE	  : Read mouse, but ignore buttons III-VI.
  186                        	;
  187                        	; It doesn't make sense to design a game the relies on both the 6-button and
  188                        	; the mouse, so the joystick library is optimized for one or the other.
  189                        	;
  190                        	; Note that both those devices are always detected and no conflicts occur,
  191                        	; this just controls reading either buttons III-VI or the Mouse Y-movement.
  192                        	;
  193                        	
  194               0000     		.ifndef	SUPPORT_6BUTTON
  200                        		.endif
  201                        	
  202                        	;
  203                        	; How many joypad/mouse devices should be supported?
  204                        	;
  205                        	; This is normally 5, but can be set to 3 (or lower) in order to speed up
  206                        	; the processing and free up CPU time for other code, which is especially
  207                        	; useful for mouse games.
  208                        	;
  209                        	
  210               0000     		.ifndef	MAX_PADS
  212                        		.endif
  213                        	
  214                        	;
  215                        	; Implement a HuC-compatible seperate array for accumulating joypad presses?
  216                        	;
  217                        	; This is only really needed if your game is not expected to run at 60Hz and
  218                        	; so you will sometimes miss joypad presses.
  219                        	;
  220                        	; Alternatively you can set ACCUMULATE_JOY so that joypad presses are always
  221                        	; accumulated in the normal joytrg array, which is how asm programmers would
  222                        	; normally deal with this situation.
  223                        	;
  224                        	
  225               0000     		.ifndef HUC_JOY_EVENTS
  227                        		.endif
  228                        	
  229                        	;
  230                        	; Should "joytrg" accumulate presses, and so need to be explicitely cleared
  231                        	; after reading, or should it just be the result of the last read?
  232                        	;
  233                        	; This option has no effect if HUC_JOY_EVENTS is non-zero since that option
  234                        	; takes precedence over this one!
  235                        	;
  236                        	
  237               0000     		.ifndef ACCUMULATE_JOY
  239                        		.endif
  240                        	
  241                        	;
  242                        	; The DATA_BANK location needs to be set as early as possible so that library
  243                        	; code is able to put data in there before the total overall size of the code
  244                        	; is known.
  245                        	;
  246                        	; By default, DATA_BANK is the next bank after the CORE_BANK.
  247                        	;
  248                        	; RESERVE_BANKS allows developers to reserve some banks between the CORE_BANK
  249                        	; and the DATA_BANK that they can use however they wish.
  250                        	;
  251                        	; One use for RESERVE_BANKS is to create empty space that PCEAS can use when
  252                        	; it relocates procedures. This provides a way for a developer to group code
  253                        	; together at the start of memory, and leave the maximum number of banks for
  254                        	; loading dynamic data from CD-ROM.
  255                        	;
  256                        	; The KickC environment sets RESERVE_BANKS=1 (or higher) so that there is a
  257                        	; a bank for the permanent C code and static constants.
  258                        	;
  259                        	
  260               0000     		.ifndef	RESERVE_BANKS
  266                        		.endif	RESERVE_BANKS
                             #[3]   "..\..\..\include\hucc\core.inc"
   35                        	
   36                        	;
   37                        	; This is a simple macro to call System Card functions when using MPR7 for
   38                        	; running the "CORE(not TM)" PC Engine library code.
   39                        	;
   40                        	
   41                        	system		.macro
   42                        			ldy     #<\1
   43                        			jsr	call_bios
   44                        			.endm
   45                        	
   46                        	;
   47                        	; This replaces the System Card's ex_setvec, because "call_bios" uses the
   48                        	; Y register.
   49                        	;
   50                        	
   51                        	setvec		.macro
   52                        			php
   53                        			sei
   54                        			lda.l	#\2
   55                        			sta.l	\1
   56                        			lda.h	#\2
   57                        			sta.h	\1
   58                        			plp
   59                        			.endm
   60                        	
   61                        	;
   62                        	; Repurpose this System Card variable, since nmi_hook is never used.
   63                        	;
   64                        	; We'll use it as a vector to a user-supplied sound driver instead.
   65                        	;
   66                        	
   67               2206     	sound_hook	=	nmi_hook		; Sound Driver to run in VBL.
   68                        	
   69                        	;
   70                        	; CORE Zero-Page variables, relative to the System Card's ZP variables.
   71                        	;
   72                        	
   73               0000     		.if	USING_PSGDRIVER
   75                        		.else
   76               20EC     	core_zpend	=	$F8:20EC
   77                        		.endif	USING_PSGDRIVER
   78                        	
   79               0001     		.if	SUPPORT_SGX
   80                        	
   81                        			; Put some "CORE(not TM)" variables at the start of Zero Page.
   82                        			;
   83                        			; These are at the *start* of ZP so that the SuperGrafx shadow
   84                        			; "sgx_" registers are at a specific offset from their System
   85                        			; Card "vdc_" counterparts, and they MUST NOT be moved!
   86                        			;
   87                        			; This allows us to put SGX_VDC_OFFSET or PCE_VDC_OFFSET into
   88                        			; the X register, and then index into either set of hardware
   89                        			; registers and the "sgx_reg" or "vdc_reg" shadow-variables.
   90                        	
   91               0000     	PCE_VDC_OFFSET	=	$00		; Offset to PCE VDC chip & shadow vars.
   92               0010     	SGX_VDC_OFFSET	=	$10		; Offset to SGX VDC chip & shadow vars.
   93                        	
   94               2000     			.zp
   95               2000     			.org	$2000
   96    F8:2000             	__temp		ds	2		; $F8:2000 Use within any ASM routine.
   97    F8:2002             	_bp_bank	ds	1		; $F8:2002 Use within any ASM/HuCC routine.
   98    F8:2003             	sgx_crl		ds	1		; $F8:2003 SGX shadow (vdc_crl = $20F3).
   99    F8:2004             	sgx_crh		ds	1		; $F8:2004 SGX shadow (vdc_crh = $20F4).
  100    F8:2005             	core_1stbank	ds	1		; $F8:2005 1st bank of library code.
  101    F8:2006             	sgx_sr		ds	1		; $F8:2006 SGX shadow (vdc_sr  = $20F6).
  102    F8:2007             	sgx_reg		ds	1		; $F8:2007 SGX shadow (vdc_reg = $20F7).
  103                        	
  104               2008     	core_zp1st	=	*		; $F8:2008 1st free user address.
  105                        	
  106                        		.else	SUPPORT_SGX
  116                        		.endif	SUPPORT_SGX
  117                        	
  118                        	;
  119                        	; The kernel code in RAM follows the System Card's RAM variables.
  120                        	;
  121                        	
  122               0000     		.if	USING_PSGDRIVER
  124                        		.else
  125               22D0     	core_ram1st     =	$F8:22D0
  126                        		.endif	USING_PSGDRIVER
  127                        	
  128                        	;
  129                        	; Include the "CORE(not TM)" startup code to begin the HuCARD / Overlay.
  130                        	;
  131                        	
                             #[4]   "..\..\..\include\hucc\core-startup.asm"
  132                        			include	"core-startup.asm"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; core-startup.asm
    5                        	;
    6                        	; The "CORE(not TM)" PC Engine library startup code that runs at boot/reset.
    7                        	;
    8                        	; Copyright John Brandwood 2021-2024.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	;
   17                        	; This is the initialization code in the 1st bank, and it is responsible for
   18                        	; setting up a consistant runtime environment for the developer's program,
   19                        	; so that the developer can concentrate on writing the program itself.
   20                        	;
   21                        	; The idea is that when a program is loaded, the first 40KB of it is mapped
   22                        	; as $4000..$DFFF, and initialization starts at $4000, with the developer's
   23                        	; program getting control after initialization, with a jump to "core_main".
   24                        	;
   25                        	; The initializtion sets up a small kernel of code that provides interrupt
   26                        	; handling that mimics a subset of the System Card's behavior, designed to
   27                        	; act in the same way on HuCARD and CD-ROM, with either the System Card in
   28                        	; MPR7, or with an overlay in MPR7.
   29                        	;
   30                        	; The kernel handles reading the joypad/mouse, and it offers handler hooks
   31                        	; for running the developer's interrupt code.  On CD-ROM systems, it also
   32                        	; handles the loading and running of subsequent overlay programs.
   33                        	;
   34                        	; On HuCARD, the kernel itself runs in MPR7; while on CD-ROM systems it is
   35                        	; run from RAM in MPR1, so that overlay programs are independant from each
   36                        	; other, and can be written in different programming languages.
   37                        	;
   38                        	;
   39                        	; 1) If we're running on a HuCARD, the initialization is simple!
   40                        	;
   41                        	;    The PC Engine's memory map is set to ...
   42                        	;
   43                        	;      MPR0 = bank $FF : PCE hardware
   44                        	;      MPR1 = bank $F8 : PCE RAM with Stack & ZP
   45                        	;      MPR2 = bank $00 : HuCARD ROM
   46                        	;      MPR3 = bank $01 : HuCARD ROM
   47                        	;      MPR4 = bank $02 : HuCARD ROM
   48                        	;      MPR5 = bank $03 : HuCARD ROM
   49                        	;      MPR6 = bank $04 : HuCARD ROM
   50                        	;      MPR7 = bank $00 : HuCARD ROM
   51                        	;
   52                        	;
   53                        	; 2) If we're running on a HuCARD that supports the Turbo Everdrive, then the
   54                        	;    first 2 banks are reserved for mapping the TED2 hardware and a RAM bank.
   55                        	;
   56                        	;    The PC Engine's memory map is set to ...
   57                        	;
   58                        	;      MPR0 = bank $FF : PCE hardware
   59                        	;      MPR1 = bank $F8 : PCE RAM with Stack & ZP
   60                        	;      MPR2 = bank $02 : HuCARD ROM
   61                        	;      MPR3 = bank $03 : HuCARD ROM
   62                        	;      MPR4 = bank $04 : HuCARD ROM
   63                        	;      MPR5 = bank $05 : HuCARD ROM
   64                        	;      MPR6 = bank $06 : HuCARD ROM
   65                        	;      MPR7 = bank $02 : HuCARD ROM
   66                        	;
   67                        	;
   68                        	; 3) If we're running on an old CD System, the overlay is loaded from the ISO
   69                        	;    into banks $80-$87 (64KB max).
   70                        	;
   71                        	;    The PC Engine's memory map is set to ...
   72                        	;
   73                        	;      MPR0 = bank $FF : PCE hardware
   74                        	;      MPR1 = bank $F8 : PCE RAM with Stack & ZP
   75                        	;      MPR2 = bank $80 : CD RAM
   76                        	;      MPR3 = bank $81 : CD RAM
   77                        	;      MPR4 = bank $82 : CD RAM
   78                        	;      MPR5 = bank $83 : CD RAM
   79                        	;      MPR6 = bank $84 : CD RAM
   80                        	;      MPR7 = bank $80 : CD RAM or System Card's bank $00
   81                        	;
   82                        	;
   83                        	; 4) If we're running on a SuperCD System, the overlay is loaded from the ISO
   84                        	;    into banks $68-$87 (256KB max).
   85                        	;
   86                        	;    The PC Engine's memory map is set to ...
   87                        	;
   88                        	;      MPR0 = bank $FF : PCE hardware
   89                        	;      MPR1 = bank $F8 : PCE RAM with Stack & ZP
   90                        	;      MPR2 = bank $68 : SCD RAM
   91                        	;      MPR3 = bank $69 : SCD RAM
   92                        	;      MPR4 = bank $6A : SCD RAM
   93                        	;      MPR5 = bank $6B : SCD RAM
   94                        	;      MPR6 = bank $6C : SCD RAM
   95                        	;      MPR7 = bank $68 : SCD RAM or System Card's bank $00
   96                        	;
   97                        	; ***************************************************************************
   98                        	; ***************************************************************************
   99                        	
  100                        	
  101                        	
  102               E000     			.code
  103               0000     			.bank	0
  104                        	
  105               0000     		.if	SUPPORT_TED2			; Do we want to use a TED2?
  177                        		.endif	SUPPORT_TED2
  178                        	
  179                        	
  180                        	
  181               0001     		.if	USING_MPR7
  182                        	
  183                        	; ***************************************************************************
  184                        	; ***************************************************************************
  185                        	;
  186                        	; RESET VECTORS (when running in MPR7, either as a HuCARD, or a CD overlay)
  187                        	;
  188                        	
  189                        			; Hardware reset and interrupt vectors.
  190                        	
  191               FFF4     			.org	$FFF4
  192                        	
  193    00:FFF4  10         	core_version:	db	CORE_VERSION		; CORE(not TM) Version.
  194    00:FFF5  80         			db	$80			; System Card compatibility.
  195                        	
  196    00:FFF6  5D E0      			dw	core_irq2		; IRQ2	(from CD/ADPCM)
  197    00:FFF8  64 E0      			dw	core_irq1		; IRQ1	(from VDC)
  198    00:FFFA  58 E1      			dw	core_timer		; TIMER (from CPU)
  199    00:FFFC  5E E1      			dw	core_rti		; NMI	(unused)
  200               0000     		.if	CDROM
  202                        		.else
  203    00:FFFE  21 E0      			dw	core_hw_reset		; RESET (HuCARD)
  204                        		.endif	CDROM
  205                        	
  206               0001     		.if	USING_NEWPROC			; If the ".proc" trampolines
  207               FFF3     	__trampolineptr =	$FFF3			; are in MPR7, tell PCEAS to
  208                        		.endif					; put them below the vectors.
  209                        	
  210                        		.else	USING_MPR7
  222                        		.endif	USING_MPR7
  223                        	
  224                        	
  225                        	
  226                        	; ***************************************************************************
  227                        	; ***************************************************************************
  228                        	;
  229                        	; !!! THE HuCARD/OVERLAY PROGRAM'S FIRST BANK STARTS HERE !!!
  230                        	;
  231                        	
  232                        			; Switch to MPR2 for the "CORE(not TM)" library init.
  233                        			;
  234                        			; This is also executed by a HuCARD once it has run
  235                        			; its initial hardware-reset code.
  236                        			;
  237                        			; When run, MPR2-MPR6 are always mapped to the 1st 5 banks of
  238                        			; the overlay program, and MPR7 contains the System Card.
  239                        	
  240               4000     			.org	$4000
  241                        	
  242               0000     	CORE_BANK	=	bank(*) - _bank_base	; It isn't always zero! ;-)
  243                        	
  244               0000     			.bank	CORE_BANK, "CORE_BANK"	; Give it a label.
  245                        	
  246               0001     		.if	USING_MPR7
  247               0007     	CORE_PAGE	=	7			; User code runs in MPR7.
  248                        		.else
  250                        		.endif	USING_MPR7
  251                        	
  252    00:4000  4C 06 40   	core_boot:	jmp	* + 6			; Allow someone to patch this.
  253                        	
  254                        			; Add an ident string so isoLINK can autodetect configuration.
  255                        			;
  256                        			; This allows isoLINK to decide whether to use the IPL-SCD boot
  257                        			; sector hack, and whether to include a SuperGRAFX signature in
  258                        			; the boot sector, without the user having to manually use some
  259                        			; command line parameters, although they are free to do that if
  260                        			; they wish.
  261                        	
  262               0001     		.if	SUPPORT_SGX
  263               0000     		.if	BUILDING_STAGE1
  265                        		.else
  266    00:4003  53 47 58   			db	"SGX"			; SGX SuperCD or SGX HuCARD.
  267                        		.endif	BUILDING_STAGE1
  268                        		.else
  282                        		.endif	SUPPORT_SGX
  283                        	
  284               0000     		.if	CDROM
  331                        		.else	CDROM
  332                        	
  333                        			; Set up HuCARD RAM in a compatible way to the System Card.
  334                        			;
  335                        			; Note that the entire RAM is cleared by "core_hw_reset".
  336                        	
  337    00:4006  A9 1F      			lda	#%11111			; Enable joypad soft-reset.
  338    00:4008  8D 27 22   			sta	joyena
  339                        	
  340                        		.endif	CDROM
  341                        	
  342                        			; Now that RAM is initialized ...
  343                        	
  344    00:400B  43 04      			tma2				; Remember overlay's 1st bank
  345    00:400D  85 05      			sta	<core_1stbank		; $00, $02, $68 or $80!
  346               0001     		.if	USING_MPR7
  347    00:400F  53 80      			tam7				; "CORE(not TM)" takes MPR7!
  348                        		.endif
  349                        	
  350    00:4011  A2 FF      			ldx	#$FF			; Initialize stack pointer.
  351    00:4013  9A         			txs
  352                        	
  353    00:4014  20 5F E1   			jsr	core_clr_hooks		; Reset default hooks.
  354                        	
  355                        	;		stz	TIMER_CR		; Stop HuC6280 timer.
  356                        	;		stz	IRQ_ACK			; Clr HuC6280 timer interrupt.
  357                        	;		stz	IRQ_MSK			; Clr HuC6280 interrupt mask.
  358                        	
  359    00:4017  AD 00 02   			lda	VDC_SR			; Purge any overdue VBL.
  360    00:401A  9C 41 22   			stz	irq_cnt			; Make it easy to check.
  361    00:401D  58         			cli				; Restore interrupts.
  362                        	
  363    00:401E  4C E5 FF   			jmp	core_main		; Start the game's code.
  364                        	
  365                        	
  366                        	
  367               0001     		.if	!CDROM
  368                        	
  369                        	; ***************************************************************************
  370                        	; ***************************************************************************
  371                        	;
  372                        	; HuCARD Kernel Code
  373                        	;
  374                        	; core_ram1st - Start of code to relocate to MPR1.
  375                        	; core_ramend - End of code to relocate to MPR1.
  376                        	;
  377                        	
  378                        			; In a HuCARD, BSS variables start as low as possible.
  379                        	
  380               2200     			.bss
  381               22D0     			.org	core_ram1st
  382               22D0     	core_ramend	=	*
  383               4021     			.code
  384                        	
  385                        			; Normal HuCARD hardware-reset code, executed in MPR7.
  386                        			;
  387                        			; This does the basic PCE startup that every HuCARD (including
  388                        			; a System Card) needs to do, and then it remaps memory to be
  389                        			; compatible with the "CORE(not TM)" CD overlay program start.
  390                        	
  391               E021     			.page	7			; This will run in MPR7.
  392                        	
  393    00:E021  78         	core_hw_reset:	sei				; Disable interrupts.
  394    00:E022  D4         			csh				; Set high-speed mode.
  395    00:E023  D8         			cld
  396                        	
  397    00:E024  A2 FF      			ldx	#$FF			; Initialize stack pointer.
  398    00:E026  9A         			txs
  399    00:E027  8A         			txa				; MPR0 = $FF : PCE hardware
  400    00:E028  53 01      			tam0				; MPR1 = $F8 : PCE RAM
  401    00:E02A  A9 F8      			lda	#$F8
  402    00:E02C  53 02      			tam1
  403                        	
  404    00:E02E  9C 01 0C   			stz	TIMER_CR		; HW reset already does these,
  405    00:E031  9C 03 14   			stz	IRQ_ACK			; but this may be a reset from
  406    00:E034  9C 02 14   			stz	IRQ_MSK			; software (i.e. joypad).
  407                        	
  408    00:E037  F3 53 E0 00			tai	const_0000, $2000, 8192 ; Clear RAM.
         00:E03B  20 00 20    
  409                        	
  410    00:E03E  43 80      			tma7				; Not always bank 0!
  411                        	
  412    00:E040  53 04      			tam2				; Set CD-ROM overlay memory map,
  413    00:E042  1A         			inc	a			; 1st 5 banks in MPR2-MPR6.
  414    00:E043  53 08      			tam3
  415    00:E045  1A         			inc	a
  416    00:E046  53 10      			tam4
  417    00:E048  1A         			inc	a
  418    00:E049  53 20      			tam5
  419    00:E04B  1A         			inc	a
  420    00:E04C  53 40      			tam6
  421                        	
  422    00:E04E  4C 00 40   			jmp	core_boot		; Continue execution in MPR2.
  423                        	
  424                        			; In a HuCARD, the kernel code is permanently in MPR7.
  425                        	
                             #[5]   "..\..\..\include\hucc\core-kernel.asm"
  426                        			include "core-kernel.asm"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; core-kernel.asm
    5                        	;
    6                        	; The "CORE(not TM)" PC Engine library kernel code that runs after startup.
    7                        	;
    8                        	; Copyright John Brandwood 2021-2024.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	;
   17                        	; This code is permanently located in either MPR7 (HuCARD), or MPR1 (CD-ROM),
   18                        	; and it provides a consistant method of interrupt-handling on both systems
   19                        	; that is designed to be compatible with the System Card.
   20                        	;
   21                        	; The library uses the "irq1_hook" for its own VDC interrupt handler, and PCE
   22                        	; developers are expected to use "vsync_hook" and "hsync_hook" for their VDC
   23                        	; interrupt functions.  Plenty of memory is available in the 1st bank for the
   24                        	; developer to put those functions.
   25                        	;
   26                        	; The reason for using "irq1_hook", is so that the library can work properly
   27                        	; if either the current overlay program, or the System Card, are mapped into
   28                        	; MPR7 whenever an interrupt occurs.
   29                        	;
   30                        	; The VDC interupt handler itself is changed from the System Card's handler,
   31                        	; and it is designed to provide faster response to vsync_hook, and to enable
   32                        	; interrupts during the slow(ish) joypad and sound driver code, so that both
   33                        	; raster and timer interrupts are not delayed.
   34                        	;
   35                        	; Developers are free to enable interrupts during their own vsync_hook code,
   36                        	; if they wish to do so.
   37                        	;
   38                        	; On CD-ROM systems, this library kernel also provides a function to load and
   39                        	; run a new overlay program, without relying upon any of the code/data within
   40                        	; the current overlay program's memory (unlike HuC v3).
   41                        	;
   42                        	; ***************************************************************************
   43                        	; ***************************************************************************
   44                        	
   45                        	
   46                        	
   47                        	; ***************************************************************************
   48                        	; ***************************************************************************
   49                        	;
   50                        	; core_kernel - Start of kernel code.
   51                        	;
   52                        	
   53               E051     	core_kernel	=	*
   54                        	
   55                        	
   56                        	
   57                        	; ***************************************************************************
   58                        	; ***************************************************************************
   59                        	;
   60                        	; Useful constants, needed by joypad library code, and used by many others.
   61                        	;
   62                        	; The kernel starts with a non-zero byte so that core-startup.asm can check
   63                        	; whether it has already been loaded into RAM.
   64                        	;
   65                        	
   66    00:E051  FF FF      	const_FFFF:	dw	$FFFF			; Useful constant for TAI.
   67    00:E053  00 00      	const_0000:	dw	$0000			; Useful constant for TAI.
   68                        	
   69    00:E055  01 02 04 08	bit_mask:	db	$01,$02,$04,$08,$10,$20,$40,$80
         00:E059  10 20 40 80 
   70                        	
   71                        	
   72                        	
   73                        	; ***************************************************************************
   74                        	; ***************************************************************************
   75                        	;
   76                        	; core_irq2  - Minimal interrupt handler compatible with System Card.
   77                        	; core_irq1  - Minimal interrupt handler compatible with System Card.
   78                        	; core_timer - Minimal interrupt handler compatible with System Card.
   79                        	; core_rti   - Minimal interrupt handler compatible with System Card.
   80                        	;
   81                        	; Note that it takes 8 cycles to respond to an IRQ.
   82                        	;
   83                        	; These routines are copied to a location in RAM that does not vary when
   84                        	; a different overlay program is loaded.
   85                        	;
   86                        	; All overlay programs are set up to vector interrupts to these routines,
   87                        	; which is designed to avoid interrupt-related crashes when loading a new
   88                        	; overlay on top of an old overlay in memory.
   89                        	;
   90                        	; All of the game's actual interrupt handling itself is done in the "hook"
   91                        	; functions so that everything works the same if the System Card is banked
   92                        	; into MPR7 when an interrupt occurs.
   93                        	;
   94                        	; ***************************************************************************
   95                        	; ***************************************************************************
   96                        	;
   97                        	; Bit settings for irq_vec  ...
   98                        	;
   99                        	;   7 : 1 to skip BIOS hsync processsing
  100                        	;   6 : 1 to call [hsync_hook]
  101                        	;   5 : 1 to skip BIOS vsync processsing
  102                        	;   4 : 1 to call [vsync_hook]
  103                        	;
  104                        	;   3 : 1 to jump [nmi_hook]
  105                        	;   2 : 1 to jump [timer_hook]
  106                        	;   1 : 1 to jump [irq1_hook]
  107                        	;   0 : 1 to jump [irq2_hook]
  108                        	;
  109                        	; ***************************************************************************
  110                        	; ***************************************************************************
  111                        	
  112    00:E05D  8F F5 01   	core_irq2:	bbs0	<irq_vec, .hook		; 8 cycles if using hook.
  113                        	
  114               0000     		.if	CDROM
  138                        		.else
  139                        			; Does this HuCARD support the IFU's ADPCM hardware?
  140                        	
  141               0000     		.if	SUPPORT_ADPCM
  153                        		.endif	SUPPORT_ADPCM
  154                        	
  155    00:E060  40         			rti				; No IRQ2 hardware on HuCARD.
  156                        	
  157    00:E061  6C 00 22   	.hook:		jmp	[irq2_hook]		; 7 cycles.
  158                        		.endif	CDROM
  159                        	
  160                        	
  161                        	
  162                        	; ***************************************************************************
  163                        	; ***************************************************************************
  164                        	;
  165                        	; core_irq1 - Minimal interrupt handler compatible with System Card.
  166                        	;
  167                        	; irq1_handler - Basic "CORE(not TM)" IRQ1 handler to use as the "irq1_hook".
  168                        	;
  169                        	; Doing the IRQ1 handler processing in this hook means that things operate
  170                        	; the same whether the System Card or an Overlay is paged into MPR7.
  171                        	
  172               0000     		.ifndef	HUCC
  181                        		.else
  182                        			; Faster IRQ servicing for HuCC and code that would like to
  183                        			; avoid the 8 cycles used by the "bbs1" instruction that is
  184                        			; taken when the System Card is mapped into MPR7.
  185                        	
  186    00:E064             	core_irq1:	;;;				; 8 (cycles for the INT)
  187               0001     		.if	CDROM || !defined(NO_CORE_IRQ1_HOOK)
  188    00:E064  6C 02 22   			jmp	[irq1_hook]		; 7 cycles.
  189                        	
  190                        		.endif
  191                        		.endif
  192                        	
  193    00:E067  48         	irq1_handler:	pha				; 3 Save all registers.
  194    00:E068  DA         			phx				; 3
  195    00:E069  5A         			phy				; 3
  196                        	
  197               0000     		.ifndef	USING_RCR_MACROS		;   This slows things down
  206                        		.endif	USING_RCR_MACROS
  207                        	
  208    00:E06A  AD 00 02   			lda	VDC_SR			; 6 Acknowledge the VDC's IRQ.
  209    00:E06D  85 F6      			sta	<vdc_sr			; 4 Remember what caused it.
  210                        	
  211               0001     		.if	SUPPORT_SGX
  212    00:E06F  AE 10 02   			ldx	SGX_SR			; 6 Read SGX_SR after VDC_SR in
  213    00:E072  86 06      			stx	<sgx_sr			; 4 case this is not an SGX!
  214                        		.endif
  215                        	
  216                        			; Handle the VDC's RCR interrupt.
  217                        	
  218    00:E074  29 04      	!:		and	#$04			; 2 Is this an HSYNC interrupt?
  219    00:E076  F0 44      			beq	!+			; 2
  220                        	
  221               0001     		.ifdef	USING_RCR_MACROS
  222                        			VDC_RCR_MACRO
                             	
         00:E078  03 06      			st0	#VDC_RCR		; 5
                             	
         00:E07A  AE 19 27   			ldx	vdc_next_region		; 5 X and Y can be greater than
         00:E07D  BC 1A 27   			ldy	vdc_regionA_nxt, x	; 5 HUCC_PCE_SPLITS if regionB!
         00:E080  18         			clc				; 2
         00:E081  D0 05      			bne	!set_next_rcr+		; 4 Stop RCR if next line is 0.
                             	
         00:E083  2D 53 E0   			and	const_0000		; 5 A=$00 with the same #cycles
         00:E086  80 05      			bra	!clr_next_rcr+		; 4 as if the branch were taken.
                             	
         00:E088  B9 C9 26   	!set_next_rcr:	lda	vdc_regionA_rcr, y	; 5 Set next RCR 1 line before
         00:E08B  69 3F      			adc	#64-1			; 2 the region begins, or 0 to
         00:E08D  8D 02 02   	!clr_next_rcr:	sta	VDC_DL			; 6 disable.
         00:E090  62         			cla				; 2
         00:E091  2A         			rol	a			; 2
         00:E092  8D 03 02   			sta	VDC_DH			; 6
                             	
         00:E095  03 08      			st0	#VDC_BYR		; 5 Do BYR first to mitigate the
         00:E097  BD F9 26   			lda	vdc_regionA_yl, x	; 5 glitch if the IRQ is delayed.
         00:E09A  8D 02 02   			sta	VDC_DL			; 6 = 105 cycles from RCR on SGX
         00:E09D  BD 09 27   			lda	vdc_regionA_yh, x	; 5
         00:E0A0  8D 03 02   			sta	VDC_DH			; 6
                             	
         00:E0A3  03 05      			st0	#VDC_CR			; 5
         00:E0A5  BD B9 26   			lda	vdc_regionA_crl, x	; 5
                             	;		asl	a
         00:E0A8  8D 02 02   			sta	VDC_DL			; 6
                             	
         00:E0AB  03 07      			st0	#VDC_BXR		; 2
         00:E0AD  BD D9 26   			lda	vdc_regionA_xl, x	; 5
         00:E0B0  8D 02 02   			sta	VDC_DL			; 6
         00:E0B3  BD E9 26   			lda	vdc_regionA_xh, x	; 5
         00:E0B6  8D 03 02   			sta	VDC_DH			; 6 = 156 cycles from RCR if DUO
                             	
                             	;		bcc	!+
                             	;		lda	vdc_regionA_yh, x	; 5
                             	;		sta.l	VCE_CTW			; 6
                             	
         00:E0B9  8C 19 27   			sty	vdc_next_region		; 5
                             	
  223                        		.else
  225                        		.endif
  226                        	
  227               0001     		.if	SUPPORT_SGX
  228                        	
  229                        			; Handle the SGX's RCR interrupt.
  230                        	
  231    00:E0BC  2F 06 50   	!:		bbr2	<sgx_sr, !+		; 6 Is this an HSYNC interrupt?
  232                        	
  233               0001     		.ifdef	USING_RCR_MACROS
  234                        			SGX_RCR_MACRO
                             	
         00:E0BF  A9 06      			lda	#VDC_RCR		; 2
         00:E0C1  8D 10 02   			sta	SGX_AR			; 6
                             	
         00:E0C4  AE 9A 27   			ldx	sgx_next_region		; 5 X and Y can be greater than
         00:E0C7  BC 9B 27   			ldy	sgx_regionA_nxt, x	; 5 HUCC_SGX_SPLITS if regionB!
         00:E0CA  18         			clc				; 2
         00:E0CB  D0 05      			bne	!set_next_rcr+		; 4 Stop RCR if next line is 0.
                             	
         00:E0CD  2D 53 E0   			and	const_0000		; 5 A=$00 with the same #cycles
         00:E0D0  80 05      			bra	!clr_next_rcr+		; 4 as if the branch were taken.
                             	
         00:E0D2  B9 4A 27   	!set_next_rcr:	lda	sgx_regionA_rcr, y	; 5 Set next RCR 1 line before
         00:E0D5  69 3F      			adc	#64-1			; 2 the region begins, or 0 to
         00:E0D7  8D 12 02   	!clr_next_rcr:	sta	SGX_DL			; 6 disable.
         00:E0DA  62         			cla				; 2
         00:E0DB  2A         			rol	a			; 2
         00:E0DC  8D 13 02   			sta	SGX_DH			; 6
                             	
         00:E0DF  A9 08      			lda	#VDC_BYR		; 2 Do BYR first to mitigate the
         00:E0E1  8D 10 02   			sta	SGX_AR			; 6 glitch if the IRQ is delayed.
         00:E0E4  BD 7A 27   			lda	sgx_regionA_yl, x	; 5
         00:E0E7  8D 12 02   			sta	SGX_DL			; 6
         00:E0EA  BD 8A 27   			lda	sgx_regionA_yh, x	; 5
         00:E0ED  8D 13 02   			sta	SGX_DH			; 6
                             	
         00:E0F0  A9 05      			lda	#VDC_CR			; 2
         00:E0F2  8D 10 02   			sta	SGX_AR			; 6
         00:E0F5  BD 3A 27   			lda	sgx_regionA_crl, x	; 5
         00:E0F8  8D 12 02   			sta	SGX_DL			; 6
                             	
         00:E0FB  A9 07      			lda	#VDC_BXR		; 2
         00:E0FD  8D 10 02   			sta	SGX_AR			; 6
         00:E100  BD 5A 27   			lda	sgx_regionA_xl, x	; 5
         00:E103  8D 12 02   			sta	SGX_DL			; 6
         00:E106  BD 6A 27   			lda	sgx_regionA_xh, x	; 5
         00:E109  8D 13 02   			sta	SGX_DH			; 6 = 293 cycles (282 if no YH)
                             	
         00:E10C  8C 9A 27   			sty	sgx_next_region		; 5
                             	
  235                        		.else
  237                        		.endif
  238                        	
  239                        		.endif	SUPPORT_SGX
  240                        	
  241                        			; Handle the VDC's VBL interrupt.
  242                        	
  243    00:E10F  5F F6 32   	!:		bbr5	<vdc_sr, .exit_irq1	; 6 Is this a VBLANK interrupt?
  244                        	
  245               0001     		.ifdef	USING_RCR_MACROS		;   If we didn't do it earlier
  246               0000     		.if	CDROM				;   then we need to do it now.
  253                        		.endif	CDROM
  254                        		.endif	USING_RCR_MACROS
  255                        	
  256               0001     		.if	SUPPORT_SGX
  257    00:E112  A9 05      			lda	#VDC_CR			; Update the SGX's Control
  258    00:E114  8D 10 02   			sta	SGX_AR			; Register first, just in
  259    00:E117  8D 00 02   			sta	VDC_AR			; case this is not an SGX!
  260    00:E11A  A5 03      			lda	<sgx_crl		
  261    00:E11C  8D 12 02   			sta	SGX_DL
  262    00:E11F  A5 F3      			lda	<vdc_crl
  263    00:E121  8D 02 02   			sta	VDC_DL
  264                        	
  265                        	;		lda	<sgx_crh		; Do not mess with the SGX's
  266                        	;		sta	SGX_DH			; auto-increment!!!
  267                        	;		lda	<vdc_crh		; Do not mess with the VDC's
  268                        	;		sta	VDC_DH			; auto-increment!!!
  269                        		.else
  277                        		.endif	SUPPORT_SGX
  278                        	
  279    00:E124  EE 41 22   			inc	irq_cnt			; Mark that a VBLANK occurred.
  280                        	
  281    00:E127  4F F5 02   			bbr4	<irq_vec, .skip_hookv	; Is a driver registered?
  282                        	
  283    00:E12A  44 26      			bsr	.user_vsync		; Call game's VBLANK code.
  284                        	
  285    00:E12C  DF F5 15   	.skip_hookv:	bbs5	<irq_vec, .exit_vbl	; Should we skip "BIOS" stuff?
  286                        	
  287    00:E12F  58         			cli				; Allow HSYNC and TIMER IRQ.
  288                        	
  289    00:E130  20 DB FF   			call	read_joypads		; Update joypad state.
  290                        	
  291               0000     		.if	USING_PSGDRIVER
  305                        		.else
  306    00:E133  AD 07 22   			lda	sound_hook + 1		; Is a driver registered?
  307    00:E136  F0 0C      			beq	.exit_vbl
  308                        	
  309    00:E138  A9 80      			lda	#$80			; Acquire sound mutex to avoid
  310    00:E13A  0C E7 22   			tsb	sound_mutex		; conflict with a delayed VBL.
  311    00:E13D  30 05      			bmi	.exit_vbl
  312                        	
  313    00:E13F  44 14      			bsr	.user_sound		; Call the driver hook.
  314                        	
  315    00:E141  9C E7 22   			stz	sound_mutex		; Release sound mutex.
  316                        		.endif	USING_PSGDRIVER
  317                        	
  318    00:E144             	.exit_vbl:
  319                        	
  320               0001     		.ifdef	USING_RCR_MACROS		; If USING_RCR_MACROS then 
  321               0000     		.if	CDROM				; restore after the VBLANK.
  326                        		.endif	CDROM
  327                        		.endif	USING_RCR_MACROS
  328                        	
  329    00:E144             	.exit_irq1:
  330                        	
  331               0000     		.ifndef	USING_RCR_MACROS		; If !USING_RCR_MACROS then
  338                        		.endif	USING_RCR_MACROS
  339                        	
  340               0001     		.if	SUPPORT_SGX
  341    00:E144  A5 07      			lda	<sgx_reg		; Restore SGX_AR first, just
  342    00:E146  8D 10 02   			sta	SGX_AR			; in case this is not an SGX!
  343                        		.endif
  344                        	
  345    00:E149  A5 F7      			lda	<vdc_reg		; Restore VDC_AR in case we
  346    00:E14B  8D 00 02   			sta	VDC_AR			; changed it.
  347                        	
  348    00:E14E  7A         			ply				; Restore all registers.
  349    00:E14F  FA         			plx
  350    00:E150  68         			pla
  351                        	
  352    00:E151  40         			rti				; Return from interrupt.
  353                        	
  354    00:E152  6C 08 22   	.user_vsync:	jmp	[vsync_hook]		; 7
  355    00:E155  6C 06 22   	.user_sound:	jmp	[sound_hook]		; 7
  356                        	
  357               0000     		.ifndef	USING_RCR_MACROS
  362                        		.endif	USING_RCR_MACROS
  363                        	
  364                        	
  365                        	
  366                        	; ***************************************************************************
  367                        	; ***************************************************************************
  368                        	;
  369                        	; core_timer - Minimal interrupt handler compatible with System Card.
  370                        	;
  371                        	; tirq_handler - Basic "CORE(not TM)" TIRQ handler to use as the "timer_hook".
  372                        	;
  373                        	; Doing the TIRQ handler processing in this hook means that things operate
  374                        	; the same whether the System Card or an Overlay is paged into MPR7.
  375                        	
  376               0000     		.ifndef	HUCC
  385                        		.else
  386                        			; Faster IRQ servicing for HuCC and code that would like to
  387                        			; avoid the 8 cycles used by the "bbs2" instruction that is
  388                        			; taken when the System Card is mapped into MPR7.
  389                        	
  390    00:E158             	core_timer:	;;;				; 8 (cycles for the INT)
  391               0001     		.if	CDROM || !defined(NO_CORE_TIRQ_HOOK)
  392    00:E158  6C 04 22   			jmp	[timer_hook]		; 7 cycles.
  393                        		.endif
  394                        		.endif
  395                        	
  396    00:E15B             	tirq_handler:
  397               0000     		.ifdef	USING_TIRQ_MACRO
  399                        		.else
  400    00:E15B  9C 03 14   			stz	IRQ_ACK			; 5 Clear timer interrupt.
  401                        		.endif
  402                        	
  403    00:E15E  40         	core_rti:	rti
  404                        	
  405                        	
  406                        	
  407                        	; ***************************************************************************
  408                        	; ***************************************************************************
  409                        	;
  410                        	; core_clr_hooks - Reset default "CORE(not TM)" interrupt-handling hooks.
  411                        	;
  412                        	
  413    00:E15F  08         	core_clr_hooks:	php				; Preserve interrupt state.
  414    00:E160  78         			sei				; Disable interrupts.
  415                        	
  416               0000     		.if	USING_PSGDRIVER
  419                        		.else
  420    00:E161  9C 07 22   			stz.h	sound_hook		; Disable sound driver calls.
  421                        		.endif
  422                        	
  423    00:E164  A9 88      			lda	#<core_sw_reset		; Set up the soft-reset hook.
  424    00:E166  8D 84 22   			sta.l	reset_hook
  425    00:E169  A9 E1      			lda	#>core_sw_reset
  426    00:E16B  8D 85 22   			sta.h	reset_hook
  427                        	
  428    00:E16E  A9 67      			lda	#<irq1_handler		; Set up the IRQ1 hook.
  429    00:E170  8D 02 22   			sta.l	irq1_hook
  430    00:E173  A9 E0      			lda	#>irq1_handler
  431    00:E175  8D 03 22   			sta.h	irq1_hook
  432                        	
  433    00:E178  A9 5B      			lda	#<tirq_handler		; Set up the TIRQ hook.
  434    00:E17A  8D 04 22   			sta.l	timer_hook
  435    00:E17D  A9 E1      			lda	#>tirq_handler
  436    00:E17F  8D 05 22   			sta.h	timer_hook
  437                        	
  438    00:E182  A9 06      			lda	#%00000110		; Replace the System Card's
  439    00:E184  85 F5      			sta	<irq_vec		; IRQ1 and TIRQ processing.
  440                        	
  441    00:E186  28         			plp				; Restore interrupt state.
  442    00:E187  60         			rts
  443                        	
  444                        	
  445                        	
  446                        	; ***************************************************************************
  447                        	; ***************************************************************************
  448                        	;
  449                        	; Include the joypad library, with configuration from "core-config.inc".
  450                        	;
  451                        	
                             #[6]   "..\..\..\include\hucc\joypad.asm"
  452                        			include "joypad.asm"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; joypad.asm
    5                        	;
    6                        	; Read 2-button & 6-button joypads & PCE mouse, with or without a MultiTap.
    7                        	;
    8                        	; Copyright John Brandwood 2019-2025.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	;
   17                        	; Unlike Lemmings, this code does not interfere with a Memory Base 128! ;-)
   18                        	;
   19                        	; ***************************************************************************
   20                        	; ***************************************************************************
   21                        	;
   22                        	; With SUPPORT_MOUSE ..... 2602 cycles to read 5 ports with 5 mice
   23                        	;
   24                        	; With HuC library code .. 2442 cycles to read 5 ports with 5 pads (2-button)
   25                        	; With HuC library code .. 2442 cycles to read 5 ports with 5 pads (6-button)
   26                        	;
   27                        	; With SUPPORT_MOUSE ....  2016 cycles to read 5 ports with 5 pads (2-button)
   28                        	; With SUPPORT_MOUSE ..... 1976 cycles to read 5 ports with 5 pads (6-button)
   29                        	;
   30                        	; With SUPPORT_MOUSE ....  1618 cycles to read 3 ports with 3 mice
   31                        	; With SUPPORT_MOUSE ..... 1462 cycles to read 3 ports with 2 mice
   32                        	; With SUPPORT_MOUSE ..... 1306 cycles to read 3 ports with 1 mouse
   33                        	;
   34                        	; With SUPPORT_6BUTTON ... 1235 cycles to read 5 ports with 5 pads (2-button)
   35                        	; With SUPPORT_6BUTTON ... 1215 cycles to read 5 ports with 5 pads (6-button)
   36                        	;
   37                        	; With SUPPORT_MOUSE ..... 1126 cycles to read 2 ports with 2 mice
   38                        	; With SUPPORT_MOUSE ...... 970 cycles to read 2 ports with 1 mouse
   39                        	;
   40                        	; Only SUPPORT_2BUTTON .... 971 cycles to read 5 ports with 5 pads (2-button)
   41                        	; Only SUPPORT_2BUTTON .... 861 cycles to read 5 ports with 5 pads (6-button)
   42                        	;
   43                        	; With SUPPORT_MOUSE ...... 634 cycles to read 1 port  with 1 mouse
   44                        	;
   45                        	; ***************************************************************************
   46                        	; ***************************************************************************
   47                        	
  142                        	
  143                        	;
  144                        	; Now choose which version of the code to include.
  145                        	;
  146                        	
  147               0000     		.if	SUPPORT_2BUTTON
  278                        		.endif	SUPPORT_2BUTTON
  279                        	
  280                        	
  281                        	
  282               0000     		.if	SUPPORT_MOUSE
  845                        		.else	SUPPORT_MOUSE
  846                        	
  847                        	
  848                        	
  849               0001     		.if	SUPPORT_6BUTTON			; Without mouse!
  850                        	
  851                        	; ***************************************************************************
  852                        	; ***************************************************************************
  853                        	;
  854                        	; read_joypads - full 6-button pad support, but mouse movement is ignored.
  855                        	;
  856                        	; This code distinguishes between a mouse and a 2-button or 6-button joypad,
  857                        	; so that unsupported devices do not have to be unplugged from the MultiTap.
  858                        	;
  859                        	; The code loops two times to get both sets of buttons on a 6-button joypad.
  860                        	;
  861                        	; N.B. Takes approx 1/3 frame to detect mice the first time it is run.
  862                        	;
  863                        	; bit values for joypad 2-button bytes: (MSB = #7; LSB = #0)
  864                        	; ----------------------------------------------------------
  865                        	; bit 0 (ie $01) = I
  866                        	; bit 1 (ie $02) = II
  867                        	; bit 2 (ie $04) = SELECT
  868                        	; bit 3 (ie $08) = RUN
  869                        	; bit 4 (ie $10) = UP
  870                        	; bit 5 (ie $20) = RIGHT
  871                        	; bit 6 (ie $40) = DOWN
  872                        	; bit 7 (ie $80) = LEFT
  873                        	;
  874                        	; bit values for joypad 6-button bytes: (MSB = #7; LSB = #0)
  875                        	; ----------------------------------------------------------
  876                        	; bit 0 (ie $01) = III
  877                        	; bit 1 (ie $02) = IV
  878                        	; bit 2 (ie $04) = V
  879                        	; bit 3 (ie $08) = VI
  880                        	; bit 4 (ie $10) = zero
  881                        	; bit 5 (ie $20) = zero
  882                        	; bit 6 (ie $40) = zero
  883                        	; bit 7 (ie $80) = zero, but set to one if 6-button pad detected.
  884                        	;
  885                        	
  886               E188     			.code
  887                        	
  888               0001     		.if	(* >= $4000)			; Make this a ".proc" if it
  889    02:D1A5             	read_joypads	.proc                           ; not running in RAM.
  890                        		.else
  892                        		.endif
  893                        	
  894    02:D1A5  A9 80      			lda	#$80			; Acquire port mutex to avoid
  895    02:D1A7  0C D0 22   			tsb	port_mutex		; conflict with a delayed VBL
  896    02:D1AA  30 75      			bmi	.exit			; or access to an MB128.
  897                        	
  898    02:D1AC  73 28 22 32			tii	joynow,joyold,MAX_PADS	; Save the previous values.
         02:D1B0  22 05 00    
  899    02:D1B3  73 D3 22 D8			tii	joy6now,joy6old,MAX_PADS
         02:D1B7  22 05 00    
  900                        	
  901                        			; Reset the 6-btn bits, the user might change the joypad mode!
  902                        	
  903    02:D1BA  F3 53 E0 D3			tai	const_0000, joy6now, MAX_PADS
         02:D1BE  22 05 00    
  904                        	
  905                        			; Detect attached mice the first time this routine is called.
  906                        	
  907    02:D1C1  AD D2 22   			lda	mouse_flg		; Has mouse detection happened?
  908    02:D1C4  30 28      			bmi	.calc_pressed
  909                        	
  910    02:D1C6  A9 05      			lda	#MAX_PADS		; Reset number of pads to read.
  911    02:D1C8  8D D1 22   			sta	num_ports
  912                        	
  913    02:D1CB  A9 1F      			lda	#%00011111		; Try reading everything as a
  914    02:D1CD  8D D2 22   			sta	mouse_flg		; mouse.
  915                        	
  916    02:D1D0  A0 17      			ldy	#23			; Initialize repeat count.
  917    02:D1D2  A9 80      			lda	#$80			; Initialize mouse detection.
  918    02:D1D4  5A         	.detect_loop:	phy
  919    02:D1D5  48         			pha
  920    02:D1D6  44 53      			bsr	.read_devices		; Read all devices as if mice.
  921    02:D1D8  68         			pla
  922    02:D1D9  82         			clx
  923    02:D1DA  BC E2 22   	.detect_port:	ldy	mouse_x, x		; A movement of zero means
  924    02:D1DD  D0 03      			bne	.detect_next		; this port is a mouse.
  925    02:D1DF  1D 55 E0   			ora	bit_mask, x
  926    02:D1E2  E8         	.detect_next:	inx				; Get the next pad from the
  927    02:D1E3  E0 05      			cpx	#MAX_PADS		; multitap.
  928    02:D1E5  D0 F3      			bne	.detect_port
  929    02:D1E7  7A         			ply				; Repeat the detection test.
  930    02:D1E8  88         			dey
  931    02:D1E9  D0 E9      			bne	.detect_loop
  932                        	
  933                        	;	.if	DETECT_PHANTOMS
  934                        	;		cmp	#(1 << MAX_PADS) + 127	; If we find a mouse in every
  935                        	;		bne	.detect_done		; port, then assume mirrored!
  936                        	;		lda	#1			; Report a single mouse in a
  937                        	;		sta	num_ports		; single port.
  938                        	;		lda	#$81
  939                        	;	.endif
  940                        	
  941    02:D1EB  8D D2 22   	.detect_done:	sta	mouse_flg		; Report mouse detection.
  942                        	
  943                        			; See what has just been pressed, and check for soft-reset.
  944                        	
  945    02:D1EE  44 3B      	.calc_pressed:	bsr	.read_devices		; Read all devices normally.
  946                        	
  947    02:D1F0  A2 04      			ldx	#MAX_PADS - 1
  948                        	
  949    02:D1F2  BD D3 22   	.pressed_loop:	lda	joy6now, x		; Calc which buttons have just
  950    02:D1F5  5D D8 22   			eor	joy6old, x		; been pressed (6-button).
  951    02:D1F8  3D D3 22   			and	joy6now, x
  952               0000     		.if	HUC_JOY_EVENTS
  956                        		.else
  957               0000     		.if	ACCUMULATE_JOY
  959                        		.endif
  960    02:D1FB  9D DD 22   			sta	joy6trg, x
  961                        		.endif
  962                        	
  963    02:D1FE  BD 28 22   			lda	joynow, x		; Calc which buttons have just
  964    02:D201  A8         			tay                             ; been pressed (2-button).
  965    02:D202  5D 32 22   			eor	joyold, x
  966    02:D205  3D 28 22   			and	joynow, x
  967               0000     		.if	HUC_JOY_EVENTS
  971                        		.else
  972               0000     		.if	ACCUMULATE_JOY
  974                        		.endif
  975    02:D208  9D 2D 22   			sta	joytrg, x
  976                        		.endif
  977                        	
  978    02:D20B  C9 04      			cmp	#$04			; Detect the soft-reset combo,
  979    02:D20D  D0 0C      			bne	.not_reset		; hold RUN then press SELECT.
  980    02:D20F  C0 0C      			cpy	#$0C
  981    02:D211  D0 08      			bne	.not_reset
  982    02:D213  BD 55 E0   			lda	bit_mask, x
  983    02:D216  2C 27 22   			bit	joyena
  984    02:D219  D0 09      			bne	.soft_reset
  985                        	
  986    02:D21B  CA         	.not_reset:	dex				; Check the next pad from the
  987    02:D21C  10 D4      			bpl	.pressed_loop		; multitap.
  988                        	
  989    02:D21E  9C D0 22   			stz	port_mutex		; Release port mutex.
  990                        	
  991               0001     		.if	(* >= $4000)			; This is a ".proc" if it is
  992                        	.exit:		leave                           ; not running in RAM.
         02:D221  4C EF FF   			jmp	leave_proc
  993                        		.else
  995                        		.endif
  996                        	
  997    02:D224  78         	.soft_reset:	sei				; Disable interrupts.
  998    02:D225  9C D0 22   			stz	port_mutex		; Release port mutex.
  999    02:D228  6C 84 22   			jmp	[reset_hook]		; Jump to the soft-reset hook.
 1000                        	
 1001                        			; Read all of the devices attached to the MultiTap.
 1002                        	
 1003    02:D22B  A2 02      	.read_devices:	ldx	#2			; Repeat this loop 2 times.
 1004                        	
 1005    02:D22D  A9 01      	.read_multitap:	lda	#$01			; CLR lo, SEL hi for d-pad.
 1006    02:D22F  8D 00 10   			sta	IO_PORT
 1007    02:D232  A9 03      			lda	#$03			; CLR hi, SEL hi, reset tap.
 1008    02:D234  8D 00 10   			sta	IO_PORT
 1009    02:D237  C2         			cly				; Start at port 1.
 1010                        	
 1011    02:D238  A9 01      	.read_port:	lda	#$01			; CLR lo, SEL hi for d-pad.
 1012    02:D23A  8D 00 10   			sta	IO_PORT			; Wait 1.25us (9 cycles).
 1013                        	
 1014    02:D23D  B9 55 E0   			lda	bit_mask, y		; Is there a mouse attached?
 1015    02:D240  2D D2 22   			and	mouse_flg
 1016    02:D243  D0 33      			bne	.read_mouse
 1017                        	
 1018    02:D245  AD 00 10   	.read_pad:	lda	IO_PORT			; Read direction-pad bits.
 1019    02:D248  9C 00 10   			stz	IO_PORT			; CLR lo, SEL lo for buttons.
 1020    02:D24B  0A         			asl	a			; Wait 1.25us (9 cycles).
 1021    02:D24C  0A         			asl	a
 1022    02:D24D  0A         			asl	a
 1023    02:D24E  0A         			asl	a
 1024    02:D24F  F0 1B      			beq	.read_6button		; 6-btn pad if UDLR all held.
 1025                        	
 1026    02:D251  99 28 22   	.read_2button:	sta	joynow, y		; Get buttons of 2-btn pad.
 1027    02:D254  AD 00 10   			lda	IO_PORT
 1028    02:D257  29 0F      			and	#$0F
 1029    02:D259  19 28 22   			ora	joynow, y
 1030    02:D25C  49 FF      			eor	#$FF
 1031    02:D25E  99 28 22   			sta	joynow, y
 1032                        	
 1033    02:D261  C8         	.next_port:	iny				; Get the next pad from the
 1034    02:D262  CC D1 22   			cpy	num_ports		; multitap.
 1035    02:D265  90 D1      			bcc	.read_port
 1036                        	
 1037    02:D267  CA         			dex				; Do the next complete pass.
 1038    02:D268  CA         			dex
 1039    02:D269  10 C2      			bpl	.read_multitap		; Have we finished 2 passes?
 1040    02:D26B  60         			rts				; Now that everything is read.
 1041                        	
 1042    02:D26C  AD 00 10   	.read_6button:	lda	IO_PORT			; Get buttons of 6-btn pad.
 1043    02:D26F  29 0F      			and	#$0F
 1044    02:D271  49 8F      			eor	#$8F			; Set bit-7 to show that a
 1045    02:D273  99 D3 22   			sta	joy6now, y		; 6-button pad is present.
 1046    02:D276  80 E9      			bra	.next_port
 1047                        	
 1048    02:D278  7C A9 D2   	.read_mouse:	jmp	[.mouse_vectors, x]	; Which mouse info is next?
 1049                        	
 1050                        			; Mouse processing, normally four passes, here just two.
 1051                        	
 1052    02:D27B  A9 1C      	.mouse_x_hi:	lda	#28			; 189 cycle delay after CLR lo
 1053    02:D27D  3A         	.wait_loop:	dec	a			; on port to allow the mouse
 1054    02:D27E  D0 FD      			bne	.wait_loop		; to buffer and reset counters.
 1055                        	
 1056    02:D280  AD 00 10   			lda	IO_PORT			; Read direction-pad bits.
 1057    02:D283  9C 00 10   			stz	IO_PORT			; CLR lo, SEL lo for buttons.
 1058    02:D286  0A         			asl	a			; Wait 1.25us (9 cycles).
 1059    02:D287  0A         			asl	a
 1060    02:D288  0A         			asl	a
 1061    02:D289  0A         			asl	a
 1062    02:D28A  99 E2 22   			sta	mouse_x, y		; Save port's X-hi nibble.
 1063                        	
 1064    02:D28D  AD 00 10   			lda	IO_PORT			; Get mouse buttons.
 1065    02:D290  29 0F      			and	#$0F
 1066    02:D292  49 0F      			eor	#$0F
 1067    02:D294  99 28 22   			sta	joynow, y
 1068    02:D297  80 C8      			bra	.next_port
 1069                        	
 1070    02:D299  AD 00 10   	.mouse_x_lo:	lda	IO_PORT			; Read direction-pad bits.
 1071    02:D29C  9C 00 10   			stz	IO_PORT			; CLR lo, SEL lo for buttons.
 1072    02:D29F  29 0F      			and	#$0F			; Wait 1.25us (9 cycles).
 1073    02:D2A1  19 E2 22   			ora	mouse_x, y		; Add port's X-hi nibble.
 1074                        	;		eor	#$FF			; Negate so LEFT is -ve.
 1075                        	;		inc	a
 1076    02:D2A4  99 E2 22   			sta	mouse_x, y
 1077    02:D2A7  80 B8      			bra	.next_port
 1078                        	
 1079    02:D2A9  99 D2      	.mouse_vectors: dw	.mouse_x_lo		; Pass 2
 1080    02:D2AB  7B D2      			dw	.mouse_x_hi		; Pass 1
 1081                        	
 1082               0001     		.if	(* >= $4000)			; This is a ".proc" if it is
 1083                        			.endp                           ; not running in RAM.
 1084               22D0     			.bss				; Put the variables in RAM.
 1085                        		.endif
 1086                        	
 1087    F8:22D0             	port_mutex:	ds	1			; NZ when controller port busy.
 1088    F8:22D1             	num_ports:	ds	1			; Set to 1 if no multitap.
 1089    F8:22D2             	mouse_flg:	ds	1			; Which ports are mice?
 1090               0000     		.if	HUC_JOY_EVENTS
 1093                        		.endif
 1094    F8:22D3             	joy6now:	ds	MAX_PADS
 1095    F8:22D8             	joy6old:	ds	MAX_PADS
 1096    F8:22DD             	joy6trg:	ds	MAX_PADS
 1097    F8:22E2             	mouse_x:	ds	MAX_PADS
 1098                        	
 1099               E188     			.code
 1100                        	
 1101                        		.endif	SUPPORT_6BUTTON			; Without mouse!
 1102                        	
 1103                        		.endif	SUPPORT_MOUSE
                             #[5]   "..\..\..\include\hucc\core-kernel.asm"
  453                        	
  454                        	
  455                        	
  456               0001     		.if	!CDROM
  457                        	
  458                        	; ***************************************************************************
  459                        	; ***************************************************************************
  460                        	;
  461                        	; core_sw_reset - Default HuCARD handler for a joypad "soft-reset".
  462                        	;
  463                        	
  464    00:E188  78         	core_sw_reset:	sei				; Disable interrupts.
  465                        	
  466    00:E189  6C FE FF   			jmp	[$FFFE]			; Jump to the HuCARD reset.
  467                        	
  468                        	
  469                        	
  470                        		.else	!CDROM
  616                        		.endif	!CDROM
  617                        	
  618                        	
  619                        	
  620                        	; ***************************************************************************
  621                        	; ***************************************************************************
  622                        	
  623               0001     		.if	(core_kernel >= $4000)		; If not running in RAM, then
  624               22E7     			.bss				; put these variables in RAM.
  625                        		.endif
  626                        	
  627    F8:22E7             	sound_mutex:	ds	1			; NZ when controller port busy.
  628                        	
  629               0001     		.if	SUPPORT_SGX
  630    F8:22E8             	sgx_detected:	ds	1			; NZ if SuperGrafx detected.
  631    F8:22E9             	hsync_hook_sgx:	ds	2			; SGX version of hsync_hook.
  632                        		.endif
  633                        	
  634               0000     		.if	SUPPORT_ACD
  636                        		.endif
  637                        	
  638               0001     		.if	(core_kernel >= $4000)
  639               E18C     			.code
  640                        		.endif
                             #[4]   "..\..\..\include\hucc\core-startup.asm"
  427                        	
  428                        	
  429                        	
  430                        		.else	!CDROM
  524                        		.endif	!CDROM
  525                        	
  526                        	
  527                        	
  528                        	; ***************************************************************************
  529                        	; ***************************************************************************
  530                        	;
  531                        	; With the availability of so many different configuration options, we've now
  532                        	; built somewhere between a few hundred bytes, and a couple of KB, of code in
  533                        	; the CORE_BANK of the HuCARD / overlay program.
  534                        	;
  535                        	; This is the end of the "CORE(not TM)" library code!
  536                        	;
  537                        	; Remember that the ".proc" trampolines are located at the end of this bank,
  538                        	; so the amount of free space left depends upon the number of ".proc" calls.
  539                        	;
  540                        	
  541                        			; Switch to CORE_PAGE to run the developer's game code.
  542               E18C     			.page	CORE_PAGE
  543                        	
  544                        	
  545                        	
  546                        	; ***************************************************************************
  547                        	; ***************************************************************************
  548                        	;
  549                        	; The DATA_BANK location needs to be set as early as possible so that library
  550                        	; code is able to put data in there before the total overall size of the code
  551                        	; is known.
  552                        	;
  553                        	; By default, DATA_BANK is the next bank after the CORE_BANK.
  554                        	;
  555                        	; RESERVE_BANKS allows developers to reserve some banks between the CORE_BANK
  556                        	; and the DATA_BANK that they can use however they wish.
  557                        	;
  558                        	; One use for RESERVE_BANKS is to create empty space that PCEAS can use when
  559                        	; it relocates procedures. This provides a way for a developer to group code
  560                        	; together at the start of memory, and leave the maximum number of banks for
  561                        	; loading dynamic data from CD-ROM.
  562                        	;
  563                        	; The KickC environment sets RESERVE_BANKS=1 (or higher) so that there is a
  564                        	; a bank for the permanent C code and static constants.
  565                        	;
  566                        	; RESERVE_BANKS is normally defined in each project's "core-config.inc".
  567                        	;
  568                        	
  569                        			.opt	d+			; DATA labels use fixed MPR.
  570                        	
  571               0001     			.rsset	CORE_BANK + 1
  572                        	
  573               0000     		.ifdef	NEED_HOME_BANK
  580                        		.endif
  581                        	
  582               0001     		.ifdef	NEED_SOUND_BANK			; Defined in hucc-sound.inc
  583               0000     		.if	NEED_SOUND_BANK			; if the driver wants a bank.
  585                        		.endif
  586                        		.endif
  587                        	
  588               0001     		.ifdef	RESERVE_BANKS			; For CORE projects.
  589               0001     	RESERVED_BANK	.rs	RESERVE_BANKS
  590                        		.endif
  591                        	
  592               0001     		.ifdef	HUCC
  593               0001     		.ifdef	HUC_RESERVE_BANKS		; For HuCC projects.
  594               0001     	HUC_USER_BANK	.rs	HUC_RESERVE_BANKS
  595                        		.endif
  596                        	
  597               0001     	CONST_BANK	.rs	2
  598               6000     			.rodata
  599               0001     			.bank	CONST_BANK, ".rodata"
  600                        		.endif	HUCC
  601                        	
  602               0003     	DATA_BANK	.rs	0
  603               6000     			.data
  604               0000     		.if	BUILDING_STAGE1
  606                        		.else
  607               0003     			.bank	DATA_BANK, ".data"
  608                        		.endif
  609               6000     			.org	$6000
  610                        	
  611               E18C     			.code
                             #[3]   "..\..\..\include\hucc\core.inc"
                             #[2]   "..\..\..\include\hucc\hucc.asm"
  120                        		.else
  126                        		.endif
  127                        	
  128                        			; Allocate this as early as possible to ensure bank-aligned
  129                        			; so that there is no wasted space for aligning the table.
  130                        	
  131               0000     		.if	FAST_MULTIPLY
  138                        		.endif
  139                        	
  140                        			;
  141                        	
  144                        	
  145                        			; The hardware stack is used for expressions.
  146                        	
  147               00FF     	__tos		=	$F8:2101, 255
  148                        	
  149               2008     			.zp
  150               2008     			.align	2
  151    F8:2008             	__stack:	ds	HUCC_STACK_SZ
  152                        	
  153    F8:2088             	__ptr:		ds	2
  154    F8:208A             	__fptr:		ds	2
  155    F8:208C             	__fbank:	ds	1
  156    F8:208D             	__sp:		ds	1
  157                        	
  158                        			; REGTEMP 6-byte stack for temporaries used by SDCC.
  159                        			; Keep the size in sync with NUM_TEMP_REGS in sdcc/src/mos6502/gen.h!
  160                        	
  161    F8:208E             	REGTEMP:	ds	6
  162                        	
  163                        			; HuCC's non-recursive consecutive varargs for printf().
  164                        	
  165               2008     	__vararg1	=	__stack + 0
  166               200A     	__vararg2	=	__stack + 2
  167               200C     	__vararg3	=	__stack + 4
  168               200E     	__vararg4	=	__stack + 6
  169                        	
  170                        			; Pointer used by poke() because __ptr could be overwritten.
  171                        	
  172               20EE     	__poke		=	__si
  173                        	
  174                        			; Used for indirect calls because __ptr could be overwritten.
  175                        	
  176               20EE     	__func		=	__si
  177                        	
  178                        			; Data pointer used by SDCC for indirect indexed memory access.
  179                        	
  180               2088     	DPTR		=	__ptr
  181                        	
  182                        			; Values returned from SDCC functions that don't fit into XA.
  183                        			; These are also used as workspace for SDCC library functions,
  184                        			; including HuCC's multiplication and division functions.
  185                        	
  186    F8:2094             	___SDCC_m6502_ret0:	ds	1
  187    F8:2095             	___SDCC_m6502_ret1:	ds	1
  188    F8:2096             	___SDCC_m6502_ret2:	ds	1
  189    F8:2097             	___SDCC_m6502_ret3:	ds	1
  190                        	
  191               0000     		.if	0
  196                        		.endif
  197                        	
  198                        			; Permanent pointers for fast table-of-squares multiplication.
  199                        	
  200               0000     		.if	FAST_MULTIPLY
  205                        		.endif
  206                        	
  207                        			; HuCC keeps a realtime clock, updated in hucc_vbl.
  208                        			;
  209                        			; Defining this here means that it will go before any HuCC
  210                        			; variables in "globals.h", and so it won't get cleared in
  211                        			; a CDROM game when loading different overlays.
  212                        	
  213               22EB     			.bss
  214    F8:22EB             	old_cnt:	ds	1			; irq_cnt of previous vsync().
  215    F8:22EC             	clock_hh:	ds	1			; System Clock, hours	(0-11)
  216    F8:22ED             	clock_mm:	ds	1			; System Clock, minutes (0-59)
  217    F8:22EE             	clock_ss:	ds	1			; System Clock, seconds (0-59)
  218    F8:22EF             	clock_tt:	ds	1			; System Clock, ticks	(0-59)
  219               E18C     			.code
  220                        	
  221                        			; Critical HuCC libraries that the compiler depends upon.
  222                        			;
  223                        			; These include various macros that must be defined before
  224                        			; they are encountered in any compiler-generated code.
  225                        	
                             #[3]   "..\..\..\include\hucc\hucc-codegen.asm"
  226                        			include "hucc-codegen.asm"	; HuCC i-code macros and funcs.
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; hucc-codegen.asm
    5                        	;
    6                        	; The HuCC compiler translates C code into these macros, it does not directly
    7                        	; generate HuC6280 instructions.
    8                        	;
    9                        	; Based on the original HuC macros created by David Michel and the other HuC
   10                        	; developers, later modified and improved by Ulrich Hecht.
   11                        	;
   12                        	; Modifications copyright John Brandwood 2024.
   13                        	;
   14                        	; Distributed under the Boost Software License, Version 1.0.
   15                        	; (See accompanying file LICENSE_1_0.txt or copy at
   16                        	;  http://www.boost.org/LICENSE_1_0.txt)
   17                        	;
   18                        	; ***************************************************************************
   19                        	; ***************************************************************************
   20                        	;
   21                        	; NAMING SCHEME FOR HuCC MACROS ...
   22                        	;
   23                        	;   __function.parameters
   24                        	;
   25                        	; {parameters} is a list of alphanumeric specifiers, starting with {size} and
   26                        	; followed by {where}, followed by {index} if an array, then optional {value}
   27                        	; and finally ending with optional {suffix}
   28                        	;
   29                        	; {size}
   30                        	;   w : 16-bit signed int (default "int" in HuCC)
   31                        	;   c : 16-bit unsigned int (a "cardinal" in Pascal terms)
   32                        	;   b :  8-bit signed char
   33                        	;   u :  8-bit unsigned char (default "char" in HuCC)
   34                        	;
   35                        	; {where} or {index}
   36                        	;   r : HuCC primary register, made up of the Y:A cpu registers
   37                        	;   t : top of expression stack
   38                        	;   p : indirect pointer, usually [__ptr]
   39                        	;   f : structure field (member) offset value
   40                        	;   i : immediate value, i.e. a decimal number
   41                        	;   m : memory, i.e. C global, static, and "-fno-recursive" variables
   42                        	;   s : stack, i.e. C function parameters and locals (not "-fno-recursive")
   43                        	;   a : array, i.e. C global, static, "-fno-recursive" arrays <= 256 bytes
   44                        	;   x : array index already in the X register
   45                        	;   y : array index already in the Y register
   46                        	;
   47                        	; {value} OPTIONAL
   48                        	;   i : immediate value, i.e. a decimal number
   49                        	;   z : zero value
   50                        	;
   51                        	; {suffix} OPTIONAL
   52                        	;   q : quick, used for optimized math on only 8-bit values, because all math
   53                        	;       is normally promoted to "int" size in C; and when optimized stores do
   54                        	;       not need to preserve the primary register contents
   55                        	;
   56                        	; ***************************************************************************
   57                        	; ***************************************************************************
   58                        	
   59                        	
   60                        	
 8399                        	
 8400                        	; ***************************************************************************
 8401                        	; ***************************************************************************
 8402                        	; subroutines for logical and arithmetic shifts by a constant amount
 8403                        	; ***************************************************************************
 8404                        	; ***************************************************************************
 8405                        	
 8406                        	; **************
 8407                        	; Y:A = Y:A << const
 8408                        	
 8409    00:E1BE  0A         	aslw15:		asl	a
 8410    00:E1BF  0A         	aslw14:		asl	a
 8411    00:E1C0  0A         	aslw13:		asl	a
 8412    00:E1C1  0A         	aslw12:		asl	a
 8413    00:E1C2  0A         	aslw11:		asl	a
 8414    00:E1C3  0A         	aslw10:		asl	a
 8415    00:E1C4  0A         	aslw9:		asl	a
 8416    00:E1C5  A8         	aslw8:		tay
 8417    00:E1C6  62         			cla
 8418    00:E1C7  60         			rts
 8419                        	
 8420               0001     		.if	1
 8421    00:E1C8  66 00      	aslw5:		ror	<__temp
 8422    00:E1CA  6A         			ror	a
 8423    00:E1CB  66 00      	aslw6:		ror	<__temp
 8424    00:E1CD  6A         			ror	a
 8425    00:E1CE  66 00      	aslw7:		ror	<__temp
 8426    00:E1D0  6A         			ror	a
 8427    00:E1D1  A4 00      			ldy	<__temp
 8428    00:E1D3  60         			rts
 8429                        		.else
 8436                        		.endif
 8437    00:E1D4  0A         	aslw4:		asl	a
 8438    00:E1D5  26 00      			rol	<__temp
 8439    00:E1D7  0A         	aslw3:		asl	a
 8440    00:E1D8  26 00      			rol	<__temp
 8441    00:E1DA  0A         	aslw2:		asl	a
 8442    00:E1DB  26 00      			rol	<__temp
 8443    00:E1DD  0A         	aslw1:		asl	a
 8444    00:E1DE  26 00      			rol	<__temp
 8445    00:E1E0  A4 00      	aslw0:		ldy	<__temp
 8446    00:E1E2  60         			rts
 8447                        	
 8448                        	; **************
 8449                        	; Y:A = Y:A >> const
 8450                        	
 8451    00:E1E3  C9 80      	asrw15:		cmp	#$80
 8452    00:E1E5  6A         			ror	a
 8453    00:E1E6  C9 80      	asrw14:		cmp	#$80
 8454    00:E1E8  6A         			ror	a
 8455    00:E1E9  C9 80      	asrw13:		cmp	#$80
 8456    00:E1EB  6A         			ror	a
 8457    00:E1EC  C9 80      	asrw12:		cmp	#$80
 8458    00:E1EE  6A         			ror	a
 8459    00:E1EF  C9 80      	asrw11:		cmp	#$80
 8460    00:E1F1  6A         			ror	a
 8461    00:E1F2  C9 80      	asrw10:		cmp	#$80
 8462    00:E1F4  6A         			ror	a
 8463    00:E1F5  C9 80      	asrw9:		cmp	#$80
 8464    00:E1F7  6A         			ror	a
 8465    00:E1F8  C9 80      	asrw8:		cmp	#$80
 8466    00:E1FA  C2         			cly
 8467    00:E1FB  90 01      			bcc	!+
 8468    00:E1FD  88         			dey
 8469    00:E1FE  60         	!:		rts
 8470                        	
 8471    00:E1FF  C0 80      	asrw7:		cpy	#$80
 8472    00:E201  66 00      			ror	<__temp
 8473    00:E203  6A         			ror	a
 8474    00:E204  C0 80      	asrw6:		cpy	#$80
 8475    00:E206  66 00      			ror	<__temp
 8476    00:E208  6A         			ror	a
 8477    00:E209  C0 80      	asrw5:		cpy	#$80
 8478    00:E20B  66 00      			ror	<__temp
 8479    00:E20D  6A         			ror	a
 8480    00:E20E  C0 80      	asrw4:		cpy	#$80
 8481    00:E210  66 00      			ror	<__temp
 8482    00:E212  6A         			ror	a
 8483    00:E213  C0 80      	asrw3:		cpy	#$80
 8484    00:E215  66 00      			ror	<__temp
 8485    00:E217  6A         			ror	a
 8486    00:E218  C0 80      	asrw2:		cpy	#$80
 8487    00:E21A  66 00      			ror	<__temp
 8488    00:E21C  6A         			ror	a
 8489    00:E21D  C0 80      	asrw1:		cpy	#$80
 8490    00:E21F  66 00      			ror	<__temp
 8491    00:E221  6A         			ror	a
 8492    00:E222  A4 00      	asrw0:		ldy	<__temp
 8493    00:E224  60         			rts
 8494                        	
 8495                        	; **************
 8496                        	; Y:A = Y:A >> const
 8497                        	
 8498    00:E225  4A         	lsrw15:		lsr	a
 8499    00:E226  4A         	lsrw14:		lsr	a
 8500    00:E227  4A         	lsrw13:		lsr	a
 8501    00:E228  4A         	lsrw12:		lsr	a
 8502    00:E229  4A         	lsrw11:		lsr	a
 8503    00:E22A  4A         	lsrw10:		lsr	a
 8504    00:E22B  4A         	lsrw9:		lsr	a
 8505    00:E22C  C2         	lsrw8:		cly
 8506    00:E22D  60         			rts
 8507                        	
 8508    00:E22E  46 00      	lsrw7:		lsr	<__temp
 8509    00:E230  6A         			ror	a
 8510    00:E231  46 00      	lsrw6:		lsr	<__temp
 8511    00:E233  6A         			ror	a
 8512    00:E234  46 00      	lsrw5:		lsr	<__temp
 8513    00:E236  6A         			ror	a
 8514    00:E237  46 00      	lsrw4:		lsr	<__temp
 8515    00:E239  6A         			ror	a
 8516    00:E23A  46 00      	lsrw3:		lsr	<__temp
 8517    00:E23C  6A         			ror	a
 8518    00:E23D  46 00      	lsrw2:		lsr	<__temp
 8519    00:E23F  6A         			ror	a
 8520    00:E240  46 00      	lsrw1:		lsr	<__temp
 8521    00:E242  6A         			ror	a
 8522    00:E243  A4 00      	lsrw0:		ldy	<__temp
 8523    00:E245  60         			rts
 8524                        	
 8525                        	
 8526                        	
 8527                        	; ***************************************************************************
 8528                        	; ***************************************************************************
 8529                        	; subroutines for logical and arithmetic shifts by a variable amount
 8530                        	; ***************************************************************************
 8531                        	; ***************************************************************************
 8532                        	
 8533                        	; **************
 8534                        	; Y:A = Y:A << X
 8535                        	
 8536    00:E246  84 00      	asl.wx:		sty	<__temp
 8537    00:E248  E0 10      			cpx	#16
 8538    00:E24A  B0 37      			bcs	!zero+
 8539    00:E24C  CA         			dex
 8540    00:E24D  30 06      			bmi	.done
 8541    00:E24F  0A         	.loop:		asl	a
 8542    00:E250  26 00      			rol	<__temp
 8543    00:E252  CA         			dex
 8544    00:E253  10 FA      			bpl	.loop
 8545    00:E255  A4 00      	.done:		ldy	<__temp
 8546    00:E257  60         			rts
 8547                        	
 8548                        	; **************
 8549                        	; Y:A = Y:A >> X
 8550                        	
 8551    00:E258  84 00      	asr.wx:		sty	<__temp
 8552    00:E25A  10 17      			bpl	!positive+
 8553    00:E25C  E0 10      	!negative:	cpx	#16
 8554    00:E25E  B0 0D      			bcs	.sign
 8555    00:E260  CA         			dex
 8556    00:E261  30 07      			bmi	.done
 8557    00:E263  38         	.loop:		sec
 8558    00:E264  66 00      			ror	<__temp
 8559    00:E266  6A         			ror	a
 8560    00:E267  CA         			dex
 8561    00:E268  10 F9      			bpl	.loop
 8562    00:E26A  A4 00      	.done:		ldy	<__temp
 8563    00:E26C  60         			rts
 8564                        	
 8565    00:E26D  A9 FF      	.sign:		lda	#$FF
 8566    00:E26F  A8         			tay
 8567    00:E270  60         			rts
 8568                        	
 8569                        	; **************
 8570                        	; Y:A = Y:A >> X
 8571                        	
 8572    00:E271  84 00      	lsr.wx:		sty	<__temp
 8573    00:E273  E0 10      	!positive:	cpx	#16
 8574    00:E275  B0 0C      			bcs	!zero+
 8575    00:E277  CA         			dex
 8576    00:E278  30 06      			bmi	.done
 8577    00:E27A  46 00      	.loop:		lsr	<__temp
 8578    00:E27C  6A         			ror	a
 8579    00:E27D  CA         			dex
 8580    00:E27E  10 FA      			bpl	.loop
 8581    00:E280  A4 00      	.done:		ldy	<__temp
 8582    00:E282  60         			rts
 8583                        	
 8584    00:E283  62         	!zero:		cla
 8585    00:E284  C2         			cly
 8586    00:E285  60         			rts
 8587                        	
 8588                        	
 8589                        	
 8590                        	; ***************************************************************************
 8591                        	; ***************************************************************************
 8592                        	; POTENTIAL OPTIMIZATIONS, NOT YET ADDED
 8593                        	; ***************************************************************************
 8594                        	; ***************************************************************************
                             #[2]   "..\..\..\include\hucc\hucc.asm"
                             #[3]   "..\..\..\include\hucc\hucc-baselib.asm"
  227                        			include	"hucc-baselib.asm"	; HuCC base library macros.
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; hucc-baselib.asm
    5                        	;
    6                        	; Basic library functions provided (mostly) as macros.
    7                        	;
    8                        	; Copyright John Brandwood 2024-2025.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	
   17                        	
   18                        	
   19                        	; ***************************************************************************
   20                        	; ***************************************************************************
   21                        	;
   22                        	; Make certain System Card variables accessible to HuCC.
   23                        	
   24    00:E286             	_irq_cnt	.alias	irq_cnt
   25    00:E286             	_joynow		.alias	joynow
   26    00:E286             	_joytrg		.alias	joytrg
   27    00:E286             	_joy6now	.alias	joy6now
   28    00:E286             	_joy6trg	.alias	joy6trg
   29    00:E286             	_bg_x1		.alias	bg_x1
   30    00:E286             	_bg_y1		.alias	bg_y1
   31    00:E286             	_bg_x2		.alias	bg_x2
   32    00:E286             	_bg_y2		.alias	bg_y2
   33                        	
   34                        	
   35                        	
   36                        	; ***************************************************************************
   37                        	; ***************************************************************************
   38                        	;
   39                        	; void __fastcall dump_screen( void );
   40                        	;
   41                        	; THIS IS AN ILLEGAL INSTRUCTION ONLY IMPLEMENTED BY THE TGEMU EMULATOR!
   42                        	
   43    00:E286  33         	_dump_screen:	db	0x33
   44                        	
   45                        	
   46                        	
   47                        	; ***************************************************************************
   48                        	; ***************************************************************************
   49                        	;
   50                        	; void __fastcall abort( void );
   51                        	;
   52                        	; THIS IS AN ILLEGAL INSTRUCTION ONLY IMPLEMENTED BY THE TGEMU EMULATOR!
   53                        	
   54    00:E287  E2         	_abort:		db	0xE2
   55                        	
   56                        	
   57                        	
   58                        	; ***************************************************************************
   59                        	; ***************************************************************************
   60                        	;
   61                        	; void __fastcall exit( int value<acc> );
   62                        	;
   63                        	; THIS IS AN ILLEGAL INSTRUCTION ONLY IMPLEMENTED BY THE TGEMU EMULATOR!
   64                        	
   65    00:E288  AA         	_exit.1:	tax				; Put the return code into X.
   66    00:E289  63         			db	0x63
   67                        	
   68    00:E28A  80 FE      	.hang:		bra	.hang			; Hang if used in normal code.
   69                        	
   70                        	
   71                        	
   72                        	; ***************************************************************************
   73                        	; ***************************************************************************
   74                        	;
   75                        	; unsigned char __fastcall __macro cd_execoverlay( unsigned char ovl_index<acc> );
   76                        	;
   77                        	; Execute program overlay from disc
   78                        	;
   79                        	; N.B. This does not return, even if there's an error.
   80                        	
   81                        			.macro	_cd_execoverlay.1
   82                        			tax
   83                        			jmp	exec_overlay
   84                        			.endm
   85                        	
   86                        	
   87                        	
   88                        	; ***************************************************************************
   89                        	; ***************************************************************************
   90                        	;
   91                        	; void __fastcall __nop set_far_base( unsigned char data_bank<_bp_bank>, unsigned char *data_addr<_bp> );
   92                        	; void __fastcall set_far_offset( unsigned int offset<_bp>, unsigned char data_bank<_bp_bank>, unsigned char *data_addr<acc> );
   93                        	
   94    00:E28C             	_set_far_offset.3:
   95    00:E28C  18         			clc
   96    00:E28D  65 EC      			adc.l	<_bp
   97    00:E28F  85 EC      			sta.l	<_bp
   98    00:E291  98         			tya
   99    00:E292  29 1F      			and	#$1F
  100    00:E294  65 ED      			adc.h	<_bp
  101    00:E296  A8         			tay
  102    00:E297  29 1F      			and	#$1F
  103    00:E299  09 60      			ora	#$60
  104    00:E29B  85 ED      			sta.h	<_bp
  105    00:E29D  98         			tya
  106    00:E29E  6A         			ror	a
  107    00:E29F  4A         			lsr	a
  108    00:E2A0  4A         			lsr	a
  109    00:E2A1  4A         			lsr	a
  110    00:E2A2  4A         			lsr	a
  111    00:E2A3  18         			clc
  112    00:E2A4  65 02      			adc	<_bp_bank
  113    00:E2A6  85 02      			sta	<_bp_bank
  114    00:E2A8  60         			rts
  115                        	
  116                        	
  117                        	; ***************************************************************************
  118                        	; ***************************************************************************
  119                        	;
  120                        	; void __fastcall __macro reset_mpr2( void );
  121                        	; void __fastcall __macro reset_mpr34( void );
  122                        	;
  123                        	; void * __fastcall __macro set_mpr2( void __far *addr<_bp_bank:_bp> );
  124                        	; void * __fastcall __macro set_mpr34( void __far *addr<_bp_bank:_bp> );
  125                        	;
  126                        	; void * __fastcall __macro far_set_mpr2( void );
  127                        	; void * __fastcall __macro far_set_mpr34( void );
  128                        	
  129                        	_reset_mpr2	.macro
  130                        		.if	SUPPORT_SGX
  131                        			lda	#$F9
  132                        		.else
  133                        			lda	#$87
  134                        		.endif
  135                        			tam2
  136                        			.endm
  137                        	
  138                        	_reset_mpr34	.macro
  139                        			lda	#CONST_BANK + _bank_base
  140                        			tam3
  141                        			inc	a
  142                        			tam4
  143                        			.endm
  144                        	
  145                        	_farset_mpr2.1	.macro
  146                        			lda	<_bp_bank
  147                        			tam2
  148                        			lda.l	<_bp
  149                        			ldy.h	<_bp
  150                        			.endm
  151                        	
  152                        	_farset_mpr34.1	.macro
  153                        			lda	<_bp_bank
  154                        			tam3
  155                        			inc	a
  156                        			tam4
  157                        			lda.l	<_bp
  158                        			ldy.h	<_bp
  159                        			.endm
  160                        	
  161                        	_far_set_mpr2	.macro
  162                        			lda	<_bp_bank
  163                        			tam2
  164                        			lda.l	<_bp
  165                        			ldy.h	<_bp
  166                        			.endm
  167                        	
  168                        	_far_set_mpr34	.macro
  169                        			lda	<_bp_bank
  170                        			tam3
  171                        			inc	a
  172                        			tam4
  173                        			lda.l	<_bp
  174                        			ldy.h	<_bp
  175                        			.endm
  176                        	
  177                        	
  178                        	
  179                        	; ***************************************************************************
  180                        	; ***************************************************************************
  181                        	;
  182                        	; unsigned char __fastcall __macro ac_exists( void );
  183                        	
  184                        	_ac_exists	.macro
  185                        			cla
  186                        			ldy	ACD_FLAG
  187                        			cpy	#ACD_ID
  188                        			bne	!+
  189                        			inc	a
  190                        	!:		cly
  191                        			.endm
  192                        	
  193                        	
  194                        	
  195                        	; ***************************************************************************
  196                        	; ***************************************************************************
  197                        	;
  198                        	; unsigned char __fastcall __macro _sgx_detect( void );
  199                        	
  200                        	_sgx_detect	.macro
  201                        			lda	sgx_detected
  202                        			cly
  203                        			.endm
  204                        	
  205                        	
  206                        	
  207                        	; ***************************************************************************
  208                        	; ***************************************************************************
  209                        	;
  210                        	; unsigned int __fastcall __macro peek( unsigned int addr<__ptr> );
  211                        	
  212                        	_peek.1		.macro
  213                        			lda	[__ptr]
  214                        			cly
  215                        			.endm
  216                        	
  217                        	
  218                        	
  219                        	; ***************************************************************************
  220                        	; ***************************************************************************
  221                        	;
  222                        	; unsigned int __fastcall __macro peekw( unsigned int addr<__ptr> );
  223                        	
  224                        	_peekw.1	.macro
  225                        			lda	[__ptr]
  226                        			pha
  227                        			ldy	#1
  228                        			lda	[__ptr], y
  229                        			tay
  230                        			pla
  231                        			.endm
  232                        	
  233                        	
  234                        	
  235                        	; ***************************************************************************
  236                        	; ***************************************************************************
  237                        	;
  238                        	; void __fastcall __macro poke( unsigned int addr<__poke>, unsigned char with<acc> );
  239                        	;
  240                        	; N.B. Because the <acc> value can be a complex C calculation, it isn't safe
  241                        	; to use __ptr as the destination, which can be overwritten in C macros.
  242                        	
  243                        	_poke.2		.macro
  244                        			sta	[__poke]
  245                        			.endm
  246                        	
  247                        	
  248                        	
  249                        	; ***************************************************************************
  250                        	; ***************************************************************************
  251                        	;
  252                        	; void __fastcall __macro pokew( unsigned int addr<__poke>, unsigned int with<acc> );
  253                        	;
  254                        	; N.B. Because the <acc> value can be a complex C calculation, it isn't safe
  255                        	; to use __ptr as the destination, which can be overwritten in C macros.
  256                        	
  257                        	_pokew.2	.macro
  258                        			sta	[__poke]
  259                        			tya
  260                        			ldy	#1
  261                        			sta	[__poke], y
  262                        			.endm
  263                        	
  264                        	
  265                        	
  266                        	; ***************************************************************************
  267                        	; ***************************************************************************
  268                        	;
  269                        	; unsigned char __fastcall __macro clock_hh( void );
  270                        	
  271                        	_clock_hh	.macro
  272                        			lda	clock_hh
  273                        			cly
  274                        			.endm
  275                        	
  276                        	
  277                        	
  278                        	; ***************************************************************************
  279                        	; ***************************************************************************
  280                        	;
  281                        	; unsigned char __fastcall __macro clock_mm( void );
  282                        	
  283                        	_clock_mm	.macro
  284                        			lda	clock_mm
  285                        			cly
  286                        			.endm
  287                        	
  288                        	
  289                        	
  290                        	; ***************************************************************************
  291                        	; ***************************************************************************
  292                        	;
  293                        	; unsigned char __fastcall __macro clock_ss( void );
  294                        	
  295                        	_clock_ss	.macro
  296                        			lda	clock_ss
  297                        			cly
  298                        			.endm
  299                        	
  300                        	
  301                        	
  302                        	; ***************************************************************************
  303                        	; ***************************************************************************
  304                        	;
  305                        	; unsigned char __fastcall __macro clock_tt( void );
  306                        	
  307                        	_clock_tt	.macro
  308                        			lda	clock_tt
  309                        			cly
  310                        			.endm
  311                        	
  312                        	
  313                        	
  314                        	; ***************************************************************************
  315                        	; ***************************************************************************
  316                        	;
  317                        	; void __fastcall __macro clock_reset( void );
  318                        	
  319                        	_clock_reset	.macro
  320                        			stz	clock_hh
  321                        			stz	clock_mm
  322                        			stz	clock_ss
  323                        			stz	clock_tt
  324                        			.endm
  325                        	
  326                        	
  327                        	
  328                        	; ***************************************************************************
  329                        	; ***************************************************************************
  330                        	;
  331                        	; unsigned int __fastcall __macro joy( unsigned char which<acc> );
  332                        	
  333                        	_joy.1		.macro
  334                        			tax
  335                        			lda	joynow, x
  336                        		.if	SUPPORT_6BUTTON
  337                        			ldy	joy6now, x
  338                        		.else
  339                        			cly
  340                        		.endif
  341                        			.endm
  342                        	
  343                        	
  344                        	
  345                        	; ***************************************************************************
  346                        	; ***************************************************************************
  347                        	;
  348                        	; unsigned int __fastcall __macro joytrg( unsigned char which<acc> );
  349                        	
  350                        	_joytrg.1	.macro
  351                        			tax
  352                        			lda	joytrg, x
  353                        		.if	SUPPORT_6BUTTON
  354                        			ldy	joy6trg, x
  355                        		.else
  356                        			cly
  357                        		.endif
  358                        			.endm
  359                        	
  360                        	
  361                        	
  362                        	; ***************************************************************************
  363                        	; ***************************************************************************
  364                        	;
  365                        	; unsigned int __fastcall __macro joybuf( unsigned char which<acc> );
  366                        	
  367                        	_joybuf.1	.macro
  368                        		.if	HUC_JOY_EVENTS
  369                        			tax
  370                        			lda	joybuf, x
  371                        		.if	SUPPORT_6BUTTON
  372                        			ldy	joy6buf, x
  373                        		.else
  374                        			cly
  375                        		.endif
  376                        		.else
  377                        			.fail	You must enable HUC_JOY_EVENTS in your hucc-config.inc!
  378                        		.endif
  379                        			.endm
  380                        	
  381                        	
  382                        	
  383                        	; ***************************************************************************
  384                        	; ***************************************************************************
  385                        	;
  386                        	; unsigned int __fastcall __macro get_joy_events( unsigned char which<acc> );
  387                        	;
  388                        	; N.B. This is just a version of joybuf() that clears the accumulated events.
  389                        	
  390                        			.macro	_get_joy_events.1
  391                        		.if	HUC_JOY_EVENTS
  392                        			tax
  393                        			lda	joybuf, x
  394                        			stz	joybuf, x
  395                        		.if	SUPPORT_6BUTTON
  396                        			ldy	joy6buf, x
  397                        			stz	joy6buf, x
  398                        		.else
  399                        			cly
  400                        		.endif
  401                        		.else
  402                        		.if	ACCUMULATE_JOY
  403                        			tax
  404                        			lda	joytrg, x
  405                        			stz	joytrg, x
  406                        		.if	SUPPORT_6BUTTON
  407                        			ldy	joy6trg, x
  408                        			stz	joy6trg, x
  409                        		.else
  410                        			cly
  411                        		.endif
  412                        		.else
  413                        			.fail	You must enable HUC_JOY_EVENTS or ACCUMULATE_JOY in your hucc-config.inc!
  414                        		.endif
  415                        		.endif
  416                        			.endm
  417                        	
  418                        	
  419                        	
  420                        	; ***************************************************************************
  421                        	; ***************************************************************************
  422                        	;
  423                        	; void __fastcall __macro clear_joy_events( unsigned char mask<acc> );
  424                        	
  425                        			.macro	_clear_joy_events.1
  426                        			php
  427                        			sei
  428                        			and	#(1 << MAX_PADS) - 1
  429                        			ldx	#$FF
  430                        	.loop:		inx
  431                        			lsr	a
  432                        			bcc	.next
  433                        		.if	HUC_JOY_EVENTS
  434                        			stz	joybuf, x
  435                        		.if	SUPPORT_6BUTTON
  436                        			stz	joy6buf, x
  437                        		.endif
  438                        		.else
  439                        		.if	ACCUMULATE_JOY
  440                        			stz	joytrg, x
  441                        		.if	SUPPORT_6BUTTON
  442                        			stz	joy6trg, x
  443                        		.endif
  444                        		.else
  445                        			.fail	You must enable HUC_JOY_EVENTS or ACCUMULATE_JOY in your hucc-config.inc!
  446                        		.endif
  447                        		.endif
  448                        	.next:		bne	.loop
  449                        			plp
  450                        			.endm
  451                        	
  452                        	
  453                        	
  454                        	; ***************************************************************************
  455                        	; ***************************************************************************
  456                        	;
  457                        	; void __fastcall srand( unsigned char seed<acc> );
  458                        	
  459               0001     		.ifndef	HUCC_NO_DEFAULT_RANDOM
  460                        	_srand.1	.macro
  461                        			tay
  462                        			jsr	init_random
  463                        			.endm
  464                        		.endif
  465                        	
  466                        	
  467                        	
  468                        	; ***************************************************************************
  469                        	; ***************************************************************************
  470                        	;
  471                        	; unsigned int __fastcall rand( void );
  472                        	; unsigned char __fastcall rand8( void );
  473                        	
  474               0001     		.ifndef	HUCC_NO_DEFAULT_RANDOM
  475    00:E2A9  20 C3 E5   	_rand:		jsr	get_random		; Random in A, preserve Y.
  476    00:E2AC  A8         			tay
  477    00:E2AD  4C C3 E5   			jmp	get_random		; Random in A, preserve Y.
  478                        		.endif
  479                        	
  480                        	
  481                        	
  482                        	; ***************************************************************************
  483                        	; ***************************************************************************
  484                        	;
  485                        	; unsigned char __fastcall random8( unsigned char limit<acc> );
  486                        	;
  487                        	; IN :	A = range (0..255)
  488                        	; OUT : A = random number interval 0 <= x < A
  489                        	
  490               0001     		.ifndef	HUCC_NO_DEFAULT_RANDOM
  491                        	
  492    00:E2B0  A8         	_random8.1:	tay				; Preserve the limit.
  493    00:E2B1  20 C3 E5   			jsr	get_random		; Random in A, preserve Y.
  494                        	
  495    00:E2B4  20 F0 E4   			jsr	__muluchar
  496    00:E2B7  98         			tya				; Do a 8.0 x 0.8 fixed point
  497    00:E2B8  C2         			cly				; fractional multiply.
  498    00:E2B9  60         			rts
  499                        		.endif
  500                        	
  501                        	
  502                        	
  503                        	; ***************************************************************************
  504                        	; ***************************************************************************
  505                        	;
  506                        	; unsigned char __fastcall random( unsigned char limit<acc> );
  507                        	;
  508                        	; IN :	A = range (0..128), 129..255 is treated as 128
  509                        	; OUT : A = random number interval 0 <= x < A
  510                        	
  511               0001     		.ifndef	HUCC_NO_DEFAULT_RANDOM
  512                        	
  513    00:E2BA  A8         	_random.1:	tay				; Preserve the limit.
  514    00:E2BB  20 C3 E5   			jsr	get_random		; Random in A, preserve Y.
  515                        	
  516    00:E2BE  C0 80      			cpy	#128			; Check the limit.
  517    00:E2C0  90 04      			bcc	!+
  518                        	
  519    00:E2C2  29 7F      			and	#$7F			; Just mask the random if
  520    00:E2C4  C2         			cly				; the limit is >= 128.
  521    00:E2C5  60         			rts
  522                        	
  523    00:E2C6  20 F0 E4   	!:		jsr	__muluchar
  524    00:E2C9  98         			tya				; If the limit is < 128 then
  525    00:E2CA  C2         			cly				; do a 8.0 x 0.8 fixed point
  526    00:E2CB  60         			rts				; fractional multiply.
  527                        		.endif
  528                        	
  529                        	
  530                        	
  531                        	; ***************************************************************************
  532                        	; ***************************************************************************
  533                        	;
  534                        	; unsigned char __fastcall __builtin_ffs( unsigned int value<__temp> );
  535                        	
  536                        			.proc	___builtin_ffs.1
  556                        			.endp
  557                        	
  558                        	
  559                        	
  560                        	; ***************************************************************************
  561                        	; ***************************************************************************
  562                        	;
  563                        	; N.B. Declared in hucc-string.h, but defined here because they're macros!
  564                        	;
  565                        	; int __fastcall __macro memcmp( unsigned char *destination<_di>, unsigned char *source<_bp>, unsigned int count<acc> );
  566                        	
  567                        	_memcmp.3	.macro
  568                        			stz	<_bp_bank		; Map the source string.
  569                        			call	_farmemcmp.3
  570                        			.endm
  571                        	
  572                        	
  573                        	
  574                        	; ***************************************************************************
  575                        	; ***************************************************************************
  576                        	;
  577                        	; N.B. Declared in hucc-gfx.h, but defined here because they're macros!
  578                        	;
  579                        	; void __fastcall __macro get_color( unsigned int index<VCE_CTA> );
  580                        	
  581                        	_get_color.1	.macro
  582                        			lda.l	VCE_CTR
  583                        			ldy.h	VCE_CTR
  584                        			.endm
  585                        	
  586                        	
  587                        	
  588                        	; ***************************************************************************
  589                        	; ***************************************************************************
  590                        	;
  591                        	; N.B. Declared in hucc-gfx.h, but defined here because they're macros!
  592                        	;
  593                        	; void __fastcall __macro fade_to_black( unsigned int __far *from<_bp_bank:_bp>, unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char value_to_sub<_ah> );
  594                        	; void __fastcall __macro fade_to_white( unsigned int __far *from<_bp_bank:_bp>, unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char value_to_add<_ah> );
  595                        	; void __fastcall __macro cross_fade_to( unsigned int __far *from<_bp_bank:_bp>, unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char which_component<_ah );
  596                        	;
  597                        	; void __fastcall __macro far_fade_to_black( unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char value_to_sub<_ah> );
  598                        	; void __fastcall __macro far_fade_to_white( unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char value_to_add<_ah> );
  599                        	; void __fastcall __macro far_cross_fade_to( unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char which_component<_ah );
  600                        	
  601                        			.macro	_fade_to_black.4
  602                        			ldy	<_bp_bank
  603                        			call	fade_to_black
  604                        			.endm
  605                        	
  606                        			.macro	_fade_to_white.4
  607                        			ldy	<_bp_bank
  608                        			call	fade_to_white
  609                        			.endm
  610                        	
  611                        			.macro	_cross_fade_to.4
  612                        			ldy	<_bp_bank
  613                        			call	cross_fade_to
  614                        			.endm
  615                        	
  616                        			.macro	_far_fade_to_black.3
  617                        			ldy	<_bp_bank
  618                        			call	fade_to_black
  619                        			.endm
  620                        	
  621                        			.macro	_far_fade_to_white.3
  622                        			ldy	<_bp_bank
  623                        			call	fade_to_white
  624                        			.endm
  625                        	
  626                        			.macro	_far_cross_fade_to.3
  627                        			ldy	<_bp_bank
  628                        			call	cross_fade_to
  629                        			.endm
  630                        	
  631                        	
  632                        	
  633                        	; ***************************************************************************
  634                        	; ***************************************************************************
  635                        	;
  636                        	; N.B. Declared in hucc-gfx.h, but defined here because they're macros!
  637                        	;
  638                        	; void __fastcall __macro set_xres( unsigned int x_pixels<_ax> );
  639                        	; void __fastcall __macro sgx_set_xres( unsigned int x_pixels<_ax> );
  640                        	;
  641                        	; void __fastcall set_xres( unsigned int x_pixels<_ax>, unsigned char blur_flag<_bl> );
  642                        	; void __fastcall sgx_set_xres( unsigned int x_pixels<_ax>, unsigned char blur_flag<_bl> );
  643                        	
  644                        	_set_xres.1	.macro
  645                        			lda	#XRES_SOFT
  646                        			sta	<_bl
  647                        			call	_set_xres.2
  648                        			.endm
  649                        	
  650               0001     		.if	SUPPORT_SGX
  651                        			.macro	_sgx_set_xres.1
  652                        			lda	#XRES_SOFT
  653                        			sta	<_bl
  654                        			call	_sgx_set_xres.2
  655                        			.endm
  656                        		.endif
  657                        	
  658                        	
  659                        	
  660                        	; ***************************************************************************
  661                        	; ***************************************************************************
  662                        	;
  663                        	; N.B. Declared in hucc-gfx.h, but defined here because they're macros!
  664                        	;
  665                        	; unsigned int __fastcall __macro vram_addr( unsigned char bat_x<_al>, unsigned char bat_y<_ah> );
  666                        	; unsigned int __fastcall __macro sgx_vram_addr( unsigned char bat_x<_al>, unsigned char bat_y<_ah> );
  667                        	
  668                        			.macro	_vram_addr.2
  669                        			cla
  670                        			bit	vdc_bat_width
  671                        			bmi	!w128+
  672                        			bvs	!w64+
  673                        	!w32:		lsr	<_ah
  674                        			ror	a
  675                        	!w64:		lsr	<_ah
  676                        			ror	a
  677                        	!w128:		lsr	<_ah
  678                        			ror	a
  679                        			ora	<_al
  680                        			ldy	<_ah
  681                        			.endm
  682                        	
  683               0001     		.if	SUPPORT_SGX
  684                        			.macro	_sgx_vram_addr.2
  685                        			cla
  686                        			bit	sgx_bat_width
  687                        			bmi	!w128+
  688                        			bvs	!w64+
  689                        	!w32:		lsr	<_ah
  690                        			ror	a
  691                        	!w64:		lsr	<_ah
  692                        			ror	a
  693                        	!w128:		lsr	<_ah
  694                        			ror	a
  695                        			ora	<_al
  696                        			ldy	<_ah
  697                        			.endm
  698                        		.endif
  699                        	
  700                        	
  701                        	
  702                        	; ***************************************************************************
  703                        	; ***************************************************************************
  704                        	;
  705                        	; N.B. Declared in hucc-gfx.h, but defined here because they're macros!
  706                        	;
  707                        	; unsigned int __fastcall __macro get_vram( unsigned int address<_di> );
  708                        	; void __fastcall __macro put_vram( unsigned int address<_di>, unsigned int data<acc> );
  709                        	;
  710                        	; unsigned int __fastcall __macro sgx_get_vram( unsigned int address<_di> );
  711                        	; void __fastcall __macro sgx_put_vram( unsigned int address<_di>, unsigned int data<acc> );
  712                        	
  713                        			.macro	_get_vram.1
  714                        			jsr	vdc_di_to_marr
  715                        			lda	VDC_DL
  716                        			ldy	VDC_DH
  717                        			.endm
  718                        	
  719                        			.macro	_put_vram.2
  720                        			pha
  721                        			jsr	vdc_di_to_mawr
  722                        			pla
  723                        			sta	VDC_DL
  724                        			sty	VDC_DH
  725                        			.endm
  726                        	
  727               0001     		.if	SUPPORT_SGX
  728                        			.macro	_sgx_get_vram.1
  729                        			jsr	sgx_di_to_marr
  730                        			lda	SGX_DL
  731                        			ldy	SGX_DH
  732                        			.endm
  733                        	
  734                        			.macro	_sgx_put_vram.2
  735                        			pha
  736                        			jsr	sgx_di_to_mawr
  737                        			pla
  738                        			sta	SGX_DL
  739                        			sty	SGX_DH
  740                        			.endm
  741                        		.endif
  742                        	
  743                        	
  744                        	
  745                        	; ***************************************************************************
  746                        	; ***************************************************************************
  747                        	;
  748                        	; N.B. Declared in hucc-gfx.h, but defined here because they're macros!
  749                        	;
  750                        	; void __fastcall __macro set_bgpal( unsigned char palette<_al>, unsigned char __far *data<_bp_bank:_bp> );
  751                        	; void __fastcall __macro set_bgpal( unsigned char palette<_al>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_palettes<_ah> );
  752                        	; void __fastcall __macro set_sprpal( unsigned char palette<_al>, unsigned char __far *data<_bp_bank:_bp> );
  753                        	; void __fastcall __macro set_sprpal( unsigned char palette<_al>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_palettes<_ah> );
  754                        	
  755                        	_set_bgpal.2	.macro
  756                        			lda	#1
  757                        			sta	<_ah
  758                        			call	_load_palette.3
  759                        			.endm
  760                        	
  761                        	_set_bgpal.3	.macro
  762                        			call	_load_palette.3
  763                        			.endm
  764                        	
  765                        	_set_sprpal.2	.macro
  766                        			lda	#1
  767                        			sta	<_ah
  768                        			smb4	<_al
  769                        			call	_load_palette.3
  770                        			.endm
  771                        	
  772                        	_set_sprpal.3	.macro
  773                        			smb4	<_al
  774                        			call	_load_palette.3
  775                        			.endm
  776                        	
  777                        	
  778                        	
  779                        	; ***************************************************************************
  780                        	; ***************************************************************************
  781                        	;
  782                        	; N.B. Declared in hucc-gfx.h, but defined here because they're macros!
  783                        	;
  784                        	; void __fastcall __macro load_vram( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_words<_ax> );
  785                        	; void __fastcall __macro sgx_load_vram( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_words<_ax> );
  786                        	;
  787                        	; void __fastcall __macro far_load_vram( unsigned int vram<_di>, unsigned int num_words<_ax> );
  788                        	; void __fastcall __macro sgx_far_load_vram( unsigned int vram<_di>, unsigned int num_words<_ax> );
  789                        	;
  790                        	
  791               0001     		.if	SUPPORT_SGX
  792                        			.macro	_sgx_load_vram.3
  793                        			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  794                        			call	load_vram_x
  795                        			.endm
  796                        	
  797                        			.macro	_sgx_far_load_vram.2
  798                        			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  799                        			call	load_vram_x
  800                        			.endm
  801                        		.endif
  802                        	
  803                        			.macro	_load_vram.3
  804                        			clx				; Offset to PCE VDC.
  805                        			call	load_vram_x
  806                        			.endm
  807                        	
  808                        			.macro	_far_load_vram.2
  809                        			clx				; Offset to PCE VDC.
  810                        			call	load_vram_x
  811                        			.endm
  812                        	
  813                        	
  814                        	
  815                        	; ***************************************************************************
  816                        	; ***************************************************************************
  817                        	;
  818                        	; N.B. Declared in hucc-gfx.h, but defined here because they're macros!
  819                        	;
  820                        	; void __fastcall __macro load_sprites( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_groups<acc> );
  821                        	; void __fastcall __macro sgx_load_sprites( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_groups<acc> );
  822                        	; void __fastcall __macro far_load_sprites( unsigned int vram<_di>, unsigned int num_groups<acc> );
  823                        	; void __fastcall __macro sgx_far_load_sprites( unsigned int vram<_di>, unsigned int num_groups<acc> );
  824                        	
  825               0001     		.if	SUPPORT_SGX
  826                        			.macro	_sgx_load_sprites.3
  827                        			stz.l	<_ax
  828                        			asl	a
  829                        			sta.h	<_ax
  830                        			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  831                        			call	load_vram_x
  832                        			.endm
  833                        	
  834                        			.macro	_sgx_far_load_sprites.2
  835                        			stz.l	<_ax
  836                        			asl	a
  837                        			sta.h	<_ax
  838                        			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  839                        			call	load_vram_x
  840                        			.endm
  841                        		.endif
  842                        	
  843                        			.macro	_load_sprites.3
  844                        			stz.l	<_ax
  845                        			asl	a
  846                        			sta.h	<_ax
  847                        			clx				; Offset to PCE VDC.
  848                        			call	load_vram_x
  849                        			.endm
  850                        	
  851                        			.macro	_far_load_sprites.2
  852                        			stz.l	<_ax
  853                        			asl	a
  854                        			sta.h	<_ax
  855                        			clx				; Offset to PCE VDC.
  856                        			call	load_vram_x
  857                        			.endm
  858                        	
  859                        	
  860                        	
  861                        	; ***************************************************************************
  862                        	; ***************************************************************************
  863                        	;
  864                        	; N.B. Declared in hucc-gfx.h, but defined here because they're macros!
  865                        	;
  866                        	; void __fastcall load_default_font( void );
  867                        	; void __fastcall sgx_load_default_font( void );
  868                        	;
  869                        	
  870               0001     		.if	SUPPORT_SGX
  871                        			.macro	_sgx_load_default_font
  872                        			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  873                        			call	huc_monofont_x
  874                        			.endm
  875                        		.endif
  876                        	
  877                        			.macro	_load_default_font
  878                        			clx				; Offset to PCE VDC.
  879                        			call	huc_monofont_x
  880                        			.endm
  881                        	
  882                        	
  883                        	
  884                        	; ***************************************************************************
  885                        	; ***************************************************************************
  886                        	
  887               0000     		.if	0
  905                        		.endif
                             #[2]   "..\..\..\include\hucc\hucc.asm"
  228                        	
  229               0000     		.if	CDROM
  231                        		.endif
  232                        	
  233                        			; Definitions for compatibility with old HuC/MagicKit projects.
  234                        	
  235               0001     		.ifndef	HUCC_NO_DEPRECATED
                             #[3]   "..\..\..\include\hucc\hucc-deprecated.inc"
  236                        			include	"hucc-deprecated.inc"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; hucc-deprecated.inc
    5                        	;
    6                        	; Macros and definitions for compatibility with old HuC/MagicKit projects.
    7                        	;
    8                        	; Based on the original HuC and MagicKit definitions by David Michel and the
    9                        	; other original HuC developers.
   10                        	;
   11                        	; ***************************************************************************
   12                        	; ***************************************************************************
   13                        	
   14                        			; For compatibility with HuC projects that use the old name.
   15                        	
   16               0001     	HUC_USER_RESERVED = HUC_USER_BANK
   17                        	
   18                        			; For compatibility with code that expects the HuC naming that
   19                        			; is used in the newer HuC, rather than the original HuC v3.21.
   20                        			;
   21                        			; Code generated by HuCC uses the original single-underscore.
   22                        	
   23               0001     		.if	1				
   24               0002     	__bp		=	$F8:20EC, 2		; base pointer
   25               0002     	__si		=	$F8:20EE, 2		; source address
   26               0002     	__di		=	$F8:20F0, 2		; destination address
   27                        	
   28               0002     	__ax		=	$F8:20F8, 2
   29               0001     	__al		=	$F8:20F8, 1
   30               0001     	__ah		=	$F8:20F9, 1
   31                        	
   32               0002     	__bx		=	$F8:20FA, 2
   33               0001     	__bl		=	$F8:20FA, 1
   34               0001     	__bh		=	$F8:20FB, 1
   35                        	
   36               0002     	__cx		=	$F8:20FC, 2
   37               0001     	__cl		=	$F8:20FC, 1
   38               0001     	__ch		=	$F8:20FD, 1
   39                        	
   40               0002     	__dx		=	$F8:20FE, 2
   41               0001     	__dl		=	$F8:20FE, 1
   42               0001     	__dh		=	$F8:20FF, 1
   43                        		.endif
   44                        	
   45                        			; For compatibility with code that expects the HuC naming that
   46                        			; is used rather than the shorter upper-case #define naming.
   47                        	
   48               0001     		.if	1				
   49               0001     	video_reg	=	$FF:0200, 1		; Address/Status Register
   50               0001     	video_reg_l	=	$FF:0200, 1		; Address/Status Register
   51               0001     	video_reg_h	=	$FF:0201, 1		; Address/Status Register
   52               0002     	video_data	=	$FF:0202, 2		; Data (Read/Write) Low
   53               0001     	video_data_l	=	$FF:0202, 1		; Data (Read/Write) Low
   54               0001     	video_data_h	=	$FF:0203, 1		; Data (Read/Write) High
   55                        	
   56               0002     	color_ctrl	=	$FF:0400, 2		; Control Register
   57               0002     	color_reg	=	$FF:0402, 2		; Color Table Address
   58               0001     	color_reg_l	=	$FF:0402, 1		; Color Table Address
   59               0001     	color_reg_h	=	$FF:0402, 1		; Color Table Address
   60               0002     	color_data	=	$FF:0404, 2		; Color Table Data Read/Write
   61               0001     	color_data_l	=	$FF:0404, 1		; Color Table Data Read/Write
   62               0001     	color_data_h	=	$FF:0405, 1		; Color Table Data Read/Write
   63                        	
   64               0001     	psg_ch		=	$FF:0800, 1		; Channel Select
   65               0001     	psg_mainvol	=	$FF:0801, 1		; Main Amplitude Level
   66               0001     	psg_freqlo	=	$FF:0802, 1		; Frequency Low
   67               0001     	psg_freqhi	=	$FF:0803, 1		; Frequency High
   68               0001     	psg_ctrl	=	$FF:0804, 1		; Control & Channel Amplitude
   69               0001     	psg_pan		=	$FF:0805, 1		; L/R Amplitude Level
   70               0001     	psg_wavebuf	=	$FF:0806, 1		; Waveform
   71               0001     	psg_noise	=	$FF:0807, 1		; Noise
   72               0001     	psg_lfofreq	=	$FF:0808, 1		; LFO Frequency
   73               0001     	psg_lfoctrl	=	$FF:0809, 1		; LFO Control
   74                        	
   75               0001     	irq_m		=	irq_vec, 1		; Old System Card name.
   76               0002     	irq2_jmp	=	irq2_hook, 2		; Old System Card name.
   77               0002     	irq1_jmp	=	irq1_hook, 2		; Old System Card name.
   78               0002     	timer_jmp	=	timer_hook, 2		; Old System Card name.
   79               0002     	nmi_jmp		=	nmi_hook, 2		; Old System Card name.
   80               0002     	sat_adr		=	satb_addr, 2		; Old System Card name.
   81               0005     	joy		=	joynow, 5		; Old System Card name.
   82               0001     	mwr_m		=	vdc_mwr, 1		; Old System Card name.
   83               0001     	dcr_m		=	vdc_dcr, 1		; Old System Card name.
   84                        		.endif
   85                        	
   86                        			; Macros for compatibility with #asm usage in old HuC projects.
   87                        	
   88                        	stw		.macro
   89                        			lda.l	\1
   90                        			sta.l	\2
   91                        			lda.h	\1
   92                        			sta.h	\2
   93                        			.endm
   94                        	
   95                        	stb		.macro
   96                        			lda	\1
   97                        			sta	\2
   98                        			.endm
   99                        	
  100                        	addw		.macro
  101                        		.if	(\# = 3)
  102                        			clc
  103                        			lda.l	\2
  104                        			adc.l	\1
  105                        			sta.l	\3
  106                        			lda.h	\2
  107                        			adc.h	\1
  108                        			sta.h	\3
  109                        		.else
  110                        			clc
  111                        			lda.l	\2
  112                        			adc.l	\1
  113                        			sta.l	\2
  114                        			lda.h	\2
  115                        			adc.h	\1
  116                        			sta.h	\2
  117                        		.endif
  118                        			.endm
  119                        	
  120                        	add		.macro			; add byte-sized value to
  121                        		.if (\# = 2)			; register A (handle carry
  122                        			lda	\2		; flag)
  123                        			clc
  124                        			adc	\1
  125                        			sta	\2
  126                        		.else
  127                        			clc
  128                        			adc	\1
  129                        		.endif
  130                        			.endm
  131                        	
  132                        	subw		.macro
  133                        			sec
  134                        			lda.l	\2
  135                        			sbc.l	\1
  136                        			sta.l	\2
  137                        			lda.h	\2
  138                        			sbc.h	\1
  139                        			sta.h	\2
  140                        			.endm
  141                        	
  142                        	sub		.macro			; subtract byte-sized value
  143                        		.if (\# = 2)			; from register A (handle
  144                        			lda	\2		; carry flag)
  145                        			sec
  146                        			sbc	\1
  147                        			sta	\2
  148                        		.else
  149                        			sec
  150                        			sbc	\1
  151                        		.endif
  152                        			.endm
  153                        	
  154                        	incw		.macro			; increment a word-sized
  155                        			inc.l	\1		; value at stated memory
  156                        			bne	!+		; location
  157                        			inc.h	\1
  158                        	!:
  159                        			.endm
  160                        	
  161                        	decw		.macro			; decrement a word-sized
  162                        			lda	\1		; value at stated memory
  163                        			bne	!+		; location
  164                        			dec.h	\1
  165                        	!:		dec.l	\1
  166                        			.endm
  167                        	
  168                        	lbne		.macro
  169                        			bne	\1
  170                        			.endm
  171                        	
  172                        	lbeq		.macro
  173                        			beq	\1
  174                        			.endm
  175                        	
  176                        	lbpl		.macro
  177                        			bpl	\1
  178                        			.endm
  179                        	
  180                        	lbmi		.macro
  181                        			bmi	\1
  182                        			.endm
  183                        	
  184                        	lbcc		.macro
  185                        			bcc	\1
  186                        			.endm
  187                        	
  188                        	lbcs		.macro
  189                        			bcs	\1
  190                        			.endm
  191                        	
  192                        	lblo		.macro
  193                        			bcc	\1
  194                        			.endm
  195                        	
  196                        	lbhs		.macro
  197                        			bcs	\1
  198                        			.endm
  199                        	
  200                        	__ldwi		.macro
  201                        		__ld.wi		\1
  202                        			.endm
                             #[2]   "..\..\..\include\hucc\hucc.asm"
  237                        		.endif
  238                        	
  239                        			;
  240                        			;
  241                        			;
  242                        	
  243                        	
  244                        	
  245                        	; ***************************************************************************
  246                        	; ***************************************************************************
  247                        	;
  248                        	; core_main - This is executed after "CORE(not TM)" library initialization.
  249                        	;
  250                        	; This is the first code assembled after the library includes, so we're still
  251                        	; in the CORE_BANK, usually ".bank 0"; and because this is assembled with the
  252                        	; default configuration from "include/core-config.inc", which sets the option
  253                        	; "USING_MPR7", then we're running in MPR7 ($E000-$FFFF).
  254                        	
  255    02:D9B0             	core_main	.proc
  256                        	
  257               0001     		.if	SUPPORT_SGX
  258    02:D9B0  A9 F9      			lda	#$F9			; Map the 2nd SGX RAM bank.
  259                        		.else
  261                        		.endif
  262    02:D9B2  53 04      			tam2
  263                        	
  264    02:D9B4  A9 01      			lda	#CONST_BANK + _bank_base; Map HuCC's .RODATA bank.
  265    02:D9B6  53 08      			tam3
  266    02:D9B8  1A         			inc	a
  267    02:D9B9  53 10      			tam4
  268                        	
  269               0000     		.ifdef	HOME_BANK
  271                        		.else
  272    02:D9BB  1A         			inc	a
  273                        		.endif
  274    02:D9BC  53 20      			tam5
  275                        	
  276    02:D9BE  08         			php				; Disable interrupts while
  277    02:D9BF  78         			sei				; clearing overlay's BSS.
  278                        	
  279               0000     		.ifndef	USING_RCR_MACROS
  294                        		.endif	USING_RCR_MACROS
  295                        	
  296    02:D9C0  A9 CC      			lda	#<hucc_vbl		; Setup HuCC's VBL IRQ handler.
  297    02:D9C2  8D 08 22   			sta.l	vsync_hook
  298    02:D9C5  A9 E2      			lda	#>hucc_vbl
  299    02:D9C7  8D 09 22   			sta.h	vsync_hook
  300                        	
  301               0000     		.if	CDROM				; Overlays should clear BSS.
  303                        		.else
  304    02:D9CA  73 17 DA F0			tii	.rom_tia, ram_tia, 16	; Only needed on HuCARD.
         02:D9CE  22 10 00    
  305                        		.endif	CDROM
  306                        	
  307               0000     		.if	(__heap_start - __bss_init)	; Copy initialized BSS data.
  309                        		.endif
  310                        	
  311    02:D9D1  F3 15 DA 08			tai	.stack_fill, __stack, HUCC_STACK_SZ
         02:D9D5  20 80 00    
  312                        	
  313               0000     		.if	FAST_MULTIPLY
  322                        		.endif
  323                        	
  324    02:D9D8  A9 10      			lda	#$10			; Enable HuCC's vblank IRQ
  325    02:D9DA  04 F5      			tsb	<irq_vec		; handler.
  326                        	
  327                        			__sound_init			; Initialize a sound driver.
  328                        	
  329    02:D9DC  AD 00 02   			lda	VDC_SR			; Purge any overdue VBL.
  330    02:D9DF  9C 41 22   			stz	irq_cnt			; Make it easy to check.
  331                        	
  332    02:D9E2  28         			plp				; Restore interrupts.
  333                        	
  334               0001     		.ifndef	HUCC_NO_DEFAULT_SCREEN
  335    02:D9E3  20 D1 FF   			call	_init_256x224		; HuCC initializes the VDC and
  336    02:D9E6  20 16 E4   			jsr	set_dspon		; turns the display on.
  337                        		.endif
  338                        	
  339               0001     		.ifndef	HUCC_NO_DEFAULT_FONT
  340    02:D9E9  A9 01      			lda	#1			; HuCC loads a default font.
  341    02:D9EB  8D A7 26   			sta	monofont_fg
  342    02:D9EE  9C A8 26   			stz	monofont_bg
  343                        			_load_default_font
         02:D9F1  82         			clx				; Offset to PCE VDC.
         02:D9F2  20 C7 FF   			call	huc_monofont_x
  344    02:D9F5  A9 01      			lda	#$01			; Set the font palette entry to
  345    02:D9F7  8D 02 04   			sta.l	VCE_CTA			; cyan which is a) visible, but
  346    02:D9FA  9C 03 04   			stz.h	VCE_CTA			; b) a clear indicator that the
  347    02:D9FD  A0 96      			ldy	#$96			; user hasn't set a palette yet.
  348    02:D9FF  8C 04 04   			sty.l	VCE_CTW
  349    02:DA02  8D 05 04   			sta.h	VCE_CTW
  350                        		.endif
  351                        	
  352               0001     		.ifndef	HUCC_NO_DEFAULT_RANDOM
  353    02:DA05  AC 41 22   			ldy	irq_cnt			; Initialize random seed.
  354    02:DA08  20 BD FF   			call	init_random
  355                        		.endif
  356                        	
  357    02:DA0B  A2 80      			ldx	#HUCC_STACK_SZ		; Initialize the HuCC stack.
  358    02:DA0D  86 8D      			stx	<__sp
  359                        	
  360    02:DA0F  20 B3 FF   			call	_main			; Execute the HuCC program.
  361                        	
  362    02:DA12  4C 88 E2   			jmp	_exit.1			; Pass the exit code on.
  363                        	
  364    02:DA15  EA EA      	.stack_fill:	db	$EA,$EA			; To make it easier to see.
  365                        	
  366               0001     		.if	!CDROM
  367                        	
  368    02:DA17  E3 34 12 02	.rom_tia:	tia	$1234, VDC_DL, 32
         02:DA1B  02 20 00    
  369    02:DA1E  60         			rts
  370                        	
  371    02:DA1F  73 34 12 78	.rom_tii:	tii	$1234, $5678, $9ABC
         02:DA23  56 BC 9A    
  372    02:DA26  60         			rts
  373                        	
  374               22F0     			.bss
  375    F8:22F0             	ram_tia:	ds	8
  376    F8:22F8             	ram_tii:	ds	8
  377               DA27     			.code
  378                        	
  379                        		.endif	!CDROM
  380                        	
  381                        			.endp
  382                        	
  383                        			;
  384                        			; Self-Modifying TIA and TII instruction subroutines.
  385                        			;
  386                        			; These need to be in permanently-accessible memory so that
  387                        			; HuCC code can modify the values as __fastcall parameters.
  388                        			;
  389                        	
  390               0000     		.if	CDROM
  398                        		.endif	CDROM
  399                        	
  400               22F0     			rsset	ram_tia
  401               22F0     	ram_tia_opc	rs	1
  402               22F1     	ram_tia_src	rs	2
  403               22F3     	ram_tia_dst	rs	2
  404               22F5     	ram_tia_len	rs	2
  405               22F7     	ram_tia_rts	rs	1
  406                        	
  407               22F8     			rsset	ram_tii
  408               22F8     	ram_tii_opc	rs	1
  409               22F9     	ram_tii_src	rs	2
  410               22FB     	ram_tii_dst	rs	2
  411               22FD     	ram_tii_len	rs	2
  412               22FF     	ram_tii_rts	rs	1
  413                        	
  414                        	
  415                        	
  416                        	; ***************************************************************************
  417                        	; ***************************************************************************
  418                        	;
  419                        	; hucc_vbl - vblank IRQ handler, called by the "CORE(not TM)" kernel.
  420                        	;
  421                        	; This uses the kernel's hook to process things during vblank. It returns
  422                        	; with a simple RTS, and it can corrupt any register.
  423                        	;
  424                        	; Any slow routines in here should enable interrupts and protect itself from
  425                        	; re-entrancy problems.
  426                        	;
  427                        	
  428    00:E2CC  20 A9 FF   	hucc_vbl:	call	vbl_init_scroll		; Prepare for the next frame.
  429                        	
  430    00:E2CF  F8         			sed				; Update the HuC system clock
  431    00:E2D0  38         			sec				; which is in BCD here rather
  432    00:E2D1  AD EF 22   			lda	clock_tt		; than the binary one in HuC.
  433    00:E2D4  69 00      			adc	#0			; BCD add ...
  434    00:E2D6  C9 60      			cmp	#$60			; ... but binary comparison.
  435    00:E2D8  90 28      			bcc	.ticks
  436    00:E2DA  AD EE 22   			lda	clock_ss
  437    00:E2DD  69 00      			adc	#0			; BCD add ...
  438    00:E2DF  C9 60      			cmp	#$60			; ... but binary comparison.
  439    00:E2E1  90 1B      			bcc	.seconds
  440    00:E2E3  AD ED 22   			lda	clock_mm
  441    00:E2E6  69 00      			adc	#0			; BCD add ...
  442    00:E2E8  C9 60      			cmp	#$60			; ... but binary comparison.
  443    00:E2EA  90 0E      			bcc	.minutes
  444    00:E2EC  AD EC 22   			lda	clock_hh
  445    00:E2EF  69 00      			adc	#0			; BCD add ...
  446    00:E2F1  C9 12      			cmp	#$12			; ... but binary comparison.
  447    00:E2F3  90 01      			bcc	.hours
  448    00:E2F5  62         			cla
  449    00:E2F6  8D EC 22   	.hours:		sta	clock_hh
  450    00:E2F9  62         			cla
  451    00:E2FA  8D ED 22   	.minutes:	sta	clock_mm
  452    00:E2FD  62         			cla
  453    00:E2FE  8D EE 22   	.seconds:	sta	clock_ss
  454    00:E301  62         			cla
  455    00:E302  8D EF 22   	.ticks:		sta	clock_tt
  456    00:E305  D8         			cld
  457                        	
  458    00:E306  4C 96 E3   			jmp	xfer_palettes		; Upload any palette changes.
                             #[1]   "main.s"
   15               6000     			.data
   16               0003     			.bank	DATA_BANK
   17                        	
   18               E309     		.code
   19                        	
   20                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 1; // **************************************************************************
   21                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 2; // **************************************************************************
   22                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 3; //
   23                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 4; // globals.h
   24                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 5; //
   25                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 6; // **************************************************************************
   26                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 7; // **************************************************************************
   27                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 8; //
   28                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 9; // The idea is that you, a PCE developer, copy this file from the ../include/
   29                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 10; // directory and into your project's directory, and then define the variables
   30                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 11; // that you want to have shared access to in all overlay programs on your CD.
   31                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 12; //
   32                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 13; // Because PCEAS searches the current (i.e. project) directory for an include
   33                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 14; // file first, then it will find your customized copy of the file rather than
   34                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 15; // the original copy in the ../include/ directory.
   35                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 16; //
   36                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 17; // **************************************************************************
   37                        		.dbg	line,	"..\..\..\include\hucc\globals.h", 18; // **************************************************************************
   38                        		.dbg	clear
   39               2300     		.bss
   40    F8:2300             	huc_globals:
   41                        	
   42    F8:2300             	huc_globals_end:
   43               E309     		.code
   44                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 1; #ifndef _hucc_legacy_h
   45                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 2; #define _hucc_legacy_h
   46                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 4; /****************************************************************************
   47                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 5; ; ***************************************************************************
   48                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 6; ;
   49                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 7; ; huc.h
   50                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 8; ;
   51                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 9; ; HuCC wrapper file to include a default set of HuC-compatible functions.
   52                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 10; ;
   53                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 11; ; Copyright John Brandwood 2024.
   54                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 12; ;
   55                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 13; ; Distributed under the Boost Software License, Version 1.0.
   56                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
   57                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
   58                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 16; ;
   59                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 17; ; ***************************************************************************
   60                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 18; ; ***************************************************************************
   61                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 19; ;
   62                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 20; ; When the HuCC compiler is invoked with the "--legacy" option to compile old
   63                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 21; ; projects, then this "huc.h" file is automatically included.
   64                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 22; ;
   65                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 23; ; This file includes a set of the individual HuCC headers which correspond to
   66                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 24; ; HuC's built-in functions and MagicKit library.
   67                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 25; ;
   68                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 26; ; New HuCC projects should, preferably, include the specific headers that are
   69                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 27; ; needed, which will then allow them to replace parts of the standard library
   70                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 28; ; with newer functions, or they can just manually include this "huc.h" file.
   71                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 29; ;
   72                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 30; ; ***************************************************************************
   73                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 31; ; **************************************************************************/
   74                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 33; #include "hucc-systemcard.h"
   75                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 1; #ifndef _hucc_systemcard_h
   76                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 2; #define _hucc_systemcard_h
   77                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 4; /****************************************************************************
   78                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 5; ; ***************************************************************************
   79                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 6; ;
   80                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 7; ; hucc-systemcard.h
   81                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 8; ;
   82                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 9; ; Macros and library functions for using the System Card.
   83                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 10; ;
   84                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 11; ; Copyright John Brandwood 2024.
   85                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 12; ;
   86                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 13; ; Distributed under the Boost Software License, Version 1.0.
   87                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
   88                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
   89                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 16; ;
   90                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 17; ; ***************************************************************************
   91                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 18; ; ***************************************************************************
   92                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 19; ;
   93                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 20; ; Because these are mainly macros, and so must be included before being used
   94                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 21; ; in compiled code, the actual functions here are written to avoid using any
   95                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 22; ; BSS memory so that HuCC's overlay global-shared-variables are not effected.
   96                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 23; ;
   97                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 24; ; ***************************************************************************
   98                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 25; ; **************************************************************************/
   99                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 27; // *************
  100                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 28; // Backup RAM defines ...
  101                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 29; // *************
  102                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 31; #define  BM_OK             0
  103                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 32; #define  BM_NOT_FOUND      1
  104                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 33; #define  BM_BAD_CHECKSUM   2
  105                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 34; #define  BM_DIR_CORRUPTED  3
  106                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 35; #define  BM_FILE_EMPTY     4
  107                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 36; #define  BM_FULL           5
  108                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 37; #define  BM_NOT_FORMATED   0xFF			// HuC incorrect spelling.
  109                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 38; #define  BM_NOT_FORMATTED  0xFF			// HuCC can use a dictionary!
  110                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 40; #define  BRAM_STARTPTR     0x8010
  111                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 42; // *************
  112                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 43; // CD defines ...
  113                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 44; // *************
  114                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 46; #define	CDPLAY_MUTE		0
  115                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 47; #define	CDPLAY_REPEAT		1
  116                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 48; #define	CDPLAY_NORMAL		2
  117                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 49; #define	CDPLAY_ENDOFDISC	0
  118                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 51; #define	CDFADE_CANCEL	0
  119                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 52; #define	CDFADE_PCM6	8
  120                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 53; #define	CDFADE_ADPCM6	10
  121                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 54; #define	CDFADE_PCM2	12
  122                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 55; #define	CDFADE_ADPCM2	14
  123                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 57; #define CDTRK_AUDIO	0
  124                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 58; #define CDTRK_DATA	4
  125                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 60; // *************
  126                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 61; // ADPCM defines ...
  127                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 62; // *************
  128                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 64; #define	ADPLAY_AUTOSTOP		0
  129                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 65; #define	ADPLAY_REPEAT		0x80
  130                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 67; #define ADPLAY_FREQ_16KHZ	0xE
  131                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 68; #define ADPLAY_FREQ_10KHZ	0xD
  132                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 69; #define ADPLAY_FREQ_8KHZ	0xC
  133                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 70; #define ADPLAY_FREQ_6KHZ	0xB
  134                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 71; #define ADPLAY_FREQ_5KHZ	0xA
  135                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 73; #define ADREAD_RAM	0
  136                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 74; #define ADREAD_VRAM	0xFF
  137                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 76; #define ADWRITE_RAM	0
  138                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 77; #define ADWRITE_VRAM	0xFF
  139                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 79; // *************
  140                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 80; // Functions in hucc-systemcard.asm ...
  141                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 81; // *************
  142                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 83; #ifdef __HUCC__
  143                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 85; #asmdef	HUCC_USES_SYSTEMCARD 1
  144               0001     	HUCC_USES_SYSTEMCARD = 1
  145                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 87; extern void __fastcall __macro cd_boot( void );
  146                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 88; extern unsigned int __fastcall __macro cd_getver( void );
  147                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 89; extern void __fastcall __macro cd_reset( void );
  148                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 90; extern unsigned char __fastcall __macro cd_pause( void );
  149                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 91; extern unsigned char __fastcall cd_unpause( void );
  150                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 92; extern void __fastcall __macro cd_fade( unsigned char type<acc> );
  151                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 93; extern unsigned char __fastcall cd_playtrk( unsigned char start_track<_bx>, unsigned char end_track<_cx>, unsigned char mode<_dh> );
  152                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 94; extern unsigned char __fastcall cd_playmsf( unsigned char start_minute<_al>,  unsigned char start_second<_ah>,  unsigned char start_frame<_bl>, unsigned char end_minute<_cl>,  unsigned char end_second<_ch>,  unsigned char end_frame<_dl>,  unsigned char mode<_dh> );
  153                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 95; extern unsigned char __fastcall cd_fastvram( unsigned char ovl_index<_cl>, unsigned int sect_offset<_si>, unsigned int vramaddr<_bx>, unsigned int sectors<_al> );
  154                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 96; extern unsigned char __fastcall cd_loadvram( unsigned char ovl_index<_cl>, unsigned int sect_offset<_si>, unsigned int vramaddr<_bx>, unsigned int bytes<_ax> );
  155                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 97; extern unsigned char __fastcall cd_loaddata( unsigned char ovl_index<_cl>, unsigned int sect_offset<_si>, unsigned char __far *buffer<_bp_bank:_bp>, unsigned int bytes<__ptr> );
  156                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 98; extern unsigned char __fastcall cd_loadbank( unsigned char ovl_index<_cl>, unsigned int sect_offset<_si>, unsigned char bank<_bl>, unsigned int sectors<_al> );
  157                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 99; extern unsigned char __fastcall __macro cd_status( unsigned char mode<acc> );
  158                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 101; extern void __fastcall __macro ad_reset( void );
  159                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 102; extern unsigned char __fastcall __macro ad_trans( unsigned char ovl_index<_cl>, unsigned int sect_offset<_si>, unsigned char nb_sectors<_dh>, unsigned int ad_addr<_bx> );
  160                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 103; extern void __fastcall __macro ad_read( unsigned int ad_addr<_cx>, unsigned char mode<_dh>, unsigned int buf<_bx>, unsigned int bytes<_ax> );
  161                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 104; extern void __fastcall __macro ad_write( unsigned int ad_addr<_cx>, unsigned char mode<_dh>, unsigned int buf<_bx>, unsigned int bytes<_ax> );
  162                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 105; extern unsigned char __fastcall __macro ad_play( unsigned int ad_addr<_bx>, unsigned int bytes<_ax>, unsigned char freq<_dh>, unsigned char mode<_dl> );
  163                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 106; extern unsigned char __fastcall __macro ad_cplay( unsigned char ovl_index<_cl>, unsigned int sect_offset<_si>, unsigned int nb_sectors<_bx>, unsigned char freq<_dh> );
  164                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 107; extern void __fastcall __macro ad_stop( void );
  165                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 108; extern unsigned char __fastcall __macro ad_stat( void );
  166                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 110; extern unsigned char __fastcall bm_check( void );
  167                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 111; extern unsigned char __fastcall bm_format( void );
  168                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 112; extern unsigned int __fastcall __macro bm_free( void );
  169                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 113; extern unsigned char __fastcall __macro bm_read( unsigned char *buffer<_bx>, unsigned char *name<_ax>, unsigned int offset<_dx>, unsigned int length<_cx> );
  170                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 114; extern unsigned char __fastcall __macro bm_write( unsigned char *buffer<_bx>, unsigned char *name<_ax>, unsigned int offset<_dx>, unsigned int length<_cx> );
  171                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 115; extern unsigned char __fastcall __macro bm_delete( unsigned char *name<_ax> );
  172                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 117; // Deprecated functions ...
  173                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 119; extern unsigned char __fastcall __macro bm_exist( unsigned char *name<_ax> );
  174                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 120; extern unsigned char __fastcall __macro bm_create( unsigned char *name<_ax>, unsigned int length<_cx> );
  175                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 122; // void __fastcall _xsafe add_sectors( unsigned int sector_offset<acc> );
  176                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 124; #endif // __HUCC__
  177                        		.dbg	line,	"..\..\..\include\hucc\hucc-systemcard.h", 126; #endif // _hucc_systemcard_h
  178                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 34; #include "hucc-baselib.h"
  179                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 1; #ifndef _hucc_baselib_h
  180                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 2; #define _hucc_baselib_h
  181                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 4; /****************************************************************************
  182                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 5; ; ***************************************************************************
  183                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 6; ;
  184                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 7; ; hucc-baselib.h
  185                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 8; ;
  186                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 9; ; Basic library functions provided as macros.
  187                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 10; ;
  188                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 11; ; Copyright John Brandwood 2024.
  189                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 12; ;
  190                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 13; ; Distributed under the Boost Software License, Version 1.0.
  191                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
  192                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
  193                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 16; ;
  194                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 17; ; ***************************************************************************
  195                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 18; ; **************************************************************************/
  196                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 20; // *************
  197                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 21; // Joypad defines ...
  198                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 22; // *************
  199                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 24; #define	JOY_A		0x01
  200                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 25; #define	JOY_I		0x01
  201                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 26; #define	JOY_B		0x02
  202                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 27; #define	JOY_II		0x02
  203                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 28; #define	JOY_SLCT	0x04
  204                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 29; #define	JOY_SEL		0x04
  205                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 30; #define	JOY_STRT	0x08
  206                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 31; #define	JOY_RUN		0x08
  207                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 32; #define	JOY_UP		0x10
  208                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 33; #define	JOY_RGHT	0x20
  209                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 34; #define	JOY_RIGHT	0x20
  210                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 35; #define	JOY_DOWN	0x40
  211                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 36; #define	JOY_LEFT	0x80
  212                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 38; #define	JOY_C		0x0100
  213                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 39; #define	JOY_III		0x0100
  214                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 40; #define	JOY_D		0x0200
  215                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 41; #define	JOY_IV		0x0200
  216                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 42; #define	JOY_E		0x0400
  217                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 43; #define	JOY_V		0x0400
  218                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 44; #define	JOY_F		0x0800
  219                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 45; #define	JOY_VI		0x0800
  220                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 47; #define JOY_SIXBUT	0x8000
  221                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 48; #define JOY_TYPE6	0x8000
  222                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 50; // *************
  223                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 51; // SuperGRAFX VPC settings for set_vpc_ctl() ...
  224                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 52; // *************
  225                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 54; #define VPC_SPR1_BKG1_SPR2_BKG2	0x3000 // same as SGX_PARALLAX=0
  226                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 55; #define VPC_SPR1_SPR2_BKG1_BKG2	0x7000 // same as SGX_PARALLAX=1
  227                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 56; #define VPC_BKG1_BKG2_SPR1_SPR2	0xB000
  228                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 58; // *************
  229                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 59; // System Card variables ...
  230                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 60; // *************
  231                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 62; extern unsigned int si;
  232                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 63; extern unsigned int di;
  233                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 64; extern unsigned int bp;
  234                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 66; extern unsigned int ax;
  235                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 67; extern unsigned int bx;
  236                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 68; extern unsigned int cx;
  237                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 69; extern unsigned int dx;
  238                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 71; extern unsigned char al;
  239                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 72; extern unsigned char ah;
  240                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 73; extern unsigned char bl;
  241                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 74; extern unsigned char bh;
  242                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 75; extern unsigned char cl;
  243                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 76; extern unsigned char ch;
  244                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 77; extern unsigned char dl;
  245                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 78; extern unsigned char dh;
  246                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 80; extern unsigned char irq_cnt;
  247                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 81; extern unsigned char joynow[5];
  248                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 82; extern unsigned char joytrg[5];
  249                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 83; extern unsigned char joy6now[5];
  250                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 84; extern unsigned char joy6trg[5];
  251                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 85; extern unsigned int  bg_x1;
  252                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 86; extern unsigned int  bg_y1;
  253                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 87; extern unsigned int  bg_x2;
  254                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 88; extern unsigned int  bg_y2;
  255                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 90; // *************
  256                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 91; // Special macros to get information from PCEAS ...
  257                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 92; // *************
  258                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 94; #define BANK( datasym ) ((unsigned) (&__bank__ ## datasym))
  259                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 95; #define SIZEOF( datasym ) ((unsigned) (&__sizeof__ ## datasym))
  260                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 96; #define COUNTOF( datasym ) ((unsigned) (&__countof__ ## datasym))
  261                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 97; #define OVERLAY( datasym ) ((unsigned) (&__overlay__ ## datasym))
  262                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 100; // *************
  263                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 101; // Functions in hucc-baselib.asm ...
  264                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 102; // *************
  265                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 104; #ifdef __HUCC__
  266                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 106; #asmdef	HUCC_USES_BASELIB 1
  267               0001     	HUCC_USES_BASELIB = 1
  268                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 108; #define	_OPTIMIZE 1
  269                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 111; // *************
  270                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 112; // Hardware Detection
  271                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 113; // *************
  272                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 115; extern unsigned char __fastcall __macro sgx_detect( void );
  273                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 116; extern unsigned char __fastcall __macro ac_exists( void );
  274                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 119; // *************
  275                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 120; // Memory Access
  276                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 121; // *************
  277                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 123; extern unsigned char __fastcall __macro peek( unsigned int addr<__ptr> );
  278                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 124; extern unsigned int  __fastcall __macro peekw( unsigned int addr<__ptr> );
  279                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 126; extern void __fastcall __macro poke( unsigned int addr<__poke>, unsigned char with<acc> );
  280                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 127; extern void __fastcall __macro pokew( unsigned int addr<__poke>, unsigned int with<acc> );
  281                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 129; extern unsigned char __fastcall farpeek( void __far *addr<_bp_bank:_bp> );
  282                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 130; extern unsigned int  __fastcall farpeekw( void __far *addr<_bp_bank:_bp> );
  283                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 132; extern void __fastcall __nop set_far_base( unsigned char data_bank<_bp_bank>, unsigned char *data_addr<_bp> );
  284                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 133; extern void __fastcall set_far_offset( unsigned int offset<_bp>, unsigned char data_bank<_bp_bank>, unsigned char *data_addr<acc> );
  285                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 135; extern unsigned char __fastcall far_peek( void );
  286                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 136; extern unsigned int  __fastcall far_peekw( void );
  287                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 138; extern void __fastcall __macro reset_mpr2( void );
  288                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 139; extern void __fastcall __macro reset_mpr34( void );
  289                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 141; extern void * __fastcall __macro farset_mpr2( void __far *addr<_bp_bank:_bp> );
  290                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 142; extern void * __fastcall __macro farset_mpr34( void __far *addr<_bp_bank:_bp> );
  291                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 144; extern void * __fastcall __macro far_set_mpr2( void );
  292                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 145; extern void * __fastcall __macro far_set_mpr34( void );
  293                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 148; // *************
  294                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 149; // Clock Functions
  295                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 150; // *************
  296                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 152; extern unsigned char __fastcall __macro clock_hh( void );
  297                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 153; extern unsigned char __fastcall __macro clock_mm( void );
  298                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 154; extern unsigned char __fastcall __macro clock_ss( void );
  299                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 155; extern unsigned char __fastcall __macro clock_tt( void );
  300                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 156; extern void __fastcall __macro clock_reset( void );
  301                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 159; // *************
  302                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 160; // Joypad Functions
  303                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 161; // *************
  304                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 163; extern unsigned int __fastcall __macro joy( unsigned char which<acc> );
  305                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 164; extern unsigned int __fastcall __macro joytrg( unsigned char which<acc> );
  306                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 167; // *************
  307                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 168; // Number Functions
  308                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 169; // *************
  309                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 171; extern int __fastcall abs( int value<acc> );
  310                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 173; extern void __fastcall __macro srand( unsigned char seed<acc> );
  311                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 174; extern unsigned int __fastcall rand( void );
  312                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 175; extern unsigned char __fastcall rand8( void );
  313                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 177; // Note: "limit" is 0..255.
  314                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 178; extern unsigned char __fastcall random8( unsigned char limit<acc> );
  315                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 180; // Note: "limit" is 0..128, 129..255 are treated as 128!
  316                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 181; extern unsigned char __fastcall random( unsigned char limit<acc> );
  317                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 184; // *************
  318                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 185; // Overlay Execution
  319                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 186; // *************
  320                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 188; extern unsigned char __fastcall __macro cd_execoverlay( unsigned char ovl_index<acc> );
  321                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 191; // *************
  322                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 192; // Functions that are only optionally available if configured in your hucc-config.inc
  323                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 193; // *************
  324                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 195; extern unsigned int __fastcall __macro joybuf( unsigned char which<acc> );
  325                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 196; extern unsigned int __fastcall __macro get_joy_events( unsigned char which<acc> );
  326                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 197; extern void __fastcall __macro clear_joy_events( unsigned char mask<acc> );
  327                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 200; // *************
  328                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 201; // Functions that are only implemented in the TGEMU emulator for unit-testing
  329                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 202; // the compiler, and which should never be used in normal HuCC projects ...
  330                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 203; // *************
  331                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 205; extern void __fastcall dump_screen( void );
  332                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 206; extern void __fastcall abort( void );
  333                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 207; extern void __fastcall exit( int value<acc> );
  334                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 209; extern unsigned char __fastcall __builtin_ffs( unsigned int value<__temp> );
  335                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 211; #endif // __HUCC__
  336                        		.dbg	line,	"..\..\..\include\hucc\hucc-baselib.h", 213; #endif // _hucc_baselib_h
  337                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 35; #include "hucc-gfx.h"
  338                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 1; #ifndef _hucc_gfx_h
  339                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 2; #define _hucc_gfx_h
  340                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 4; /****************************************************************************
  341                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 5; ; ***************************************************************************
  342                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 6; ;
  343                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 7; ; huc-gfx.h
  344                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 8; ;
  345                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 9; ; Based on the original HuC and MagicKit functions by David Michel and the
  346                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 10; ; other original HuC developers.
  347                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 11; ;
  348                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 12; ; Modifications copyright John Brandwood 2024.
  349                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 13; ;
  350                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 14; ; Distributed under the Boost Software License, Version 1.0.
  351                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 15; ; (See accompanying file LICENSE_1_0.txt or copy at
  352                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 16; ;  http://www.boost.org/LICENSE_1_0.txt)
  353                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 17; ;
  354                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 18; ; ***************************************************************************
  355                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 19; ; **************************************************************************/
  356                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 21; // *************
  357                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 22; // Screen defines ...
  358                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 23; // *************
  359                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 25; #define	SCR_SIZE_32x32	0
  360                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 26; #define	SCR_SIZE_64x32	1
  361                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 27; #define	SCR_SIZE_128x32	2
  362                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 28; #define	SCR_SIZE_32x64	4
  363                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 29; #define	SCR_SIZE_64x64	5
  364                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 30; #define	SCR_SIZE_128x64	6
  365                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 32; #define	XRES_SHARP	0
  366                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 33; #define	XRES_SOFT	4
  367                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 34; #define	XRES_KEEP	128
  368                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 36; #define VPC_WIN_A	0x00
  369                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 37; #define VPC_WIN_B	0x01
  370                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 38; #define	VPC_WIN_AB	0x02
  371                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 39; #define	VPC_WIN_NONE	0x03
  372                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 40; #define	VPC_NORM	0x00
  373                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 41; #define	VPC_SPR		0x04
  374                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 42; #define	VPC_INV_SPR	0x08
  375                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 43; #define VDC1_ON		0x01
  376                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 44; #define	VDC1_OFF	0x00
  377                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 45; #define VDC2_ON		0x02
  378                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 46; #define	VDC2_OFF	0x00
  379                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 47; #define VDC_ON		0x03
  380                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 48; #define	VDC_OFF		0x00
  381                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 50; // *************
  382                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 51; // Functions in hucc-gfx.asm ...
  383                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 52; // *************
  384                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 54; #ifdef __HUCC__
  385                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 56; #asmdef	HUCC_USES_GFX 1
  386               0001     	HUCC_USES_GFX = 1
  387                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 58; // *************
  388                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 59; // Color and Palette Functions
  389                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 60; // *************
  390                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 62; extern void __fastcall clear_palette( void );
  391                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 64; extern void __fastcall __nop set_color( unsigned int index<VCE_CTA>, unsigned int value<VCE_CTW> );
  392                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 65; extern void __fastcall set_color_rgb( unsigned int index<VCE_CTA>, unsigned char r<_al>, unsigned char g<_ah>, unsigned char b<acc> );
  393                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 66; extern unsigned int __fastcall __macro get_color( unsigned int index<VCE_CTA> );
  394                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 68; extern void __fastcall load_palette( unsigned char palette<_al>, unsigned char __far *data<_bp_bank:_bp>, unsigned char num_palettes<_ah> );
  395                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 69; extern void __fastcall far_load_palette( unsigned char palette<_al>, unsigned char num_palettes<_ah> );
  396                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 71; extern void __fastcall read_palette( unsigned char palette<_al>, unsigned char num_palettes<_ah>, unsigned int *destination<_di> );
  397                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 73; extern void __fastcall __macro fade_to_black( unsigned int __far *from<_bp_bank:_bp>, unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char value_to_sub<_ah> );
  398                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 74; extern void __fastcall __macro fade_to_white( unsigned int __far *from<_bp_bank:_bp>, unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char value_to_add<_ah> );
  399                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 75; extern void __fastcall __macro cross_fade_to( unsigned int __far *from<_bp_bank:_bp>, unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char which_component<_ah> );
  400                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 77; extern void __fastcall __macro far_fade_to_black( unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char value_to_sub<_ah> );
  401                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 78; extern void __fastcall __macro far_fade_to_white( unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char value_to_add<_ah> );
  402                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 79; extern void __fastcall __macro far_cross_fade_to( unsigned int *destination<_di>, unsigned char num_colors<_al>, unsigned char which_component<_ah> );
  403                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 83; // *************
  404                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 84; // Video Functions
  405                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 85; // *************
  406                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 87; extern void __fastcall init_240x208( void );
  407                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 88; extern void __fastcall init_256x224( void );
  408                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 90; extern void __fastcall vsync( void );
  409                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 91; extern void __fastcall vsync( unsigned char count<_al> );
  410                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 93; extern void __fastcall disp_on( void );
  411                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 94; extern void __fastcall disp_off( void );
  412                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 96; extern void __fastcall set_screen_size( unsigned char value<_al> );
  413                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 98; extern void __fastcall set_xres( unsigned int x_pixels<_ax>, unsigned char blur_flag<_bl> );
  414                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 100; extern void __fastcall cls( void );
  415                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 101; extern void __fastcall cls( unsigned int tile<acc> );
  416                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 103; extern unsigned int __fastcall __macro vram_addr( unsigned char bat_x<_al>, unsigned char bat_y<_ah> );
  417                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 104; extern unsigned int __fastcall __macro get_vram( unsigned int address<_di> );
  418                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 105; extern void __fastcall __macro put_vram( unsigned int address<_di>, unsigned int data<acc> );
  419                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 107; extern void __fastcall __macro load_vram( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_words<_ax> );
  420                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 108; extern void __fastcall __macro far_load_vram( unsigned int vram<_di>,  unsigned int num_words<_ax> );
  421                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 110; extern void __fastcall load_bat( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned char tiles_w<_al>, unsigned char tiles_h<_ah> );
  422                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 111; extern void __fastcall far_load_bat( unsigned int vram<_di>, unsigned char tiles_w<_al>, unsigned char tiles_h<_ah> );
  423                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 113; extern void __fastcall __macro load_sprites( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_groups<acc> );
  424                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 114; extern void __fastcall __macro far_load_sprites( unsigned int vram<_di>, unsigned int num_groups<acc> );
  425                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 116; extern void __fastcall vram2vram( unsigned int vram_dst<_ax>, unsigned int vram_src<_bx>, unsigned int word_len<_cx> );
  426                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 119; // *************
  427                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 120; // SuperGRAFX Video Functions
  428                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 121; // *************
  429                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 123; extern void __fastcall __nop vpc_set_ctl( unsigned int bits<VPC_CR> );
  430                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 124; extern void __fastcall __nop vpc_set_win1( unsigned int width<VPC_WINDOW1> );
  431                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 125; extern void __fastcall __nop vpc_set_win2( unsigned int width<VPC_WINDOW2> );
  432                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 127; extern void __fastcall sgx_set_screen_size( unsigned char value<_al> );
  433                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 129; extern void __fastcall sgx_set_xres( unsigned int x_pixels<_ax>, unsigned char blur_flag<_bl> );
  434                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 131; extern void __fastcall sgx_cls( void );
  435                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 132; extern void __fastcall sgx_cls( unsigned int tile<acc> );
  436                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 134; extern unsigned int __fastcall __macro sgx_vram_addr( unsigned char bat_x<_al>, unsigned char bat_y<_ah> );
  437                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 135; extern unsigned int __fastcall __macro sgx_get_vram( unsigned int address<_di> );
  438                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 136; extern void __fastcall __macro sgx_put_vram( unsigned int address<_di>, unsigned int data<acc> );
  439                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 138; extern void __fastcall __macro sgx_load_vram( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_words<_ax> );
  440                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 139; extern void __fastcall __macro sgx_far_load_vram( unsigned int vram<_di>, unsigned int num_words<_ax> );
  441                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 141; extern void __fastcall sgx_load_bat( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned char tiles_w<_al>, unsigned char tiles_h<_ah> );
  442                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 142; extern void __fastcall sgx_far_load_bat( unsigned int vram<_di>, unsigned char tiles_w<_al>, unsigned char tiles_h<_ah> );
  443                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 144; extern void __fastcall __macro sgx_load_sprites( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_groups<acc> );
  444                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 145; extern void __fastcall __macro sgx_far_load_sprites( unsigned int vram<_di>, unsigned int num_groups<acc> );
  445                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 147; extern void __fastcall sgx_vram2vram( unsigned int vram_dst<_ax>, unsigned int vram_src<_bx>, unsigned int word_len<_cx> );
  446                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 150; // *************
  447                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 151; // Font Functions
  448                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 152; // *************
  449                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 154; extern void __fastcall set_font_addr( unsigned int vram<acc> );
  450                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 155; extern void __fastcall set_font_pal( unsigned char palette<acc> );
  451                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 157; extern void __fastcall load_font( unsigned char __far *font<_bp_bank:_bp>, unsigned char count<_al>, unsigned int vram<acc> );
  452                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 158; extern void __fastcall far_load_font( unsigned char count<_al>, unsigned int vram<acc> );
  453                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 160; extern void __fastcall __nop set_font_color( unsigned char foreground<monofont_fg>, unsigned char background<monofont_bg> );
  454                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 161; extern void __fastcall __macro load_default_font( void );
  455                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 164; // *************
  456                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 165; // SuperGRAFX Font Functions
  457                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 166; // *************
  458                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 168; extern void __fastcall sgx_set_font_addr( unsigned int vram<acc> );
  459                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 169; extern void __fastcall sgx_set_font_pal( unsigned char palette<acc> );
  460                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 171; extern void __fastcall sgx_load_font( char __far *font<_bp_bank:_bp>, unsigned char count<_al>, unsigned int vram<acc> );
  461                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 172; extern void __fastcall sgx_far_load_font( unsigned char count<_al>, unsigned int vram<acc> );
  462                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 174; extern void __fastcall __macro sgx_load_default_font( void );
  463                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 177; // *************
  464                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 178; // Deprecated functions ...
  465                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 179; // *************
  466                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 181; extern void __fastcall __macro set_xres( unsigned int x_pixels<_ax> );
  467                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 182; extern void __fastcall __macro sgx_set_xres( unsigned int x_pixels<_ax> );
  468                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 184; extern void __fastcall load_background( unsigned char __far *tiles<_bp_bank:_bp>, unsigned char __far *palettes<__fbank:__fptr>, unsigned char __far *bat<_cl:_bx>, unsigned char w<_dl>, unsigned char h<_dh> );
  469                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 186; extern void __fastcall __macro set_bgpal( unsigned char palette<_al>, unsigned char __far *data<_bp_bank:_bp> );
  470                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 187; extern void __fastcall __macro set_bgpal( unsigned char palette<_al>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_palettes<_ah> );
  471                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 188; extern void __fastcall __macro set_sprpal( unsigned char palette<_al>, unsigned char __far *data<_bp_bank:_bp> );
  472                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 189; extern void __fastcall __macro set_sprpal( unsigned char palette<_al>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_palettes<_ah> );
  473                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 191; extern void __fastcall load_font( char __far *font<_bp_bank:_bp>, unsigned char count<_al> );
  474                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 193; extern void __fastcall put_string( unsigned char *string<_bp>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
  475                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 195; extern void __fastcall put_char( unsigned char digit<_bl>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
  476                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 196; extern void __fastcall put_digit( unsigned char digit<_bl>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
  477                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 197; extern void __fastcall put_hex( unsigned int number<_bx>, unsigned char length<_cl>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
  478                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 198; extern void __fastcall put_number( unsigned int number<_bx>, unsigned char length<_cl>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
  479                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 199; extern void __fastcall put_raw( unsigned int data<_bx>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
  480                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 201; #endif // __HUCC__
  481                        		.dbg	line,	"..\..\..\include\hucc\hucc-gfx.h", 203; #endif // _hucc_gfx_h
  482                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 36; #include "hucc-string.h"
  483                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 1; #ifndef _hucc_string_h
  484                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 2; #define _hucc_string_h
  485                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 4; /****************************************************************************
  486                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 5; ; ***************************************************************************
  487                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 6; ;
  488                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 7; ; hucc-string.h
  489                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 8; ;
  490                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 9; ; Not-quite-standard, but fast, replacements for <string.h>.
  491                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 10; ;
  492                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 11; ; Copyright John Brandwood 2024.
  493                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 12; ;
  494                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 13; ; Distributed under the Boost Software License, Version 1.0.
  495                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
  496                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
  497                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 16; ;
  498                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 17; ; ***************************************************************************
  499                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 18; ; ***************************************************************************
  500                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 19; ;
  501                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 20; ; !!! WARNING : non-standard return values !!!
  502                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 21; ;
  503                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 22; ; Strings are limited to a maximum of 255 characters (+ the terminator)!
  504                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 23; ;
  505                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 24; ; The memcpy(), strcpy() and strcat() functions do NOT return the destination
  506                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 25; ; address, and they are declared "void" to check that the value is not used.
  507                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 26; ;
  508                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 27; ; mempcpy() is provided which returns the end address instead of the starting
  509                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 28; ; address, because this is typically more useful.
  510                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 29; ;
  511                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 30; ; Please note that both memcpy() and memset() are implemented using a TII for
  512                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 31; ; speed, and so the length should be < 16 bytes if used in time-critical bits
  513                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 32; ; of code (such as when using a split screen) because they delay interrupts.
  514                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 33; ;
  515                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 34; ; strncpy() and strncat() are not provided, because strncpy() was not created
  516                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 35; ; for the purpose of avoiding string overruns, and strncat() is just a poorly
  517                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 36; ; designed function IMHO.
  518                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 37; ;
  519                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 38; ; POSIX strlcpy() and strlcat() are provided instead, but once again they are
  520                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 39; ; slightly non-standard in that the return value when there is an overflow is
  521                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 40; ; the buffer size (so that the overflow can be detected), instead of the full
  522                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 41; ; size of the destination string that was too big to fit in the buffer.
  523                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 42; ;
  524                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 43; ; ***************************************************************************
  525                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 44; ; **************************************************************************/
  526                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 46; // *************
  527                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 47; // Functions in hucc-string.asm ...
  528                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 48; // *************
  529                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 50; #ifdef __HUCC__
  530                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 52; #asmdef	HUCC_USES_STRING 1
  531               0001     	HUCC_USES_STRING = 1
  532                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 54; extern void __fastcall strcpy( char *destination<_di>, char *source<_bp> );
  533                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 55; extern void __fastcall strcat( char *destination<_di>, char *source<_bp> );
  534                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 57; extern unsigned int __fastcall strlen( char *source<_bp> );
  535                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 59; extern unsigned int __fastcall strlcpy( char *destination<_di>, char *source<_bp>, unsigned char size<acc> );
  536                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 60; extern unsigned int __fastcall strlcat( char *destination<_di>, char *source<_bp>, unsigned char size<acc> );
  537                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 62; extern void __fastcall memcpy( unsigned char *destination<ram_tii_dst>, unsigned char *source<ram_tii_src>, unsigned int count<acc> );
  538                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 63; extern void __fastcall farmemcpy( unsigned char *destination<ram_tii_dst>, unsigned char __far *source<_bp_bank:ram_tii_src>, unsigned int count<acc> );
  539                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 64; extern void __fastcall far_memcpy( unsigned char *destination<ram_tii_dst>, unsigned int count<acc> );
  540                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 66; extern unsigned char * __fastcall mempcpy( unsigned char *destination<ram_tii_dst>, unsigned char *source<ram_tii_src>, unsigned int count<acc> );
  541                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 67; extern unsigned char * __fastcall farmempcpy( unsigned char *destination<ram_tii_dst>, unsigned char __far *source<_bp_bank:ram_tii_src>, unsigned int count<acc> );
  542                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 68; extern unsigned char * __fastcall far_mempcpy( unsigned char *destination<ram_tii_dst>, unsigned int count<acc> );
  543                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 70; extern void __fastcall memset( unsigned char *destination<ram_tii_src>, unsigned char value<_al>, unsigned int count<acc> );
  544                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 72; //  0 	if strings are equal
  545                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 73; //  1 	if the first non-matching character in string1 > string2 (in ASCII).
  546                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 74; // -1 	if the first non-matching character in string1 < string2 (in ASCII).
  547                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 76; extern int __fastcall strcmp( char *string1<_di>, char *string2<_bp> );
  548                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 77; extern int __fastcall strncmp( char *string1<_di>, char *string2<_bp>, unsigned int count<_ax> );
  549                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 79; extern int __fastcall __macro memcmp( unsigned char *string1<_di>, unsigned char *string2<_bp>, unsigned int count<acc> );
  550                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 80; extern int __fastcall farmemcmp( unsigned char *string1<_di>, unsigned char __far *string2<_bp_bank:_bp>, unsigned int count<acc> );
  551                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 81; extern int __fastcall far_memcmp( unsigned char *string1<_di>, unsigned int count<acc> );
  552                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 83; #endif // __HUCC__
  553                        		.dbg	line,	"..\..\..\include\hucc\hucc-string.h", 85; #endif // _hucc_string_h
  554                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 37; #include "hucc-old-scroll.h"
  555                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 1; #ifndef _hucc_old_scroll_h
  556                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 2; #define _hucc_old_scroll_h
  557                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 4; /****************************************************************************
  558                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 5; ; ***************************************************************************
  559                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 6; ;
  560                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 7; ; hucc-old-scroll.h
  561                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 8; ;
  562                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 9; ; Based on the original HuC and MagicKit functions by David Michel and the
  563                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 10; ; other original HuC developers.
  564                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 11; ;
  565                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 12; ; Modifications copyright John Brandwood 2024.
  566                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 13; ;
  567                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 14; ; Distributed under the Boost Software License, Version 1.0.
  568                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 15; ; (See accompanying file LICENSE_1_0.txt or copy at
  569                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 16; ;  http://www.boost.org/LICENSE_1_0.txt)
  570                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 17; ;
  571                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 18; ; ***************************************************************************
  572                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 19; ; ***************************************************************************
  573                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 20; ;
  574                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 21; ; HuC's old scrolling library is provided for use with existing HuC projects,
  575                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 22; ; but it should preferably be avoided in new projects because it is slow and
  576                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 23; ; forever limited by its choice to handle gaps between areas, and sorting.
  577                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 24; ;
  578                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 25; ; HuCC's new scrolling library puts the responibility for defining both gaps
  579                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 26; ; and the display order into the project's hands, but in return it runs much
  580                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 27; ; faster, using less than 1/6 of the processing time in VBLANK, and far less
  581                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 28; ; time in the RCR interrputs themselves. It also supports the 2nd SuperGRAFX
  582                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 29; ; screen layer, which HuC's old scrolling library ignores.
  583                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 30; ;
  584                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 31; ; ***************************************************************************
  585                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 32; ; **************************************************************************/
  586                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 34; // *************
  587                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 35; // Functions in hucc-old-scroll.asm ...
  588                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 36; // *************
  589                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 38; #ifdef __HUCC__
  590                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 40; #asmdef	HUCC_USES_OLD_SCROLL 1
  591               0001     	HUCC_USES_OLD_SCROLL = 1
  592                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 42; extern void __fastcall scroll( unsigned char num<_al>, unsigned int x<_cx>, unsigned int y<_dx>, unsigned char top<_ah>, unsigned char bottom<_bl>, unsigned char disp<acc> );
  593                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 43; extern void __fastcall scroll_disable( unsigned char num<acc> );
  594                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 45; #endif // __HUCC__
  595                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-scroll.h", 47; #endif // _hucc_old_scroll_h
  596                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 38; #include "hucc-old-spr.h"
  597                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 1; #ifndef _hucc_old_spr_h
  598                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 2; #define _hucc_old_spr_h
  599                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 4; /****************************************************************************
  600                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 5; ; ***************************************************************************
  601                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 6; ;
  602                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 7; ; hucc-old-spr.h
  603                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 8; ;
  604                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 9; ; Based on the original HuC and MagicKit functions by David Michel and the
  605                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 10; ; other original HuC developers.
  606                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 11; ;
  607                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 12; ; Modifications copyright John Brandwood 2024.
  608                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 13; ;
  609                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 14; ; Distributed under the Boost Software License, Version 1.0.
  610                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 15; ; (See accompanying file LICENSE_1_0.txt or copy at
  611                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 16; ;  http://www.boost.org/LICENSE_1_0.txt)
  612                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 17; ;
  613                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 18; ; ***************************************************************************
  614                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 19; ; **************************************************************************/
  615                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 21; // *************
  616                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 22; // Sprite defines ...
  617                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 23; // *************
  618                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 25; #define FLIP_X_MASK 0x08
  619                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 26; #define FLIP_Y_MASK 0x80
  620                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 27; #define FLIP_MAS    0x88
  621                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 28; #define SIZE_MAS    0x31
  622                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 30; #define NO_FLIP     0x00
  623                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 31; #define NO_FLIP_X   0x00
  624                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 32; #define NO_FLIP_Y   0x00
  625                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 33; #define FLIP_X      0x08
  626                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 34; #define FLIP_Y      0x80
  627                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 35; #define SZ_16x16    0x00
  628                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 36; #define SZ_16x32    0x10
  629                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 37; #define SZ_16x64    0x30
  630                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 38; #define SZ_32x16    0x01
  631                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 39; #define SZ_32x32    0x11
  632                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 40; #define	SZ_32x64    0x31
  633                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 42; // *************
  634                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 43; // Functions in hucc-old-spr.asm ...
  635                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 44; // *************
  636                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 46; #ifdef __HUCC__
  637                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 48; #asmdef	HUCC_USES_OLD_SPR 1
  638               0001     	HUCC_USES_OLD_SPR = 1
  639                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 50; extern void __fastcall init_satb( void );
  640                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 51; extern void __fastcall reset_satb( void );
  641                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 52; extern void __fastcall satb_update( void );
  642                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 53; extern void __fastcall spr_set( unsigned char num<acc> );
  643                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 54; extern void __fastcall spr_hide( void );
  644                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 55; extern void __fastcall spr_show( void );
  645                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 56; extern void __fastcall spr_x( unsigned int value<acc> );
  646                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 57; extern void __fastcall spr_y( unsigned int value<acc> );
  647                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 58; extern void __fastcall spr_pattern( unsigned int vaddr<acc> );
  648                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 59; extern void __fastcall spr_ctrl( unsigned char mask<_al>, unsigned char value<acc> );
  649                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 60; extern void __fastcall spr_pal( unsigned char palette<acc> );
  650                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 61; extern void __fastcall spr_pri( unsigned char priority<acc> );
  651                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 63; extern unsigned int __fastcall spr_get_x( void );
  652                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 64; extern unsigned int __fastcall spr_get_y( void );
  653                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 66; extern void __fastcall sgx_init_satb( void );
  654                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 67; extern void __fastcall sgx_reset_satb( void );
  655                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 68; extern void __fastcall sgx_satb_update( void );
  656                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 69; extern void __fastcall sgx_spr_set( unsigned char num<acc> );
  657                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 70; extern void __fastcall sgx_spr_hide( void );
  658                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 71; extern void __fastcall sgx_spr_show( void );
  659                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 72; extern void __fastcall sgx_spr_x( unsigned int value<acc> );
  660                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 73; extern void __fastcall sgx_spr_y( unsigned int value<acc> );
  661                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 74; extern void __fastcall sgx_spr_pattern( unsigned int vaddr<acc> );
  662                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 75; extern void __fastcall sgx_spr_ctrl( unsigned char mask<_al>, unsigned char value<acc> );
  663                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 76; extern void __fastcall sgx_spr_pal( unsigned char palette<acc> );
  664                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 77; extern void __fastcall sgx_spr_pri( unsigned char priority<acc> );
  665                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 79; extern unsigned int __fastcall sgx_spr_get_x( void );
  666                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 80; extern unsigned int __fastcall sgx_spr_get_y( void );
  667                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 82; #endif // __HUCC__
  668                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-spr.h", 84; #endif // _hucc_old_spr_h
  669                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 39; #include "hucc-old-map.h"
  670                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 1; #ifndef _hucc_old_map_h
  671                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 2; #define _hucc_old_map_h
  672                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 4; /****************************************************************************
  673                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 5; ; ***************************************************************************
  674                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 6; ;
  675                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 7; ; hucc-old-map.h
  676                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 8; ;
  677                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 9; ; Based on the original HuC and MagicKit functions by David Michel and the
  678                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 10; ; other original HuC developers.
  679                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 11; ;
  680                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 12; ; Modifications copyright John Brandwood 2024.
  681                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 13; ;
  682                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 14; ; Distributed under the Boost Software License, Version 1.0.
  683                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 15; ; (See accompanying file LICENSE_1_0.txt or copy at
  684                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 16; ;  http://www.boost.org/LICENSE_1_0.txt)
  685                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 17; ;
  686                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 18; ; ***************************************************************************
  687                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 19; ; **************************************************************************/
  688                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 21; // *************
  689                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 22; // Functions in hucc-old-map.asm ...
  690                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 23; // *************
  691                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 25; #ifdef __HUCC__
  692                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 27; #asmdef	HUCC_USES_OLD_MAP 1
  693               0001     	HUCC_USES_OLD_MAP = 1
  694                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 29; extern void __fastcall set_tile_address( unsigned int vram<_di> );
  695                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 30; extern void __fastcall sgx_set_tile_address( unsigned int vram<_di> );
  696                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 32; extern void __fastcall __nop set_tile_data( unsigned char __far *tiles<vdc_tile_bank:vdc_tile_addr>, unsigned char num_tiles<vdc_num_tiles>, unsigned char __far *palette_table<vdc_attr_bank:vdc_attr_addr>, unsigned char tile_type<vdc_tile_type> );
  697                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 33; extern void __fastcall __nop sgx_set_tile_data( unsigned char __far *tiles<sgx_tile_bank:sgx_tile_addr>, unsigned char num_tiles<sgx_num_tiles>, unsigned char __far *palette_table<sgx_attr_bank:sgx_attr_addr>, unsigned char tile_type<sgx_tile_type> );
  698                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 35; extern void __fastcall __nop set_far_tile_data( unsigned char tile_bank<vdc_tile_bank>, unsigned char *tile_addr<vdc_tile_addr>, unsigned char num_tiles<vdc_num_tiles>, unsigned char palette_table_bank<vdc_attr_bank>, unsigned char *palette_table_addr<vdc_attr_addr>, unsigned char tile_type<vdc_tile_type> );
  699                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 36; extern void __fastcall __nop sgx_set_far_tile_data( unsigned char tile_bank<sgx_tile_bank>, unsigned char *tile_addr<sgx_tile_addr>, unsigned char num_tiles<sgx_num_tiles>, unsigned char palette_table_bank<sgx_attr_bank>, unsigned char *palette_table_addr<sgx_attr_addr>, unsigned char tile_type<sgx_tile_type> );
  700                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 38; extern void __fastcall __nop set_map_data( unsigned char __far *map<vdc_map_bank:vdc_map_addr>, unsigned char w<vdc_map_width>, unsigned char h<vdc_map_height> );
  701                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 39; extern void __fastcall __nop sgx_set_map_data( unsigned char __far *map<sgx_map_bank:sgx_map_addr>, unsigned char w<sgx_map_width>, unsigned char h<sgx_map_height> );
  702                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 41; extern void __fastcall __nop set_far_map_data( unsigned char map_bank<vdc_map_bank>, unsigned char *map_addr<vdc_map_addr>, unsigned char w<vdc_map_width>, unsigned char h<vdc_map_height> );
  703                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 42; extern void __fastcall __nop sgx_set_far_map_data( unsigned char map_bank<vdc_map_bank>, unsigned char *map_addr<vdc_map_addr>, unsigned char w<sgx_map_width>, unsigned char h<sgx_map_height> );
  704                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 44; extern void __fastcall load_tile( unsigned int vram<_di> );
  705                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 45; extern void __fastcall sgx_load_tile( unsigned int vram<_di> );
  706                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 47; extern void __fastcall load_map( unsigned char bat_x<_al>, unsigned char bat_y<_ah>, int map_x<_bx>, int map_y<_dx>, unsigned char tiles_w<_cl>, unsigned char tiles_h<_ch> );
  707                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 48; extern void __fastcall sgx_load_map( unsigned char bat_x<_al>, unsigned char bat_y<_ah>, int map_x<_bx>, int map_y<_dx>, unsigned char tiles_w<_cl>, unsigned char tiles_h<_ch> );
  708                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 50; extern unsigned char __fastcall map_get_tile( unsigned char map_x<_bl>, unsigned char map_y<_bh> );
  709                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 51; extern unsigned char __fastcall sgx_map_get_tile( unsigned char map_x<_bl>, unsigned char map_y<_bh> );
  710                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 53; extern void __fastcall map_put_tile( unsigned char map_x<_bl>, unsigned char map_y<_bh>, unsigned char tile<_al> );
  711                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 54; extern void __fastcall sgx_map_put_tile( unsigned char map_x<_bl>, unsigned char map_y<_bh>, unsigned char tile<_al> );
  712                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 56; extern void __fastcall put_tile( unsigned char tile<_bl>, unsigned char bat_x<_al>, unsigned char bat_y<_ah> );
  713                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 57; extern void __fastcall sgx_put_tile( unsigned char tile<_bl>, unsigned char bat_x<_al>, unsigned char bat_y<_ah> );
  714                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 59; // Deprecated functions ...
  715                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 61; extern void __fastcall set_tile_data( unsigned char *tile_ex<_di> );
  716                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 63; extern void __fastcall __nop set_map_pals( unsigned char __far *palette_table<vdc_attr_bank:vdc_attr_addr> );
  717                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 64; extern void __fastcall __nop set_map_tile_type( unsigned char tile_type<vdc_tile_type> );
  718                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 66; extern void __fastcall __nop sgx_set_map_pals( unsigned char __far *palette_table<sgx_attr_bank:sgx_attr_addr> );
  719                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 67; extern void __fastcall __nop sgx_set_map_tile_type( unsigned char tile_type<sgx_tile_type> );
  720                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 69; extern void __fastcall set_map_tile_base( unsigned int vram<_di> );
  721                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 70; extern void __fastcall sgx_set_map_tile_base( unsigned int vram<_di> );
  722                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 72; #endif // __HUCC__
  723                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-map.h", 74; #endif // _hucc_old_map_h
  724                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 40; #include "hucc-old-line.h"
  725                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 1; #ifndef _hucc_old_line_h
  726                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 2; #define _hucc_old_line_h
  727                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 4; /****************************************************************************
  728                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 5; ; ***************************************************************************
  729                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 6; ;
  730                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 7; ; hucc-old-line.h
  731                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 8; ;
  732                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 9; ; Based on the original HuC and MagicKit functions by David Michel and the
  733                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 10; ; other original HuC developers.
  734                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 11; ;
  735                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 12; ; Modifications copyright John Brandwood 2024.
  736                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 13; ;
  737                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 14; ; Distributed under the Boost Software License, Version 1.0.
  738                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 15; ; (See accompanying file LICENSE_1_0.txt or copy at
  739                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 16; ;  http://www.boost.org/LICENSE_1_0.txt)
  740                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 17; ;
  741                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 18; ; ***************************************************************************
  742                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 19; ; **************************************************************************/
  743                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 21; // *************
  744                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 22; // Functions in hucc-old-line.asm ...
  745                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 23; // *************
  746                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 25; #ifdef __HUCC__
  747                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 27; #asmdef	HUCC_USES_OLD_LINE 1
  748               0001     	HUCC_USES_OLD_LINE = 1
  749                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 29; extern void __fastcall gfx_init( unsigned int start_vram_addr<_ax> );
  750                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 30; extern void __fastcall gfx_clear( unsigned int start_vram_addr<_di> );
  751                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 31; extern void __fastcall gfx_plot( unsigned int x<_gfx_x1>, unsigned int y<_gfx_y1>, char color<_gfx_color> );
  752                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 32; extern void __fastcall gfx_line( unsigned int x1<_gfx_x1>, unsigned int y1<_gfx_y1>, unsigned int x2<_gfx_x2>, unsigned int y2<_gfx_y2>, unsigned char color<_gfx_color> );
  753                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 34; #endif // __HUCC__
  754                        		.dbg	line,	"..\..\..\include\hucc\hucc-old-line.h", 36; #endif // _hucc_old_line_h
  755                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 42; #endif // _hucc_legacy_h
  756                        		.dbg	line,	"main.c", 1; #include "huc.h"
  757                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 1; #ifndef _hucc_legacy_h
  758                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 2; #define _hucc_legacy_h
  759                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 4; /****************************************************************************
  760                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 5; ; ***************************************************************************
  761                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 6; ;
  762                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 7; ; huc.h
  763                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 8; ;
  764                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 9; ; HuCC wrapper file to include a default set of HuC-compatible functions.
  765                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 10; ;
  766                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 11; ; Copyright John Brandwood 2024.
  767                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 12; ;
  768                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 13; ; Distributed under the Boost Software License, Version 1.0.
  769                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
  770                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
  771                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 16; ;
  772                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 17; ; ***************************************************************************
  773                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 18; ; ***************************************************************************
  774                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 19; ;
  775                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 20; ; When the HuCC compiler is invoked with the "--legacy" option to compile old
  776                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 21; ; projects, then this "huc.h" file is automatically included.
  777                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 22; ;
  778                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 23; ; This file includes a set of the individual HuCC headers which correspond to
  779                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 24; ; HuC's built-in functions and MagicKit library.
  780                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 25; ;
  781                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 26; ; New HuCC projects should, preferably, include the specific headers that are
  782                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 27; ; needed, which will then allow them to replace parts of the standard library
  783                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 28; ; with newer functions, or they can just manually include this "huc.h" file.
  784                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 29; ;
  785                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 30; ; ***************************************************************************
  786                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 31; ; **************************************************************************/
  787                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 33; #include "hucc-systemcard.h"
  788                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 34; #include "hucc-baselib.h"
  789                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 35; #include "hucc-gfx.h"
  790                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 36; #include "hucc-string.h"
  791                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 37; #include "hucc-old-scroll.h"
  792                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 38; #include "hucc-old-spr.h"
  793                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 39; #include "hucc-old-map.h"
  794                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 40; #include "hucc-old-line.h"
  795                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 42; #endif // _hucc_legacy_h
  796                        		.dbg	line,	"main.c", 2; #include "hucc-scroll.h"
  797                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 1; #ifndef _hucc_scroll_h
  798                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 2; #define _hucc_scroll_h
  799                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 4; /****************************************************************************
  800                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 5; ; ***************************************************************************
  801                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 6; ;
  802                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 7; ; hucc-scroll.h
  803                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 8; ;
  804                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 9; ; Routines for a fast split-screen scrolling system.
  805                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 10; ;
  806                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 11; ; Copyright John Brandwood 2024.
  807                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 12; ;
  808                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 13; ; Distributed under the Boost Software License, Version 1.0.
  809                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
  810                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
  811                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 16; ;
  812                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 17; ; ***************************************************************************
  813                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 18; ; ***************************************************************************
  814                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 19; ;
  815                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 20; ; The maximum number of splits for each screen layer is set in your project's
  816                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 21; ; "hucc-config.inc" file, with the library having a limit of 128-per-layer.
  817                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 22; ;
  818                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 23; ; Your first active split must be defined to start at screen line 0, and then
  819                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 24; ; the rest of the active splits must be in increasing line order to match the
  820                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 25; ; way that the PC Engine displays the output image.
  821                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 26; ;
  822                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 27; ; You can have disabled splits interleaved with your active splits.
  823                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 28; ;
  824                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 29; ; Splits that are normally disabled can be used to create full screen effects
  825                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 30; ; such as bouncing the screen up and down by adding blank areas at the top or
  826                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 31; ; bottom of the screen, and then rapidly changing the height of those areas.
  827                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 32; ;
  828                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 33; ; ***************************************************************************
  829                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 34; ; **************************************************************************/
  830                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 36; // *************
  831                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 37; // VDC bits for display_flags ...
  832                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 38; // *************
  833                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 40; #ifndef BKG_OFF
  834                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 41; #define BKG_OFF 0x00
  835                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 42; #endif
  836                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 44; #ifndef SPR_OFF
  837                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 45; #define SPR_OFF 0x00
  838                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 46; #endif
  839                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 48; #ifndef BKG_ON
  840                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 49; #define BKG_ON 0x80
  841                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 50; #endif
  842                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 52; #ifndef SPR_ON
  843                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 53; #define SPR_ON 0x40
  844                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 54; #endif
  845                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 56; // *************
  846                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 57; // Functions in hucc-scroll.asm ...
  847                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 58; // *************
  848                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 60; #ifdef __HUCC__
  849                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 62; #asmdef	HUCC_USES_NEW_SCROLL 1
  850               0001     	HUCC_USES_NEW_SCROLL = 1
  851                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 64; extern void __fastcall scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
  852                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 65; extern void __fastcall sgx_scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
  853                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 67; extern void __fastcall disable_split( unsigned char index<acc> );
  854                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 68; extern void __fastcall sgx_disable_split( unsigned char index<acc> );
  855                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 70; extern void __fastcall __macro disable_all_splits( void );
  856                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 71; extern void __fastcall __macro sgx_disable_all_splits( void );
  857                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 73; #asm
  858                        		.dbg	clear
  859                        			.macro	_disable_all_splits
  860                        			ldy	#HUCC_PCE_SPLITS - 1
  861                        	!loop:		tya
  862                        			call	_disable_split.1
  863                        			dey
  864                        			bpl	!loop-
  865                        			.endm
  866                        			.macro	_sgx_disable_all_splits
  867                        			ldy	#HUCC_SGX_SPLITS - 1
  868                        	!loop:		tya
  869                        			call	_sgx_disable_split.1
  870                        			dey
  871                        			bpl	!loop-
  872                        			.endm
  873                        	
  874                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 89; #endasm
  875                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 91; #endif // __HUCC__
  876                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 93; #endif // _hucc_scroll_h
  877                        		.dbg	line,	"main.c", 3; #include "hucc-chrmap.h"
  878                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 1; #ifndef _hucc_chrmap_h
  879                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 2; #define _hucc_chrmap_h
  880                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 4; /****************************************************************************
  881                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 5; ; ***************************************************************************
  882                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 6; ;
  883                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 7; ; hucc-chrmap.h
  884                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 8; ;
  885                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 9; ; A simple map system based on 8x8 characters (aka "tiles") in BAT format.
  886                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 10; ;
  887                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 11; ; Copyright John Brandwood 2025.
  888                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 12; ;
  889                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
  890                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
  891                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
  892                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 16; ;
  893                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 17; ; ***************************************************************************
  894                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 18; ; ***************************************************************************
  895                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 19; ;
  896                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 20; ; The maximum X and Y size for chrmaps is 256 characters (2048 pixels).
  897                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 21; ;
  898                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 22; ; The maximum total size for a chrmap is 16KBytes, which allows for maps up
  899                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 23; ; to 256x32 tiles (2048x256 pixels).
  900                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 24; ;
  901                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 25; ; ***************************************************************************
  902                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 26; ; **************************************************************************/
  903                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 28; // *************
  904                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 29; // This code extends the blkmap library ...
  905                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 30; // *************
  906                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 32; #include "hucc-blkmap.h"
  907                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 1; #ifndef _hucc_blkmap_h
  908                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 2; #define _hucc_blkmap_h
  909                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 4; /****************************************************************************
  910                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 5; ; ***************************************************************************
  911                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 6; ;
  912                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 7; ; hucc-blkmap.h
  913                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 8; ;
  914                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 9; ; A map system based on 16x16 meta-tiles (aka "blocks", aka CHR/BLK/MAP).
  915                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 10; ;
  916                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 11; ; Copyright John Brandwood 2025.
  917                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 12; ;
  918                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
  919                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
  920                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
  921                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 16; ;
  922                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 17; ; ***************************************************************************
  923                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 18; ; ***************************************************************************
  924                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 19; ;
  925                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 20; ; The maximum X and Y size for blkmaps is 128 blocks (2048 pixels).
  926                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 21; ;
  927                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 22; ; The maximum total size for a blkmap is 16KBytes, which allows for maps up
  928                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 23; ; to 128x128 blocks (2048x2048 pixels).
  929                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 24; ;
  930                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 25; ; Huge multi-screen blkmaps are also supported (optionally).
  931                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 26; ;
  932                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 27; ; The maximum X and Y for multi-screen maps is 128 screens (32768 pixels).
  933                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 28; ;
  934                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 29; ; The maximum total size for a multi-screen map is 8KBytes, which allows for
  935                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 30; ; a total of 1024 screens.
  936                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 31; ;
  937                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 32; ; ***************************************************************************
  938                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 33; ; **************************************************************************/
  939                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 35; // *************
  940                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 36; // Functions in blkmap.asm ...
  941                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 37; // *************
  942                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 39; #ifdef __HUCC__
  943                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 41; #asmdef	HUCC_USES_BLKMAP 1
  944               0001     	HUCC_USES_BLKMAP = 1
  945                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 43; // Current top-left of drawn map in pixels.
  946                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 44; extern unsigned int   vdc_map_pxl_x;
  947                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 45; extern unsigned int   vdc_map_pxl_y;
  948                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 47; // Width and height to draw/scroll in characters (not tiles).
  949                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 48; extern unsigned char  vdc_map_draw_w;
  950                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 49; extern unsigned char  vdc_map_draw_h;
  951                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 51; // Width of map (or multi-screen BAT) in tiles.
  952                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 52; extern unsigned char  vdc_map_line_w;
  953                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 54; // Width of map in screens (if multi-screen map).
  954                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 55; extern unsigned char  vdc_map_scrn_w;
  955                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 57; // Extra information returned by get_map_block() and sgx_get_map_block(),
  956                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 58; // which are the collision flags and the mask/overlay sprite for the BLK.
  957                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 59; extern unsigned char  map_blk_flag;
  958                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 60; extern unsigned char  map_blk_mask;
  959                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 62; extern unsigned char  vdc_scr_bank;
  960                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 63; extern unsigned char *vdc_scr_addr;
  961                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 65; extern unsigned char  vdc_map_bank;
  962                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 66; extern unsigned char *vdc_map_addr;
  963                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 68; extern unsigned char  vdc_blk_bank;
  964                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 69; extern unsigned char *vdc_blk_addr;
  965                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 71; extern unsigned char  vdc_tbl_bank;
  966                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 72; extern unsigned char *vdc_tbl_addr;
  967                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 74; extern void __fastcall set_blocks( unsigned char __far *blk_def<vdc_blk_bank:vdc_blk_addr>, unsigned char __far *flg_def<vdc_tbl_bank:vdc_tbl_addr>, unsigned char number_of_blocks<_al> );
  968                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 75; extern void __fastcall __macro set_blkmap( unsigned char __far *blk_map<vdc_map_bank:vdc_map_addr>, unsigned char blocks_w<vdc_map_line_w> );
  969                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 76; extern void __fastcall __macro set_multimap( unsigned char __far *multi_map<vdc_scr_bank:vdc_scr_addr>, unsigned char screens_w<vdc_map_scrn_w> );
  970                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 78; extern void __fastcall draw_map( void );
  971                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 79; extern void __fastcall scroll_map( void );
  972                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 81; extern void __fastcall blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
  973                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 83; extern unsigned char __fastcall get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
  974                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 85; #asm
  975                        		.dbg	clear
  976                        			.macro	_set_blkmap.2
  977                        			stz	vdc_scr_bank
  978                        			.endm
  979                        			.macro	_set_multimap.2
  980                        			lda	vdc_bat_width
  981                        			lsr	a
  982                        			sta	vdc_map_line_w
  983                        			.endm
  984                        			.macro	SCREEN
  985                        			db	(((\1) & $1FFF) | $6000) >> 8, bank(\1)
  986                        			db	(((\2) & $1FFF) | $4000) >> 8, bank(\2)
  987                        			db	(((\3) & $1FFF) | $6000) >> 8, bank(\3)
  988                        			dw	(\4)
  989                        			.endm
  990                        	
  991                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 102; #endasm
  992                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 104; #ifdef _SGX
  993                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 106; // Current top-left of drawn map in pixels.
  994                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 107; extern unsigned int   sgx_map_pxl_x;
  995                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 108; extern unsigned int   sgx_map_pxl_y;
  996                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 110; // Width and height to draw/scroll in characters (not tiles).
  997                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 111; extern unsigned char  sgx_map_draw_w;
  998                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 112; extern unsigned char  sgx_map_draw_h;
  999                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 114; // Width of map (or multi-screen BAT) in tiles.
 1000                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 115; extern unsigned char  sgx_map_line_w;
 1001                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 117; // Width of map in screens (if multi-screen map).
 1002                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 118; extern unsigned char  sgx_map_scrn_w;
 1003                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 120; extern unsigned char  sgx_scr_bank;
 1004                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 121; extern unsigned char *sgx_scr_addr;
 1005                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 123; extern unsigned char  sgx_map_bank;
 1006                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 124; extern unsigned char *sgx_map_addr;
 1007                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 126; extern unsigned char  sgx_blk_bank;
 1008                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 127; extern unsigned char *sgx_blk_addr;
 1009                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 129; extern unsigned char  sgx_tbl_bank;
 1010                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 130; extern unsigned char *sgx_tbl_addr;
 1011                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 132; extern void __fastcall sgx_set_blocks( unsigned char __far *blk_def<sgx_blk_bank:sgx_blk_addr>, unsigned char __far *flg_def<sgx_tbl_bank:sgx_tbl_addr>, unsigned char number_of_blocks<_al> );
 1012                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 133; extern void __fastcall __macro sgx_set_blkmap( unsigned char __far *blk_map<sgx_map_bank:sgx_map_addr>, unsigned char blocks_w<sgx_map_line_w> );
 1013                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 134; extern void __fastcall __macro sgx_set_multimap( unsigned char __far *multi_map<sgx_scr_bank:sgx_scr_addr>, unsigned char screens_w<sgx_map_scrn_w> );
 1014                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 136; extern void __fastcall sgx_draw_map( void );
 1015                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 137; extern void __fastcall sgx_scroll_map( void );
 1016                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 139; extern void __fastcall sgx_blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1017                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 141; extern unsigned char __fastcall sgx_get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
 1018                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 143; #asm
 1019                        		.dbg	clear
 1020                        			.macro	_sgx_set_blkmap.2
 1021                        			stz	sgx_scr_bank
 1022                        			.endm
 1023                        			.macro	_sgx_set_multimap.2
 1024                        			lda	sgx_bat_width
 1025                        			lsr	a
 1026                        			sta	sgx_map_line_w
 1027                        			.endm
 1028                        	
 1029                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 153; #endasm
 1030                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 155; #endif
 1031                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 157; #endif // __HUCC__
 1032                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 159; #endif // _hucc_blkmap_h
 1033                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 34; // *************
 1034                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 35; // Functions in chrmap.asm ...
 1035                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 36; // *************
 1036                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 38; #ifdef __HUCC__
 1037                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 40; #asmdef	HUCC_USES_CHRMAP 1
 1038               0001     	HUCC_USES_CHRMAP = 1
 1039                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 42; extern void __fastcall __nop set_chrmap( unsigned char __far *chrmap<vdc_map_bank:vdc_map_addr>, unsigned char tiles_w<vdc_map_line_w> );
 1040                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 44; extern void __fastcall draw_bat( void );
 1041                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 45; extern void __fastcall scroll_bat( void );
 1042                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 47; extern void __fastcall blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1043                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 49; #ifdef _SGX
 1044                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 51; extern void __fastcall __nop sgx_set_chrmap( unsigned char __far *chrmap<sgx_map_bank:sgx_map_addr>, unsigned char tiles_w<sgx_map_line_w> );
 1045                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 53; extern void __fastcall sgx_draw_bat( void );
 1046                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 54; extern void __fastcall sgx_scroll_bat( void );
 1047                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 56; extern void __fastcall sgx_blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1048                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 58; #endif
 1049                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 60; #endif // __HUCC__
 1050                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 62; #endif // _hucc_chrmap_h
 1051                        		.dbg	line,	"main.c", 4; #include "hucc-blkmap.h"
 1052                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 1; #ifndef _hucc_blkmap_h
 1053                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 2; #define _hucc_blkmap_h
 1054                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 4; /****************************************************************************
 1055                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 5; ; ***************************************************************************
 1056                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 6; ;
 1057                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 7; ; hucc-blkmap.h
 1058                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 8; ;
 1059                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 9; ; A map system based on 16x16 meta-tiles (aka "blocks", aka CHR/BLK/MAP).
 1060                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 10; ;
 1061                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 11; ; Copyright John Brandwood 2025.
 1062                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 12; ;
 1063                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 1064                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 1065                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 1066                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 16; ;
 1067                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 17; ; ***************************************************************************
 1068                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 18; ; ***************************************************************************
 1069                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 19; ;
 1070                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 20; ; The maximum X and Y size for blkmaps is 128 blocks (2048 pixels).
 1071                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 21; ;
 1072                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 22; ; The maximum total size for a blkmap is 16KBytes, which allows for maps up
 1073                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 23; ; to 128x128 blocks (2048x2048 pixels).
 1074                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 24; ;
 1075                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 25; ; Huge multi-screen blkmaps are also supported (optionally).
 1076                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 26; ;
 1077                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 27; ; The maximum X and Y for multi-screen maps is 128 screens (32768 pixels).
 1078                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 28; ;
 1079                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 29; ; The maximum total size for a multi-screen map is 8KBytes, which allows for
 1080                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 30; ; a total of 1024 screens.
 1081                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 31; ;
 1082                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 32; ; ***************************************************************************
 1083                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 33; ; **************************************************************************/
 1084                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 35; // *************
 1085                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 36; // Functions in blkmap.asm ...
 1086                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 37; // *************
 1087                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 39; #ifdef __HUCC__
 1088                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 41; #asmdef	HUCC_USES_BLKMAP 1
 1089                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 43; // Current top-left of drawn map in pixels.
 1090                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 44; extern unsigned int   vdc_map_pxl_x;
 1091                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 45; extern unsigned int   vdc_map_pxl_y;
 1092                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 47; // Width and height to draw/scroll in characters (not tiles).
 1093                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 48; extern unsigned char  vdc_map_draw_w;
 1094                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 49; extern unsigned char  vdc_map_draw_h;
 1095                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 51; // Width of map (or multi-screen BAT) in tiles.
 1096                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 52; extern unsigned char  vdc_map_line_w;
 1097                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 54; // Width of map in screens (if multi-screen map).
 1098                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 55; extern unsigned char  vdc_map_scrn_w;
 1099                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 57; // Extra information returned by get_map_block() and sgx_get_map_block(),
 1100                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 58; // which are the collision flags and the mask/overlay sprite for the BLK.
 1101                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 59; extern unsigned char  map_blk_flag;
 1102                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 60; extern unsigned char  map_blk_mask;
 1103                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 62; extern unsigned char  vdc_scr_bank;
 1104                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 63; extern unsigned char *vdc_scr_addr;
 1105                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 65; extern unsigned char  vdc_map_bank;
 1106                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 66; extern unsigned char *vdc_map_addr;
 1107                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 68; extern unsigned char  vdc_blk_bank;
 1108                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 69; extern unsigned char *vdc_blk_addr;
 1109                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 71; extern unsigned char  vdc_tbl_bank;
 1110                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 72; extern unsigned char *vdc_tbl_addr;
 1111                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 74; extern void __fastcall set_blocks( unsigned char __far *blk_def<vdc_blk_bank:vdc_blk_addr>, unsigned char __far *flg_def<vdc_tbl_bank:vdc_tbl_addr>, unsigned char number_of_blocks<_al> );
 1112                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 75; extern void __fastcall __macro set_blkmap( unsigned char __far *blk_map<vdc_map_bank:vdc_map_addr>, unsigned char blocks_w<vdc_map_line_w> );
 1113                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 76; extern void __fastcall __macro set_multimap( unsigned char __far *multi_map<vdc_scr_bank:vdc_scr_addr>, unsigned char screens_w<vdc_map_scrn_w> );
 1114                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 78; extern void __fastcall draw_map( void );
 1115                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 79; extern void __fastcall scroll_map( void );
 1116                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 81; extern void __fastcall blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1117                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 83; extern unsigned char __fastcall get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
 1118                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 85; #asm
 1119                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 86; .macro	_set_blkmap.2
 1120                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 87; stz	vdc_scr_bank
 1121                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 88; .endm
 1122                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 90; .macro	_set_multimap.2
 1123                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 91; lda	vdc_bat_width
 1124                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 92; lsr	a
 1125                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 93; sta	vdc_map_line_w
 1126                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 94; .endm
 1127                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 96; .macro	SCREEN
 1128                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 97; db	(((\1) & $1FFF) | $6000) >> 8, bank(\1)
 1129                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 98; db	(((\2) & $1FFF) | $4000) >> 8, bank(\2)
 1130                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 99; db	(((\3) & $1FFF) | $6000) >> 8, bank(\3)
 1131                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 100; dw	(\4)
 1132                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 101; .endm
 1133                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 102; #endasm
 1134                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 104; #ifdef _SGX
 1135                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 106; // Current top-left of drawn map in pixels.
 1136                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 107; extern unsigned int   sgx_map_pxl_x;
 1137                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 108; extern unsigned int   sgx_map_pxl_y;
 1138                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 110; // Width and height to draw/scroll in characters (not tiles).
 1139                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 111; extern unsigned char  sgx_map_draw_w;
 1140                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 112; extern unsigned char  sgx_map_draw_h;
 1141                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 114; // Width of map (or multi-screen BAT) in tiles.
 1142                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 115; extern unsigned char  sgx_map_line_w;
 1143                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 117; // Width of map in screens (if multi-screen map).
 1144                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 118; extern unsigned char  sgx_map_scrn_w;
 1145                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 120; extern unsigned char  sgx_scr_bank;
 1146                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 121; extern unsigned char *sgx_scr_addr;
 1147                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 123; extern unsigned char  sgx_map_bank;
 1148                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 124; extern unsigned char *sgx_map_addr;
 1149                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 126; extern unsigned char  sgx_blk_bank;
 1150                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 127; extern unsigned char *sgx_blk_addr;
 1151                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 129; extern unsigned char  sgx_tbl_bank;
 1152                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 130; extern unsigned char *sgx_tbl_addr;
 1153                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 132; extern void __fastcall sgx_set_blocks( unsigned char __far *blk_def<sgx_blk_bank:sgx_blk_addr>, unsigned char __far *flg_def<sgx_tbl_bank:sgx_tbl_addr>, unsigned char number_of_blocks<_al> );
 1154                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 133; extern void __fastcall __macro sgx_set_blkmap( unsigned char __far *blk_map<sgx_map_bank:sgx_map_addr>, unsigned char blocks_w<sgx_map_line_w> );
 1155                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 134; extern void __fastcall __macro sgx_set_multimap( unsigned char __far *multi_map<sgx_scr_bank:sgx_scr_addr>, unsigned char screens_w<sgx_map_scrn_w> );
 1156                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 136; extern void __fastcall sgx_draw_map( void );
 1157                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 137; extern void __fastcall sgx_scroll_map( void );
 1158                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 139; extern void __fastcall sgx_blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1159                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 141; extern unsigned char __fastcall sgx_get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
 1160                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 143; #asm
 1161                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 144; .macro	_sgx_set_blkmap.2
 1162                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 145; stz	sgx_scr_bank
 1163                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 146; .endm
 1164                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 148; .macro	_sgx_set_multimap.2
 1165                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 149; lda	sgx_bat_width
 1166                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 150; lsr	a
 1167                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 151; sta	sgx_map_line_w
 1168                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 152; .endm
 1169                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 153; #endasm
 1170                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 155; #endif
 1171                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 157; #endif // __HUCC__
 1172                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 159; #endif // _hucc_blkmap_h
 1173                        		.dbg	line,	"main.c", 7; #include "include/constants.c"
 1174                        		.dbg	line,	"include\constants.c", 1; //*****************************************************************************//
 1175                        		.dbg	line,	"include\constants.c", 2; //                                                                             //
 1176                        		.dbg	line,	"include\constants.c", 3; //                                SYSTEM CONSTANTS                             //
 1177                        		.dbg	line,	"include\constants.c", 4; //                                                                             //
 1178                        		.dbg	line,	"include\constants.c", 5; //*****************************************************************************//
 1179                        		.dbg	line,	"include\constants.c", 7; #define FALSE 0
 1180                        		.dbg	line,	"include\constants.c", 8; #define TRUE  1
 1181                        		.dbg	line,	"include\constants.c", 10; #define YES   1
 1182                        		.dbg	line,	"include\constants.c", 11; #define NO    2
 1183                        		.dbg	line,	"include\constants.c", 13; #define JOYPAD_1 0
 1184                        		.dbg	line,	"include\constants.c", 14; #define JOYPAD_2 1
 1185                        		.dbg	line,	"include\constants.c", 16; #define BAT_SIZE_W 2048 // IN PIXELS
 1186                        		.dbg	line,	"include\constants.c", 17; #define BAT_SIZE_H 256  // IN PIXELS
 1187                        		.dbg	line,	"include\constants.c", 19; #define NUMBERS_FONT_VRAM_ADR   0x0900
 1188                        		.dbg	line,	"include\constants.c", 21; #define JOY_DIR_PRESSED (JOY_DOWN | JOY_UP | JOY_RIGHT | JOY_LEFT)
 1189                        		.dbg	line,	"include\constants.c", 24; #define TILES_1   16
 1190                        		.dbg	line,	"include\constants.c", 25; #define TILES_2   32
 1191                        		.dbg	line,	"include\constants.c", 26; #define TILES_3   48
 1192                        		.dbg	line,	"include\constants.c", 27; #define TILES_4   64
 1193                        		.dbg	line,	"include\constants.c", 28; #define TILES_8   128
 1194                        		.dbg	line,	"include\constants.c", 29; #define TILES_16  256
 1195                        		.dbg	line,	"include\constants.c", 30; #define TILES_32  512
 1196                        		.dbg	line,	"include\constants.c", 31; #define TILES_48  768
 1197                        		.dbg	line,	"include\constants.c", 32; #define TILES_64  1024
 1198                        		.dbg	line,	"include\constants.c", 33; #define TILES_80  1280
 1199                        		.dbg	line,	"include\constants.c", 34; #define TILES_96  1536
 1200                        		.dbg	line,	"include\constants.c", 37; #define OFFSET_PLAYER_WALK_1            512
 1201                        		.dbg	line,	"include\constants.c", 38; #define OFFSET_PLAYER_WALK_2            1024
 1202                        		.dbg	line,	"include\constants.c", 39; #define OFFSET_PLAYER_WALK_3            1536
 1203                        		.dbg	line,	"include\constants.c", 40; #define OFFSET_PLAYER_WALK_4            2048
 1204                        		.dbg	line,	"include\constants.c", 41; #define OFFSET_PLAYER_WALK_5            2560
 1205                        		.dbg	line,	"include\constants.c", 42; #define OFFSET_PLAYER_WALK_6            3072
 1206                        		.dbg	line,	"include\constants.c", 44; #define OFFSET_PLAYER_JUMP              3584
 1207                        		.dbg	line,	"include\constants.c", 45; #define OFFSET_PLAYER_CROUCH            4096
 1208                        		.dbg	line,	"include\constants.c", 46; #define OFFSET_PLAYER_HANG              4608
 1209                        		.dbg	line,	"include\constants.c", 48; #define OFFSET_PLAYER_CLIMB_1           5120
 1210                        		.dbg	line,	"include\constants.c", 49; #define OFFSET_PLAYER_CLIMB_2           5632
 1211                        		.dbg	line,	"include\constants.c", 50; #define OFFSET_PLAYER_CLIMB_3           6144
 1212                        		.dbg	line,	"include\constants.c", 51; #define OFFSET_PLAYER_CLIMB_4           6656
 1213                        		.dbg	line,	"include\constants.c", 53; #define OFFSET_PLAYER_FALL              7680
 1214                        		.dbg	line,	"include\constants.c", 55; #define OFFSET_PLAYER_ATTACK_1          8192
 1215                        		.dbg	line,	"include\constants.c", 56; #define OFFSET_PLAYER_ATTACK_2          8704
 1216                        		.dbg	line,	"include\constants.c", 58; #define OFFSET_PLAYER_ATTACK_CROUCH_1   9216
 1217                        		.dbg	line,	"include\constants.c", 59; #define OFFSET_PLAYER_ATTACK_CROUCH_2   9728
 1218                        		.dbg	line,	"include\constants.c", 66; #define SEQUENCE_TITLE      0
 1219                        		.dbg	line,	"include\constants.c", 67; #define SEQUENCE_INTRO      1
 1220                        		.dbg	line,	"include\constants.c", 68; #define SEQUENCE_GAME       2
 1221                        		.dbg	line,	"include\constants.c", 69; #define SEQUENCE_NPC        3
 1222                        		.dbg	line,	"include\constants.c", 70; #define SEQUENCE_SHOP       4
 1223                        		.dbg	line,	"include\constants.c", 73; #define CAMERA_RECENTER_VELOCITY    4
 1224                        		.dbg	line,	"include\constants.c", 78; //-----------------------------------------------------------------------------//
 1225                        		.dbg	line,	"include\constants.c", 79; //                                                                             //
 1226                        		.dbg	line,	"include\constants.c", 80; //                                   PLAYER                                    //
 1227                        		.dbg	line,	"include\constants.c", 81; //                                                                             //
 1228                        		.dbg	line,	"include\constants.c", 82; //-----------------------------------------------------------------------------//
 1229                        		.dbg	line,	"include\constants.c", 84; #define AXIS_RIGHT          0
 1230                        		.dbg	line,	"include\constants.c", 85; #define AXIS_LEFT           1
 1231                        		.dbg	line,	"include\constants.c", 86; #define AXIS_UP             2
 1232                        		.dbg	line,	"include\constants.c", 87; #define AXIS_DOWN           3
 1233                        		.dbg	line,	"include\constants.c", 91; #define STATE_IDLE          0
 1234                        		.dbg	line,	"include\constants.c", 92; #define STATE_WALK          1
 1235                        		.dbg	line,	"include\constants.c", 93; #define STATE_ATTACK        2
 1236                        		.dbg	line,	"include\constants.c", 94; #define STATE_JUMP          4
 1237                        		.dbg	line,	"include\constants.c", 95; #define STATE_JUMP_RIGHT    5
 1238                        		.dbg	line,	"include\constants.c", 96; #define STATE_JUMP_LEFT     6
 1239                        		.dbg	line,	"include\constants.c", 97; #define STATE_CROUCH        7
 1240                        		.dbg	line,	"include\constants.c", 98; #define STATE_CROUCH_ATTACK 8
 1241                        		.dbg	line,	"include\constants.c", 99; #define STATE_FALL          9
 1242                        		.dbg	line,	"include\constants.c", 100; #define STATE_HANG          10
 1243                        		.dbg	line,	"include\constants.c", 101; #define STATE_CLIMB_UP      11
 1244                        		.dbg	line,	"include\constants.c", 102; #define STATE_CLIMB_DOWN    12
 1245                        		.dbg	line,	"include\constants.c", 103; #define STATE_JUMP_LADDER   13
 1246                        		.dbg	line,	"include\constants.c", 107; #define PLAYER_VRAM_ADR     0x1800
 1247                        		.dbg	line,	"include\constants.c", 109; #define PLAYER_BASE_Y_POS   128
 1248                        		.dbg	line,	"include\constants.c", 112; #define RESPAWN_DEAD        1
 1249                        		.dbg	line,	"include\constants.c", 113; #define RESPAWN_SHOP        2
 1250                        		.dbg	line,	"include\constants.c", 118; //-----------------------------------------------------------------------------//
 1251                        		.dbg	line,	"include\constants.c", 119; //                                                                             //
 1252                        		.dbg	line,	"include\constants.c", 120; //                                  COLLISIONS                                 //
 1253                        		.dbg	line,	"include\constants.c", 121; //                                                                             //
 1254                        		.dbg	line,	"include\constants.c", 122; //-----------------------------------------------------------------------------//
 1255                        		.dbg	line,	"include\constants.c", 124; #define TILE_EMPTY          0
 1256                        		.dbg	line,	"include\constants.c", 125; #define TILE_BG             1
 1257                        		.dbg	line,	"include\constants.c", 126; #define TILE_LADDER         2
 1258                        		.dbg	line,	"include\constants.c", 131; //-----------------------------------------------------------------------------//
 1259                        		.dbg	line,	"include\constants.c", 132; //                                                                             //
 1260                        		.dbg	line,	"include\constants.c", 133; //                                     HUD                                     //
 1261                        		.dbg	line,	"include\constants.c", 134; //                                                                             //
 1262                        		.dbg	line,	"include\constants.c", 135; //-----------------------------------------------------------------------------//
 1263                        		.dbg	line,	"include\constants.c", 137; #define LIFEBAR_1_VRAM_ADR      0x1000
 1264                        		.dbg	line,	"include\constants.c", 138; #define LIFEBAR_2_VRAM_ADR      LIFEBAR_1_VRAM_ADR+TILES_2
 1265                        		.dbg	line,	"include\constants.c", 139; #define LIFEBAR_3_VRAM_ADR      LIFEBAR_2_VRAM_ADR+TILES_2
 1266                        		.dbg	line,	"include\constants.c", 140; #define LIFEBAR_4_VRAM_ADR      LIFEBAR_3_VRAM_ADR+TILES_2
 1267                        		.dbg	line,	"include\constants.c", 141; #define LIFEBAR_5_VRAM_ADR      LIFEBAR_4_VRAM_ADR+TILES_2
 1268                        		.dbg	line,	"include\constants.c", 143; #define WEAPON_VRAM_ADR         LIFEBAR_5_VRAM_ADR+TILES_2
 1269                        		.dbg	line,	"include\constants.c", 144; #define ARMOR_VRAM_ADR          WEAPON_VRAM_ADR+TILES_4
 1270                        		.dbg	line,	"include\constants.c", 149; //-----------------------------------------------------------------------------//
 1271                        		.dbg	line,	"include\constants.c", 150; //                                                                             //
 1272                        		.dbg	line,	"include\constants.c", 151; //                                    LEVELS                                   //
 1273                        		.dbg	line,	"include\constants.c", 152; //                                                                             //
 1274                        		.dbg	line,	"include\constants.c", 153; //-----------------------------------------------------------------------------//
 1275                        		.dbg	line,	"include\constants.c", 155; #define LV1_WALL_VRAM_ADR       0x1000
 1276                        		.dbg	line,	"include\constants.c", 156; #define LV1_DOOR_VRAM_ADR       LV1_WALL_VRAM_ADR+256
 1277                        		.dbg	line,	"include\constants.c", 159; #define OBJECT_NUMBER_LV1       23
 1278                        		.dbg	line,	"include\constants.c", 160; #define CHEST_NUMBER_LV1        2
 1279                        		.dbg	line,	"include\constants.c", 161; #define NPC_NUMBER_LV1          2
 1280                        		.dbg	line,	"include\constants.c", 163; #define OBJECT_START_INDEX_LV1  3
 1281                        		.dbg	line,	"include\constants.c", 164; #define CHEST_START_INDEX_LV1   OBJECT_START_INDEX_LV1+OBJECT_NUMBER_LV1
 1282                        		.dbg	line,	"include\constants.c", 165; #define NPC_START_INDEX_LV1     CHEST_START_INDEX_LV1+CHEST_NUMBER_LV1
 1283                        		.dbg	line,	"include\constants.c", 170; //-----------------------------------------------------------------------------//
 1284                        		.dbg	line,	"include\constants.c", 171; //                                                                             //
 1285                        		.dbg	line,	"include\constants.c", 172; //                                   OBJECT                                    //
 1286                        		.dbg	line,	"include\constants.c", 173; //                                                                             //
 1287                        		.dbg	line,	"include\constants.c", 174; //-----------------------------------------------------------------------------//
 1288                        		.dbg	line,	"include\constants.c", 176; #define TYPE_HOURGLASS          0
 1289                        		.dbg	line,	"include\constants.c", 177; #define TYPE_POT                1
 1290                        		.dbg	line,	"include\constants.c", 178; #define TYPE_POW                2
 1291                        		.dbg	line,	"include\constants.c", 179; #define TYPE_CHEST              3
 1292                        		.dbg	line,	"include\constants.c", 180; #define TYPE_GRAY_KEY           4
 1293                        		.dbg	line,	"include\constants.c", 181; #define TYPE_GOLD_KEY           5
 1294                        		.dbg	line,	"include\constants.c", 182; #define TYPE_1UP                6
 1295                        		.dbg	line,	"include\constants.c", 183; #define TYPE_COIN_1             7
 1296                        		.dbg	line,	"include\constants.c", 184; #define TYPE_COIN_5             8
 1297                        		.dbg	line,	"include\constants.c", 185; #define TYPE_COIN_10            9
 1298                        		.dbg	line,	"include\constants.c", 186; #define TYPE_COIN_50            10
 1299                        		.dbg	line,	"include\constants.c", 187; #define TYPE_COIN_100           11
 1300                        		.dbg	line,	"include\constants.c", 188; #define TYPE_COIN_500           12
 1301                        		.dbg	line,	"include\constants.c", 189; #define TYPE_COIN_1000          13
 1302                        		.dbg	line,	"include\constants.c", 190; #define TYPE_YASHICHI           14
 1303                        		.dbg	line,	"include\constants.c", 193; #define STATE_ACTIVE            0
 1304                        		.dbg	line,	"include\constants.c", 194; #define STATE_INACTIVE          1
 1305                        		.dbg	line,	"include\constants.c", 196; #define OBJECT_MARGIN           10//9
 1306                        		.dbg	line,	"include\constants.c", 199; #define POT1_VRAM_ADR           0x1C00
 1307                        		.dbg	line,	"include\constants.c", 200; #define POT2_VRAM_ADR           POT1_VRAM_ADR+TILES_4
 1308                        		.dbg	line,	"include\constants.c", 201; #define POT3_VRAM_ADR           POT2_VRAM_ADR+TILES_4
 1309                        		.dbg	line,	"include\constants.c", 202; #define POT4_VRAM_ADR           POT3_VRAM_ADR+TILES_4
 1310                        		.dbg	line,	"include\constants.c", 203; #define POT5_VRAM_ADR           POT4_VRAM_ADR+TILES_4
 1311                        		.dbg	line,	"include\constants.c", 204; #define POT6_VRAM_ADR           POT5_VRAM_ADR+TILES_4
 1312                        		.dbg	line,	"include\constants.c", 205; #define POT7_VRAM_ADR           POT6_VRAM_ADR+TILES_4
 1313                        		.dbg	line,	"include\constants.c", 206; #define POT8_VRAM_ADR           POT7_VRAM_ADR+TILES_4
 1314                        		.dbg	line,	"include\constants.c", 208; #define POW_VRAM_ADR            POT8_VRAM_ADR+TILES_4
 1315                        		.dbg	line,	"include\constants.c", 209; #define GRAY_KEY_VRAM_ADR       POW_VRAM_ADR+TILES_4
 1316                        		.dbg	line,	"include\constants.c", 210; #define GOLD_KEY_VRAM_ADR       GRAY_KEY_VRAM_ADR+TILES_4
 1317                        		.dbg	line,	"include\constants.c", 211; #define LIFE_VRAM_ADR           GOLD_KEY_VRAM_ADR+TILES_4
 1318                        		.dbg	line,	"include\constants.c", 213; #define COIN_1_VRAM_ADR         LIFE_VRAM_ADR+TILES_4
 1319                        		.dbg	line,	"include\constants.c", 214; #define COIN_5_VRAM_ADR         COIN_1_VRAM_ADR+TILES_4
 1320                        		.dbg	line,	"include\constants.c", 215; #define COIN_10_VRAM_ADR        COIN_5_VRAM_ADR+TILES_4
 1321                        		.dbg	line,	"include\constants.c", 216; #define COIN_50_VRAM_ADR        COIN_10_VRAM_ADR+TILES_4
 1322                        		.dbg	line,	"include\constants.c", 217; #define COIN_100_VRAM_ADR       COIN_50_VRAM_ADR+TILES_4
 1323                        		.dbg	line,	"include\constants.c", 218; #define COIN_500_VRAM_ADR       COIN_100_VRAM_ADR+TILES_4
 1324                        		.dbg	line,	"include\constants.c", 219; #define COIN_1000_VRAM_ADR      COIN_500_VRAM_ADR+TILES_4
 1325                        		.dbg	line,	"include\constants.c", 221; #define STAR_VRAM_ADR           COIN_1000_VRAM_ADR+TILES_4
 1326                        		.dbg	line,	"include\constants.c", 222; #define OCTOPUS_VRAM_ADR        STAR_VRAM_ADR+TILES_4
 1327                        		.dbg	line,	"include\constants.c", 223; #define FRUIT_VRAM_ADR          OCTOPUS_VRAM_ADR+TILES_4
 1328                        		.dbg	line,	"include\constants.c", 224; #define BARREL_VRAM_ADR         FRUIT_VRAM_ADR+TILES_4
 1329                        		.dbg	line,	"include\constants.c", 225; #define HOURGLASS_VRAM_ADR      BARREL_VRAM_ADR+TILES_4
 1330                        		.dbg	line,	"include\constants.c", 226; #define BAMBOO_VRAM_ADR         HOURGLASS_VRAM_ADR+TILES_4
 1331                        		.dbg	line,	"include\constants.c", 227; #define YASHICHI_VRAM_ADR       BAMBOO_VRAM_ADR+TILES_4
 1332                        		.dbg	line,	"include\constants.c", 228; #define ELEPHANT_VRAM_ADR       YASHICHI_VRAM_ADR+TILES_4
 1333                        		.dbg	line,	"include\constants.c", 229; #define DRAGONFLY_VRAM_ADR      ELEPHANT_VRAM_ADR+TILES_4
 1334                        		.dbg	line,	"include\constants.c", 230; #define COW_VRAM_ADR            DRAGONFLY_VRAM_ADR+TILES_4
 1335                        		.dbg	line,	"include\constants.c", 231; #define MOBICHAN_VRAM_ADR       COW_VRAM_ADR+TILES_4
 1336                        		.dbg	line,	"include\constants.c", 233; #define CHEST_VRAM_ADR          0x2400
 1337                        		.dbg	line,	"include\constants.c", 234; #define NPC_VRAM_ADR            CHEST_VRAM_ADR+TILES_96
 1338                        		.dbg	line,	"include\constants.c", 239; //-----------------------------------------------------------------------------//
 1339                        		.dbg	line,	"include\constants.c", 240; //                                                                             //
 1340                        		.dbg	line,	"include\constants.c", 241; //                                    NPC                                      //
 1341                        		.dbg	line,	"include\constants.c", 242; //                                                                             //
 1342                        		.dbg	line,	"include\constants.c", 243; //-----------------------------------------------------------------------------//
 1343                        		.dbg	line,	"include\constants.c", 245; #define TYPE_NPC_REWARD         0
 1344                        		.dbg	line,	"include\constants.c", 246; #define TYPE_NPC_SHOP           1
 1345                        		.dbg	line,	"include\constants.c", 251; //-----------------------------------------------------------------------------//
 1346                        		.dbg	line,	"include\constants.c", 252; //                                                                             //
 1347                        		.dbg	line,	"include\constants.c", 253; //                                    SHOP                                     //
 1348                        		.dbg	line,	"include\constants.c", 254; //                                                                             //
 1349                        		.dbg	line,	"include\constants.c", 255; //-----------------------------------------------------------------------------//
 1350                        		.dbg	line,	"include\constants.c", 257; #define SHOP_PHASE_ENTER        0
 1351                        		.dbg	line,	"include\constants.c", 258; #define SHOP_PHASE_BUY          1
 1352                        		.dbg	line,	"include\constants.c", 259; #define SHOP_PHASE_EXIT         2
 1353                        		.dbg	line,	"include\constants.c", 261; #define TYPE_ITEM_WEAPON_2      0
 1354                        		.dbg	line,	"include\constants.c", 262; #define TYPE_ITEM_WEAPON_3      1
 1355                        		.dbg	line,	"include\constants.c", 263; #define TYPE_ITEM_WEAPON_4      2
 1356                        		.dbg	line,	"include\constants.c", 264; #define TYPE_ITEM_WEAPON_5      3
 1357                        		.dbg	line,	"include\constants.c", 265; #define TYPE_ITEM_KEY           4
 1358                        		.dbg	line,	"include\constants.c", 267; #define TYPE_ITEM_ARMOR_2       5
 1359                        		.dbg	line,	"include\constants.c", 268; #define TYPE_ITEM_ARMOR_3       6
 1360                        		.dbg	line,	"include\constants.c", 269; #define TYPE_ITEM_ARMOR_4       7
 1361                        		.dbg	line,	"include\constants.c", 270; #define TYPE_ITEM_ARMOR_5       8
 1362                        		.dbg	line,	"include\constants.c", 271; #define TYPE_ITEM_POTION        9
 1363                        		.dbg	line,	"main.c", 8; #include "include/variables.c"
 1364                        		.dbg	line,	"include\variables.c", 1; #include "huc.h"
 1365                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 1; #ifndef _hucc_legacy_h
 1366                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 2; #define _hucc_legacy_h
 1367                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 4; /****************************************************************************
 1368                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 5; ; ***************************************************************************
 1369                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 6; ;
 1370                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 7; ; huc.h
 1371                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 8; ;
 1372                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 9; ; HuCC wrapper file to include a default set of HuC-compatible functions.
 1373                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 10; ;
 1374                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 11; ; Copyright John Brandwood 2024.
 1375                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 12; ;
 1376                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 1377                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 1378                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 1379                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 16; ;
 1380                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 17; ; ***************************************************************************
 1381                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 18; ; ***************************************************************************
 1382                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 19; ;
 1383                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 20; ; When the HuCC compiler is invoked with the "--legacy" option to compile old
 1384                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 21; ; projects, then this "huc.h" file is automatically included.
 1385                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 22; ;
 1386                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 23; ; This file includes a set of the individual HuCC headers which correspond to
 1387                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 24; ; HuC's built-in functions and MagicKit library.
 1388                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 25; ;
 1389                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 26; ; New HuCC projects should, preferably, include the specific headers that are
 1390                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 27; ; needed, which will then allow them to replace parts of the standard library
 1391                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 28; ; with newer functions, or they can just manually include this "huc.h" file.
 1392                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 29; ;
 1393                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 30; ; ***************************************************************************
 1394                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 31; ; **************************************************************************/
 1395                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 33; #include "hucc-systemcard.h"
 1396                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 34; #include "hucc-baselib.h"
 1397                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 35; #include "hucc-gfx.h"
 1398                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 36; #include "hucc-string.h"
 1399                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 37; #include "hucc-old-scroll.h"
 1400                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 38; #include "hucc-old-spr.h"
 1401                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 39; #include "hucc-old-map.h"
 1402                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 40; #include "hucc-old-line.h"
 1403                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 42; #endif // _hucc_legacy_h
 1404                        		.dbg	line,	"include\variables.c", 2; #include "hucc-scroll.h"
 1405                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 1; #ifndef _hucc_scroll_h
 1406                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 2; #define _hucc_scroll_h
 1407                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 4; /****************************************************************************
 1408                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 5; ; ***************************************************************************
 1409                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 6; ;
 1410                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 7; ; hucc-scroll.h
 1411                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 8; ;
 1412                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 9; ; Routines for a fast split-screen scrolling system.
 1413                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 10; ;
 1414                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 11; ; Copyright John Brandwood 2024.
 1415                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 12; ;
 1416                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 1417                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 1418                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 1419                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 16; ;
 1420                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 17; ; ***************************************************************************
 1421                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 18; ; ***************************************************************************
 1422                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 19; ;
 1423                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 20; ; The maximum number of splits for each screen layer is set in your project's
 1424                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 21; ; "hucc-config.inc" file, with the library having a limit of 128-per-layer.
 1425                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 22; ;
 1426                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 23; ; Your first active split must be defined to start at screen line 0, and then
 1427                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 24; ; the rest of the active splits must be in increasing line order to match the
 1428                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 25; ; way that the PC Engine displays the output image.
 1429                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 26; ;
 1430                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 27; ; You can have disabled splits interleaved with your active splits.
 1431                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 28; ;
 1432                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 29; ; Splits that are normally disabled can be used to create full screen effects
 1433                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 30; ; such as bouncing the screen up and down by adding blank areas at the top or
 1434                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 31; ; bottom of the screen, and then rapidly changing the height of those areas.
 1435                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 32; ;
 1436                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 33; ; ***************************************************************************
 1437                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 34; ; **************************************************************************/
 1438                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 36; // *************
 1439                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 37; // VDC bits for display_flags ...
 1440                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 38; // *************
 1441                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 40; #ifndef BKG_OFF
 1442                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 41; #define BKG_OFF 0x00
 1443                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 42; #endif
 1444                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 44; #ifndef SPR_OFF
 1445                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 45; #define SPR_OFF 0x00
 1446                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 46; #endif
 1447                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 48; #ifndef BKG_ON
 1448                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 49; #define BKG_ON 0x80
 1449                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 50; #endif
 1450                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 52; #ifndef SPR_ON
 1451                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 53; #define SPR_ON 0x40
 1452                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 54; #endif
 1453                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 56; // *************
 1454                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 57; // Functions in hucc-scroll.asm ...
 1455                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 58; // *************
 1456                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 60; #ifdef __HUCC__
 1457                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 62; #asmdef	HUCC_USES_NEW_SCROLL 1
 1458                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 64; extern void __fastcall scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
 1459                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 65; extern void __fastcall sgx_scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
 1460                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 67; extern void __fastcall disable_split( unsigned char index<acc> );
 1461                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 68; extern void __fastcall sgx_disable_split( unsigned char index<acc> );
 1462                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 70; extern void __fastcall __macro disable_all_splits( void );
 1463                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 71; extern void __fastcall __macro sgx_disable_all_splits( void );
 1464                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 73; #asm
 1465                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 74; .macro	_disable_all_splits
 1466                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 75; ldy	#HUCC_PCE_SPLITS - 1
 1467                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 76; !loop:		tya
 1468                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 77; call	_disable_split.1
 1469                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 78; dey
 1470                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 79; bpl	!loop-
 1471                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 80; .endm
 1472                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 82; .macro	_sgx_disable_all_splits
 1473                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 83; ldy	#HUCC_SGX_SPLITS - 1
 1474                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 84; !loop:		tya
 1475                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 85; call	_sgx_disable_split.1
 1476                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 86; dey
 1477                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 87; bpl	!loop-
 1478                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 88; .endm
 1479                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 89; #endasm
 1480                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 91; #endif // __HUCC__
 1481                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 93; #endif // _hucc_scroll_h
 1482                        		.dbg	line,	"include\variables.c", 3; #include "hucc-chrmap.h"
 1483                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 1; #ifndef _hucc_chrmap_h
 1484                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 2; #define _hucc_chrmap_h
 1485                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 4; /****************************************************************************
 1486                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 5; ; ***************************************************************************
 1487                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 6; ;
 1488                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 7; ; hucc-chrmap.h
 1489                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 8; ;
 1490                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 9; ; A simple map system based on 8x8 characters (aka "tiles") in BAT format.
 1491                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 10; ;
 1492                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 11; ; Copyright John Brandwood 2025.
 1493                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 12; ;
 1494                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 1495                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 1496                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 1497                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 16; ;
 1498                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 17; ; ***************************************************************************
 1499                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 18; ; ***************************************************************************
 1500                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 19; ;
 1501                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 20; ; The maximum X and Y size for chrmaps is 256 characters (2048 pixels).
 1502                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 21; ;
 1503                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 22; ; The maximum total size for a chrmap is 16KBytes, which allows for maps up
 1504                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 23; ; to 256x32 tiles (2048x256 pixels).
 1505                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 24; ;
 1506                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 25; ; ***************************************************************************
 1507                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 26; ; **************************************************************************/
 1508                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 28; // *************
 1509                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 29; // This code extends the blkmap library ...
 1510                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 30; // *************
 1511                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 32; #include "hucc-blkmap.h"
 1512                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 34; // *************
 1513                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 35; // Functions in chrmap.asm ...
 1514                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 36; // *************
 1515                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 38; #ifdef __HUCC__
 1516                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 40; #asmdef	HUCC_USES_CHRMAP 1
 1517                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 42; extern void __fastcall __nop set_chrmap( unsigned char __far *chrmap<vdc_map_bank:vdc_map_addr>, unsigned char tiles_w<vdc_map_line_w> );
 1518                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 44; extern void __fastcall draw_bat( void );
 1519                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 45; extern void __fastcall scroll_bat( void );
 1520                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 47; extern void __fastcall blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1521                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 49; #ifdef _SGX
 1522                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 51; extern void __fastcall __nop sgx_set_chrmap( unsigned char __far *chrmap<sgx_map_bank:sgx_map_addr>, unsigned char tiles_w<sgx_map_line_w> );
 1523                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 53; extern void __fastcall sgx_draw_bat( void );
 1524                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 54; extern void __fastcall sgx_scroll_bat( void );
 1525                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 56; extern void __fastcall sgx_blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1526                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 58; #endif
 1527                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 60; #endif // __HUCC__
 1528                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 62; #endif // _hucc_chrmap_h
 1529                        		.dbg	line,	"include\variables.c", 4; #include "hucc-blkmap.h"
 1530                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 1; #ifndef _hucc_blkmap_h
 1531                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 2; #define _hucc_blkmap_h
 1532                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 4; /****************************************************************************
 1533                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 5; ; ***************************************************************************
 1534                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 6; ;
 1535                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 7; ; hucc-blkmap.h
 1536                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 8; ;
 1537                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 9; ; A map system based on 16x16 meta-tiles (aka "blocks", aka CHR/BLK/MAP).
 1538                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 10; ;
 1539                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 11; ; Copyright John Brandwood 2025.
 1540                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 12; ;
 1541                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 1542                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 1543                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 1544                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 16; ;
 1545                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 17; ; ***************************************************************************
 1546                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 18; ; ***************************************************************************
 1547                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 19; ;
 1548                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 20; ; The maximum X and Y size for blkmaps is 128 blocks (2048 pixels).
 1549                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 21; ;
 1550                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 22; ; The maximum total size for a blkmap is 16KBytes, which allows for maps up
 1551                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 23; ; to 128x128 blocks (2048x2048 pixels).
 1552                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 24; ;
 1553                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 25; ; Huge multi-screen blkmaps are also supported (optionally).
 1554                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 26; ;
 1555                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 27; ; The maximum X and Y for multi-screen maps is 128 screens (32768 pixels).
 1556                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 28; ;
 1557                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 29; ; The maximum total size for a multi-screen map is 8KBytes, which allows for
 1558                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 30; ; a total of 1024 screens.
 1559                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 31; ;
 1560                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 32; ; ***************************************************************************
 1561                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 33; ; **************************************************************************/
 1562                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 35; // *************
 1563                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 36; // Functions in blkmap.asm ...
 1564                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 37; // *************
 1565                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 39; #ifdef __HUCC__
 1566                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 41; #asmdef	HUCC_USES_BLKMAP 1
 1567                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 43; // Current top-left of drawn map in pixels.
 1568                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 44; extern unsigned int   vdc_map_pxl_x;
 1569                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 45; extern unsigned int   vdc_map_pxl_y;
 1570                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 47; // Width and height to draw/scroll in characters (not tiles).
 1571                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 48; extern unsigned char  vdc_map_draw_w;
 1572                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 49; extern unsigned char  vdc_map_draw_h;
 1573                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 51; // Width of map (or multi-screen BAT) in tiles.
 1574                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 52; extern unsigned char  vdc_map_line_w;
 1575                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 54; // Width of map in screens (if multi-screen map).
 1576                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 55; extern unsigned char  vdc_map_scrn_w;
 1577                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 57; // Extra information returned by get_map_block() and sgx_get_map_block(),
 1578                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 58; // which are the collision flags and the mask/overlay sprite for the BLK.
 1579                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 59; extern unsigned char  map_blk_flag;
 1580                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 60; extern unsigned char  map_blk_mask;
 1581                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 62; extern unsigned char  vdc_scr_bank;
 1582                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 63; extern unsigned char *vdc_scr_addr;
 1583                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 65; extern unsigned char  vdc_map_bank;
 1584                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 66; extern unsigned char *vdc_map_addr;
 1585                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 68; extern unsigned char  vdc_blk_bank;
 1586                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 69; extern unsigned char *vdc_blk_addr;
 1587                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 71; extern unsigned char  vdc_tbl_bank;
 1588                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 72; extern unsigned char *vdc_tbl_addr;
 1589                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 74; extern void __fastcall set_blocks( unsigned char __far *blk_def<vdc_blk_bank:vdc_blk_addr>, unsigned char __far *flg_def<vdc_tbl_bank:vdc_tbl_addr>, unsigned char number_of_blocks<_al> );
 1590                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 75; extern void __fastcall __macro set_blkmap( unsigned char __far *blk_map<vdc_map_bank:vdc_map_addr>, unsigned char blocks_w<vdc_map_line_w> );
 1591                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 76; extern void __fastcall __macro set_multimap( unsigned char __far *multi_map<vdc_scr_bank:vdc_scr_addr>, unsigned char screens_w<vdc_map_scrn_w> );
 1592                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 78; extern void __fastcall draw_map( void );
 1593                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 79; extern void __fastcall scroll_map( void );
 1594                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 81; extern void __fastcall blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1595                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 83; extern unsigned char __fastcall get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
 1596                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 85; #asm
 1597                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 86; .macro	_set_blkmap.2
 1598                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 87; stz	vdc_scr_bank
 1599                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 88; .endm
 1600                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 90; .macro	_set_multimap.2
 1601                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 91; lda	vdc_bat_width
 1602                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 92; lsr	a
 1603                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 93; sta	vdc_map_line_w
 1604                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 94; .endm
 1605                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 96; .macro	SCREEN
 1606                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 97; db	(((\1) & $1FFF) | $6000) >> 8, bank(\1)
 1607                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 98; db	(((\2) & $1FFF) | $4000) >> 8, bank(\2)
 1608                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 99; db	(((\3) & $1FFF) | $6000) >> 8, bank(\3)
 1609                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 100; dw	(\4)
 1610                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 101; .endm
 1611                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 102; #endasm
 1612                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 104; #ifdef _SGX
 1613                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 106; // Current top-left of drawn map in pixels.
 1614                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 107; extern unsigned int   sgx_map_pxl_x;
 1615                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 108; extern unsigned int   sgx_map_pxl_y;
 1616                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 110; // Width and height to draw/scroll in characters (not tiles).
 1617                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 111; extern unsigned char  sgx_map_draw_w;
 1618                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 112; extern unsigned char  sgx_map_draw_h;
 1619                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 114; // Width of map (or multi-screen BAT) in tiles.
 1620                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 115; extern unsigned char  sgx_map_line_w;
 1621                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 117; // Width of map in screens (if multi-screen map).
 1622                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 118; extern unsigned char  sgx_map_scrn_w;
 1623                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 120; extern unsigned char  sgx_scr_bank;
 1624                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 121; extern unsigned char *sgx_scr_addr;
 1625                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 123; extern unsigned char  sgx_map_bank;
 1626                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 124; extern unsigned char *sgx_map_addr;
 1627                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 126; extern unsigned char  sgx_blk_bank;
 1628                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 127; extern unsigned char *sgx_blk_addr;
 1629                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 129; extern unsigned char  sgx_tbl_bank;
 1630                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 130; extern unsigned char *sgx_tbl_addr;
 1631                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 132; extern void __fastcall sgx_set_blocks( unsigned char __far *blk_def<sgx_blk_bank:sgx_blk_addr>, unsigned char __far *flg_def<sgx_tbl_bank:sgx_tbl_addr>, unsigned char number_of_blocks<_al> );
 1632                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 133; extern void __fastcall __macro sgx_set_blkmap( unsigned char __far *blk_map<sgx_map_bank:sgx_map_addr>, unsigned char blocks_w<sgx_map_line_w> );
 1633                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 134; extern void __fastcall __macro sgx_set_multimap( unsigned char __far *multi_map<sgx_scr_bank:sgx_scr_addr>, unsigned char screens_w<sgx_map_scrn_w> );
 1634                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 136; extern void __fastcall sgx_draw_map( void );
 1635                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 137; extern void __fastcall sgx_scroll_map( void );
 1636                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 139; extern void __fastcall sgx_blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1637                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 141; extern unsigned char __fastcall sgx_get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
 1638                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 143; #asm
 1639                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 144; .macro	_sgx_set_blkmap.2
 1640                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 145; stz	sgx_scr_bank
 1641                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 146; .endm
 1642                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 148; .macro	_sgx_set_multimap.2
 1643                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 149; lda	sgx_bat_width
 1644                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 150; lsr	a
 1645                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 151; sta	sgx_map_line_w
 1646                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 152; .endm
 1647                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 153; #endasm
 1648                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 155; #endif
 1649                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 157; #endif // __HUCC__
 1650                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 159; #endif // _hucc_blkmap_h
 1651                        		.dbg	line,	"include\variables.c", 13; unsigned char   sequence_id,
 1652                        		.dbg	line,	"include\variables.c", 14; sequence_loaded,
 1653                        		.dbg	line,	"include\variables.c", 16; level_id,
 1654                        		.dbg	line,	"include\variables.c", 18; // PLAYER //
 1655                        		.dbg	line,	"include\variables.c", 19; respawn,
 1656                        		.dbg	line,	"include\variables.c", 20; player_id,
 1657                        		.dbg	line,	"include\variables.c", 21; player_state,
 1658                        		.dbg	line,	"include\variables.c", 22; player_axis,
 1659                        		.dbg	line,	"include\variables.c", 23; player_previous_axis,
 1660                        		.dbg	line,	"include\variables.c", 24; player_counter_anim,
 1661                        		.dbg	line,	"include\variables.c", 25; player_index_jump,
 1662                        		.dbg	line,	"include\variables.c", 26; player_index_fall,
 1663                        		.dbg	line,	"include\variables.c", 28; player_naked,
 1664                        		.dbg	line,	"include\variables.c", 29; player_attack,
 1665                        		.dbg	line,	"include\variables.c", 31; jump_ladder,
 1666                        		.dbg	line,	"include\variables.c", 32; jump_max_index,
 1667                        		.dbg	line,	"include\variables.c", 34; // ARMOR + WEAPON //
 1668                        		.dbg	line,	"include\variables.c", 35; armor_level,
 1669                        		.dbg	line,	"include\variables.c", 36; weapon_level,
 1670                        		.dbg	line,	"include\variables.c", 38; // HUD //
 1671                        		.dbg	line,	"include\variables.c", 39; life_amount,
 1672                        		.dbg	line,	"include\variables.c", 40; key_amount,
 1673                        		.dbg	line,	"include\variables.c", 41; potion_amount,
 1674                        		.dbg	line,	"include\variables.c", 43; // TIME //
 1675                        		.dbg	line,	"include\variables.c", 44; minutes,
 1676                        		.dbg	line,	"include\variables.c", 45; seconds,
 1677                        		.dbg	line,	"include\variables.c", 46; time_counter,
 1678                        		.dbg	line,	"include\variables.c", 48; minutes_backup,
 1679                        		.dbg	line,	"include\variables.c", 49; seconds_backup,
 1680                        		.dbg	line,	"include\variables.c", 52; // OBJECTS //
 1681                        		.dbg	line,	"include\variables.c", 53; object_start_index,
 1682                        		.dbg	line,	"include\variables.c", 54; level_object_number,
 1683                        		.dbg	line,	"include\variables.c", 55; onscreen_object_number,
 1684                        		.dbg	line,	"include\variables.c", 56; 
 1685                        		.dbg	line,	"include\variables.c", 57; list_object_type[25],
 1686                        		.dbg	line,	"include\variables.c", 58; list_object_state[25],
 1687                        		.dbg	line,	"include\variables.c", 59; list_object_energy[25],
 1688                        		.dbg	line,	"include\variables.c", 60; list_reward_type[25],
 1689                        		.dbg	line,	"include\variables.c", 61; 
 1690                        		.dbg	line,	"include\variables.c", 62; list_onscreen_object[8],
 1691                        		.dbg	line,	"include\variables.c", 63; 
 1692                        		.dbg	line,	"include\variables.c", 64; // CHESTS //
 1693                        		.dbg	line,	"include\variables.c", 65; chest_start_index,
 1694                        		.dbg	line,	"include\variables.c", 66; level_chest_number,
 1695                        		.dbg	line,	"include\variables.c", 67; onscreen_chest_number,
 1696                        		.dbg	line,	"include\variables.c", 68; 
 1697                        		.dbg	line,	"include\variables.c", 69; list_chest_state[8],
 1698                        		.dbg	line,	"include\variables.c", 70; list_onscreen_chest[8],
 1699                        		.dbg	line,	"include\variables.c", 72; // NPC //
 1700                        		.dbg	line,	"include\variables.c", 73; npc_start_index,
 1701                        		.dbg	line,	"include\variables.c", 74; level_npc_number,
 1702                        		.dbg	line,	"include\variables.c", 75; onscreen_npc_number,
 1703                        		.dbg	line,	"include\variables.c", 77; list_npc_type[9],
 1704                        		.dbg	line,	"include\variables.c", 78; list_npc_state[9],
 1705                        		.dbg	line,	"include\variables.c", 79; list_onscreen_npc[9],
 1706                        		.dbg	line,	"include\variables.c", 81; // SHOPS //
 1707                        		.dbg	line,	"include\variables.c", 82; index_x,
 1708                        		.dbg	line,	"include\variables.c", 83; index_y,
 1709                        		.dbg	line,	"include\variables.c", 84; item_index,
 1710                        		.dbg	line,	"include\variables.c", 86; shop_phase,
 1711                        		.dbg	line,	"include\variables.c", 87; shop_counter,
 1712                        		.dbg	line,	"include\variables.c", 88; 
 1713                        		.dbg	line,	"include\variables.c", 89; tilemap_mask[256];
 1714                        		.dbg	line,	"include\variables.c", 94; signed int      player_pos_x,
 1715                        		.dbg	line,	"include\variables.c", 95; player_pos_y,
 1716                        		.dbg	line,	"include\variables.c", 96; camera_max_y_position,
 1717                        		.dbg	line,	"include\variables.c", 98; camera_pos_x_backup,
 1718                        		.dbg	line,	"include\variables.c", 99; camera_pos_y_backup,
 1719                        		.dbg	line,	"include\variables.c", 102; list_object_x_pos[25],
 1720                        		.dbg	line,	"include\variables.c", 103; list_object_y_pos[25],
 1721                        		.dbg	line,	"include\variables.c", 104; list_object_x_pos_ref[25],
 1722                        		.dbg	line,	"include\variables.c", 105; list_object_y_pos_ref[25],
 1723                        		.dbg	line,	"include\variables.c", 108; list_chest_x_pos[8],
 1724                        		.dbg	line,	"include\variables.c", 109; list_chest_y_pos[8],
 1725                        		.dbg	line,	"include\variables.c", 110; list_chest_x_pos_ref[8],
 1726                        		.dbg	line,	"include\variables.c", 111; list_chest_y_pos_ref[8],
 1727                        		.dbg	line,	"include\variables.c", 114; list_npc_x_pos[9],
 1728                        		.dbg	line,	"include\variables.c", 115; list_npc_y_pos[9],
 1729                        		.dbg	line,	"include\variables.c", 116; list_npc_x_pos_ref[9],
 1730                        		.dbg	line,	"include\variables.c", 117; list_npc_y_pos_ref[9];
 1731                        		.dbg	line,	"include\variables.c", 118; 
 1732                        		.dbg	line,	"include\variables.c", 122; int             zenny_amount,
 1733                        		.dbg	line,	"include\variables.c", 123; score,
 1734                        		.dbg	line,	"include\variables.c", 125; shop_prices[10];
 1735                        		.dbg	line,	"include\variables.c", 130; extern unsigned char tileset_LV1_BG_B[];
 1736                        		.dbg	line,	"include\variables.c", 131; extern unsigned char multimap_LV1_BG_B[];
 1737                        		.dbg	line,	"include\variables.c", 133; extern unsigned char tileset_HUD[];
 1738                        		.dbg	line,	"include\variables.c", 134; extern unsigned char multimap_LV1_BG_A[];
 1739                        		.dbg	line,	"include\variables.c", 136; extern unsigned char tileset_SHOP_BG_B[];
 1740                        		.dbg	line,	"include\variables.c", 139; int *ptr_SHOP_ITEM_PRICES;
 1741                        		.dbg	line,	"main.c", 11; #include "include/gfx_BG.c"
 1742                        		.dbg	line,	"include\gfx_BG.c", 1; #include "huc.h"
 1743                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 1; #ifndef _hucc_legacy_h
 1744                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 2; #define _hucc_legacy_h
 1745                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 4; /****************************************************************************
 1746                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 5; ; ***************************************************************************
 1747                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 6; ;
 1748                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 7; ; huc.h
 1749                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 8; ;
 1750                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 9; ; HuCC wrapper file to include a default set of HuC-compatible functions.
 1751                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 10; ;
 1752                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 11; ; Copyright John Brandwood 2024.
 1753                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 12; ;
 1754                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 1755                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 1756                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 1757                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 16; ;
 1758                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 17; ; ***************************************************************************
 1759                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 18; ; ***************************************************************************
 1760                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 19; ;
 1761                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 20; ; When the HuCC compiler is invoked with the "--legacy" option to compile old
 1762                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 21; ; projects, then this "huc.h" file is automatically included.
 1763                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 22; ;
 1764                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 23; ; This file includes a set of the individual HuCC headers which correspond to
 1765                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 24; ; HuC's built-in functions and MagicKit library.
 1766                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 25; ;
 1767                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 26; ; New HuCC projects should, preferably, include the specific headers that are
 1768                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 27; ; needed, which will then allow them to replace parts of the standard library
 1769                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 28; ; with newer functions, or they can just manually include this "huc.h" file.
 1770                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 29; ;
 1771                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 30; ; ***************************************************************************
 1772                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 31; ; **************************************************************************/
 1773                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 33; #include "hucc-systemcard.h"
 1774                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 34; #include "hucc-baselib.h"
 1775                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 35; #include "hucc-gfx.h"
 1776                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 36; #include "hucc-string.h"
 1777                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 37; #include "hucc-old-scroll.h"
 1778                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 38; #include "hucc-old-spr.h"
 1779                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 39; #include "hucc-old-map.h"
 1780                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 40; #include "hucc-old-line.h"
 1781                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 42; #endif // _hucc_legacy_h
 1782                        		.dbg	line,	"include\gfx_BG.c", 2; #include "hucc-scroll.h"
 1783                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 1; #ifndef _hucc_scroll_h
 1784                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 2; #define _hucc_scroll_h
 1785                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 4; /****************************************************************************
 1786                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 5; ; ***************************************************************************
 1787                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 6; ;
 1788                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 7; ; hucc-scroll.h
 1789                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 8; ;
 1790                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 9; ; Routines for a fast split-screen scrolling system.
 1791                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 10; ;
 1792                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 11; ; Copyright John Brandwood 2024.
 1793                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 12; ;
 1794                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 1795                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 1796                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 1797                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 16; ;
 1798                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 17; ; ***************************************************************************
 1799                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 18; ; ***************************************************************************
 1800                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 19; ;
 1801                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 20; ; The maximum number of splits for each screen layer is set in your project's
 1802                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 21; ; "hucc-config.inc" file, with the library having a limit of 128-per-layer.
 1803                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 22; ;
 1804                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 23; ; Your first active split must be defined to start at screen line 0, and then
 1805                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 24; ; the rest of the active splits must be in increasing line order to match the
 1806                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 25; ; way that the PC Engine displays the output image.
 1807                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 26; ;
 1808                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 27; ; You can have disabled splits interleaved with your active splits.
 1809                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 28; ;
 1810                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 29; ; Splits that are normally disabled can be used to create full screen effects
 1811                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 30; ; such as bouncing the screen up and down by adding blank areas at the top or
 1812                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 31; ; bottom of the screen, and then rapidly changing the height of those areas.
 1813                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 32; ;
 1814                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 33; ; ***************************************************************************
 1815                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 34; ; **************************************************************************/
 1816                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 36; // *************
 1817                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 37; // VDC bits for display_flags ...
 1818                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 38; // *************
 1819                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 40; #ifndef BKG_OFF
 1820                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 41; #define BKG_OFF 0x00
 1821                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 42; #endif
 1822                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 44; #ifndef SPR_OFF
 1823                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 45; #define SPR_OFF 0x00
 1824                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 46; #endif
 1825                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 48; #ifndef BKG_ON
 1826                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 49; #define BKG_ON 0x80
 1827                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 50; #endif
 1828                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 52; #ifndef SPR_ON
 1829                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 53; #define SPR_ON 0x40
 1830                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 54; #endif
 1831                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 56; // *************
 1832                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 57; // Functions in hucc-scroll.asm ...
 1833                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 58; // *************
 1834                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 60; #ifdef __HUCC__
 1835                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 62; #asmdef	HUCC_USES_NEW_SCROLL 1
 1836                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 64; extern void __fastcall scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
 1837                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 65; extern void __fastcall sgx_scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
 1838                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 67; extern void __fastcall disable_split( unsigned char index<acc> );
 1839                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 68; extern void __fastcall sgx_disable_split( unsigned char index<acc> );
 1840                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 70; extern void __fastcall __macro disable_all_splits( void );
 1841                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 71; extern void __fastcall __macro sgx_disable_all_splits( void );
 1842                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 73; #asm
 1843                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 74; .macro	_disable_all_splits
 1844                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 75; ldy	#HUCC_PCE_SPLITS - 1
 1845                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 76; !loop:		tya
 1846                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 77; call	_disable_split.1
 1847                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 78; dey
 1848                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 79; bpl	!loop-
 1849                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 80; .endm
 1850                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 82; .macro	_sgx_disable_all_splits
 1851                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 83; ldy	#HUCC_SGX_SPLITS - 1
 1852                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 84; !loop:		tya
 1853                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 85; call	_sgx_disable_split.1
 1854                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 86; dey
 1855                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 87; bpl	!loop-
 1856                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 88; .endm
 1857                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 89; #endasm
 1858                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 91; #endif // __HUCC__
 1859                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 93; #endif // _hucc_scroll_h
 1860                        		.dbg	line,	"include\gfx_BG.c", 3; #include "hucc-chrmap.h"
 1861                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 1; #ifndef _hucc_chrmap_h
 1862                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 2; #define _hucc_chrmap_h
 1863                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 4; /****************************************************************************
 1864                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 5; ; ***************************************************************************
 1865                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 6; ;
 1866                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 7; ; hucc-chrmap.h
 1867                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 8; ;
 1868                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 9; ; A simple map system based on 8x8 characters (aka "tiles") in BAT format.
 1869                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 10; ;
 1870                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 11; ; Copyright John Brandwood 2025.
 1871                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 12; ;
 1872                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 1873                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 1874                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 1875                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 16; ;
 1876                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 17; ; ***************************************************************************
 1877                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 18; ; ***************************************************************************
 1878                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 19; ;
 1879                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 20; ; The maximum X and Y size for chrmaps is 256 characters (2048 pixels).
 1880                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 21; ;
 1881                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 22; ; The maximum total size for a chrmap is 16KBytes, which allows for maps up
 1882                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 23; ; to 256x32 tiles (2048x256 pixels).
 1883                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 24; ;
 1884                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 25; ; ***************************************************************************
 1885                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 26; ; **************************************************************************/
 1886                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 28; // *************
 1887                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 29; // This code extends the blkmap library ...
 1888                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 30; // *************
 1889                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 32; #include "hucc-blkmap.h"
 1890                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 34; // *************
 1891                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 35; // Functions in chrmap.asm ...
 1892                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 36; // *************
 1893                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 38; #ifdef __HUCC__
 1894                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 40; #asmdef	HUCC_USES_CHRMAP 1
 1895                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 42; extern void __fastcall __nop set_chrmap( unsigned char __far *chrmap<vdc_map_bank:vdc_map_addr>, unsigned char tiles_w<vdc_map_line_w> );
 1896                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 44; extern void __fastcall draw_bat( void );
 1897                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 45; extern void __fastcall scroll_bat( void );
 1898                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 47; extern void __fastcall blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1899                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 49; #ifdef _SGX
 1900                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 51; extern void __fastcall __nop sgx_set_chrmap( unsigned char __far *chrmap<sgx_map_bank:sgx_map_addr>, unsigned char tiles_w<sgx_map_line_w> );
 1901                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 53; extern void __fastcall sgx_draw_bat( void );
 1902                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 54; extern void __fastcall sgx_scroll_bat( void );
 1903                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 56; extern void __fastcall sgx_blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1904                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 58; #endif
 1905                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 60; #endif // __HUCC__
 1906                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 62; #endif // _hucc_chrmap_h
 1907                        		.dbg	line,	"include\gfx_BG.c", 4; #include "hucc-blkmap.h"
 1908                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 1; #ifndef _hucc_blkmap_h
 1909                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 2; #define _hucc_blkmap_h
 1910                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 4; /****************************************************************************
 1911                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 5; ; ***************************************************************************
 1912                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 6; ;
 1913                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 7; ; hucc-blkmap.h
 1914                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 8; ;
 1915                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 9; ; A map system based on 16x16 meta-tiles (aka "blocks", aka CHR/BLK/MAP).
 1916                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 10; ;
 1917                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 11; ; Copyright John Brandwood 2025.
 1918                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 12; ;
 1919                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 1920                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 1921                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 1922                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 16; ;
 1923                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 17; ; ***************************************************************************
 1924                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 18; ; ***************************************************************************
 1925                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 19; ;
 1926                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 20; ; The maximum X and Y size for blkmaps is 128 blocks (2048 pixels).
 1927                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 21; ;
 1928                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 22; ; The maximum total size for a blkmap is 16KBytes, which allows for maps up
 1929                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 23; ; to 128x128 blocks (2048x2048 pixels).
 1930                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 24; ;
 1931                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 25; ; Huge multi-screen blkmaps are also supported (optionally).
 1932                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 26; ;
 1933                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 27; ; The maximum X and Y for multi-screen maps is 128 screens (32768 pixels).
 1934                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 28; ;
 1935                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 29; ; The maximum total size for a multi-screen map is 8KBytes, which allows for
 1936                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 30; ; a total of 1024 screens.
 1937                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 31; ;
 1938                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 32; ; ***************************************************************************
 1939                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 33; ; **************************************************************************/
 1940                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 35; // *************
 1941                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 36; // Functions in blkmap.asm ...
 1942                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 37; // *************
 1943                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 39; #ifdef __HUCC__
 1944                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 41; #asmdef	HUCC_USES_BLKMAP 1
 1945                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 43; // Current top-left of drawn map in pixels.
 1946                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 44; extern unsigned int   vdc_map_pxl_x;
 1947                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 45; extern unsigned int   vdc_map_pxl_y;
 1948                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 47; // Width and height to draw/scroll in characters (not tiles).
 1949                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 48; extern unsigned char  vdc_map_draw_w;
 1950                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 49; extern unsigned char  vdc_map_draw_h;
 1951                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 51; // Width of map (or multi-screen BAT) in tiles.
 1952                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 52; extern unsigned char  vdc_map_line_w;
 1953                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 54; // Width of map in screens (if multi-screen map).
 1954                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 55; extern unsigned char  vdc_map_scrn_w;
 1955                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 57; // Extra information returned by get_map_block() and sgx_get_map_block(),
 1956                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 58; // which are the collision flags and the mask/overlay sprite for the BLK.
 1957                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 59; extern unsigned char  map_blk_flag;
 1958                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 60; extern unsigned char  map_blk_mask;
 1959                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 62; extern unsigned char  vdc_scr_bank;
 1960                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 63; extern unsigned char *vdc_scr_addr;
 1961                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 65; extern unsigned char  vdc_map_bank;
 1962                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 66; extern unsigned char *vdc_map_addr;
 1963                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 68; extern unsigned char  vdc_blk_bank;
 1964                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 69; extern unsigned char *vdc_blk_addr;
 1965                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 71; extern unsigned char  vdc_tbl_bank;
 1966                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 72; extern unsigned char *vdc_tbl_addr;
 1967                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 74; extern void __fastcall set_blocks( unsigned char __far *blk_def<vdc_blk_bank:vdc_blk_addr>, unsigned char __far *flg_def<vdc_tbl_bank:vdc_tbl_addr>, unsigned char number_of_blocks<_al> );
 1968                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 75; extern void __fastcall __macro set_blkmap( unsigned char __far *blk_map<vdc_map_bank:vdc_map_addr>, unsigned char blocks_w<vdc_map_line_w> );
 1969                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 76; extern void __fastcall __macro set_multimap( unsigned char __far *multi_map<vdc_scr_bank:vdc_scr_addr>, unsigned char screens_w<vdc_map_scrn_w> );
 1970                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 78; extern void __fastcall draw_map( void );
 1971                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 79; extern void __fastcall scroll_map( void );
 1972                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 81; extern void __fastcall blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 1973                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 83; extern unsigned char __fastcall get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
 1974                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 85; #asm
 1975                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 86; .macro	_set_blkmap.2
 1976                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 87; stz	vdc_scr_bank
 1977                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 88; .endm
 1978                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 90; .macro	_set_multimap.2
 1979                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 91; lda	vdc_bat_width
 1980                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 92; lsr	a
 1981                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 93; sta	vdc_map_line_w
 1982                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 94; .endm
 1983                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 96; .macro	SCREEN
 1984                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 97; db	(((\1) & $1FFF) | $6000) >> 8, bank(\1)
 1985                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 98; db	(((\2) & $1FFF) | $4000) >> 8, bank(\2)
 1986                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 99; db	(((\3) & $1FFF) | $6000) >> 8, bank(\3)
 1987                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 100; dw	(\4)
 1988                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 101; .endm
 1989                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 102; #endasm
 1990                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 104; #ifdef _SGX
 1991                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 106; // Current top-left of drawn map in pixels.
 1992                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 107; extern unsigned int   sgx_map_pxl_x;
 1993                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 108; extern unsigned int   sgx_map_pxl_y;
 1994                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 110; // Width and height to draw/scroll in characters (not tiles).
 1995                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 111; extern unsigned char  sgx_map_draw_w;
 1996                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 112; extern unsigned char  sgx_map_draw_h;
 1997                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 114; // Width of map (or multi-screen BAT) in tiles.
 1998                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 115; extern unsigned char  sgx_map_line_w;
 1999                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 117; // Width of map in screens (if multi-screen map).
 2000                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 118; extern unsigned char  sgx_map_scrn_w;
 2001                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 120; extern unsigned char  sgx_scr_bank;
 2002                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 121; extern unsigned char *sgx_scr_addr;
 2003                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 123; extern unsigned char  sgx_map_bank;
 2004                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 124; extern unsigned char *sgx_map_addr;
 2005                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 126; extern unsigned char  sgx_blk_bank;
 2006                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 127; extern unsigned char *sgx_blk_addr;
 2007                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 129; extern unsigned char  sgx_tbl_bank;
 2008                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 130; extern unsigned char *sgx_tbl_addr;
 2009                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 132; extern void __fastcall sgx_set_blocks( unsigned char __far *blk_def<sgx_blk_bank:sgx_blk_addr>, unsigned char __far *flg_def<sgx_tbl_bank:sgx_tbl_addr>, unsigned char number_of_blocks<_al> );
 2010                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 133; extern void __fastcall __macro sgx_set_blkmap( unsigned char __far *blk_map<sgx_map_bank:sgx_map_addr>, unsigned char blocks_w<sgx_map_line_w> );
 2011                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 134; extern void __fastcall __macro sgx_set_multimap( unsigned char __far *multi_map<sgx_scr_bank:sgx_scr_addr>, unsigned char screens_w<sgx_map_scrn_w> );
 2012                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 136; extern void __fastcall sgx_draw_map( void );
 2013                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 137; extern void __fastcall sgx_scroll_map( void );
 2014                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 139; extern void __fastcall sgx_blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 2015                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 141; extern unsigned char __fastcall sgx_get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
 2016                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 143; #asm
 2017                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 144; .macro	_sgx_set_blkmap.2
 2018                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 145; stz	sgx_scr_bank
 2019                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 146; .endm
 2020                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 148; .macro	_sgx_set_multimap.2
 2021                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 149; lda	sgx_bat_width
 2022                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 150; lsr	a
 2023                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 151; sta	sgx_map_line_w
 2024                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 152; .endm
 2025                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 153; #endasm
 2026                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 155; #endif
 2027                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 157; #endif // __HUCC__
 2028                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 159; #endif // _hucc_blkmap_h
 2029                        		.dbg	line,	"include\gfx_BG.c", 13; #incchr(tileset_FONT,"res/maps/tiles_FONT.png");
 2030               6000     		.data
 2031    03:6000             	_tileset_FONT: 	.incchr		"res/maps/tiles_FONT.png"
 2032               E309     		.code
 2033                        		.dbg	line,	"include\gfx_BG.c", 14; //#incchr(tileset_NUMBERS_FONT,"res/maps/tiles_NUMBERS_FONT.png");
 2034                        		.dbg	line,	"include\gfx_BG.c", 17; //**************************************************************************************//
 2035                        		.dbg	line,	"include\gfx_BG.c", 18; //                                                                                      //
 2036                        		.dbg	line,	"include\gfx_BG.c", 19; //                                       LEVEL 1                                        //
 2037                        		.dbg	line,	"include\gfx_BG.c", 20; //                                                                                      //
 2038                        		.dbg	line,	"include\gfx_BG.c", 21; //**************************************************************************************//
 2039                        		.dbg	line,	"include\gfx_BG.c", 23; #incchr(tileset_LV1_WALL,"res/maps/tiles_LV1_WALL.png", 4 , 4);
 2040               6C00     		.data
 2041    03:6C00             	_tileset_LV1_WALL: 	.incchr		"res/maps/tiles_LV1_WALL.png", 4, 4
 2042               E309     		.code
 2043                        		.dbg	line,	"include\gfx_BG.c", 24; #incchr(tileset_LV1_DOOR_OPEN,"res/maps/tiles_LV1_DOOR_OPEN.png", 4 , 6);
 2044               6E00     		.data
 2045    03:6E00             	_tileset_LV1_DOOR_OPEN: 	.incchr		"res/maps/tiles_LV1_DOOR_OPEN.png", 4, 6
 2046               E309     		.code
 2047                        		.dbg	line,	"include\gfx_BG.c", 25; #incchr(tileset_LV1_DOOR_CLOSED,"res/maps/tiles_LV1_DOOR_CLOSED.png", 4 , 6);
 2048               7100     		.data
 2049    03:7100             	_tileset_LV1_DOOR_CLOSED: 	.incchr		"res/maps/tiles_LV1_DOOR_CLOSED.png", 4, 6
 2050               E309     		.code
 2051                        		.dbg	line,	"include\gfx_BG.c", 27; #incchr(tileset_LIFE_RED,"res/maps/tileset_LIFE_RED.png", 2 , 1);
 2052               7400     		.data
 2053    03:7400             	_tileset_LIFE_RED: 	.incchr		"res/maps/tileset_LIFE_RED.png", 2, 1
 2054               E309     		.code
 2055                        		.dbg	line,	"include\gfx_BG.c", 28; #incchr(tileset_LIFE_ORANGE,"res/maps/tileset_LIFE_ORANGE.png", 2 , 1);
 2056               7440     		.data
 2057    03:7440             	_tileset_LIFE_ORANGE: 	.incchr		"res/maps/tileset_LIFE_ORANGE.png", 2, 1
 2058               E309     		.code
 2059                        		.dbg	line,	"include\gfx_BG.c", 29; #incchr(tileset_LIFE_YELLOW,"res/maps/tileset_LIFE_YELLOW.png", 2 , 1);
 2060               7480     		.data
 2061    03:7480             	_tileset_LIFE_YELLOW: 	.incchr		"res/maps/tileset_LIFE_YELLOW.png", 2, 1
 2062               E309     		.code
 2063                        		.dbg	line,	"include\gfx_BG.c", 30; #incchr(tileset_LIFE_EMPTY,"res/maps/tileset_LIFE_EMPTY.png", 2 , 1);
 2064               74C0     		.data
 2065    03:74C0             	_tileset_LIFE_EMPTY: 	.incchr		"res/maps/tileset_LIFE_EMPTY.png", 2, 1
 2066               E309     		.code
 2067                        		.dbg	line,	"include\gfx_BG.c", 32; #incchr(tileset_ARMOR_1,"res/maps/tileset_ARMOR_1.png", 2 , 2);
 2068               7500     		.data
 2069    03:7500             	_tileset_ARMOR_1: 	.incchr		"res/maps/tileset_ARMOR_1.png", 2, 2
 2070               E309     		.code
 2071                        		.dbg	line,	"include\gfx_BG.c", 33; #incchr(tileset_ARMOR_2,"res/maps/tileset_ARMOR_2.png", 2 , 2);
 2072               7580     		.data
 2073    03:7580             	_tileset_ARMOR_2: 	.incchr		"res/maps/tileset_ARMOR_2.png", 2, 2
 2074               E309     		.code
 2075                        		.dbg	line,	"include\gfx_BG.c", 34; #incchr(tileset_ARMOR_4,"res/maps/tileset_ARMOR_4.png", 2 , 2);
 2076               7600     		.data
 2077    03:7600             	_tileset_ARMOR_4: 	.incchr		"res/maps/tileset_ARMOR_4.png", 2, 2
 2078               E309     		.code
 2079                        		.dbg	line,	"include\gfx_BG.c", 35; #incchr(tileset_ARMOR_8,"res/maps/tileset_ARMOR_8.png", 2 , 2);
 2080               7680     		.data
 2081    03:7680             	_tileset_ARMOR_8: 	.incchr		"res/maps/tileset_ARMOR_8.png", 2, 2
 2082               E309     		.code
 2083                        		.dbg	line,	"include\gfx_BG.c", 37; #incchr(tileset_WEAPON_1,"res/maps/tileset_WEAPON_1.png", 2 , 2);
 2084               7700     		.data
 2085    03:7700             	_tileset_WEAPON_1: 	.incchr		"res/maps/tileset_WEAPON_1.png", 2, 2
 2086               E309     		.code
 2087                        		.dbg	line,	"include\gfx_BG.c", 38; #incchr(tileset_WEAPON_2,"res/maps/tileset_WEAPON_2.png", 2 , 2);
 2088               7780     		.data
 2089    03:7780             	_tileset_WEAPON_2: 	.incchr		"res/maps/tileset_WEAPON_2.png", 2, 2
 2090               E309     		.code
 2091                        		.dbg	line,	"include\gfx_BG.c", 39; #incchr(tileset_WEAPON_4,"res/maps/tileset_WEAPON_4.png", 2 , 2);
 2092               7800     		.data
 2093    03:7800             	_tileset_WEAPON_4: 	.incchr		"res/maps/tileset_WEAPON_4.png", 2, 2
 2094               E309     		.code
 2095                        		.dbg	line,	"include\gfx_BG.c", 40; #incchr(tileset_WEAPON_5,"res/maps/tileset_WEAPON_5.png", 2 , 2);
 2096               7880     		.data
 2097    03:7880             	_tileset_WEAPON_5: 	.incchr		"res/maps/tileset_WEAPON_5.png", 2, 2
 2098               E309     		.code
 2099                        		.dbg	line,	"include\gfx_BG.c", 41; #incchr(tileset_WEAPON_8,"res/maps/tileset_WEAPON_8.png", 2 , 2);
 2100               7900     		.data
 2101    03:7900             	_tileset_WEAPON_8: 	.incchr		"res/maps/tileset_WEAPON_8.png", 2, 2
 2102               E309     		.code
 2103                        		.dbg	line,	"include\gfx_BG.c", 44; //--------------------------------------------------------------------------------------//
 2104                        		.dbg	line,	"include\gfx_BG.c", 45; //                                        VDC 2                                         //
 2105                        		.dbg	line,	"include\gfx_BG.c", 46; //--------------------------------------------------------------------------------------//
 2106                        		.dbg	line,	"include\gfx_BG.c", 48; #asm
 2107                        		.dbg	clear
 2108               0001     	OPTIMIZE	=	1
 2109               7980     			.data
 2110                        	; EXTRACT TILESET
 2111                        	;----------------
 2112    03:7980             	_tileset_LV1_BG_B:  incchr	"res/maps/template_LV1_WALL.png"
 2113    03:7B80             			incchr	"res/maps/template_LV1_DOOR.png"
 2114    03:7E80             			incchr	"res/maps/tilemap_LV1_BG_B.png", OPTIMIZE
 2115                        	; EXTRACT BLOCKS
 2116                        	;--------------
 2117    07:7000             	blocks_LV1_BG_B1:	incblk	"res/maps/tilemap_LV1_BG_B.png" , 0x1000 ,    0 ,   0 ,  64 , 32 , _tileset_LV1_BG_B ; // 96x16 = 1536 | 32x16 =  512
 2118    07:7800             	blocks_LV1_BG_B2:	incblk	"res/maps/tilemap_LV1_BG_B.png" , 0x1000 , 1024 ,   0 ,  96 , 32 , _tileset_LV1_BG_B ; // 64x16 = 1024 | 32x16 =  512
 2119    08:6000             	blocks_LV1_BG_B3:	incblk	"res/maps/tilemap_LV1_BG_B.png" , 0x1000 ,    0 , 512 ,  64 , 32 , _tileset_LV1_BG_B ; // 96x16 = 1536 | 16x16 =  256
 2120    08:6800             	blocks_LV1_BG_B4:	incblk	"res/maps/tilemap_LV1_BG_B.png" , 0x1000 , 1024 , 512 ,  96 , 32 , _tileset_LV1_BG_B ; // 64x16 = 1024 | 16x16 =  256
 2121                        	; EXTRACT MAPS
 2122                        	;------------
 2123               7000     			align	256
 2124    08:7000             	MAP_LV1_BG_B1:		incmap	"res/maps/tilemap_LV1_BG_B.png",    0 ,   0 ,  64 , 32 , blocks_LV1_BG_B1 ; // 96x16 = 1536 | 32x16 =  512
 2125               7800     			align	256
 2126    08:7800             	MAP_LV1_BG_B2:		incmap	"res/maps/tilemap_LV1_BG_B.png", 1024 ,   0 ,  96 , 32 , blocks_LV1_BG_B2 ; // 64x16 = 1024 | 32x16 =  512
 2127               6400     			align	256
 2128    09:6400             	MAP_LV1_BG_B3:		incmap	"res/maps/tilemap_LV1_BG_B.png",    0 , 512 ,  64 , 32 , blocks_LV1_BG_B3 ; // 96x16 = 1536 | 16x16 =  256
 2129               6C00     			align	256
 2130    09:6C00             	MAP_LV1_BG_B4:		incmap	"res/maps/tilemap_LV1_BG_B.png", 1024 , 512 ,  96 , 32 , blocks_LV1_BG_B4 ; // 64x16 = 1024 | 16x16 =  256
 2131                        	; MASK (EMPTY)
 2132                        	;----------------
 2133    09:7800  00 00 00 00	dummy_tbl:	ds	256
         09:7804  00 00 00 00 
         09:7808  00 00 00 00 
         09:780C  00 00 00 00 
         09:7810  00 00 00 00 
         09:7814  00 00 00 00 
         09:7818  00 00 00 00 
         09:781C  00 00 00 00 
         09:7820  00 00 00 00 
         09:7824  00 00 00 00 
         09:7828  00 00 00 00 
         09:782C  00 00 00 00 
         09:7830  00 00 00 00 
         09:7834  00 00 00 00 
         09:7838  00 00 00 00 
         09:783C  00 00 00 00 
         09:7840  00 00 00 00 
         09:7844  00 00 00 00 
         09:7848  00 00 00 00 
         09:784C  00 00 00 00 
         09:7850  00 00 00 00 
         09:7854  00 00 00 00 
         09:7858  00 00 00 00 
         09:785C  00 00 00 00 
         09:7860  00 00 00 00 
         09:7864  00 00 00 00 
         09:7868  00 00 00 00 
         09:786C  00 00 00 00 
         09:7870  00 00 00 00 
         09:7874  00 00 00 00 
         09:7878  00 00 00 00 
         09:787C  00 00 00 00 
         09:7880  00 00 00 00 
         09:7884  00 00 00 00 
         09:7888  00 00 00 00 
         09:788C  00 00 00 00 
         09:7890  00 00 00 00 
         09:7894  00 00 00 00 
         09:7898  00 00 00 00 
         09:789C  00 00 00 00 
         09:78A0  00 00 00 00 
         09:78A4  00 00 00 00 
         09:78A8  00 00 00 00 
         09:78AC  00 00 00 00 
         09:78B0  00 00 00 00 
         09:78B4  00 00 00 00 
         09:78B8  00 00 00 00 
         09:78BC  00 00 00 00 
         09:78C0  00 00 00 00 
         09:78C4  00 00 00 00 
         09:78C8  00 00 00 00 
         09:78CC  00 00 00 00 
         09:78D0  00 00 00 00 
         09:78D4  00 00 00 00 
         09:78D8  00 00 00 00 
         09:78DC  00 00 00 00 
         09:78E0  00 00 00 00 
         09:78E4  00 00 00 00 
         09:78E8  00 00 00 00 
         09:78EC  00 00 00 00 
         09:78F0  00 00 00 00 
         09:78F4  00 00 00 00 
         09:78F8  00 00 00 00 
         09:78FC  00 00 00 00 
 2134                        	; SWIZZLE MAPS
 2135                        	;-------------
 2136    09:7900             	swizzle	MAP_LV1_BG_B1,  32, 16 ;
 2137    09:7900             	swizzle	MAP_LV1_BG_B2,  32, 16 ;
 2138    09:7900             	swizzle	MAP_LV1_BG_B3,  32, 16 ;
 2139    09:7900             	swizzle	MAP_LV1_BG_B4,  32, 16 ;
 2140                        	; BUILD MULTIMAP
 2141                        	;---------------
 2142    09:7900             	_multimap_LV1_BG_B:
 2143                        			; 1st line of 5 screens (512x256)
 2144                        			SCREEN MAP_LV1_BG_B1 + 0x0000, blocks_LV1_BG_B1, dummy_tbl, 0
         09:7900  70 08      			db	(((MAP_LV1_BG_B1 + 0x0000) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B1 + 0x0000)
         09:7902  50 07      			db	(((blocks_LV1_BG_B1) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B1)
         09:7904  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:7906  00 00      			dw	(0)
 2145                        			SCREEN MAP_LV1_BG_B1 + 0x0200, blocks_LV1_BG_B1, dummy_tbl, 0
         09:7908  72 08      			db	(((MAP_LV1_BG_B1 + 0x0200) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B1 + 0x0200)
         09:790A  50 07      			db	(((blocks_LV1_BG_B1) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B1)
         09:790C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:790E  00 00      			dw	(0)
 2146                        			SCREEN MAP_LV1_BG_B2 + 0x0000, blocks_LV1_BG_B2, dummy_tbl, 0
         09:7910  78 08      			db	(((MAP_LV1_BG_B2 + 0x0000) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B2 + 0x0000)
         09:7912  58 07      			db	(((blocks_LV1_BG_B2) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B2)
         09:7914  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:7916  00 00      			dw	(0)
 2147                        			SCREEN MAP_LV1_BG_B2 + 0x0200, blocks_LV1_BG_B2, dummy_tbl, 0
         09:7918  7A 08      			db	(((MAP_LV1_BG_B2 + 0x0200) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B2 + 0x0200)
         09:791A  58 07      			db	(((blocks_LV1_BG_B2) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B2)
         09:791C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:791E  00 00      			dw	(0)
 2148                        			SCREEN MAP_LV1_BG_B2 + 0x0400, blocks_LV1_BG_B2, dummy_tbl, 0
         09:7920  7C 08      			db	(((MAP_LV1_BG_B2 + 0x0400) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B2 + 0x0400)
         09:7922  58 07      			db	(((blocks_LV1_BG_B2) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B2)
         09:7924  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:7926  00 00      			dw	(0)
 2149                        			; 2nd line of 5 screens (512x256)
 2150                        			SCREEN MAP_LV1_BG_B1 + 0x0400, blocks_LV1_BG_B1, dummy_tbl, 0
         09:7928  74 08      			db	(((MAP_LV1_BG_B1 + 0x0400) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B1 + 0x0400)
         09:792A  50 07      			db	(((blocks_LV1_BG_B1) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B1)
         09:792C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:792E  00 00      			dw	(0)
 2151                        			SCREEN MAP_LV1_BG_B1 + 0x0600, blocks_LV1_BG_B1, dummy_tbl, 0
         09:7930  76 08      			db	(((MAP_LV1_BG_B1 + 0x0600) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B1 + 0x0600)
         09:7932  50 07      			db	(((blocks_LV1_BG_B1) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B1)
         09:7934  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:7936  00 00      			dw	(0)
 2152                        			SCREEN MAP_LV1_BG_B2 + 0x0600, blocks_LV1_BG_B2, dummy_tbl, 0
         09:7938  7E 08      			db	(((MAP_LV1_BG_B2 + 0x0600) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B2 + 0x0600)
         09:793A  58 07      			db	(((blocks_LV1_BG_B2) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B2)
         09:793C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:793E  00 00      			dw	(0)
 2153                        			SCREEN MAP_LV1_BG_B2 + 0x0800, blocks_LV1_BG_B2, dummy_tbl, 0
         09:7940  60 09      			db	(((MAP_LV1_BG_B2 + 0x0800) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B2 + 0x0800)
         09:7942  58 07      			db	(((blocks_LV1_BG_B2) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B2)
         09:7944  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:7946  00 00      			dw	(0)
 2154                        			SCREEN MAP_LV1_BG_B2 + 0x0A00, blocks_LV1_BG_B2, dummy_tbl, 0
         09:7948  62 09      			db	(((MAP_LV1_BG_B2 + 0x0A00) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B2 + 0x0A00)
         09:794A  58 07      			db	(((blocks_LV1_BG_B2) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B2)
         09:794C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:794E  00 00      			dw	(0)
 2155                        			; 3rd line of 5 screens (512x256)
 2156                        			SCREEN MAP_LV1_BG_B3 + 0x0000, blocks_LV1_BG_B3, dummy_tbl, 0
         09:7950  64 09      			db	(((MAP_LV1_BG_B3 + 0x0000) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B3 + 0x0000)
         09:7952  40 08      			db	(((blocks_LV1_BG_B3) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B3)
         09:7954  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:7956  00 00      			dw	(0)
 2157                        			SCREEN MAP_LV1_BG_B3 + 0x0200, blocks_LV1_BG_B3, dummy_tbl, 0
         09:7958  66 09      			db	(((MAP_LV1_BG_B3 + 0x0200) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B3 + 0x0200)
         09:795A  40 08      			db	(((blocks_LV1_BG_B3) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B3)
         09:795C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:795E  00 00      			dw	(0)
 2158                        			SCREEN MAP_LV1_BG_B4 + 0x0000, blocks_LV1_BG_B4, dummy_tbl, 0
         09:7960  6C 09      			db	(((MAP_LV1_BG_B4 + 0x0000) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B4 + 0x0000)
         09:7962  48 08      			db	(((blocks_LV1_BG_B4) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B4)
         09:7964  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:7966  00 00      			dw	(0)
 2159                        			SCREEN MAP_LV1_BG_B4 + 0x0200, blocks_LV1_BG_B4, dummy_tbl, 0
         09:7968  6E 09      			db	(((MAP_LV1_BG_B4 + 0x0200) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B4 + 0x0200)
         09:796A  48 08      			db	(((blocks_LV1_BG_B4) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B4)
         09:796C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:796E  00 00      			dw	(0)
 2160                        			SCREEN MAP_LV1_BG_B4 + 0x0400, blocks_LV1_BG_B4, dummy_tbl, 0
         09:7970  70 09      			db	(((MAP_LV1_BG_B4 + 0x0400) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B4 + 0x0400)
         09:7972  48 08      			db	(((blocks_LV1_BG_B4) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B4)
         09:7974  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:7976  00 00      			dw	(0)
 2161                        			; 4th line of 5 screens (512x256)
 2162                        			SCREEN MAP_LV1_BG_B3 + 0x0400, blocks_LV1_BG_B3, dummy_tbl, 0
         09:7978  68 09      			db	(((MAP_LV1_BG_B3 + 0x0400) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B3 + 0x0400)
         09:797A  40 08      			db	(((blocks_LV1_BG_B3) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B3)
         09:797C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:797E  00 00      			dw	(0)
 2163                        			SCREEN MAP_LV1_BG_B3 + 0x0600, blocks_LV1_BG_B3, dummy_tbl, 0
         09:7980  6A 09      			db	(((MAP_LV1_BG_B3 + 0x0600) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B3 + 0x0600)
         09:7982  40 08      			db	(((blocks_LV1_BG_B3) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B3)
         09:7984  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:7986  00 00      			dw	(0)
 2164                        			SCREEN MAP_LV1_BG_B4 + 0x0600, blocks_LV1_BG_B4, dummy_tbl, 0
         09:7988  72 09      			db	(((MAP_LV1_BG_B4 + 0x0600) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B4 + 0x0600)
         09:798A  48 08      			db	(((blocks_LV1_BG_B4) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B4)
         09:798C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:798E  00 00      			dw	(0)
 2165                        			SCREEN MAP_LV1_BG_B4 + 0x0800, blocks_LV1_BG_B4, dummy_tbl, 0
         09:7990  74 09      			db	(((MAP_LV1_BG_B4 + 0x0800) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B4 + 0x0800)
         09:7992  48 08      			db	(((blocks_LV1_BG_B4) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B4)
         09:7994  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:7996  00 00      			dw	(0)
 2166                        			SCREEN MAP_LV1_BG_B4 + 0x0A00, blocks_LV1_BG_B4, dummy_tbl, 0
         09:7998  76 09      			db	(((MAP_LV1_BG_B4 + 0x0A00) & $1FFF) | $6000) >> 8, bank(MAP_LV1_BG_B4 + 0x0A00)
         09:799A  48 08      			db	(((blocks_LV1_BG_B4) & $1FFF) | $4000) >> 8, bank(blocks_LV1_BG_B4)
         09:799C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         09:799E  00 00      			dw	(0)
 2167                        	;//--------------------------------------------------------------------------------------//
 2168                        	;//                                        VDC 1                                         //
 2169                        	;//--------------------------------------------------------------------------------------//
 2170                        	; EXTRACT TILESET
 2171                        	;----------------
 2172    09:79A0             	_tileset_HUD:	incchr	"res/maps/template_LIFEBAR_1.png"
 2173    09:79E0             			incchr	"res/maps/template_LIFEBAR_2.png"
 2174    09:7A20             			incchr	"res/maps/template_LIFEBAR_3.png"
 2175    09:7A60             			incchr	"res/maps/template_LIFEBAR_4.png"
 2176    09:7AA0             			incchr	"res/maps/template_LIFEBAR_5.png"
 2177    09:7AE0             			incchr	"res/maps/tileset_WEAPON_1.png"
 2178    09:7B60             			incchr	"res/maps/tileset_ARMOR_2.png"
 2179    09:7BE0             			incchr	"res/maps/tilemap_HUD.png", OPTIMIZE
 2180                        	; EXTRACT BLOCKS
 2181                        	;--------------
 2182    0A:6000             	blocks_HUD1:	incblk	"res/maps/tilemap_HUD.png" , 0x1000 ,    0 ,   0 , 128 , 64 , _tileset_HUD ; // 128x16 = 2048 | 64x16 = 1024
 2183    0A:6800             	blocks_HUD2:	incblk	"res/maps/tilemap_HUD.png" , 0x1000 , 2048 ,   0 ,  32 , 64 , _tileset_HUD ; //  32x16 =  512 | 64x16 = 1024
 2184                        	; EXTRACT MAPS
 2185                        	;------------
 2186               7000     			align	256
 2187    0A:7000             	MAP_HUD1:		incmap	"res/maps/tilemap_HUD.png",    0 ,   0 , 128 , 64 , blocks_HUD1 ; // 128x16 = 2048 | 64x16 = 1024
 2188    0B:7000             			flagmap "res/maps/collision_LV1.png",       0 ,   0 , 128 , 64 , MAP_HUD1
 2189               7000     			align	256
 2190    0B:7000             	MAP_HUD2:		incmap	"res/maps/tilemap_HUD.png", 2048 ,   0 ,  32 , 64 , blocks_HUD2 ; //  32x16 =  512 | 64x16 = 1024
 2191    0B:7800             			flagmap "res/maps/collision_LV1.png",    2048 ,   0 ,  32 , 64 , MAP_HUD2
 2192                        	; SWIZZLE MAPS
 2193                        	;-------------
 2194    0B:7800             	swizzle	MAP_HUD1,  32, 16 ;
 2195    0B:7800             	swizzle	MAP_HUD2,  32, 16 ;
 2196                        	; BUILD MULTIMAP
 2197                        	;---------------
 2198    0B:7800             	_multimap_LV1_BG_A:
 2199                        			; 1st line of 5 screens (512x256)
 2200                        			SCREEN MAP_HUD1 + 0x0000, blocks_HUD1, dummy_tbl, 0
         0B:7800  70 0A      			db	(((MAP_HUD1 + 0x0000) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x0000)
         0B:7802  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:7804  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:7806  00 00      			dw	(0)
 2201                        			SCREEN MAP_HUD1 + 0x0200, blocks_HUD1, dummy_tbl, 0
         0B:7808  72 0A      			db	(((MAP_HUD1 + 0x0200) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x0200)
         0B:780A  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:780C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:780E  00 00      			dw	(0)
 2202                        			SCREEN MAP_HUD1 + 0x0400, blocks_HUD1, dummy_tbl, 0
         0B:7810  74 0A      			db	(((MAP_HUD1 + 0x0400) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x0400)
         0B:7812  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:7814  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:7816  00 00      			dw	(0)
 2203                        			SCREEN MAP_HUD1 + 0x0600, blocks_HUD1, dummy_tbl, 0
         0B:7818  76 0A      			db	(((MAP_HUD1 + 0x0600) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x0600)
         0B:781A  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:781C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:781E  00 00      			dw	(0)
 2204                        			SCREEN MAP_HUD2 + 0x0000, blocks_HUD2, dummy_tbl, 0
         0B:7820  70 0B      			db	(((MAP_HUD2 + 0x0000) & $1FFF) | $6000) >> 8, bank(MAP_HUD2 + 0x0000)
         0B:7822  48 0A      			db	(((blocks_HUD2) & $1FFF) | $4000) >> 8, bank(blocks_HUD2)
         0B:7824  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:7826  00 00      			dw	(0)
 2205                        			; 2nd line of 5 screens (512x256)
 2206                        			SCREEN MAP_HUD1 + 0x0800, blocks_HUD1, dummy_tbl, 0
         0B:7828  78 0A      			db	(((MAP_HUD1 + 0x0800) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x0800)
         0B:782A  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:782C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:782E  00 00      			dw	(0)
 2207                        			SCREEN MAP_HUD1 + 0x0A00, blocks_HUD1, dummy_tbl, 0
         0B:7830  7A 0A      			db	(((MAP_HUD1 + 0x0A00) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x0A00)
         0B:7832  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:7834  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:7836  00 00      			dw	(0)
 2208                        			SCREEN MAP_HUD1 + 0x0C00, blocks_HUD1, dummy_tbl, 0
         0B:7838  7C 0A      			db	(((MAP_HUD1 + 0x0C00) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x0C00)
         0B:783A  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:783C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:783E  00 00      			dw	(0)
 2209                        			SCREEN MAP_HUD1 + 0x0E00, blocks_HUD1, dummy_tbl, 0
         0B:7840  7E 0A      			db	(((MAP_HUD1 + 0x0E00) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x0E00)
         0B:7842  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:7844  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:7846  00 00      			dw	(0)
 2210                        			SCREEN MAP_HUD2 + 0x0200, blocks_HUD2, dummy_tbl, 0
         0B:7848  72 0B      			db	(((MAP_HUD2 + 0x0200) & $1FFF) | $6000) >> 8, bank(MAP_HUD2 + 0x0200)
         0B:784A  48 0A      			db	(((blocks_HUD2) & $1FFF) | $4000) >> 8, bank(blocks_HUD2)
         0B:784C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:784E  00 00      			dw	(0)
 2211                        			; 3rd line of 5 screens (512x256)
 2212                        			SCREEN MAP_HUD1 + 0x1000, blocks_HUD1, dummy_tbl, 0
         0B:7850  60 0B      			db	(((MAP_HUD1 + 0x1000) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x1000)
         0B:7852  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:7854  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:7856  00 00      			dw	(0)
 2213                        			SCREEN MAP_HUD1 + 0x1200, blocks_HUD1, dummy_tbl, 0
         0B:7858  62 0B      			db	(((MAP_HUD1 + 0x1200) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x1200)
         0B:785A  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:785C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:785E  00 00      			dw	(0)
 2214                        			SCREEN MAP_HUD1 + 0x1400, blocks_HUD1, dummy_tbl, 0
         0B:7860  64 0B      			db	(((MAP_HUD1 + 0x1400) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x1400)
         0B:7862  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:7864  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:7866  00 00      			dw	(0)
 2215                        			SCREEN MAP_HUD1 + 0x1600, blocks_HUD1, dummy_tbl, 0
         0B:7868  66 0B      			db	(((MAP_HUD1 + 0x1600) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x1600)
         0B:786A  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:786C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:786E  00 00      			dw	(0)
 2216                        			SCREEN MAP_HUD2 + 0x0400, blocks_HUD2, dummy_tbl, 0
         0B:7870  74 0B      			db	(((MAP_HUD2 + 0x0400) & $1FFF) | $6000) >> 8, bank(MAP_HUD2 + 0x0400)
         0B:7872  48 0A      			db	(((blocks_HUD2) & $1FFF) | $4000) >> 8, bank(blocks_HUD2)
         0B:7874  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:7876  00 00      			dw	(0)
 2217                        			; 4th line of 5 screens (512x256)
 2218                        			SCREEN MAP_HUD1 + 0x1800, blocks_HUD1, dummy_tbl, 0
         0B:7878  68 0B      			db	(((MAP_HUD1 + 0x1800) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x1800)
         0B:787A  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:787C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:787E  00 00      			dw	(0)
 2219                        			SCREEN MAP_HUD1 + 0x1A00, blocks_HUD1, dummy_tbl, 0
         0B:7880  6A 0B      			db	(((MAP_HUD1 + 0x1A00) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x1A00)
         0B:7882  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:7884  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:7886  00 00      			dw	(0)
 2220                        			SCREEN MAP_HUD1 + 0x1C00, blocks_HUD1, dummy_tbl, 0
         0B:7888  6C 0B      			db	(((MAP_HUD1 + 0x1C00) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x1C00)
         0B:788A  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:788C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:788E  00 00      			dw	(0)
 2221                        			SCREEN MAP_HUD1 + 0x1E00, blocks_HUD1, dummy_tbl, 0
         0B:7890  6E 0B      			db	(((MAP_HUD1 + 0x1E00) & $1FFF) | $6000) >> 8, bank(MAP_HUD1 + 0x1E00)
         0B:7892  40 0A      			db	(((blocks_HUD1) & $1FFF) | $4000) >> 8, bank(blocks_HUD1)
         0B:7894  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:7896  00 00      			dw	(0)
 2222                        			SCREEN MAP_HUD2 + 0x0600, blocks_HUD2, dummy_tbl, 0
         0B:7898  76 0B      			db	(((MAP_HUD2 + 0x0600) & $1FFF) | $6000) >> 8, bank(MAP_HUD2 + 0x0600)
         0B:789A  48 0A      			db	(((blocks_HUD2) & $1FFF) | $4000) >> 8, bank(blocks_HUD2)
         0B:789C  78 09      			db	(((dummy_tbl) & $1FFF) | $6000) >> 8, bank(dummy_tbl)
         0B:789E  00 00      			dw	(0)
 2223               E309     			.code
 2224                        	
 2225                        		.dbg	line,	"include\gfx_BG.c", 208; #endasm
 2226                        		.dbg	line,	"include\gfx_BG.c", 212; //--------------------------------------------------------------------------------------//
 2227                        		.dbg	line,	"include\gfx_BG.c", 213; //                                   EXTRACT PALETTES                                   //
 2228                        		.dbg	line,	"include\gfx_BG.c", 214; //--------------------------------------------------------------------------------------//
 2229                        		.dbg	line,	"include\gfx_BG.c", 216; #incpal(palette_LV1,"res/maps/tilemap_LV1_BG_B.png");
 2230               78A0     		.data
 2231    0B:78A0             	_palette_LV1:	.incpal		"res/maps/tilemap_LV1_BG_B.png"
 2232               E309     		.code
 2233                        		.dbg	line,	"include\gfx_BG.c", 225; //**************************************************************************************//
 2234                        		.dbg	line,	"include\gfx_BG.c", 226; //                                                                                      //
 2235                        		.dbg	line,	"include\gfx_BG.c", 227; //                                         SHOP                                         //
 2236                        		.dbg	line,	"include\gfx_BG.c", 228; //                                                                                      //
 2237                        		.dbg	line,	"include\gfx_BG.c", 229; //**************************************************************************************//
 2238                        		.dbg	line,	"include\gfx_BG.c", 231; #asm
 2239                        		.dbg	clear
 2240               0001     	OPTIMIZE	=	1
 2241               7AA0     			.data
 2242                        	;//--------------------------------------------------------------------------------------//
 2243                        	;//                                        VDC 1                                         //
 2244                        	;//--------------------------------------------------------------------------------------//
 2245                        	; EXTRACT TILESET
 2246                        	;----------------
 2247    0B:7AA0             	_tileset_SHOP_BG_B:		incchr	"res/maps/template_ITEM_1.png"
 2248    0B:7B20             			incchr	"res/maps/template_ITEM_2.png"
 2249    0B:7BA0             			incchr	"res/maps/template_ITEM_3.png"
 2250    0B:7C20             			incchr	"res/maps/template_ITEM_4.png"
 2251    0B:7CA0             			incchr	"res/maps/template_ITEM_5.png"
 2252    0B:7D20             			incchr	"res/maps/template_ITEM_6.png"
 2253    0B:7DA0             			incchr	"res/maps/template_ITEM_7.png"
 2254    0B:7E20             			incchr	"res/maps/template_ITEM_8.png"
 2255    0B:7EA0             			incchr	"res/maps/template_ITEM_9.png"
 2256    0B:7F20             			incchr	"res/maps/template_ITEM_10.png"
 2257    0B:7FA0             			incchr	"res/maps/tilemap_SHOP_BG_B.png", OPTIMIZE
 2258               E309     			.code
 2259                        	
 2260                        		.dbg	line,	"include\gfx_BG.c", 255; #endasm
 2261                        		.dbg	line,	"include\gfx_BG.c", 258; // EXTRACT BLOCKS //
 2262                        		.dbg	line,	"include\gfx_BG.c", 259; #incblk(blocks_SHOP_BG_B, "res/maps/tilemap_SHOP_BG_B.png", 0x1000, tileset_SHOP_BG_B);
 2263               7400     		.data
 2264    0D:7800             	_blocks_SHOP_BG_B:	.incblk		"res/maps/tilemap_SHOP_BG_B.png", 4096, _tileset_SHOP_BG_B
 2265               E309     		.code
 2266                        		.dbg	line,	"include\gfx_BG.c", 261; // EXTRACT MAP //
 2267                        		.dbg	line,	"include\gfx_BG.c", 262; #incmap(map_SHOP_BG_B, "res/maps/tilemap_SHOP_BG_B.png", blocks_SHOP_BG_B);
 2268               8000     		.data
 2269    0E:6000             	_map_SHOP_BG_B:	.incmap		"res/maps/tilemap_SHOP_BG_B.png", _blocks_SHOP_BG_B
 2270               E309     		.code
 2271                        		.dbg	line,	"include\gfx_BG.c", 265; //--------------------------------------------------------------------------------------//
 2272                        		.dbg	line,	"include\gfx_BG.c", 266; //                                        ITEMS                                         //
 2273                        		.dbg	line,	"include\gfx_BG.c", 267; //--------------------------------------------------------------------------------------//
 2274                        		.dbg	line,	"include\gfx_BG.c", 269; #incchr(tiles_ITEM_WEAPON_2,"res/maps/tiles_ITEM_WEAPON_2.png", 2 , 2);
 2275               60E0     		.data
 2276    0E:60E0             	_tiles_ITEM_WEAPON_2: 	.incchr		"res/maps/tiles_ITEM_WEAPON_2.png", 2, 2
 2277               E309     		.code
 2278                        		.dbg	line,	"include\gfx_BG.c", 270; #incchr(tiles_ITEM_WEAPON_3,"res/maps/tiles_ITEM_WEAPON_3.png", 2 , 2);
 2279               6160     		.data
 2280    0E:6160             	_tiles_ITEM_WEAPON_3: 	.incchr		"res/maps/tiles_ITEM_WEAPON_3.png", 2, 2
 2281               E309     		.code
 2282                        		.dbg	line,	"include\gfx_BG.c", 271; #incchr(tiles_ITEM_WEAPON_4,"res/maps/tiles_ITEM_WEAPON_4.png", 2 , 2);
 2283               61E0     		.data
 2284    0E:61E0             	_tiles_ITEM_WEAPON_4: 	.incchr		"res/maps/tiles_ITEM_WEAPON_4.png", 2, 2
 2285               E309     		.code
 2286                        		.dbg	line,	"include\gfx_BG.c", 272; #incchr(tiles_ITEM_WEAPON_5,"res/maps/tiles_ITEM_WEAPON_5.png", 2 , 2);
 2287               6260     		.data
 2288    0E:6260             	_tiles_ITEM_WEAPON_5: 	.incchr		"res/maps/tiles_ITEM_WEAPON_5.png", 2, 2
 2289               E309     		.code
 2290                        		.dbg	line,	"include\gfx_BG.c", 273; #incchr(tiles_ITEM_KEY,"res/maps/tiles_ITEM_KEY.png", 2 , 2);
 2291               62E0     		.data
 2292    0E:62E0             	_tiles_ITEM_KEY: 	.incchr		"res/maps/tiles_ITEM_KEY.png", 2, 2
 2293               E309     		.code
 2294                        		.dbg	line,	"include\gfx_BG.c", 274; #incchr(tiles_ITEM_ARMOR_2,"res/maps/tiles_ITEM_ARMOR_2.png", 2 , 2);
 2295               6360     		.data
 2296    0E:6360             	_tiles_ITEM_ARMOR_2: 	.incchr		"res/maps/tiles_ITEM_ARMOR_2.png", 2, 2
 2297               E309     		.code
 2298                        		.dbg	line,	"include\gfx_BG.c", 275; #incchr(tiles_ITEM_ARMOR_3,"res/maps/tiles_ITEM_ARMOR_3.png", 2 , 2);
 2299               63E0     		.data
 2300    0E:63E0             	_tiles_ITEM_ARMOR_3: 	.incchr		"res/maps/tiles_ITEM_ARMOR_3.png", 2, 2
 2301               E309     		.code
 2302                        		.dbg	line,	"include\gfx_BG.c", 276; #incchr(tiles_ITEM_ARMOR_4,"res/maps/tiles_ITEM_ARMOR_4.png", 2 , 2);
 2303               6460     		.data
 2304    0E:6460             	_tiles_ITEM_ARMOR_4: 	.incchr		"res/maps/tiles_ITEM_ARMOR_4.png", 2, 2
 2305               E309     		.code
 2306                        		.dbg	line,	"include\gfx_BG.c", 277; #incchr(tiles_ITEM_ARMOR_5,"res/maps/tiles_ITEM_ARMOR_5.png", 2 , 2);
 2307               64E0     		.data
 2308    0E:64E0             	_tiles_ITEM_ARMOR_5: 	.incchr		"res/maps/tiles_ITEM_ARMOR_5.png", 2, 2
 2309               E309     		.code
 2310                        		.dbg	line,	"include\gfx_BG.c", 278; #incchr(tiles_ITEM_POTION,"res/maps/tiles_ITEM_POTION.png", 2 , 2);
 2311               6560     		.data
 2312    0E:6560             	_tiles_ITEM_POTION: 	.incchr		"res/maps/tiles_ITEM_POTION.png", 2, 2
 2313               E309     		.code
 2314                        		.dbg	line,	"include\gfx_BG.c", 280; //#incchr(tileset_NUMBERS_SHOP_FONT,"res/maps/tiles_NUMBERS_SHOP_FONT.png");
 2315                        		.dbg	line,	"include\gfx_BG.c", 283; //--------------------------------------------------------------------------------------//
 2316                        		.dbg	line,	"include\gfx_BG.c", 284; //                                   EXTRACT PALETTES                                   //
 2317                        		.dbg	line,	"include\gfx_BG.c", 285; //--------------------------------------------------------------------------------------//
 2318                        		.dbg	line,	"include\gfx_BG.c", 287; #incpal(palette_SHOP,"res/maps/tilemap_SHOP_BG_B.png");
 2319               65E0     		.data
 2320    0E:65E0             	_palette_SHOP:	.incpal		"res/maps/tilemap_SHOP_BG_B.png"
 2321               E309     		.code
 2322                        		.dbg	line,	"include\gfx_BG.c", 288; #incpal(palette_SHOP_ITEMS,"res/palettes/palette_SHOP_ITEMS.png");
 2323               67E0     		.data
 2324    0E:67E0             	_palette_SHOP_ITEMS:	.incpal		"res/palettes/palette_SHOP_ITEMS.png"
 2325               E309     		.code
 2326                        		.dbg	line,	"main.c", 12; #include "include/gfx_SPRITES.c"
 2327                        		.dbg	line,	"include\gfx_SPRITES.c", 1; #include "huc.h"
 2328                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 1; #ifndef _hucc_legacy_h
 2329                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 2; #define _hucc_legacy_h
 2330                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 4; /****************************************************************************
 2331                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 5; ; ***************************************************************************
 2332                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 6; ;
 2333                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 7; ; huc.h
 2334                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 8; ;
 2335                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 9; ; HuCC wrapper file to include a default set of HuC-compatible functions.
 2336                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 10; ;
 2337                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 11; ; Copyright John Brandwood 2024.
 2338                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 12; ;
 2339                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 2340                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 2341                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 2342                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 16; ;
 2343                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 17; ; ***************************************************************************
 2344                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 18; ; ***************************************************************************
 2345                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 19; ;
 2346                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 20; ; When the HuCC compiler is invoked with the "--legacy" option to compile old
 2347                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 21; ; projects, then this "huc.h" file is automatically included.
 2348                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 22; ;
 2349                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 23; ; This file includes a set of the individual HuCC headers which correspond to
 2350                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 24; ; HuC's built-in functions and MagicKit library.
 2351                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 25; ;
 2352                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 26; ; New HuCC projects should, preferably, include the specific headers that are
 2353                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 27; ; needed, which will then allow them to replace parts of the standard library
 2354                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 28; ; with newer functions, or they can just manually include this "huc.h" file.
 2355                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 29; ;
 2356                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 30; ; ***************************************************************************
 2357                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 31; ; **************************************************************************/
 2358                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 33; #include "hucc-systemcard.h"
 2359                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 34; #include "hucc-baselib.h"
 2360                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 35; #include "hucc-gfx.h"
 2361                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 36; #include "hucc-string.h"
 2362                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 37; #include "hucc-old-scroll.h"
 2363                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 38; #include "hucc-old-spr.h"
 2364                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 39; #include "hucc-old-map.h"
 2365                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 40; #include "hucc-old-line.h"
 2366                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 42; #endif // _hucc_legacy_h
 2367                        		.dbg	line,	"include\gfx_SPRITES.c", 10; // EXTRACT PLAYER TILES //
 2368                        		.dbg	line,	"include\gfx_SPRITES.c", 11; #incspr(tiles_SPR_PLAYER_ARMOR,"res/sprites/tiles_SPR_PLAYER_ARMOR.png")
 2369               69E0     		.data
 2370    0E:69E0             	_tiles_SPR_PLAYER_ARMOR:	.incspr		"res/sprites/tiles_SPR_PLAYER_ARMOR.png"
 2371               E309     		.code
 2372                        		.dbg	line,	"include\gfx_SPRITES.c", 12; #incspr(tiles_SPR_PLAYER_NAKED,"res/sprites/tiles_SPR_PLAYER_NAKED.png")
 2373               71E0     		.data
 2374    0F:71E0             	_tiles_SPR_PLAYER_NAKED:	.incspr		"res/sprites/tiles_SPR_PLAYER_NAKED.png"
 2375               E309     		.code
 2376                        		.dbg	line,	"include\gfx_SPRITES.c", 14; // EXTRACT PLAYER PALETTE //
 2377                        		.dbg	line,	"include\gfx_SPRITES.c", 15; #incpal(palette_PLAYER_1,"res/palettes/palette_PLAYER_1.png");
 2378               71E0     		.data
 2379    10:71E0             	_palette_PLAYER_1:	.incpal		"res/palettes/palette_PLAYER_1.png"
 2380               E309     		.code
 2381                        		.dbg	line,	"include\gfx_SPRITES.c", 16; #incpal(palette_PLAYER_4,"res/palettes/palette_PLAYER_4.png");
 2382               73E0     		.data
 2383    10:73E0             	_palette_PLAYER_4:	.incpal		"res/palettes/palette_PLAYER_4.png"
 2384               E309     		.code
 2385                        		.dbg	line,	"include\gfx_SPRITES.c", 17; #incpal(palette_PLAYER_5,"res/palettes/palette_PLAYER_5.png");
 2386               75E0     		.data
 2387    10:75E0             	_palette_PLAYER_5:	.incpal		"res/palettes/palette_PLAYER_5.png"
 2388               E309     		.code
 2389                        		.dbg	line,	"include\gfx_SPRITES.c", 18; #incpal(palette_PLAYER_8,"res/palettes/palette_PLAYER_8.png");
 2390               77E0     		.data
 2391    10:77E0             	_palette_PLAYER_8:	.incpal		"res/palettes/palette_PLAYER_8.png"
 2392               E309     		.code
 2393                        		.dbg	line,	"include\gfx_SPRITES.c", 21; #incspr(tiles_SPR_HIT,"res/sprites/tiles_SPR_HIT.png")
 2394               79E0     		.data
 2395    10:79E0             	_tiles_SPR_HIT:	.incspr		"res/sprites/tiles_SPR_HIT.png"
 2396               E309     		.code
 2397                        		.dbg	line,	"include\gfx_SPRITES.c", 24; // EXTRACT OBJECTS TILES //
 2398                        		.dbg	line,	"include\gfx_SPRITES.c", 25; #incspr(tiles_SPR_BARREL,"res/sprites/tiles_SPR_BARREL.png")
 2399               7A60     		.data
 2400    10:7A60             	_tiles_SPR_BARREL:	.incspr		"res/sprites/tiles_SPR_BARREL.png"
 2401               E309     		.code
 2402                        		.dbg	line,	"include\gfx_SPRITES.c", 26; #incspr(tiles_SPR_CHEST,"res/sprites/tiles_SPR_CHEST.png")
 2403               7AE0     		.data
 2404    10:7AE0             	_tiles_SPR_CHEST:	.incspr		"res/sprites/tiles_SPR_CHEST.png"
 2405               E309     		.code
 2406                        		.dbg	line,	"include\gfx_SPRITES.c", 27; #incspr(tiles_SPR_COIN_1,"res/sprites/tiles_SPR_COIN_1.png")
 2407               66E0     		.data
 2408    11:66E0             	_tiles_SPR_COIN_1:	.incspr		"res/sprites/tiles_SPR_COIN_1.png"
 2409               E309     		.code
 2410                        		.dbg	line,	"include\gfx_SPRITES.c", 28; #incspr(tiles_SPR_COIN_5,"res/sprites/tiles_SPR_COIN_5.png")
 2411               6760     		.data
 2412    11:6760             	_tiles_SPR_COIN_5:	.incspr		"res/sprites/tiles_SPR_COIN_5.png"
 2413               E309     		.code
 2414                        		.dbg	line,	"include\gfx_SPRITES.c", 29; #incspr(tiles_SPR_COIN_10,"res/sprites/tiles_SPR_COIN_10.png")
 2415               67E0     		.data
 2416    11:67E0             	_tiles_SPR_COIN_10:	.incspr		"res/sprites/tiles_SPR_COIN_10.png"
 2417               E309     		.code
 2418                        		.dbg	line,	"include\gfx_SPRITES.c", 30; #incspr(tiles_SPR_COIN_50,"res/sprites/tiles_SPR_COIN_50.png")
 2419               6860     		.data
 2420    11:6860             	_tiles_SPR_COIN_50:	.incspr		"res/sprites/tiles_SPR_COIN_50.png"
 2421               E309     		.code
 2422                        		.dbg	line,	"include\gfx_SPRITES.c", 31; #incspr(tiles_SPR_COIN_100,"res/sprites/tiles_SPR_COIN_100.png")
 2423               68E0     		.data
 2424    11:68E0             	_tiles_SPR_COIN_100:	.incspr		"res/sprites/tiles_SPR_COIN_100.png"
 2425               E309     		.code
 2426                        		.dbg	line,	"include\gfx_SPRITES.c", 32; #incspr(tiles_SPR_COIN_500,"res/sprites/tiles_SPR_COIN_500.png")
 2427               6960     		.data
 2428    11:6960             	_tiles_SPR_COIN_500:	.incspr		"res/sprites/tiles_SPR_COIN_500.png"
 2429               E309     		.code
 2430                        		.dbg	line,	"include\gfx_SPRITES.c", 33; #incspr(tiles_SPR_COIN_1000,"res/sprites/tiles_SPR_COIN_1000.png")
 2431               69E0     		.data
 2432    11:69E0             	_tiles_SPR_COIN_1000:	.incspr		"res/sprites/tiles_SPR_COIN_1000.png"
 2433               E309     		.code
 2434                        		.dbg	line,	"include\gfx_SPRITES.c", 34; #incspr(tiles_SPR_FRUIT,"res/sprites/tiles_SPR_FRUIT.png")
 2435               6A60     		.data
 2436    11:6A60             	_tiles_SPR_FRUIT:	.incspr		"res/sprites/tiles_SPR_FRUIT.png"
 2437               E309     		.code
 2438                        		.dbg	line,	"include\gfx_SPRITES.c", 35; #incspr(tiles_SPR_GRAY_KEY,"res/sprites/tiles_SPR_GRAY_KEY.png")
 2439               6AE0     		.data
 2440    11:6AE0             	_tiles_SPR_GRAY_KEY:	.incspr		"res/sprites/tiles_SPR_GRAY_KEY.png"
 2441               E309     		.code
 2442                        		.dbg	line,	"include\gfx_SPRITES.c", 36; #incspr(tiles_SPR_GOLD_KEY,"res/sprites/tiles_SPR_GOLD_KEY.png")
 2443               6B60     		.data
 2444    11:6B60             	_tiles_SPR_GOLD_KEY:	.incspr		"res/sprites/tiles_SPR_GOLD_KEY.png"
 2445               E309     		.code
 2446                        		.dbg	line,	"include\gfx_SPRITES.c", 37; #incspr(tiles_SPR_HOURGLASS,"res/sprites/tiles_SPR_HOURGLASS.png")
 2447               6BE0     		.data
 2448    11:6BE0             	_tiles_SPR_HOURGLASS:	.incspr		"res/sprites/tiles_SPR_HOURGLASS.png"
 2449               E309     		.code
 2450                        		.dbg	line,	"include\gfx_SPRITES.c", 38; #incspr(tiles_SPR_LIFE,"res/sprites/tiles_SPR_LIFE.png")
 2451               6C60     		.data
 2452    11:6C60             	_tiles_SPR_LIFE:	.incspr		"res/sprites/tiles_SPR_LIFE.png"
 2453               E309     		.code
 2454                        		.dbg	line,	"include\gfx_SPRITES.c", 39; #incspr(tiles_SPR_OCTOPUS,"res/sprites/tiles_SPR_OCTOPUS.png")
 2455               6CE0     		.data
 2456    11:6CE0             	_tiles_SPR_OCTOPUS:	.incspr		"res/sprites/tiles_SPR_OCTOPUS.png"
 2457               E309     		.code
 2458                        		.dbg	line,	"include\gfx_SPRITES.c", 40; #incspr(tiles_SPR_POT,"res/sprites/tiles_SPR_POT.png")
 2459               6D60     		.data
 2460    11:6D60             	_tiles_SPR_POT:	.incspr		"res/sprites/tiles_SPR_POT.png"
 2461               E309     		.code
 2462                        		.dbg	line,	"include\gfx_SPRITES.c", 41; #incspr(tiles_SPR_POW,"res/sprites/tiles_SPR_POW.png")
 2463               7160     		.data
 2464    11:7160             	_tiles_SPR_POW:	.incspr		"res/sprites/tiles_SPR_POW.png"
 2465               E309     		.code
 2466                        		.dbg	line,	"include\gfx_SPRITES.c", 42; #incspr(tiles_SPR_STAR,"res/sprites/tiles_SPR_STAR.png")
 2467               71E0     		.data
 2468    11:71E0             	_tiles_SPR_STAR:	.incspr		"res/sprites/tiles_SPR_STAR.png"
 2469               E309     		.code
 2470                        		.dbg	line,	"include\gfx_SPRITES.c", 43; #incspr(tiles_SPR_BAMBOO,"res/sprites/tiles_SPR_BAMBOO.png")
 2471               7260     		.data
 2472    11:7260             	_tiles_SPR_BAMBOO:	.incspr		"res/sprites/tiles_SPR_BAMBOO.png"
 2473               E309     		.code
 2474                        		.dbg	line,	"include\gfx_SPRITES.c", 44; #incspr(tiles_SPR_YASHICHI,"res/sprites/tiles_SPR_YASHICHI.png")
 2475               72E0     		.data
 2476    11:72E0             	_tiles_SPR_YASHICHI:	.incspr		"res/sprites/tiles_SPR_YASHICHI.png"
 2477               E309     		.code
 2478                        		.dbg	line,	"include\gfx_SPRITES.c", 45; #incspr(tiles_SPR_ELEPHANT,"res/sprites/tiles_SPR_ELEPHANT.png")
 2479               7360     		.data
 2480    11:7360             	_tiles_SPR_ELEPHANT:	.incspr		"res/sprites/tiles_SPR_ELEPHANT.png"
 2481               E309     		.code
 2482                        		.dbg	line,	"include\gfx_SPRITES.c", 46; #incspr(tiles_SPR_DRAGONFLY,"res/sprites/tiles_SPR_DRAGONFLY.png")
 2483               73E0     		.data
 2484    11:73E0             	_tiles_SPR_DRAGONFLY:	.incspr		"res/sprites/tiles_SPR_DRAGONFLY.png"
 2485               E309     		.code
 2486                        		.dbg	line,	"include\gfx_SPRITES.c", 47; #incspr(tiles_SPR_COW,"res/sprites/tiles_SPR_COW.png")
 2487               7460     		.data
 2488    11:7460             	_tiles_SPR_COW:	.incspr		"res/sprites/tiles_SPR_COW.png"
 2489               E309     		.code
 2490                        		.dbg	line,	"include\gfx_SPRITES.c", 48; #incspr(tiles_SPR_MOBICHAN,"res/sprites/tiles_SPR_MOBICHAN.png")
 2491               74E0     		.data
 2492    11:74E0             	_tiles_SPR_MOBICHAN:	.incspr		"res/sprites/tiles_SPR_MOBICHAN.png"
 2493               E309     		.code
 2494                        		.dbg	line,	"include\gfx_SPRITES.c", 50; // EXTRACT OBJECTS PALETTE //
 2495                        		.dbg	line,	"include\gfx_SPRITES.c", 51; #incpal(palette_objects_1,"res/palettes/palette_objects_1.png");
 2496               7560     		.data
 2497    11:7560             	_palette_objects_1:	.incpal		"res/palettes/palette_objects_1.png"
 2498               E309     		.code
 2499                        		.dbg	line,	"include\gfx_SPRITES.c", 52; #incpal(palette_objects_2,"res/palettes/palette_objects_2.png");
 2500               7760     		.data
 2501    11:7760             	_palette_objects_2:	.incpal		"res/palettes/palette_objects_2.png"
 2502               E309     		.code
 2503                        		.dbg	line,	"include\gfx_SPRITES.c", 55; // EXTRACT NPCS TILES //
 2504                        		.dbg	line,	"include\gfx_SPRITES.c", 56; #incspr(tiles_SPR_NPC,"res/sprites/tiles_SPR_NPC.png")
 2505               7960     		.data
 2506    11:7960             	_tiles_SPR_NPC:	.incspr		"res/sprites/tiles_SPR_NPC.png"
 2507               E309     		.code
 2508                        		.dbg	line,	"include\gfx_SPRITES.c", 60; // EXTRACT CURSOR TILES //
 2509                        		.dbg	line,	"include\gfx_SPRITES.c", 61; #incspr(tiles_SPR_CURSOR,"res/sprites/tiles_SPR_CURSOR.png")
 2510               6560     		.data
 2511    12:6560             	_tiles_SPR_CURSOR:	.incspr		"res/sprites/tiles_SPR_CURSOR.png"
 2512               E309     		.code
 2513                        		.dbg	line,	"main.c", 15; #include "include/tables_NPC.c"
 2514                        		.dbg	line,	"include\tables_NPC.c", 1; //-----------------------------------------------------------------------------//
 2515                        		.dbg	line,	"include\tables_NPC.c", 2; //                                                                             //
 2516                        		.dbg	line,	"include\tables_NPC.c", 3; //                                   LEVEL 1                                   //
 2517                        		.dbg	line,	"include\tables_NPC.c", 4; //                                                                             //
 2518                        		.dbg	line,	"include\tables_NPC.c", 5; //-----------------------------------------------------------------------------//
 2519                        		.dbg	line,	"include\tables_NPC.c", 7; const char              TABLE_NPC_TYPE_LV1[NPC_NUMBER_LV1]              =   {
 2520                        		.dbg	line,	"include\tables_NPC.c", 8; TYPE_NPC_SHOP,
 2521                        		.dbg	line,	"include\tables_NPC.c", 9; TYPE_NPC_REWARD
 2522                        		.dbg	line,	"include\tables_NPC.c", 10; };
 2523                        		.dbg	line,	"include\tables_NPC.c", 13; const signed int        TABLE_NPC_X_POS_REF_LV1[NPC_NUMBER_LV1]         =   {
 2524                        		.dbg	line,	"include\tables_NPC.c", 14; 912,
 2525                        		.dbg	line,	"include\tables_NPC.c", 15; 1232
 2526                        		.dbg	line,	"include\tables_NPC.c", 16; };
 2527                        		.dbg	line,	"include\tables_NPC.c", 19; const signed int        TABLE_NPC_Y_POS_REF_LV1[NPC_NUMBER_LV1]         =   {
 2528                        		.dbg	line,	"include\tables_NPC.c", 20; 576,
 2529                        		.dbg	line,	"include\tables_NPC.c", 21; 400
 2530                        		.dbg	line,	"include\tables_NPC.c", 22; };
 2531                        		.dbg	line,	"main.c", 16; #include "include/tables_OBJECT.c"
 2532                        		.dbg	line,	"include\tables_OBJECT.c", 1; //-----------------------------------------------------------------------------//
 2533                        		.dbg	line,	"include\tables_OBJECT.c", 2; //                                                                             //
 2534                        		.dbg	line,	"include\tables_OBJECT.c", 3; //                                   LEVEL 1                                   //
 2535                        		.dbg	line,	"include\tables_OBJECT.c", 4; //                                                                             //
 2536                        		.dbg	line,	"include\tables_OBJECT.c", 5; //-----------------------------------------------------------------------------//
 2537                        		.dbg	line,	"include\tables_OBJECT.c", 7; const char              TABLE_OBJECT_TYPE_LV1[OBJECT_NUMBER_LV1]      =   {
 2538                        		.dbg	line,	"include\tables_OBJECT.c", 8; TYPE_HOURGLASS,
 2539                        		.dbg	line,	"include\tables_OBJECT.c", 9; TYPE_POT,
 2540                        		.dbg	line,	"include\tables_OBJECT.c", 10; TYPE_POT,
 2541                        		.dbg	line,	"include\tables_OBJECT.c", 11; TYPE_POT,
 2542                        		.dbg	line,	"include\tables_OBJECT.c", 12; TYPE_POT,
 2543                        		.dbg	line,	"include\tables_OBJECT.c", 13; TYPE_POT,
 2544                        		.dbg	line,	"include\tables_OBJECT.c", 14; TYPE_POT,
 2545                        		.dbg	line,	"include\tables_OBJECT.c", 15; TYPE_POW,
 2546                        		.dbg	line,	"include\tables_OBJECT.c", 16; TYPE_POT,
 2547                        		.dbg	line,	"include\tables_OBJECT.c", 17; TYPE_POT,
 2548                        		.dbg	line,	"include\tables_OBJECT.c", 19; //
 2549                        		.dbg	line,	"include\tables_OBJECT.c", 20; TYPE_POT,
 2550                        		.dbg	line,	"include\tables_OBJECT.c", 21; TYPE_POT,
 2551                        		.dbg	line,	"include\tables_OBJECT.c", 22; TYPE_POT,
 2552                        		.dbg	line,	"include\tables_OBJECT.c", 23; TYPE_POT,
 2553                        		.dbg	line,	"include\tables_OBJECT.c", 24; TYPE_POT,
 2554                        		.dbg	line,	"include\tables_OBJECT.c", 25; TYPE_POT,
 2555                        		.dbg	line,	"include\tables_OBJECT.c", 26; TYPE_POT,
 2556                        		.dbg	line,	"include\tables_OBJECT.c", 27; TYPE_POT,
 2557                        		.dbg	line,	"include\tables_OBJECT.c", 28; TYPE_POT,
 2558                        		.dbg	line,	"include\tables_OBJECT.c", 29; TYPE_POT,
 2559                        		.dbg	line,	"include\tables_OBJECT.c", 31; //
 2560                        		.dbg	line,	"include\tables_OBJECT.c", 32; TYPE_POT,
 2561                        		.dbg	line,	"include\tables_OBJECT.c", 33; TYPE_POT,
 2562                        		.dbg	line,	"include\tables_OBJECT.c", 34; TYPE_POT
 2563                        		.dbg	line,	"include\tables_OBJECT.c", 35; };
 2564                        		.dbg	line,	"include\tables_OBJECT.c", 38; const signed int        TABLE_OBJECT_X_POS_REF_LV1[OBJECT_NUMBER_LV1] =   {
 2565                        		.dbg	line,	"include\tables_OBJECT.c", 39; 1680,
 2566                        		.dbg	line,	"include\tables_OBJECT.c", 40; 1280,
 2567                        		.dbg	line,	"include\tables_OBJECT.c", 41; 1472,
 2568                        		.dbg	line,	"include\tables_OBJECT.c", 42; 1440,
 2569                        		.dbg	line,	"include\tables_OBJECT.c", 43; 1168,
 2570                        		.dbg	line,	"include\tables_OBJECT.c", 44; 1200,
 2571                        		.dbg	line,	"include\tables_OBJECT.c", 45; 960,
 2572                        		.dbg	line,	"include\tables_OBJECT.c", 46; 984,
 2573                        		.dbg	line,	"include\tables_OBJECT.c", 47; 1360,
 2574                        		.dbg	line,	"include\tables_OBJECT.c", 48; 1392,
 2575                        		.dbg	line,	"include\tables_OBJECT.c", 50; //
 2576                        		.dbg	line,	"include\tables_OBJECT.c", 51; 1552,
 2577                        		.dbg	line,	"include\tables_OBJECT.c", 52; 1680,
 2578                        		.dbg	line,	"include\tables_OBJECT.c", 53; 1712,
 2579                        		.dbg	line,	"include\tables_OBJECT.c", 54; 1744,
 2580                        		.dbg	line,	"include\tables_OBJECT.c", 55; 1248,
 2581                        		.dbg	line,	"include\tables_OBJECT.c", 56; 1280,
 2582                        		.dbg	line,	"include\tables_OBJECT.c", 57; 1168,
 2583                        		.dbg	line,	"include\tables_OBJECT.c", 58; 1040,
 2584                        		.dbg	line,	"include\tables_OBJECT.c", 59; 640,
 2585                        		.dbg	line,	"include\tables_OBJECT.c", 60; 672,
 2586                        		.dbg	line,	"include\tables_OBJECT.c", 62; //
 2587                        		.dbg	line,	"include\tables_OBJECT.c", 63; 336,
 2588                        		.dbg	line,	"include\tables_OBJECT.c", 64; 368,
 2589                        		.dbg	line,	"include\tables_OBJECT.c", 65; 416
 2590                        		.dbg	line,	"include\tables_OBJECT.c", 66; };
 2591                        		.dbg	line,	"include\tables_OBJECT.c", 69; const signed int        TABLE_OBJECT_Y_POS_REF_LV1[OBJECT_NUMBER_LV1] =   {
 2592                        		.dbg	line,	"include\tables_OBJECT.c", 70; 384,
 2593                        		.dbg	line,	"include\tables_OBJECT.c", 71; 416,
 2594                        		.dbg	line,	"include\tables_OBJECT.c", 72; 480,
 2595                        		.dbg	line,	"include\tables_OBJECT.c", 73; 496,
 2596                        		.dbg	line,	"include\tables_OBJECT.c", 74; 560,
 2597                        		.dbg	line,	"include\tables_OBJECT.c", 75; 560,
 2598                        		.dbg	line,	"include\tables_OBJECT.c", 76; 592,
 2599                        		.dbg	line,	"include\tables_OBJECT.c", 77; 592,
 2600                        		.dbg	line,	"include\tables_OBJECT.c", 78; 592,
 2601                        		.dbg	line,	"include\tables_OBJECT.c", 79; 592,
 2602                        		.dbg	line,	"include\tables_OBJECT.c", 81; //
 2603                        		.dbg	line,	"include\tables_OBJECT.c", 82; 704,
 2604                        		.dbg	line,	"include\tables_OBJECT.c", 83; 720,
 2605                        		.dbg	line,	"include\tables_OBJECT.c", 84; 720,
 2606                        		.dbg	line,	"include\tables_OBJECT.c", 85; 720,
 2607                        		.dbg	line,	"include\tables_OBJECT.c", 86; 736,
 2608                        		.dbg	line,	"include\tables_OBJECT.c", 87; 736,
 2609                        		.dbg	line,	"include\tables_OBJECT.c", 88; 752,
 2610                        		.dbg	line,	"include\tables_OBJECT.c", 89; 848,
 2611                        		.dbg	line,	"include\tables_OBJECT.c", 90; 880,
 2612                        		.dbg	line,	"include\tables_OBJECT.c", 91; 880,
 2613                        		.dbg	line,	"include\tables_OBJECT.c", 93; //
 2614                        		.dbg	line,	"include\tables_OBJECT.c", 94; 896,
 2615                        		.dbg	line,	"include\tables_OBJECT.c", 95; 896,
 2616                        		.dbg	line,	"include\tables_OBJECT.c", 96; 896
 2617                        		.dbg	line,	"include\tables_OBJECT.c", 97; };
 2618                        		.dbg	line,	"include\tables_OBJECT.c", 100; /*const char              TABLE_REWARD_TYPE_LV1[OBJECT_NUMBER_LV1]       =   {
 2619                        		.dbg	line,	"include\tables_OBJECT.c", 101; TYPE_POT
 2620                        		.dbg	line,	"include\tables_OBJECT.c", 102; TYPE_POT,
 2621                        		.dbg	line,	"include\tables_OBJECT.c", 103; TYPE_POT,
 2622                        		.dbg	line,	"include\tables_OBJECT.c", 104; TYPE_POT,
 2623                        		.dbg	line,	"include\tables_OBJECT.c", 105; TYPE_POT,
 2624                        		.dbg	line,	"include\tables_OBJECT.c", 106; TYPE_POT,
 2625                        		.dbg	line,	"include\tables_OBJECT.c", 107; TYPE_POT,
 2626                        		.dbg	line,	"include\tables_OBJECT.c", 108; TYPE_POW,
 2627                        		.dbg	line,	"include\tables_OBJECT.c", 109; TYPE_POT,
 2628                        		.dbg	line,	"include\tables_OBJECT.c", 110; TYPE_POT,
 2629                        		.dbg	line,	"include\tables_OBJECT.c", 112; //
 2630                        		.dbg	line,	"include\tables_OBJECT.c", 113; TYPE_POT,
 2631                        		.dbg	line,	"include\tables_OBJECT.c", 114; TYPE_POT,
 2632                        		.dbg	line,	"include\tables_OBJECT.c", 115; TYPE_POT,
 2633                        		.dbg	line,	"include\tables_OBJECT.c", 116; TYPE_POT,
 2634                        		.dbg	line,	"include\tables_OBJECT.c", 117; TYPE_POT,
 2635                        		.dbg	line,	"include\tables_OBJECT.c", 118; TYPE_POT,
 2636                        		.dbg	line,	"include\tables_OBJECT.c", 119; TYPE_POT,
 2637                        		.dbg	line,	"include\tables_OBJECT.c", 120; TYPE_POT,
 2638                        		.dbg	line,	"include\tables_OBJECT.c", 122; //
 2639                        		.dbg	line,	"include\tables_OBJECT.c", 123; TYPE_GRAY_KEY,
 2640                        		.dbg	line,	"include\tables_OBJECT.c", 124; TYPE_GRAY_KEY,
 2641                        		.dbg	line,	"include\tables_OBJECT.c", 125; TYPE_GRAY_KEY,
 2642                        		.dbg	line,	"include\tables_OBJECT.c", 126; TYPE_COIN_5,
 2643                        		.dbg	line,	"include\tables_OBJECT.c", 127; TYPE_GRAY_KEY
 2644                        		.dbg	line,	"include\tables_OBJECT.c", 128; };*/
 2645                        		.dbg	line,	"include\tables_OBJECT.c", 133; const signed int        TABLE_CHEST_X_POS_REF_LV1[CHEST_NUMBER_LV1]   =   {
 2646                        		.dbg	line,	"include\tables_OBJECT.c", 134; 1072,
 2647                        		.dbg	line,	"include\tables_OBJECT.c", 135; 816
 2648                        		.dbg	line,	"include\tables_OBJECT.c", 136; };
 2649                        		.dbg	line,	"include\tables_OBJECT.c", 139; const signed int        TABLE_CHEST_Y_POS_REF_LV1[CHEST_NUMBER_LV1]   =   {
 2650                        		.dbg	line,	"include\tables_OBJECT.c", 140; 832,
 2651                        		.dbg	line,	"include\tables_OBJECT.c", 141; 848
 2652                        		.dbg	line,	"main.c", 16; };
 2653                        		.dbg	line,	"main.c", 17; #include "include/tables_PLAYER.c"
 2654                        		.dbg	line,	"include\tables_PLAYER.c", 3; const unsigned char     *TABLE_PLAYER_TILES_ADR[2]     =   {
 2655                        		.dbg	line,	"include\tables_PLAYER.c", 4; &tiles_SPR_PLAYER_ARMOR,
 2656                        		.dbg	line,	"include\tables_PLAYER.c", 5; &tiles_SPR_PLAYER_NAKED
 2657                        		.dbg	line,	"include\tables_PLAYER.c", 6; };
 2658                        		.dbg	line,	"include\tables_PLAYER.c", 9; const unsigned char     TABLE_PLAYER_TILES_BANK[2]     =   {
 2659                        		.dbg	line,	"include\tables_PLAYER.c", 10; ^tiles_SPR_PLAYER_ARMOR,
 2660                        		.dbg	line,	"include\tables_PLAYER.c", 11; ^tiles_SPR_PLAYER_NAKED
 2661                        		.dbg	line,	"include\tables_PLAYER.c", 12; };
 2662                        		.dbg	line,	"include\tables_PLAYER.c", 15; const signed char       TABLE_PLAYER_JUMP_V[35]     =   {
 2663                        		.dbg	line,	"include\tables_PLAYER.c", 16; // UPWARD
 2664                        		.dbg	line,	"include\tables_PLAYER.c", 17; -4,
 2665                        		.dbg	line,	"include\tables_PLAYER.c", 18; -5,
 2666                        		.dbg	line,	"include\tables_PLAYER.c", 19; -10,
 2667                        		.dbg	line,	"include\tables_PLAYER.c", 20; -4,
 2668                        		.dbg	line,	"include\tables_PLAYER.c", 21; -4,
 2669                        		.dbg	line,	"include\tables_PLAYER.c", 22; -7,
 2670                        		.dbg	line,	"include\tables_PLAYER.c", 23; -6,
 2671                        		.dbg	line,	"include\tables_PLAYER.c", 24; -3,
 2672                        		.dbg	line,	"include\tables_PLAYER.c", 25; -5,
 2673                        		.dbg	line,	"include\tables_PLAYER.c", 26; -2,
 2674                        		.dbg	line,	"include\tables_PLAYER.c", 27; -4,
 2675                        		.dbg	line,	"include\tables_PLAYER.c", 28; -1,
 2676                        		.dbg	line,	"include\tables_PLAYER.c", 29; -1,
 2677                        		.dbg	line,	"include\tables_PLAYER.c", 30; -1,
 2678                        		.dbg	line,	"include\tables_PLAYER.c", 31; -1,
 2679                        		.dbg	line,	"include\tables_PLAYER.c", 32; 0,
 2680                        		.dbg	line,	"include\tables_PLAYER.c", 33; 0,
 2681                        		.dbg	line,	"include\tables_PLAYER.c", 34; 0,
 2682                        		.dbg	line,	"include\tables_PLAYER.c", 35; 0,
 2683                        		.dbg	line,	"include\tables_PLAYER.c", 36; // DOWNWARD
 2684                        		.dbg	line,	"include\tables_PLAYER.c", 37; 1,
 2685                        		.dbg	line,	"include\tables_PLAYER.c", 38; 1,
 2686                        		.dbg	line,	"include\tables_PLAYER.c", 39; 1,
 2687                        		.dbg	line,	"include\tables_PLAYER.c", 40; 1,
 2688                        		.dbg	line,	"include\tables_PLAYER.c", 41; 4,
 2689                        		.dbg	line,	"include\tables_PLAYER.c", 42; 2,
 2690                        		.dbg	line,	"include\tables_PLAYER.c", 43; 5,
 2691                        		.dbg	line,	"include\tables_PLAYER.c", 44; 3,
 2692                        		.dbg	line,	"include\tables_PLAYER.c", 45; 6,
 2693                        		.dbg	line,	"include\tables_PLAYER.c", 46; 7,
 2694                        		.dbg	line,	"include\tables_PLAYER.c", 47; 4,
 2695                        		.dbg	line,	"include\tables_PLAYER.c", 48; 4,
 2696                        		.dbg	line,	"include\tables_PLAYER.c", 49; 10,
 2697                        		.dbg	line,	"include\tables_PLAYER.c", 50; 4,
 2698                        		.dbg	line,	"include\tables_PLAYER.c", 51; 4,
 2699                        		.dbg	line,	"include\tables_PLAYER.c", 52; 5
 2700                        		.dbg	line,	"include\tables_PLAYER.c", 53; };
 2701                        		.dbg	line,	"include\tables_PLAYER.c", 56; const signed char       TABLE_PLAYER_FALL[21]       =   {
 2702                        		.dbg	line,	"include\tables_PLAYER.c", 57; 0,
 2703                        		.dbg	line,	"include\tables_PLAYER.c", 58; 0,
 2704                        		.dbg	line,	"include\tables_PLAYER.c", 59; 0,
 2705                        		.dbg	line,	"include\tables_PLAYER.c", 60; 0,
 2706                        		.dbg	line,	"include\tables_PLAYER.c", 61; 1,
 2707                        		.dbg	line,	"include\tables_PLAYER.c", 62; 1,
 2708                        		.dbg	line,	"include\tables_PLAYER.c", 63; 1,
 2709                        		.dbg	line,	"include\tables_PLAYER.c", 64; 1,
 2710                        		.dbg	line,	"include\tables_PLAYER.c", 65; 2,
 2711                        		.dbg	line,	"include\tables_PLAYER.c", 66; 2,
 2712                        		.dbg	line,	"include\tables_PLAYER.c", 67; 2,
 2713                        		.dbg	line,	"include\tables_PLAYER.c", 68; 2,
 2714                        		.dbg	line,	"include\tables_PLAYER.c", 69; 3,
 2715                        		.dbg	line,	"include\tables_PLAYER.c", 70; 3,
 2716                        		.dbg	line,	"include\tables_PLAYER.c", 71; 3,
 2717                        		.dbg	line,	"include\tables_PLAYER.c", 72; 4,
 2718                        		.dbg	line,	"include\tables_PLAYER.c", 73; 4,
 2719                        		.dbg	line,	"include\tables_PLAYER.c", 74; 4,
 2720                        		.dbg	line,	"include\tables_PLAYER.c", 75; 4,
 2721                        		.dbg	line,	"include\tables_PLAYER.c", 76; 4,
 2722                        		.dbg	line,	"include\tables_PLAYER.c", 77; 5
 2723                        		.dbg	line,	"include\tables_PLAYER.c", 78; };
 2724                        		.dbg	line,	"include\tables_PLAYER.c", 81; const signed char       TABLE_PLAYER_JUMP_LADDER[30]    =   {
 2725                        		.dbg	line,	"include\tables_PLAYER.c", 82; // UPWARD
 2726                        		.dbg	line,	"include\tables_PLAYER.c", 83; -4,
 2727                        		.dbg	line,	"include\tables_PLAYER.c", 84; -4,
 2728                        		.dbg	line,	"include\tables_PLAYER.c", 85; -3,
 2729                        		.dbg	line,	"include\tables_PLAYER.c", 86; -3,
 2730                        		.dbg	line,	"include\tables_PLAYER.c", 87; -3,
 2731                        		.dbg	line,	"include\tables_PLAYER.c", 88; -2,
 2732                        		.dbg	line,	"include\tables_PLAYER.c", 89; -2,
 2733                        		.dbg	line,	"include\tables_PLAYER.c", 90; -2,
 2734                        		.dbg	line,	"include\tables_PLAYER.c", 91; -1,
 2735                        		.dbg	line,	"include\tables_PLAYER.c", 92; -1,
 2736                        		.dbg	line,	"include\tables_PLAYER.c", 93; -1,
 2737                        		.dbg	line,	"include\tables_PLAYER.c", 94; -1,
 2738                        		.dbg	line,	"include\tables_PLAYER.c", 95; -1,
 2739                        		.dbg	line,	"include\tables_PLAYER.c", 96; 0,
 2740                        		.dbg	line,	"include\tables_PLAYER.c", 97; 0,
 2741                        		.dbg	line,	"include\tables_PLAYER.c", 98; 0,
 2742                        		.dbg	line,	"include\tables_PLAYER.c", 99; 0,
 2743                        		.dbg	line,	"include\tables_PLAYER.c", 100; // DOWNWARD
 2744                        		.dbg	line,	"include\tables_PLAYER.c", 101; 1,
 2745                        		.dbg	line,	"include\tables_PLAYER.c", 102; 1,
 2746                        		.dbg	line,	"include\tables_PLAYER.c", 103; 1,
 2747                        		.dbg	line,	"include\tables_PLAYER.c", 104; 1,
 2748                        		.dbg	line,	"include\tables_PLAYER.c", 105; 1,
 2749                        		.dbg	line,	"include\tables_PLAYER.c", 106; 2,
 2750                        		.dbg	line,	"include\tables_PLAYER.c", 107; 2,
 2751                        		.dbg	line,	"include\tables_PLAYER.c", 108; 2,
 2752                        		.dbg	line,	"include\tables_PLAYER.c", 109; 3,
 2753                        		.dbg	line,	"include\tables_PLAYER.c", 110; 3,
 2754                        		.dbg	line,	"include\tables_PLAYER.c", 111; 3,
 2755                        		.dbg	line,	"include\tables_PLAYER.c", 112; 4,
 2756                        		.dbg	line,	"include\tables_PLAYER.c", 113; 4
 2757                        		.dbg	line,	"main.c", 17; };
 2758                        		.dbg	line,	"main.c", 18; #include "include/tables_SHOP.c"
 2759                        		.dbg	line,	"include\tables_SHOP.c", 1; //-----------------------------------------------------------------------------//
 2760                        		.dbg	line,	"include\tables_SHOP.c", 2; //                                                                             //
 2761                        		.dbg	line,	"include\tables_SHOP.c", 3; //                                   LEVEL 1                                   //
 2762                        		.dbg	line,	"include\tables_SHOP.c", 4; //                                                                             //
 2763                        		.dbg	line,	"include\tables_SHOP.c", 5; //-----------------------------------------------------------------------------//
 2764                        		.dbg	line,	"include\tables_SHOP.c", 7; const char              TABLE_SHOP_ITEMS_LV1[10]        =   {
 2765                        		.dbg	line,	"include\tables_SHOP.c", 8; TYPE_ITEM_WEAPON_2,
 2766                        		.dbg	line,	"include\tables_SHOP.c", 9; TYPE_ITEM_WEAPON_3,
 2767                        		.dbg	line,	"include\tables_SHOP.c", 10; TYPE_ITEM_WEAPON_4,
 2768                        		.dbg	line,	"include\tables_SHOP.c", 11; TYPE_ITEM_WEAPON_5,
 2769                        		.dbg	line,	"include\tables_SHOP.c", 12; TYPE_ITEM_KEY,
 2770                        		.dbg	line,	"include\tables_SHOP.c", 14; TYPE_ITEM_ARMOR_2,
 2771                        		.dbg	line,	"include\tables_SHOP.c", 15; TYPE_ITEM_ARMOR_3,
 2772                        		.dbg	line,	"include\tables_SHOP.c", 16; TYPE_ITEM_ARMOR_4,
 2773                        		.dbg	line,	"include\tables_SHOP.c", 17; TYPE_ITEM_ARMOR_5,
 2774                        		.dbg	line,	"include\tables_SHOP.c", 18; TYPE_ITEM_POTION
 2775                        		.dbg	line,	"include\tables_SHOP.c", 19; };
 2776                        		.dbg	line,	"include\tables_SHOP.c", 22; const int               TABLE_SHOP_PRICES_LV1[10]       =   {
 2777                        		.dbg	line,	"include\tables_SHOP.c", 23; 100,
 2778                        		.dbg	line,	"include\tables_SHOP.c", 24; 1000,
 2779                        		.dbg	line,	"include\tables_SHOP.c", 25; 2400,
 2780                        		.dbg	line,	"include\tables_SHOP.c", 26; 9600,
 2781                        		.dbg	line,	"include\tables_SHOP.c", 27; 30,
 2782                        		.dbg	line,	"include\tables_SHOP.c", 28; 80,
 2783                        		.dbg	line,	"include\tables_SHOP.c", 29; 300,
 2784                        		.dbg	line,	"include\tables_SHOP.c", 30; 800,
 2785                        		.dbg	line,	"include\tables_SHOP.c", 31; 1600,
 2786                        		.dbg	line,	"include\tables_SHOP.c", 32; 150
 2787                        		.dbg	line,	"include\tables_SHOP.c", 33; };
 2788                        		.dbg	line,	"include\tables_SHOP.c", 36; const unsigned char     *TABLE_SHOP_ITEMS_TILES_ADR[10]     =   {
 2789                        		.dbg	line,	"include\tables_SHOP.c", 37; &tiles_ITEM_WEAPON_2,
 2790                        		.dbg	line,	"include\tables_SHOP.c", 38; &tiles_ITEM_WEAPON_3,
 2791                        		.dbg	line,	"include\tables_SHOP.c", 39; &tiles_ITEM_WEAPON_4,
 2792                        		.dbg	line,	"include\tables_SHOP.c", 40; &tiles_ITEM_WEAPON_5,
 2793                        		.dbg	line,	"include\tables_SHOP.c", 41; &tiles_ITEM_KEY,
 2794                        		.dbg	line,	"include\tables_SHOP.c", 42; &tiles_ITEM_ARMOR_2,
 2795                        		.dbg	line,	"include\tables_SHOP.c", 43; &tiles_ITEM_ARMOR_3,
 2796                        		.dbg	line,	"include\tables_SHOP.c", 44; &tiles_ITEM_ARMOR_4,
 2797                        		.dbg	line,	"include\tables_SHOP.c", 45; &tiles_ITEM_ARMOR_5,
 2798                        		.dbg	line,	"include\tables_SHOP.c", 46; &tiles_ITEM_POTION
 2799                        		.dbg	line,	"include\tables_SHOP.c", 47; };
 2800                        		.dbg	line,	"include\tables_SHOP.c", 50; const unsigned char     TABLE_SHOP_ITEMS_TILES_BANK[10]     =   {
 2801                        		.dbg	line,	"include\tables_SHOP.c", 51; ^tiles_ITEM_WEAPON_2,
 2802                        		.dbg	line,	"include\tables_SHOP.c", 52; ^tiles_ITEM_WEAPON_3,
 2803                        		.dbg	line,	"include\tables_SHOP.c", 53; ^tiles_ITEM_WEAPON_4,
 2804                        		.dbg	line,	"include\tables_SHOP.c", 54; ^tiles_ITEM_WEAPON_5,
 2805                        		.dbg	line,	"include\tables_SHOP.c", 55; ^tiles_ITEM_KEY,
 2806                        		.dbg	line,	"include\tables_SHOP.c", 56; ^tiles_ITEM_ARMOR_2,
 2807                        		.dbg	line,	"include\tables_SHOP.c", 57; ^tiles_ITEM_ARMOR_3,
 2808                        		.dbg	line,	"include\tables_SHOP.c", 58; ^tiles_ITEM_ARMOR_4,
 2809                        		.dbg	line,	"include\tables_SHOP.c", 59; ^tiles_ITEM_ARMOR_5,
 2810                        		.dbg	line,	"include\tables_SHOP.c", 60; ^tiles_ITEM_POTION
 2811                        		.dbg	line,	"include\tables_SHOP.c", 61; };
 2812                        		.dbg	line,	"include\tables_SHOP.c", 64; const char              TABLE_CURSOR_POS_X[11]              =   {
 2813                        		.dbg	line,	"include\tables_SHOP.c", 65; 24,
 2814                        		.dbg	line,	"include\tables_SHOP.c", 66; 56,
 2815                        		.dbg	line,	"include\tables_SHOP.c", 67; 96,
 2816                        		.dbg	line,	"include\tables_SHOP.c", 68; 136,
 2817                        		.dbg	line,	"include\tables_SHOP.c", 69; 176,
 2818                        		.dbg	line,	"include\tables_SHOP.c", 70; 24,
 2819                        		.dbg	line,	"include\tables_SHOP.c", 71; 56,
 2820                        		.dbg	line,	"include\tables_SHOP.c", 72; 96,
 2821                        		.dbg	line,	"include\tables_SHOP.c", 73; 136,
 2822                        		.dbg	line,	"include\tables_SHOP.c", 74; 176,
 2823                        		.dbg	line,	"include\tables_SHOP.c", 75; 212
 2824                        		.dbg	line,	"include\tables_SHOP.c", 76; };
 2825                        		.dbg	line,	"main.c", 22; #include "include/routines_LEVELS.c"
 2826                        		.dbg	line,	"include\routines_LEVELS.c", 1; #include "huc.h"
 2827                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 1; #ifndef _hucc_legacy_h
 2828                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 2; #define _hucc_legacy_h
 2829                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 4; /****************************************************************************
 2830                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 5; ; ***************************************************************************
 2831                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 6; ;
 2832                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 7; ; huc.h
 2833                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 8; ;
 2834                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 9; ; HuCC wrapper file to include a default set of HuC-compatible functions.
 2835                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 10; ;
 2836                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 11; ; Copyright John Brandwood 2024.
 2837                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 12; ;
 2838                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 2839                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 2840                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 2841                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 16; ;
 2842                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 17; ; ***************************************************************************
 2843                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 18; ; ***************************************************************************
 2844                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 19; ;
 2845                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 20; ; When the HuCC compiler is invoked with the "--legacy" option to compile old
 2846                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 21; ; projects, then this "huc.h" file is automatically included.
 2847                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 22; ;
 2848                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 23; ; This file includes a set of the individual HuCC headers which correspond to
 2849                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 24; ; HuC's built-in functions and MagicKit library.
 2850                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 25; ;
 2851                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 26; ; New HuCC projects should, preferably, include the specific headers that are
 2852                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 27; ; needed, which will then allow them to replace parts of the standard library
 2853                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 28; ; with newer functions, or they can just manually include this "huc.h" file.
 2854                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 29; ;
 2855                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 30; ; ***************************************************************************
 2856                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 31; ; **************************************************************************/
 2857                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 33; #include "hucc-systemcard.h"
 2858                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 34; #include "hucc-baselib.h"
 2859                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 35; #include "hucc-gfx.h"
 2860                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 36; #include "hucc-string.h"
 2861                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 37; #include "hucc-old-scroll.h"
 2862                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 38; #include "hucc-old-spr.h"
 2863                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 39; #include "hucc-old-map.h"
 2864                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 40; #include "hucc-old-line.h"
 2865                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 42; #endif // _hucc_legacy_h
 2866                        		.dbg	line,	"include\routines_LEVELS.c", 2; #include "hucc-scroll.h"
 2867                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 1; #ifndef _hucc_scroll_h
 2868                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 2; #define _hucc_scroll_h
 2869                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 4; /****************************************************************************
 2870                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 5; ; ***************************************************************************
 2871                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 6; ;
 2872                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 7; ; hucc-scroll.h
 2873                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 8; ;
 2874                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 9; ; Routines for a fast split-screen scrolling system.
 2875                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 10; ;
 2876                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 11; ; Copyright John Brandwood 2024.
 2877                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 12; ;
 2878                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 2879                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 2880                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 2881                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 16; ;
 2882                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 17; ; ***************************************************************************
 2883                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 18; ; ***************************************************************************
 2884                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 19; ;
 2885                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 20; ; The maximum number of splits for each screen layer is set in your project's
 2886                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 21; ; "hucc-config.inc" file, with the library having a limit of 128-per-layer.
 2887                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 22; ;
 2888                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 23; ; Your first active split must be defined to start at screen line 0, and then
 2889                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 24; ; the rest of the active splits must be in increasing line order to match the
 2890                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 25; ; way that the PC Engine displays the output image.
 2891                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 26; ;
 2892                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 27; ; You can have disabled splits interleaved with your active splits.
 2893                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 28; ;
 2894                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 29; ; Splits that are normally disabled can be used to create full screen effects
 2895                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 30; ; such as bouncing the screen up and down by adding blank areas at the top or
 2896                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 31; ; bottom of the screen, and then rapidly changing the height of those areas.
 2897                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 32; ;
 2898                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 33; ; ***************************************************************************
 2899                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 34; ; **************************************************************************/
 2900                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 36; // *************
 2901                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 37; // VDC bits for display_flags ...
 2902                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 38; // *************
 2903                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 40; #ifndef BKG_OFF
 2904                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 41; #define BKG_OFF 0x00
 2905                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 42; #endif
 2906                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 44; #ifndef SPR_OFF
 2907                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 45; #define SPR_OFF 0x00
 2908                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 46; #endif
 2909                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 48; #ifndef BKG_ON
 2910                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 49; #define BKG_ON 0x80
 2911                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 50; #endif
 2912                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 52; #ifndef SPR_ON
 2913                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 53; #define SPR_ON 0x40
 2914                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 54; #endif
 2915                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 56; // *************
 2916                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 57; // Functions in hucc-scroll.asm ...
 2917                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 58; // *************
 2918                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 60; #ifdef __HUCC__
 2919                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 62; #asmdef	HUCC_USES_NEW_SCROLL 1
 2920                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 64; extern void __fastcall scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
 2921                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 65; extern void __fastcall sgx_scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
 2922                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 67; extern void __fastcall disable_split( unsigned char index<acc> );
 2923                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 68; extern void __fastcall sgx_disable_split( unsigned char index<acc> );
 2924                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 70; extern void __fastcall __macro disable_all_splits( void );
 2925                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 71; extern void __fastcall __macro sgx_disable_all_splits( void );
 2926                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 73; #asm
 2927                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 74; .macro	_disable_all_splits
 2928                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 75; ldy	#HUCC_PCE_SPLITS - 1
 2929                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 76; !loop:		tya
 2930                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 77; call	_disable_split.1
 2931                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 78; dey
 2932                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 79; bpl	!loop-
 2933                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 80; .endm
 2934                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 82; .macro	_sgx_disable_all_splits
 2935                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 83; ldy	#HUCC_SGX_SPLITS - 1
 2936                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 84; !loop:		tya
 2937                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 85; call	_sgx_disable_split.1
 2938                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 86; dey
 2939                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 87; bpl	!loop-
 2940                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 88; .endm
 2941                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 89; #endasm
 2942                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 91; #endif // __HUCC__
 2943                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 93; #endif // _hucc_scroll_h
 2944                        		.dbg	line,	"include\routines_LEVELS.c", 3; #include "hucc-chrmap.h"
 2945                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 1; #ifndef _hucc_chrmap_h
 2946                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 2; #define _hucc_chrmap_h
 2947                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 4; /****************************************************************************
 2948                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 5; ; ***************************************************************************
 2949                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 6; ;
 2950                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 7; ; hucc-chrmap.h
 2951                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 8; ;
 2952                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 9; ; A simple map system based on 8x8 characters (aka "tiles") in BAT format.
 2953                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 10; ;
 2954                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 11; ; Copyright John Brandwood 2025.
 2955                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 12; ;
 2956                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 2957                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 2958                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 2959                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 16; ;
 2960                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 17; ; ***************************************************************************
 2961                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 18; ; ***************************************************************************
 2962                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 19; ;
 2963                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 20; ; The maximum X and Y size for chrmaps is 256 characters (2048 pixels).
 2964                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 21; ;
 2965                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 22; ; The maximum total size for a chrmap is 16KBytes, which allows for maps up
 2966                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 23; ; to 256x32 tiles (2048x256 pixels).
 2967                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 24; ;
 2968                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 25; ; ***************************************************************************
 2969                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 26; ; **************************************************************************/
 2970                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 28; // *************
 2971                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 29; // This code extends the blkmap library ...
 2972                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 30; // *************
 2973                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 32; #include "hucc-blkmap.h"
 2974                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 34; // *************
 2975                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 35; // Functions in chrmap.asm ...
 2976                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 36; // *************
 2977                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 38; #ifdef __HUCC__
 2978                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 40; #asmdef	HUCC_USES_CHRMAP 1
 2979                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 42; extern void __fastcall __nop set_chrmap( unsigned char __far *chrmap<vdc_map_bank:vdc_map_addr>, unsigned char tiles_w<vdc_map_line_w> );
 2980                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 44; extern void __fastcall draw_bat( void );
 2981                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 45; extern void __fastcall scroll_bat( void );
 2982                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 47; extern void __fastcall blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 2983                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 49; #ifdef _SGX
 2984                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 51; extern void __fastcall __nop sgx_set_chrmap( unsigned char __far *chrmap<sgx_map_bank:sgx_map_addr>, unsigned char tiles_w<sgx_map_line_w> );
 2985                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 53; extern void __fastcall sgx_draw_bat( void );
 2986                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 54; extern void __fastcall sgx_scroll_bat( void );
 2987                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 56; extern void __fastcall sgx_blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 2988                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 58; #endif
 2989                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 60; #endif // __HUCC__
 2990                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 62; #endif // _hucc_chrmap_h
 2991                        		.dbg	line,	"include\routines_LEVELS.c", 4; #include "hucc-blkmap.h"
 2992                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 1; #ifndef _hucc_blkmap_h
 2993                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 2; #define _hucc_blkmap_h
 2994                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 4; /****************************************************************************
 2995                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 5; ; ***************************************************************************
 2996                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 6; ;
 2997                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 7; ; hucc-blkmap.h
 2998                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 8; ;
 2999                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 9; ; A map system based on 16x16 meta-tiles (aka "blocks", aka CHR/BLK/MAP).
 3000                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 10; ;
 3001                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 11; ; Copyright John Brandwood 2025.
 3002                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 12; ;
 3003                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 3004                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 3005                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 3006                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 16; ;
 3007                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 17; ; ***************************************************************************
 3008                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 18; ; ***************************************************************************
 3009                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 19; ;
 3010                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 20; ; The maximum X and Y size for blkmaps is 128 blocks (2048 pixels).
 3011                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 21; ;
 3012                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 22; ; The maximum total size for a blkmap is 16KBytes, which allows for maps up
 3013                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 23; ; to 128x128 blocks (2048x2048 pixels).
 3014                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 24; ;
 3015                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 25; ; Huge multi-screen blkmaps are also supported (optionally).
 3016                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 26; ;
 3017                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 27; ; The maximum X and Y for multi-screen maps is 128 screens (32768 pixels).
 3018                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 28; ;
 3019                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 29; ; The maximum total size for a multi-screen map is 8KBytes, which allows for
 3020                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 30; ; a total of 1024 screens.
 3021                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 31; ;
 3022                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 32; ; ***************************************************************************
 3023                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 33; ; **************************************************************************/
 3024                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 35; // *************
 3025                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 36; // Functions in blkmap.asm ...
 3026                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 37; // *************
 3027                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 39; #ifdef __HUCC__
 3028                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 41; #asmdef	HUCC_USES_BLKMAP 1
 3029                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 43; // Current top-left of drawn map in pixels.
 3030                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 44; extern unsigned int   vdc_map_pxl_x;
 3031                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 45; extern unsigned int   vdc_map_pxl_y;
 3032                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 47; // Width and height to draw/scroll in characters (not tiles).
 3033                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 48; extern unsigned char  vdc_map_draw_w;
 3034                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 49; extern unsigned char  vdc_map_draw_h;
 3035                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 51; // Width of map (or multi-screen BAT) in tiles.
 3036                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 52; extern unsigned char  vdc_map_line_w;
 3037                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 54; // Width of map in screens (if multi-screen map).
 3038                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 55; extern unsigned char  vdc_map_scrn_w;
 3039                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 57; // Extra information returned by get_map_block() and sgx_get_map_block(),
 3040                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 58; // which are the collision flags and the mask/overlay sprite for the BLK.
 3041                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 59; extern unsigned char  map_blk_flag;
 3042                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 60; extern unsigned char  map_blk_mask;
 3043                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 62; extern unsigned char  vdc_scr_bank;
 3044                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 63; extern unsigned char *vdc_scr_addr;
 3045                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 65; extern unsigned char  vdc_map_bank;
 3046                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 66; extern unsigned char *vdc_map_addr;
 3047                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 68; extern unsigned char  vdc_blk_bank;
 3048                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 69; extern unsigned char *vdc_blk_addr;
 3049                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 71; extern unsigned char  vdc_tbl_bank;
 3050                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 72; extern unsigned char *vdc_tbl_addr;
 3051                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 74; extern void __fastcall set_blocks( unsigned char __far *blk_def<vdc_blk_bank:vdc_blk_addr>, unsigned char __far *flg_def<vdc_tbl_bank:vdc_tbl_addr>, unsigned char number_of_blocks<_al> );
 3052                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 75; extern void __fastcall __macro set_blkmap( unsigned char __far *blk_map<vdc_map_bank:vdc_map_addr>, unsigned char blocks_w<vdc_map_line_w> );
 3053                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 76; extern void __fastcall __macro set_multimap( unsigned char __far *multi_map<vdc_scr_bank:vdc_scr_addr>, unsigned char screens_w<vdc_map_scrn_w> );
 3054                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 78; extern void __fastcall draw_map( void );
 3055                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 79; extern void __fastcall scroll_map( void );
 3056                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 81; extern void __fastcall blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 3057                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 83; extern unsigned char __fastcall get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
 3058                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 85; #asm
 3059                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 86; .macro	_set_blkmap.2
 3060                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 87; stz	vdc_scr_bank
 3061                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 88; .endm
 3062                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 90; .macro	_set_multimap.2
 3063                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 91; lda	vdc_bat_width
 3064                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 92; lsr	a
 3065                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 93; sta	vdc_map_line_w
 3066                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 94; .endm
 3067                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 96; .macro	SCREEN
 3068                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 97; db	(((\1) & $1FFF) | $6000) >> 8, bank(\1)
 3069                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 98; db	(((\2) & $1FFF) | $4000) >> 8, bank(\2)
 3070                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 99; db	(((\3) & $1FFF) | $6000) >> 8, bank(\3)
 3071                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 100; dw	(\4)
 3072                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 101; .endm
 3073                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 102; #endasm
 3074                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 104; #ifdef _SGX
 3075                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 106; // Current top-left of drawn map in pixels.
 3076                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 107; extern unsigned int   sgx_map_pxl_x;
 3077                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 108; extern unsigned int   sgx_map_pxl_y;
 3078                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 110; // Width and height to draw/scroll in characters (not tiles).
 3079                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 111; extern unsigned char  sgx_map_draw_w;
 3080                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 112; extern unsigned char  sgx_map_draw_h;
 3081                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 114; // Width of map (or multi-screen BAT) in tiles.
 3082                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 115; extern unsigned char  sgx_map_line_w;
 3083                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 117; // Width of map in screens (if multi-screen map).
 3084                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 118; extern unsigned char  sgx_map_scrn_w;
 3085                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 120; extern unsigned char  sgx_scr_bank;
 3086                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 121; extern unsigned char *sgx_scr_addr;
 3087                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 123; extern unsigned char  sgx_map_bank;
 3088                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 124; extern unsigned char *sgx_map_addr;
 3089                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 126; extern unsigned char  sgx_blk_bank;
 3090                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 127; extern unsigned char *sgx_blk_addr;
 3091                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 129; extern unsigned char  sgx_tbl_bank;
 3092                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 130; extern unsigned char *sgx_tbl_addr;
 3093                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 132; extern void __fastcall sgx_set_blocks( unsigned char __far *blk_def<sgx_blk_bank:sgx_blk_addr>, unsigned char __far *flg_def<sgx_tbl_bank:sgx_tbl_addr>, unsigned char number_of_blocks<_al> );
 3094                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 133; extern void __fastcall __macro sgx_set_blkmap( unsigned char __far *blk_map<sgx_map_bank:sgx_map_addr>, unsigned char blocks_w<sgx_map_line_w> );
 3095                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 134; extern void __fastcall __macro sgx_set_multimap( unsigned char __far *multi_map<sgx_scr_bank:sgx_scr_addr>, unsigned char screens_w<sgx_map_scrn_w> );
 3096                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 136; extern void __fastcall sgx_draw_map( void );
 3097                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 137; extern void __fastcall sgx_scroll_map( void );
 3098                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 139; extern void __fastcall sgx_blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 3099                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 141; extern unsigned char __fastcall sgx_get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
 3100                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 143; #asm
 3101                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 144; .macro	_sgx_set_blkmap.2
 3102                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 145; stz	sgx_scr_bank
 3103                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 146; .endm
 3104                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 148; .macro	_sgx_set_multimap.2
 3105                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 149; lda	sgx_bat_width
 3106                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 150; lsr	a
 3107                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 151; sta	sgx_map_line_w
 3108                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 152; .endm
 3109                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 153; #endasm
 3110                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 155; #endif
 3111                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 157; #endif // __HUCC__
 3112                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 159; #endif // _hucc_blkmap_h
 3113                        		.dbg	line,	"include\routines_LEVELS.c", 13; void hide_LEVEL_SPRITES()
 3114                        		.dbg	line,	"include\routines_LEVELS.c", 14; {
 3115                        	;***********************
 3116                        	;***********************
 3117                        	
 3118                        		.hucc
 3119    02:DDE8             		.proc		_hide_LEVEL_SPRITES
 3120                        		__enter		_hide_LEVEL_SPRITES
 3121                        	
 3122                        		.dbg	line,	"include\routines_LEVELS.c", 15; char i;
 3123                        	
 3124                        		.dbg	line,	"include\routines_LEVELS.c", 17; for(i=0 ; i<64 ; i++)
 3125                        		__st.umiq	0, __hide_LEVEL_SPRITES_end - 1  /* i */
         02:DDE8  9C 45 26   			stz	__hide_LEVEL_SPRITES_end - 1
 3126    02:DDEB             	.LL3:
 3127                        		__ld.umq	__hide_LEVEL_SPRITES_end - 1  /* i */
         02:DDEB  AD 45 26   			lda	__hide_LEVEL_SPRITES_end - 1
 3128                        		__ult_b.uiq	64
         02:DDEE  C9 40      			cmp	#64		; Subtract integer from A.
         02:DDF0  6A         			ror	a		; CC if A < integer.
         02:DDF1  49 80      			eor	#$80
         02:DDF3  2A         			rol	a
 3129                        		__btrue		.LL5
         02:DDF4  B0 07      			bcs	.LL5
 3130                        		__bra		.LL6
         02:DDF6  80 10      			bra	.LL6
 3131    02:DDF8             	.LL4:
 3132                        		__inc.umq	__hide_LEVEL_SPRITES_end - 1  /* i */
         02:DDF8  EE 45 26   			inc	__hide_LEVEL_SPRITES_end - 1
 3133                        		__bra		.LL3
         02:DDFB  80 EE      			bra	.LL3
 3134    02:DDFD             	.LL5:
 3135                        	
 3136                        		.dbg	line,	"include\routines_LEVELS.c", 18; {
 3137                        	
 3138                        		.dbg	line,	"include\routines_LEVELS.c", 19; spr_set(i);
 3139                        		__ld.umq	__hide_LEVEL_SPRITES_end - 1  /* i */
         02:DDFD  AD 45 26   			lda	__hide_LEVEL_SPRITES_end - 1
 3140                        		__call		_spr_set.1
         02:DE00  20 DD E7   			call	_spr_set.1
 3141                        	
 3142                        		.dbg	line,	"include\routines_LEVELS.c", 20; spr_hide();
 3143                        		__call		_spr_hide
         02:DE03  20 F8 E7   			call	_spr_hide
 3144                        	
 3145                        		.dbg	line,	"include\routines_LEVELS.c", 21; }
 3146                        		__bra		.LL4
         02:DE06  80 F0      			bra	.LL4
 3147    02:DE08             	.LL6:
 3148                        	
 3149                        		.dbg	line,	"include\routines_LEVELS.c", 22; }
 3150    02:DE08             	.LL2:
 3151                        		__return	0
         02:DE08  4C EF FF   			jmp	leave_proc
 3152                        		.dbg	clear
 3153                        		.endp
 3154                        		.pceas
 3155                        	
 3156                        		.dbg	line,	"include\routines_LEVELS.c", 27; void display_LIFE()
 3157                        		.dbg	line,	"include\routines_LEVELS.c", 28; {
 3158                        	;***********************
 3159                        	;***********************
 3160                        	
 3161                        		.hucc
 3162                        		.proc		_display_LIFE
 3171                        		.endp
 3172                        		.pceas
 3173                        	
 3174                        		.dbg	line,	"include\routines_LEVELS.c", 33; void display_SCORE()
 3175                        		.dbg	line,	"include\routines_LEVELS.c", 34; {
 3176                        	;***********************
 3177                        	;***********************
 3178                        	
 3179                        		.hucc
 3180    02:DE0B             		.proc		_display_SCORE
 3181                        		__enter		_display_SCORE
 3182                        	
 3183                        		.dbg	line,	"include\routines_LEVELS.c", 35; put_number(score,6,14,1);
 3184                        		__ld.wm		_score
         02:DE0B  AD 2A 26   			lda.l	_score
         02:DE0E  AC 2B 26   			ldy.h	_score
 3185                        		__st.wmq	_bx
         02:DE11  85 FA      			sta.l	_bx
         02:DE13  84 FB      			sty.h	_bx
 3186                        		__st.umiq	6, _cl
         02:DE15  A9 06      			lda.l	#6
         02:DE17  85 FC      			sta	_cl
 3187                        		__st.umiq	14, _dil
         02:DE19  A9 0E      			lda.l	#14
         02:DE1B  85 F0      			sta	_dil
 3188                        		__st.umiq	1, _dih
         02:DE1D  A9 01      			lda.l	#1
         02:DE1F  85 F1      			sta	_dih
 3189                        		__call		_put_number.4
         02:DE21  20 9F FF   			call	_put_number.4
 3190                        	
 3191                        		.dbg	line,	"include\routines_LEVELS.c", 36; }
 3192    02:DE24             	.LL8:
 3193                        		__return	0
         02:DE24  4C EF FF   			jmp	leave_proc
 3194                        		.dbg	clear
 3195                        		.endp
 3196                        		.pceas
 3197                        	
 3198                        		.dbg	line,	"include\routines_LEVELS.c", 39; void display_TIME_LEVEL()
 3199                        		.dbg	line,	"include\routines_LEVELS.c", 40; {
 3200                        	;***********************
 3201                        	;***********************
 3202                        	
 3203                        		.hucc
 3204    02:D792             		.proc		_display_TIME_LEVEL
 3205                        		__enter		_display_TIME_LEVEL
 3206                        	
 3207                        		.dbg	line,	"include\routines_LEVELS.c", 41; put_number(minutes,1,1,3);
 3208                        		__ld.um		_minutes
         02:D792  AD 24 23   			lda	_minutes
         02:D795  C2         			cly
 3209                        		__st.wmq	_bx
         02:D796  85 FA      			sta.l	_bx
         02:D798  84 FB      			sty.h	_bx
 3210                        		__st.umiq	1, _cl
         02:D79A  A9 01      			lda.l	#1
         02:D79C  85 FC      			sta	_cl
 3211                        		__st.umiq	1, _dil
         02:D79E  A9 01      			lda.l	#1
         02:D7A0  85 F0      			sta	_dil
 3212                        		__st.umiq	3, _dih
         02:D7A2  A9 03      			lda.l	#3
         02:D7A4  85 F1      			sta	_dih
 3213                        		__call		_put_number.4
         02:D7A6  20 9F FF   			call	_put_number.4
 3214                        	
 3215                        		.dbg	line,	"include\routines_LEVELS.c", 43; if(seconds < 10)
 3216                        		__ld.umq	_seconds
         02:D7A9  AD 25 23   			lda	_seconds
 3217                        		__ult_b.uiq	10
         02:D7AC  C9 0A      			cmp	#10		; Subtract integer from A.
         02:D7AE  6A         			ror	a		; CC if A < integer.
         02:D7AF  49 80      			eor	#$80
         02:D7B1  2A         			rol	a
 3218                        		__bfalse	.LL10
         02:D7B2  90 2C      			bcc	.LL10
 3219                        	
 3220                        		.dbg	line,	"include\routines_LEVELS.c", 44; {
 3221                        	
 3222                        		.dbg	line,	"include\routines_LEVELS.c", 45; put_number(0,1,3,3);
 3223                        		__st.wmiq	0, _bx
         02:D7B4  64 FA      			stz.l	_bx
         02:D7B6  64 FB      			stz.h	_bx
 3224                        		__st.umiq	1, _cl
         02:D7B8  A9 01      			lda.l	#1
         02:D7BA  85 FC      			sta	_cl
 3225                        		__st.umiq	3, _dil
         02:D7BC  A9 03      			lda.l	#3
         02:D7BE  85 F0      			sta	_dil
 3226                        		__st.umiq	3, _dih
         02:D7C0  A9 03      			lda.l	#3
         02:D7C2  85 F1      			sta	_dih
 3227                        		__call		_put_number.4
         02:D7C4  20 9F FF   			call	_put_number.4
 3228                        	
 3229                        		.dbg	line,	"include\routines_LEVELS.c", 46; put_number(seconds,1,4,3);
 3230                        		__ld.um		_seconds
         02:D7C7  AD 25 23   			lda	_seconds
         02:D7CA  C2         			cly
 3231                        		__st.wmq	_bx
         02:D7CB  85 FA      			sta.l	_bx
         02:D7CD  84 FB      			sty.h	_bx
 3232                        		__st.umiq	1, _cl
         02:D7CF  A9 01      			lda.l	#1
         02:D7D1  85 FC      			sta	_cl
 3233                        		__st.umiq	4, _dil
         02:D7D3  A9 04      			lda.l	#4
         02:D7D5  85 F0      			sta	_dil
 3234                        		__st.umiq	3, _dih
         02:D7D7  A9 03      			lda.l	#3
         02:D7D9  85 F1      			sta	_dih
 3235                        		__call		_put_number.4
         02:D7DB  20 9F FF   			call	_put_number.4
 3236                        	
 3237                        		.dbg	line,	"include\routines_LEVELS.c", 47; }
 3238                        	
 3239                        		.dbg	line,	"include\routines_LEVELS.c", 49; else
 3240                        		__bra		.LL11
         02:D7DE  80 17      			bra	.LL11
 3241    02:D7E0             	.LL10:
 3242                        	
 3243                        		.dbg	line,	"include\routines_LEVELS.c", 50; {
 3244                        	
 3245                        		.dbg	line,	"include\routines_LEVELS.c", 51; put_number(seconds,2,3,3);
 3246                        		__ld.um		_seconds
         02:D7E0  AD 25 23   			lda	_seconds
         02:D7E3  C2         			cly
 3247                        		__st.wmq	_bx
         02:D7E4  85 FA      			sta.l	_bx
         02:D7E6  84 FB      			sty.h	_bx
 3248                        		__st.umiq	2, _cl
         02:D7E8  A9 02      			lda.l	#2
         02:D7EA  85 FC      			sta	_cl
 3249                        		__st.umiq	3, _dil
         02:D7EC  A9 03      			lda.l	#3
         02:D7EE  85 F0      			sta	_dil
 3250                        		__st.umiq	3, _dih
         02:D7F0  A9 03      			lda.l	#3
         02:D7F2  85 F1      			sta	_dih
 3251                        		__call		_put_number.4
         02:D7F4  20 9F FF   			call	_put_number.4
 3252                        	
 3253                        		.dbg	line,	"include\routines_LEVELS.c", 52; }
 3254    02:D7F7             	.LL11:
 3255                        	
 3256                        		.dbg	line,	"include\routines_LEVELS.c", 54; time_counter += 1;
 3257                        		__add_st.umiq	1, _time_counter
         02:D7F7  EE 26 23   			inc	_time_counter
 3258                        	
 3259                        		.dbg	line,	"include\routines_LEVELS.c", 56; if(time_counter == 60)
 3260                        		__ld.umq	_time_counter
         02:D7FA  AD 26 23   			lda	_time_counter
 3261                        		__equ_b.uiq	60
         02:D7FD  C9 3C      			cmp	#60
         02:D7FF  F0 01      			beq	!+
         02:D801  18         			clc
         02:D802             	!:
 3262                        		__bfalse	.LL12
         02:D802  90 28      			bcc	.LL12
 3263                        	
 3264                        		.dbg	line,	"include\routines_LEVELS.c", 57; {
 3265                        	
 3266                        		.dbg	line,	"include\routines_LEVELS.c", 58; time_counter = 0;
 3267                        		__st.umiq	0, _time_counter
         02:D804  9C 26 23   			stz	_time_counter
 3268                        	
 3269                        		.dbg	line,	"include\routines_LEVELS.c", 60; if(seconds > 0)
 3270                        		__ld.umq	_seconds
         02:D807  AD 25 23   			lda	_seconds
 3271                        		__ugt_b.uiq	0
         02:D80A  18         			clc			; Subtract integer+1 from A.
         02:D80B  E9 00      			sbc	#0		; CS if A > integer.
 3272                        		__bfalse	.LL13
         02:D80D  90 05      			bcc	.LL13
 3273                        	
 3274                        		.dbg	line,	"include\routines_LEVELS.c", 61; {
 3275                        	
 3276                        		.dbg	line,	"include\routines_LEVELS.c", 62; seconds -= 1;
 3277                        		__sub_st.umiq	1, _seconds
         02:D80F  CE 25 23   			dec	_seconds
 3278                        	
 3279                        		.dbg	line,	"include\routines_LEVELS.c", 63; }
 3280                        	
 3281                        		.dbg	line,	"include\routines_LEVELS.c", 65; else
 3282                        		__bra		.LL14
         02:D812  80 18      			bra	.LL14
 3283    02:D814             	.LL13:
 3284                        	
 3285                        		.dbg	line,	"include\routines_LEVELS.c", 66; {
 3286                        	
 3287                        		.dbg	line,	"include\routines_LEVELS.c", 67; if(minutes > 0)
 3288                        		__ld.umq	_minutes
         02:D814  AD 24 23   			lda	_minutes
 3289                        		__ugt_b.uiq	0
         02:D817  18         			clc			; Subtract integer+1 from A.
         02:D818  E9 00      			sbc	#0		; CS if A > integer.
 3290                        		__bfalse	.LL15
         02:D81A  90 0A      			bcc	.LL15
 3291                        	
 3292                        		.dbg	line,	"include\routines_LEVELS.c", 68; {
 3293                        	
 3294                        		.dbg	line,	"include\routines_LEVELS.c", 69; seconds = 59;
 3295                        		__st.umiq	59, _seconds
         02:D81C  A9 3B      			lda.l	#59
         02:D81E  8D 25 23   			sta	_seconds
 3296                        	
 3297                        		.dbg	line,	"include\routines_LEVELS.c", 70; minutes -= 1;
 3298                        		__sub_st.umiq	1, _minutes
         02:D821  CE 24 23   			dec	_minutes
 3299                        	
 3300                        		.dbg	line,	"include\routines_LEVELS.c", 71; }
 3301                        	
 3302                        		.dbg	line,	"include\routines_LEVELS.c", 73; else
 3303                        		__bra		.LL16
         02:D824  80 06      			bra	.LL16
 3304    02:D826             	.LL15:
 3305                        	
 3306                        		.dbg	line,	"include\routines_LEVELS.c", 74; {
 3307                        	
 3308                        		.dbg	line,	"include\routines_LEVELS.c", 75; seconds = 0;
 3309                        		__st.umiq	0, _seconds
         02:D826  9C 25 23   			stz	_seconds
 3310                        	
 3311                        		.dbg	line,	"include\routines_LEVELS.c", 76; minutes = 0;
 3312                        		__st.umiq	0, _minutes
         02:D829  9C 24 23   			stz	_minutes
 3313                        	
 3314                        		.dbg	line,	"include\routines_LEVELS.c", 77; // TIME OUT //
 3315                        	
 3316                        		.dbg	line,	"include\routines_LEVELS.c", 78; }
 3317    02:D82C             	.LL16:
 3318                        	
 3319                        		.dbg	line,	"include\routines_LEVELS.c", 79; }
 3320    02:D82C             	.LL14:
 3321                        	
 3322                        		.dbg	line,	"include\routines_LEVELS.c", 80; } 
 3323                        	
 3324                        		.dbg	line,	"include\routines_LEVELS.c", 81; }
 3325    02:D82C             	.LL12:
 3326    02:D82C             	.LL9:
 3327                        		__return	0
         02:D82C  4C EF FF   			jmp	leave_proc
 3328                        		.dbg	clear
 3329                        		.endp
 3330                        		.pceas
 3331                        	
 3332                        		.dbg	line,	"include\routines_LEVELS.c", 84; void display_KEY()
 3333                        		.dbg	line,	"include\routines_LEVELS.c", 85; {
 3334                        	;***********************
 3335                        	;***********************
 3336                        	
 3337                        		.hucc
 3338    02:DE5F             		.proc		_display_KEY
 3339                        		__enter		_display_KEY
 3340                        	
 3341                        		.dbg	line,	"include\routines_LEVELS.c", 86; put_number(key_amount,2,7,27);
 3342                        		__ld.um		_key_amount
         02:DE5F  AD 22 23   			lda	_key_amount
         02:DE62  C2         			cly
 3343                        		__st.wmq	_bx
         02:DE63  85 FA      			sta.l	_bx
         02:DE65  84 FB      			sty.h	_bx
 3344                        		__st.umiq	2, _cl
         02:DE67  A9 02      			lda.l	#2
         02:DE69  85 FC      			sta	_cl
 3345                        		__st.umiq	7, _dil
         02:DE6B  A9 07      			lda.l	#7
         02:DE6D  85 F0      			sta	_dil
 3346                        		__st.umiq	27, _dih
         02:DE6F  A9 1B      			lda.l	#27
         02:DE71  85 F1      			sta	_dih
 3347                        		__call		_put_number.4
         02:DE73  20 9F FF   			call	_put_number.4
 3348                        	
 3349                        		.dbg	line,	"include\routines_LEVELS.c", 87; }
 3350    02:DE76             	.LL17:
 3351                        		__return	0
         02:DE76  4C EF FF   			jmp	leave_proc
 3352                        		.dbg	clear
 3353                        		.endp
 3354                        		.pceas
 3355                        	
 3356                        		.dbg	line,	"include\routines_LEVELS.c", 90; void display_POTION()
 3357                        		.dbg	line,	"include\routines_LEVELS.c", 91; {
 3358                        	;***********************
 3359                        	;***********************
 3360                        	
 3361                        		.hucc
 3362    02:DE79             		.proc		_display_POTION
 3363                        		__enter		_display_POTION
 3364                        	
 3365                        		.dbg	line,	"include\routines_LEVELS.c", 92; put_number(potion_amount,2,19,27);
 3366                        		__ld.um		_potion_amount
         02:DE79  AD 23 23   			lda	_potion_amount
         02:DE7C  C2         			cly
 3367                        		__st.wmq	_bx
         02:DE7D  85 FA      			sta.l	_bx
         02:DE7F  84 FB      			sty.h	_bx
 3368                        		__st.umiq	2, _cl
         02:DE81  A9 02      			lda.l	#2
         02:DE83  85 FC      			sta	_cl
 3369                        		__st.umiq	19, _dil
         02:DE85  A9 13      			lda.l	#19
         02:DE87  85 F0      			sta	_dil
 3370                        		__st.umiq	27, _dih
         02:DE89  A9 1B      			lda.l	#27
         02:DE8B  85 F1      			sta	_dih
 3371                        		__call		_put_number.4
         02:DE8D  20 9F FF   			call	_put_number.4
 3372                        	
 3373                        		.dbg	line,	"include\routines_LEVELS.c", 93; }
 3374    02:DE90             	.LL18:
 3375                        		__return	0
         02:DE90  4C EF FF   			jmp	leave_proc
 3376                        		.dbg	clear
 3377                        		.endp
 3378                        		.pceas
 3379                        	
 3380                        		.dbg	line,	"include\routines_LEVELS.c", 96; void display_ZENNY()
 3381                        		.dbg	line,	"include\routines_LEVELS.c", 97; {
 3382                        	;***********************
 3383                        	;***********************
 3384                        	
 3385                        		.hucc
 3386    02:DE27             		.proc		_display_ZENNY
 3387                        		__enter		_display_ZENNY
 3388                        	
 3389                        		.dbg	line,	"include\routines_LEVELS.c", 98; put_number(zenny_amount,5,26,4);
 3390                        		__ld.wm		_zenny_amount
         02:DE27  AD 28 26   			lda.l	_zenny_amount
         02:DE2A  AC 29 26   			ldy.h	_zenny_amount
 3391                        		__st.wmq	_bx
         02:DE2D  85 FA      			sta.l	_bx
         02:DE2F  84 FB      			sty.h	_bx
 3392                        		__st.umiq	5, _cl
         02:DE31  A9 05      			lda.l	#5
         02:DE33  85 FC      			sta	_cl
 3393                        		__st.umiq	26, _dil
         02:DE35  A9 1A      			lda.l	#26
         02:DE37  85 F0      			sta	_dil
 3394                        		__st.umiq	4, _dih
         02:DE39  A9 04      			lda.l	#4
         02:DE3B  85 F1      			sta	_dih
 3395                        		__call		_put_number.4
         02:DE3D  20 9F FF   			call	_put_number.4
 3396                        	
 3397                        		.dbg	line,	"include\routines_LEVELS.c", 99; }
 3398    02:DE40             	.LL19:
 3399                        		__return	0
         02:DE40  4C EF FF   			jmp	leave_proc
 3400                        		.dbg	clear
 3401                        		.endp
 3402                        		.pceas
 3403                        	
 3404                        		.dbg	line,	"include\routines_LEVELS.c", 104; void scroll_object()
 3405                        		.dbg	line,	"include\routines_LEVELS.c", 105; {
 3406                        	;***********************
 3407                        	;***********************
 3408                        	
 3409                        		.hucc
 3410    02:C9D8             		.proc		_scroll_object
 3411                        		__enter		_scroll_object
 3412                        	
 3413                        		.dbg	line,	"include\routines_LEVELS.c", 106; char i;
 3414                        	
 3415                        		.dbg	line,	"include\routines_LEVELS.c", 107; onscreen_object_number = 0;
 3416                        		__st.umiq	0, _onscreen_object_number
         02:C9D8  9C 2B 23   			stz	_onscreen_object_number
 3417                        	
 3418                        		.dbg	line,	"include\routines_LEVELS.c", 109; for(i=0 ; i<level_object_number ; i++)
 3419                        		__st.umiq	0, __scroll_object_end - 1  /* i */
         02:C9DB  9C 45 26   			stz	__scroll_object_end - 1
 3420    02:C9DE             	.LL21:
 3421                        		__ld.umq	__scroll_object_end - 1  /* i */
         02:C9DE  AD 45 26   			lda	__scroll_object_end - 1
 3422                        		__ult_b.umq	_level_object_number
         02:C9E1  CD 2A 23   			cmp	_level_object_number		; Subtract memory from A.
         02:C9E4  6A         			ror	a		; CC if A < memory.
         02:C9E5  49 80      			eor	#$80
         02:C9E7  2A         			rol	a
 3423                        		__btrue		.LL23
         02:C9E8  B0 08      			bcs	.LL23
 3424                        		__bra		.LL24
         02:C9EA  4C 3C CB   			bra	.LL24
 3425    02:C9ED             	.LL22:
 3426                        		__inc.umq	__scroll_object_end - 1  /* i */
         02:C9ED  EE 45 26   			inc	__scroll_object_end - 1
 3427                        		__bra		.LL21
         02:C9F0  80 EC      			bra	.LL21
 3428    02:C9F2             	.LL23:
 3429                        	
 3430                        		.dbg	line,	"include\routines_LEVELS.c", 110; {
 3431                        	
 3432                        		.dbg	line,	"include\routines_LEVELS.c", 111; if(list_object_state[i] != STATE_INACTIVE)
 3433                        		__ldx.umq	__scroll_object_end - 1  /* i */
         02:C9F2  AE 45 26   			ldx	__scroll_object_end - 1
 3434                        		__ld.uaxq	_list_object_state
         02:C9F5  BD 45 23   			lda	_list_object_state, x
 3435                        		__neq_b.uiq	1
         02:C9F8  38         			sec
         02:C9F9  49 01      			eor	#1
         02:C9FB  D0 01      			bne	!+
         02:C9FD  18         			clc
         02:C9FE             	!:
 3436                        		__bfalse	.LL25
         02:C9FE  90 ED      			bcc	.LL25
 3437                        	
 3438                        		.dbg	line,	"include\routines_LEVELS.c", 112; {
 3439                        	
 3440                        		.dbg	line,	"include\routines_LEVELS.c", 113; char scroll_allowed = FALSE;
 3441                        		__st.umiq	0, __scroll_object_end - 2  /* scroll_allowed */
         02:CA00  9C 44 26   			stz	__scroll_object_end - 2
 3442                        	
 3443                        		.dbg	line,	"include\routines_LEVELS.c", 114; 
 3444                        	
 3445                        		.dbg	line,	"include\routines_LEVELS.c", 115; // IF OBJECT X POSITION IS INFERIOR TO SCREEN RIGHT SIDE //
 3446                        	
 3447                        		.dbg	line,	"include\routines_LEVELS.c", 116; if(list_object_x_pos_ref[i] < sgx_map_pxl_x + 256)
 3448                        		__ld.wm		_sgx_map_pxl_x
         02:CA03  AD 8A 26   			lda.l	_sgx_map_pxl_x
         02:CA06  AC 8B 26   			ldy.h	_sgx_map_pxl_x
 3449                        		__add.wi	256
         02:CA09  18         			clc
         02:CA0A  69 00      			adc.l	#256
         02:CA0C  42         			say
         02:CA0D  69 01      			adc.h	#256
         02:CA0F  42         			say
 3450                        		__ld2x.um	__scroll_object_end - 1  /* i */
         02:CA10  AA         			tax
         02:CA11  AD 45 26   			lda	__scroll_object_end - 1
         02:CA14  0A         			asl	a
         02:CA15  22         			sax
 3451                        		__ugt_w.wax	_list_object_x_pos_ref
         02:CA16  18         			clc			; Subtract memory+1 from Y:A.
         02:CA17  FD 3C 25   			sbc.l	_list_object_x_pos_ref, x
         02:CA1A  98         			tya
         02:CA1B  FD 3D 25   			sbc.h	_list_object_x_pos_ref, x		; CS if Y:A > memory.
 3452                        		__bfalse	.LL26
         02:CA1E  B0 03 4C A3			bcc	.LL26
         02:CA22  CA          
 3453                        	
 3454                        		.dbg	line,	"include\routines_LEVELS.c", 117; {
 3455                        	
 3456                        		.dbg	line,	"include\routines_LEVELS.c", 118; // IF OBJECT X POSITION IS SUPERIOR TO SCREEN LEFT SIDE PLUS 16 PX //
 3457                        	
 3458                        		.dbg	line,	"include\routines_LEVELS.c", 119; if(list_object_x_pos_ref[i] - sgx_map_pxl_x + 16 > 0)
 3459                        		__ld2x.umq	__scroll_object_end - 1  /* i */
         02:CA23  AD 45 26   			lda	__scroll_object_end - 1
         02:CA26  0A         			asl	a
         02:CA27  AA         			tax
 3460                        		__ld.wax	_list_object_x_pos_ref
         02:CA28  BD 3C 25   			lda.l	_list_object_x_pos_ref, x
         02:CA2B  BC 3D 25   			ldy.h	_list_object_x_pos_ref, x
 3461                        		__sub.wm	_sgx_map_pxl_x
         02:CA2E  38         			sec
         02:CA2F  ED 8A 26   			sbc.l	_sgx_map_pxl_x
         02:CA32  42         			say
         02:CA33  ED 8B 26   			sbc.h	_sgx_map_pxl_x
         02:CA36  42         			say
 3462                        		__add.wi	16
         02:CA37  18         			clc
         02:CA38  69 10      			adc.l	#16
         02:CA3A  90 01      			bcc	!+
         02:CA3C  C8         			iny
         02:CA3D             	!:
 3463                        		__sgt_w.wi	0
         02:CA3D  18         			clc			; Subtract integer+1 from Y:A.
         02:CA3E  E9 00      			sbc.l	#0
         02:CA40  98         			tya
         02:CA41  E9 00      			sbc.h	#0
         02:CA43  50 02      			bvc	!+
         02:CA45  49 80      			eor	#$80		; +ve if Y:A > integer (signed).
         02:CA47  49 80      	!:		eor	#$80
         02:CA49  0A         			asl	a
 3464                        		__bfalse	.LL27
         02:CA4A  90 57      			bcc	.LL27
 3465                        	
 3466                        		.dbg	line,	"include\routines_LEVELS.c", 120; {
 3467                        	
 3468                        		.dbg	line,	"include\routines_LEVELS.c", 121; // IF OBJECT Y POSITION IS INFERIOR TO SCREEN BOTTOM //
 3469                        	
 3470                        		.dbg	line,	"include\routines_LEVELS.c", 122; if(list_object_y_pos_ref[i] < sgx_map_pxl_y + 224)
 3471                        		__ld.wm		_sgx_map_pxl_y
         02:CA4C  AD 8C 26   			lda.l	_sgx_map_pxl_y
         02:CA4F  AC 8D 26   			ldy.h	_sgx_map_pxl_y
 3472                        		__add.wi	224
         02:CA52  18         			clc
         02:CA53  69 E0      			adc.l	#224
         02:CA55  90 01      			bcc	!+
         02:CA57  C8         			iny
         02:CA58             	!:
 3473                        		__ld2x.um	__scroll_object_end - 1  /* i */
         02:CA58  AA         			tax
         02:CA59  AD 45 26   			lda	__scroll_object_end - 1
         02:CA5C  0A         			asl	a
         02:CA5D  22         			sax
 3474                        		__ugt_w.wax	_list_object_y_pos_ref
         02:CA5E  18         			clc			; Subtract memory+1 from Y:A.
         02:CA5F  FD 6E 25   			sbc.l	_list_object_y_pos_ref, x
         02:CA62  98         			tya
         02:CA63  FD 6F 25   			sbc.h	_list_object_y_pos_ref, x		; CS if Y:A > memory.
 3475                        		__bfalse	.LL28
         02:CA66  90 3B      			bcc	.LL28
 3476                        	
 3477                        		.dbg	line,	"include\routines_LEVELS.c", 123; {
 3478                        	
 3479                        		.dbg	line,	"include\routines_LEVELS.c", 124; // IF OBJECT Y POSITION IS SUPERIOR TO SCREEN TOP PLUS 16 PX //
 3480                        	
 3481                        		.dbg	line,	"include\routines_LEVELS.c", 125; if(list_object_y_pos_ref[i] - sgx_map_pxl_y + 16 > 0)
 3482                        		__ld2x.umq	__scroll_object_end - 1  /* i */
         02:CA68  AD 45 26   			lda	__scroll_object_end - 1
         02:CA6B  0A         			asl	a
         02:CA6C  AA         			tax
 3483                        		__ld.wax	_list_object_y_pos_ref
         02:CA6D  BD 6E 25   			lda.l	_list_object_y_pos_ref, x
         02:CA70  BC 6F 25   			ldy.h	_list_object_y_pos_ref, x
 3484                        		__sub.wm	_sgx_map_pxl_y
         02:CA73  38         			sec
         02:CA74  ED 8C 26   			sbc.l	_sgx_map_pxl_y
         02:CA77  42         			say
         02:CA78  ED 8D 26   			sbc.h	_sgx_map_pxl_y
         02:CA7B  42         			say
 3485                        		__add.wi	16
         02:CA7C  18         			clc
         02:CA7D  69 10      			adc.l	#16
         02:CA7F  90 01      			bcc	!+
         02:CA81  C8         			iny
         02:CA82             	!:
 3486                        		__sgt_w.wi	0
         02:CA82  18         			clc			; Subtract integer+1 from Y:A.
         02:CA83  E9 00      			sbc.l	#0
         02:CA85  98         			tya
         02:CA86  E9 00      			sbc.h	#0
         02:CA88  50 02      			bvc	!+
         02:CA8A  49 80      			eor	#$80		; +ve if Y:A > integer (signed).
         02:CA8C  49 80      	!:		eor	#$80
         02:CA8E  0A         			asl	a
 3487                        		__bfalse	.LL29
         02:CA8F  90 12      			bcc	.LL29
 3488                        	
 3489                        		.dbg	line,	"include\routines_LEVELS.c", 126; {
 3490                        	
 3491                        		.dbg	line,	"include\routines_LEVELS.c", 127; // WE STORE THE OBJECT ID //
 3492                        	
 3493                        		.dbg	line,	"include\routines_LEVELS.c", 128; //put_number(i,2,0,2+onscreen_object_number);
 3494                        	
 3495                        		.dbg	line,	"include\routines_LEVELS.c", 129; list_onscreen_object[onscreen_object_number] = i;
 3496                        		__ldx.umq	_onscreen_object_number
         02:CA91  AE 2B 23   			ldx	_onscreen_object_number
 3497                        		__ld.um		__scroll_object_end - 1  /* i */
         02:CA94  AD 45 26   			lda	__scroll_object_end - 1
         02:CA97  C2         			cly
 3498                        		__st.uaxq	_list_onscreen_object
         02:CA98  9D 90 23   			sta	_list_onscreen_object, x
 3499                        	
 3500                        		.dbg	line,	"include\routines_LEVELS.c", 130; onscreen_object_number += 1;
 3501                        		__add_st.umiq	1, _onscreen_object_number
         02:CA9B  EE 2B 23   			inc	_onscreen_object_number
 3502                        	
 3503                        		.dbg	line,	"include\routines_LEVELS.c", 131; 
 3504                        	
 3505                        		.dbg	line,	"include\routines_LEVELS.c", 132; //list_object_visibility[i] = ON_SCREEN;
 3506                        	
 3507                        		.dbg	line,	"include\routines_LEVELS.c", 133; scroll_allowed = TRUE;
 3508                        		__st.umiq	1, __scroll_object_end - 2  /* scroll_allowed */
         02:CA9E  A9 01      			lda.l	#1
         02:CAA0  8D 44 26   			sta	__scroll_object_end - 2
 3509                        	
 3510                        		.dbg	line,	"include\routines_LEVELS.c", 134; }
 3511                        	
 3512                        		.dbg	line,	"include\routines_LEVELS.c", 135; }
 3513    02:CAA3             	.LL29:
 3514                        	
 3515                        		.dbg	line,	"include\routines_LEVELS.c", 136; }
 3516    02:CAA3             	.LL28:
 3517                        	
 3518                        		.dbg	line,	"include\routines_LEVELS.c", 137; }
 3519    02:CAA3             	.LL27:
 3520                        	
 3521                        		.dbg	line,	"include\routines_LEVELS.c", 139; // IF OBJECTS IS WITHIN THE SCREEN LIMITS //
 3522                        	
 3523                        		.dbg	line,	"include\routines_LEVELS.c", 140; if(scroll_allowed == TRUE)
 3524    02:CAA3             	.LL26:
 3525                        		__ld.umq	__scroll_object_end - 2  /* scroll_allowed */
         02:CAA3  AD 44 26   			lda	__scroll_object_end - 2
 3526                        		__equ_b.uiq	1
         02:CAA6  C9 01      			cmp	#1
         02:CAA8  F0 01      			beq	!+
         02:CAAA  18         			clc
         02:CAAB             	!:
 3527                        		__bfalse	.LL30
         02:CAAB  90 44      			bcc	.LL30
 3528                        	
 3529                        		.dbg	line,	"include\routines_LEVELS.c", 141; {
 3530                        	
 3531                        		.dbg	line,	"include\routines_LEVELS.c", 142; list_object_x_pos[i] = list_object_x_pos_ref[i] - sgx_map_pxl_x;
 3532                        		__ld2x.umq	__scroll_object_end - 1  /* i */
         02:CAAD  AD 45 26   			lda	__scroll_object_end - 1
         02:CAB0  0A         			asl	a
         02:CAB1  AA         			tax
 3533                        		__ld.wax	_list_object_x_pos_ref
         02:CAB2  BD 3C 25   			lda.l	_list_object_x_pos_ref, x
         02:CAB5  BC 3D 25   			ldy.h	_list_object_x_pos_ref, x
 3534                        		__sub.wm	_sgx_map_pxl_x
         02:CAB8  38         			sec
         02:CAB9  ED 8A 26   			sbc.l	_sgx_map_pxl_x
         02:CABC  42         			say
         02:CABD  ED 8B 26   			sbc.h	_sgx_map_pxl_x
         02:CAC0  42         			say
 3535                        		__ld2x.um	__scroll_object_end - 1  /* i */
         02:CAC1  AA         			tax
         02:CAC2  AD 45 26   			lda	__scroll_object_end - 1
         02:CAC5  0A         			asl	a
         02:CAC6  22         			sax
 3536                        		__st.waxq	_list_object_x_pos
         02:CAC7  9D D8 24   			sta.l	_list_object_x_pos, x
         02:CACA  98         			tya
         02:CACB  9D D9 24   			sta.h	_list_object_x_pos, x
 3537                        	
 3538                        		.dbg	line,	"include\routines_LEVELS.c", 143; list_object_y_pos[i] = list_object_y_pos_ref[i] - sgx_map_pxl_y;
 3539                        		__ld2x.umq	__scroll_object_end - 1  /* i */
         02:CACE  AD 45 26   			lda	__scroll_object_end - 1
         02:CAD1  0A         			asl	a
         02:CAD2  AA         			tax
 3540                        		__ld.wax	_list_object_y_pos_ref
         02:CAD3  BD 6E 25   			lda.l	_list_object_y_pos_ref, x
         02:CAD6  BC 6F 25   			ldy.h	_list_object_y_pos_ref, x
 3541                        		__sub.wm	_sgx_map_pxl_y
         02:CAD9  38         			sec
         02:CADA  ED 8C 26   			sbc.l	_sgx_map_pxl_y
         02:CADD  42         			say
         02:CADE  ED 8D 26   			sbc.h	_sgx_map_pxl_y
         02:CAE1  42         			say
 3542                        		__ld2x.um	__scroll_object_end - 1  /* i */
         02:CAE2  AA         			tax
         02:CAE3  AD 45 26   			lda	__scroll_object_end - 1
         02:CAE6  0A         			asl	a
         02:CAE7  22         			sax
 3543                        		__st.waxq	_list_object_y_pos
         02:CAE8  9D 0A 25   			sta.l	_list_object_y_pos, x
         02:CAEB  98         			tya
         02:CAEC  9D 0B 25   			sta.h	_list_object_y_pos, x
 3544                        	
 3545                        		.dbg	line,	"include\routines_LEVELS.c", 144; }
 3546                        	
 3547                        		.dbg	line,	"include\routines_LEVELS.c", 146; else
 3548                        		__bra		.LL31
         02:CAEF  80 1E      			bra	.LL31
 3549    02:CAF1             	.LL30:
 3550                        	
 3551                        		.dbg	line,	"include\routines_LEVELS.c", 147; {
 3552                        	
 3553                        		.dbg	line,	"include\routines_LEVELS.c", 148; list_object_x_pos[i] = -16;
 3554                        		__ld2x.umq	__scroll_object_end - 1  /* i */
         02:CAF1  AD 45 26   			lda	__scroll_object_end - 1
         02:CAF4  0A         			asl	a
         02:CAF5  AA         			tax
 3555                        		__st.waxiq	-16, _list_object_x_pos
         02:CAF6  A9 F0      			lda.l	#-16
         02:CAF8  9D D8 24   			sta.l	_list_object_x_pos, x
         02:CAFB  A9 FF      			lda.h	#-16
         02:CAFD  9D D9 24   			sta.h	_list_object_x_pos, x
 3556                        	
 3557                        		.dbg	line,	"include\routines_LEVELS.c", 149; list_object_y_pos[i] = -16;
 3558                        		__ld2x.umq	__scroll_object_end - 1  /* i */
         02:CB00  AD 45 26   			lda	__scroll_object_end - 1
         02:CB03  0A         			asl	a
         02:CB04  AA         			tax
 3559                        		__st.waxiq	-16, _list_object_y_pos
         02:CB05  A9 F0      			lda.l	#-16
         02:CB07  9D 0A 25   			sta.l	_list_object_y_pos, x
         02:CB0A  A9 FF      			lda.h	#-16
         02:CB0C  9D 0B 25   			sta.h	_list_object_y_pos, x
 3560                        	
 3561                        		.dbg	line,	"include\routines_LEVELS.c", 150; //list_object_visibility[i] = OFF_SCREEN;
 3562                        	
 3563                        		.dbg	line,	"include\routines_LEVELS.c", 151; }
 3564    02:CB0F             	.LL31:
 3565                        	
 3566                        		.dbg	line,	"include\routines_LEVELS.c", 153; spr_set(i + object_start_index);
 3567                        		__ld.um		__scroll_object_end - 1  /* i */
         02:CB0F  AD 45 26   			lda	__scroll_object_end - 1
         02:CB12  C2         			cly
 3568                        		__add.um	_object_start_index
         02:CB13  18         			clc
         02:CB14  6D 29 23   			adc	_object_start_index
         02:CB17  90 01      			bcc	!+
         02:CB19  C8         			iny
         02:CB1A             	!:
 3569                        		__call		_spr_set.1
         02:CB1A  20 DD E7   			call	_spr_set.1
 3570                        	
 3571                        		.dbg	line,	"include\routines_LEVELS.c", 155; spr_x(list_object_x_pos[i]);
 3572                        		__ld2x.umq	__scroll_object_end - 1  /* i */
         02:CB1D  AD 45 26   			lda	__scroll_object_end - 1
         02:CB20  0A         			asl	a
         02:CB21  AA         			tax
 3573                        		__ld.wax	_list_object_x_pos
         02:CB22  BD D8 24   			lda.l	_list_object_x_pos, x
         02:CB25  BC D9 24   			ldy.h	_list_object_x_pos, x
 3574                        		__call		_spr_x.1
         02:CB28  20 0A E8   			call	_spr_x.1
 3575                        	
 3576                        		.dbg	line,	"include\routines_LEVELS.c", 156; spr_y(list_object_y_pos[i]);
 3577                        		__ld2x.umq	__scroll_object_end - 1  /* i */
         02:CB2B  AD 45 26   			lda	__scroll_object_end - 1
         02:CB2E  0A         			asl	a
         02:CB2F  AA         			tax
 3578                        		__ld.wax	_list_object_y_pos
         02:CB30  BD 0A 25   			lda.l	_list_object_y_pos, x
         02:CB33  BC 0B 25   			ldy.h	_list_object_y_pos, x
 3579                        		__call		_spr_y.1
         02:CB36  20 19 E8   			call	_spr_y.1
 3580                        	
 3581                        		.dbg	line,	"include\routines_LEVELS.c", 157; }
 3582                        	
 3583                        		.dbg	line,	"include\routines_LEVELS.c", 158; }
 3584    02:CB39             	.LL25	.alias		.LL22
 3585                        		__bra		.LL22
         02:CB39  4C ED C9   			bra	.LL22
 3586    02:CB3C             	.LL24:
 3587                        	
 3588                        		.dbg	line,	"include\routines_LEVELS.c", 159; }
 3589    02:CB3C             	.LL20:
 3590                        		__return	0
         02:CB3C  4C EF FF   			jmp	leave_proc
 3591                        		.dbg	clear
 3592                        		.endp
 3593                        		.pceas
 3594                        	
 3595                        		.dbg	line,	"include\routines_LEVELS.c", 162; void scroll_chest()
 3596                        		.dbg	line,	"include\routines_LEVELS.c", 163; {
 3597                        	;***********************
 3598                        	;***********************
 3599                        	
 3600                        		.hucc
 3601    02:CB3F             		.proc		_scroll_chest
 3602                        		__enter		_scroll_chest
 3603                        	
 3604                        		.dbg	line,	"include\routines_LEVELS.c", 164; char i;
 3605                        	
 3606                        		.dbg	line,	"include\routines_LEVELS.c", 165; onscreen_chest_number = 0;
 3607                        		__st.umiq	0, _onscreen_chest_number
         02:CB3F  9C 9A 23   			stz	_onscreen_chest_number
 3608                        	
 3609                        		.dbg	line,	"include\routines_LEVELS.c", 167; for(i=0 ; i<level_chest_number ; i++)
 3610                        		__st.umiq	0, __scroll_chest_end - 1  /* i */
         02:CB42  9C 45 26   			stz	__scroll_chest_end - 1
 3611    02:CB45             	.LL33:
 3612                        		__ld.umq	__scroll_chest_end - 1  /* i */
         02:CB45  AD 45 26   			lda	__scroll_chest_end - 1
 3613                        		__ult_b.umq	_level_chest_number
         02:CB48  CD 99 23   			cmp	_level_chest_number		; Subtract memory from A.
         02:CB4B  6A         			ror	a		; CC if A < memory.
         02:CB4C  49 80      			eor	#$80
         02:CB4E  2A         			rol	a
 3614                        		__btrue		.LL35
         02:CB4F  B0 08      			bcs	.LL35
 3615                        		__bra		.LL36
         02:CB51  4C A3 CC   			bra	.LL36
 3616    02:CB54             	.LL34:
 3617                        		__inc.umq	__scroll_chest_end - 1  /* i */
         02:CB54  EE 45 26   			inc	__scroll_chest_end - 1
 3618                        		__bra		.LL33
         02:CB57  80 EC      			bra	.LL33
 3619    02:CB59             	.LL35:
 3620                        	
 3621                        		.dbg	line,	"include\routines_LEVELS.c", 168; {
 3622                        	
 3623                        		.dbg	line,	"include\routines_LEVELS.c", 169; if(list_chest_state[i] != STATE_INACTIVE)
 3624                        		__ldx.umq	__scroll_chest_end - 1  /* i */
         02:CB59  AE 45 26   			ldx	__scroll_chest_end - 1
 3625                        		__ld.uaxq	_list_chest_state
         02:CB5C  BD 9B 23   			lda	_list_chest_state, x
 3626                        		__neq_b.uiq	1
         02:CB5F  38         			sec
         02:CB60  49 01      			eor	#1
         02:CB62  D0 01      			bne	!+
         02:CB64  18         			clc
         02:CB65             	!:
 3627                        		__bfalse	.LL37
         02:CB65  90 ED      			bcc	.LL37
 3628                        	
 3629                        		.dbg	line,	"include\routines_LEVELS.c", 170; {
 3630                        	
 3631                        		.dbg	line,	"include\routines_LEVELS.c", 171; char scroll_allowed = FALSE;
 3632                        		__st.umiq	0, __scroll_chest_end - 2  /* scroll_allowed */
         02:CB67  9C 44 26   			stz	__scroll_chest_end - 2
 3633                        	
 3634                        		.dbg	line,	"include\routines_LEVELS.c", 172; 
 3635                        	
 3636                        		.dbg	line,	"include\routines_LEVELS.c", 173; // IF CHEST X POSITION IS INFERIOR TO SCREEN RIGHT SIDE //
 3637                        	
 3638                        		.dbg	line,	"include\routines_LEVELS.c", 174; if(list_chest_x_pos_ref[i] < sgx_map_pxl_x + 256)
 3639                        		__ld.wm		_sgx_map_pxl_x
         02:CB6A  AD 8A 26   			lda.l	_sgx_map_pxl_x
         02:CB6D  AC 8B 26   			ldy.h	_sgx_map_pxl_x
 3640                        		__add.wi	256
         02:CB70  18         			clc
         02:CB71  69 00      			adc.l	#256
         02:CB73  42         			say
         02:CB74  69 01      			adc.h	#256
         02:CB76  42         			say
 3641                        		__ld2x.um	__scroll_chest_end - 1  /* i */
         02:CB77  AA         			tax
         02:CB78  AD 45 26   			lda	__scroll_chest_end - 1
         02:CB7B  0A         			asl	a
         02:CB7C  22         			sax
 3642                        		__ugt_w.wax	_list_chest_x_pos_ref
         02:CB7D  18         			clc			; Subtract memory+1 from Y:A.
         02:CB7E  FD C0 25   			sbc.l	_list_chest_x_pos_ref, x
         02:CB81  98         			tya
         02:CB82  FD C1 25   			sbc.h	_list_chest_x_pos_ref, x		; CS if Y:A > memory.
 3643                        		__bfalse	.LL38
         02:CB85  B0 03 4C 0A			bcc	.LL38
         02:CB89  CC          
 3644                        	
 3645                        		.dbg	line,	"include\routines_LEVELS.c", 175; {
 3646                        	
 3647                        		.dbg	line,	"include\routines_LEVELS.c", 176; // IF CHEST X POSITION IS SUPERIOR TO SCREEN LEFT SIDE PLUS 32 PX //
 3648                        	
 3649                        		.dbg	line,	"include\routines_LEVELS.c", 177; if(list_chest_x_pos_ref[i] - sgx_map_pxl_x + 32 > 0)
 3650                        		__ld2x.umq	__scroll_chest_end - 1  /* i */
         02:CB8A  AD 45 26   			lda	__scroll_chest_end - 1
         02:CB8D  0A         			asl	a
         02:CB8E  AA         			tax
 3651                        		__ld.wax	_list_chest_x_pos_ref
         02:CB8F  BD C0 25   			lda.l	_list_chest_x_pos_ref, x
         02:CB92  BC C1 25   			ldy.h	_list_chest_x_pos_ref, x
 3652                        		__sub.wm	_sgx_map_pxl_x
         02:CB95  38         			sec
         02:CB96  ED 8A 26   			sbc.l	_sgx_map_pxl_x
         02:CB99  42         			say
         02:CB9A  ED 8B 26   			sbc.h	_sgx_map_pxl_x
         02:CB9D  42         			say
 3653                        		__add.wi	32
         02:CB9E  18         			clc
         02:CB9F  69 20      			adc.l	#32
         02:CBA1  90 01      			bcc	!+
         02:CBA3  C8         			iny
         02:CBA4             	!:
 3654                        		__sgt_w.wi	0
         02:CBA4  18         			clc			; Subtract integer+1 from Y:A.
         02:CBA5  E9 00      			sbc.l	#0
         02:CBA7  98         			tya
         02:CBA8  E9 00      			sbc.h	#0
         02:CBAA  50 02      			bvc	!+
         02:CBAC  49 80      			eor	#$80		; +ve if Y:A > integer (signed).
         02:CBAE  49 80      	!:		eor	#$80
         02:CBB0  0A         			asl	a
 3655                        		__bfalse	.LL39
         02:CBB1  90 57      			bcc	.LL39
 3656                        	
 3657                        		.dbg	line,	"include\routines_LEVELS.c", 178; {
 3658                        	
 3659                        		.dbg	line,	"include\routines_LEVELS.c", 179; // IF CHEST Y POSITION IS INFERIOR TO SCREEN BOTTOM //
 3660                        	
 3661                        		.dbg	line,	"include\routines_LEVELS.c", 180; if(list_chest_y_pos_ref[i] < sgx_map_pxl_y + 224)
 3662                        		__ld.wm		_sgx_map_pxl_y
         02:CBB3  AD 8C 26   			lda.l	_sgx_map_pxl_y
         02:CBB6  AC 8D 26   			ldy.h	_sgx_map_pxl_y
 3663                        		__add.wi	224
         02:CBB9  18         			clc
         02:CBBA  69 E0      			adc.l	#224
         02:CBBC  90 01      			bcc	!+
         02:CBBE  C8         			iny
         02:CBBF             	!:
 3664                        		__ld2x.um	__scroll_chest_end - 1  /* i */
         02:CBBF  AA         			tax
         02:CBC0  AD 45 26   			lda	__scroll_chest_end - 1
         02:CBC3  0A         			asl	a
         02:CBC4  22         			sax
 3665                        		__ugt_w.wax	_list_chest_y_pos_ref
         02:CBC5  18         			clc			; Subtract memory+1 from Y:A.
         02:CBC6  FD D0 25   			sbc.l	_list_chest_y_pos_ref, x
         02:CBC9  98         			tya
         02:CBCA  FD D1 25   			sbc.h	_list_chest_y_pos_ref, x		; CS if Y:A > memory.
 3666                        		__bfalse	.LL40
         02:CBCD  90 3B      			bcc	.LL40
 3667                        	
 3668                        		.dbg	line,	"include\routines_LEVELS.c", 181; {
 3669                        	
 3670                        		.dbg	line,	"include\routines_LEVELS.c", 182; // IF CHEST Y POSITION IS SUPERIOR TO SCREEN TOP PLUS 32 PX //
 3671                        	
 3672                        		.dbg	line,	"include\routines_LEVELS.c", 183; if(list_chest_y_pos_ref[i] - sgx_map_pxl_y + 32 > 0)
 3673                        		__ld2x.umq	__scroll_chest_end - 1  /* i */
         02:CBCF  AD 45 26   			lda	__scroll_chest_end - 1
         02:CBD2  0A         			asl	a
         02:CBD3  AA         			tax
 3674                        		__ld.wax	_list_chest_y_pos_ref
         02:CBD4  BD D0 25   			lda.l	_list_chest_y_pos_ref, x
         02:CBD7  BC D1 25   			ldy.h	_list_chest_y_pos_ref, x
 3675                        		__sub.wm	_sgx_map_pxl_y
         02:CBDA  38         			sec
         02:CBDB  ED 8C 26   			sbc.l	_sgx_map_pxl_y
         02:CBDE  42         			say
         02:CBDF  ED 8D 26   			sbc.h	_sgx_map_pxl_y
         02:CBE2  42         			say
 3676                        		__add.wi	32
         02:CBE3  18         			clc
         02:CBE4  69 20      			adc.l	#32
         02:CBE6  90 01      			bcc	!+
         02:CBE8  C8         			iny
         02:CBE9             	!:
 3677                        		__sgt_w.wi	0
         02:CBE9  18         			clc			; Subtract integer+1 from Y:A.
         02:CBEA  E9 00      			sbc.l	#0
         02:CBEC  98         			tya
         02:CBED  E9 00      			sbc.h	#0
         02:CBEF  50 02      			bvc	!+
         02:CBF1  49 80      			eor	#$80		; +ve if Y:A > integer (signed).
         02:CBF3  49 80      	!:		eor	#$80
         02:CBF5  0A         			asl	a
 3678                        		__bfalse	.LL41
         02:CBF6  90 12      			bcc	.LL41
 3679                        	
 3680                        		.dbg	line,	"include\routines_LEVELS.c", 184; {
 3681                        	
 3682                        		.dbg	line,	"include\routines_LEVELS.c", 185; // WE STORE THE CHEST ID //
 3683                        	
 3684                        		.dbg	line,	"include\routines_LEVELS.c", 186; list_onscreen_chest[onscreen_chest_number] = i;
 3685                        		__ldx.umq	_onscreen_chest_number
         02:CBF8  AE 9A 23   			ldx	_onscreen_chest_number
 3686                        		__ld.um		__scroll_chest_end - 1  /* i */
         02:CBFB  AD 45 26   			lda	__scroll_chest_end - 1
         02:CBFE  C2         			cly
 3687                        		__st.uaxq	_list_onscreen_chest
         02:CBFF  9D A3 23   			sta	_list_onscreen_chest, x
 3688                        	
 3689                        		.dbg	line,	"include\routines_LEVELS.c", 187; onscreen_chest_number += 1;
 3690                        		__add_st.umiq	1, _onscreen_chest_number
         02:CC02  EE 9A 23   			inc	_onscreen_chest_number
 3691                        	
 3692                        		.dbg	line,	"include\routines_LEVELS.c", 188; 
 3693                        	
 3694                        		.dbg	line,	"include\routines_LEVELS.c", 189; scroll_allowed = TRUE;
 3695                        		__st.umiq	1, __scroll_chest_end - 2  /* scroll_allowed */
         02:CC05  A9 01      			lda.l	#1
         02:CC07  8D 44 26   			sta	__scroll_chest_end - 2
 3696                        	
 3697                        		.dbg	line,	"include\routines_LEVELS.c", 190; }
 3698                        	
 3699                        		.dbg	line,	"include\routines_LEVELS.c", 191; }
 3700    02:CC0A             	.LL41:
 3701                        	
 3702                        		.dbg	line,	"include\routines_LEVELS.c", 192; }
 3703    02:CC0A             	.LL40:
 3704                        	
 3705                        		.dbg	line,	"include\routines_LEVELS.c", 193; }
 3706    02:CC0A             	.LL39:
 3707                        	
 3708                        		.dbg	line,	"include\routines_LEVELS.c", 195; // IF CHEST IS WITHIN THE SCREEN LIMITS //
 3709                        	
 3710                        		.dbg	line,	"include\routines_LEVELS.c", 196; if(scroll_allowed == TRUE)
 3711    02:CC0A             	.LL38:
 3712                        		__ld.umq	__scroll_chest_end - 2  /* scroll_allowed */
         02:CC0A  AD 44 26   			lda	__scroll_chest_end - 2
 3713                        		__equ_b.uiq	1
         02:CC0D  C9 01      			cmp	#1
         02:CC0F  F0 01      			beq	!+
         02:CC11  18         			clc
         02:CC12             	!:
 3714                        		__bfalse	.LL42
         02:CC12  90 44      			bcc	.LL42
 3715                        	
 3716                        		.dbg	line,	"include\routines_LEVELS.c", 197; {
 3717                        	
 3718                        		.dbg	line,	"include\routines_LEVELS.c", 198; list_chest_x_pos[i] = list_chest_x_pos_ref[i] - sgx_map_pxl_x;
 3719                        		__ld2x.umq	__scroll_chest_end - 1  /* i */
         02:CC14  AD 45 26   			lda	__scroll_chest_end - 1
         02:CC17  0A         			asl	a
         02:CC18  AA         			tax
 3720                        		__ld.wax	_list_chest_x_pos_ref
         02:CC19  BD C0 25   			lda.l	_list_chest_x_pos_ref, x
         02:CC1C  BC C1 25   			ldy.h	_list_chest_x_pos_ref, x
 3721                        		__sub.wm	_sgx_map_pxl_x
         02:CC1F  38         			sec
         02:CC20  ED 8A 26   			sbc.l	_sgx_map_pxl_x
         02:CC23  42         			say
         02:CC24  ED 8B 26   			sbc.h	_sgx_map_pxl_x
         02:CC27  42         			say
 3722                        		__ld2x.um	__scroll_chest_end - 1  /* i */
         02:CC28  AA         			tax
         02:CC29  AD 45 26   			lda	__scroll_chest_end - 1
         02:CC2C  0A         			asl	a
         02:CC2D  22         			sax
 3723                        		__st.waxq	_list_chest_x_pos
         02:CC2E  9D A0 25   			sta.l	_list_chest_x_pos, x
         02:CC31  98         			tya
         02:CC32  9D A1 25   			sta.h	_list_chest_x_pos, x
 3724                        	
 3725                        		.dbg	line,	"include\routines_LEVELS.c", 199; list_chest_y_pos[i] = list_chest_y_pos_ref[i] - sgx_map_pxl_y;
 3726                        		__ld2x.umq	__scroll_chest_end - 1  /* i */
         02:CC35  AD 45 26   			lda	__scroll_chest_end - 1
         02:CC38  0A         			asl	a
         02:CC39  AA         			tax
 3727                        		__ld.wax	_list_chest_y_pos_ref
         02:CC3A  BD D0 25   			lda.l	_list_chest_y_pos_ref, x
         02:CC3D  BC D1 25   			ldy.h	_list_chest_y_pos_ref, x
 3728                        		__sub.wm	_sgx_map_pxl_y
         02:CC40  38         			sec
         02:CC41  ED 8C 26   			sbc.l	_sgx_map_pxl_y
         02:CC44  42         			say
         02:CC45  ED 8D 26   			sbc.h	_sgx_map_pxl_y
         02:CC48  42         			say
 3729                        		__ld2x.um	__scroll_chest_end - 1  /* i */
         02:CC49  AA         			tax
         02:CC4A  AD 45 26   			lda	__scroll_chest_end - 1
         02:CC4D  0A         			asl	a
         02:CC4E  22         			sax
 3730                        		__st.waxq	_list_chest_y_pos
         02:CC4F  9D B0 25   			sta.l	_list_chest_y_pos, x
         02:CC52  98         			tya
         02:CC53  9D B1 25   			sta.h	_list_chest_y_pos, x
 3731                        	
 3732                        		.dbg	line,	"include\routines_LEVELS.c", 200; }
 3733                        	
 3734                        		.dbg	line,	"include\routines_LEVELS.c", 202; else
 3735                        		__bra		.LL43
         02:CC56  80 1E      			bra	.LL43
 3736    02:CC58             	.LL42:
 3737                        	
 3738                        		.dbg	line,	"include\routines_LEVELS.c", 203; {
 3739                        	
 3740                        		.dbg	line,	"include\routines_LEVELS.c", 204; list_chest_x_pos[i] = -32;
 3741                        		__ld2x.umq	__scroll_chest_end - 1  /* i */
         02:CC58  AD 45 26   			lda	__scroll_chest_end - 1
         02:CC5B  0A         			asl	a
         02:CC5C  AA         			tax
 3742                        		__st.waxiq	-32, _list_chest_x_pos
         02:CC5D  A9 E0      			lda.l	#-32
         02:CC5F  9D A0 25   			sta.l	_list_chest_x_pos, x
         02:CC62  A9 FF      			lda.h	#-32
         02:CC64  9D A1 25   			sta.h	_list_chest_x_pos, x
 3743                        	
 3744                        		.dbg	line,	"include\routines_LEVELS.c", 205; list_chest_y_pos[i] = -32;
 3745                        		__ld2x.umq	__scroll_chest_end - 1  /* i */
         02:CC67  AD 45 26   			lda	__scroll_chest_end - 1
         02:CC6A  0A         			asl	a
         02:CC6B  AA         			tax
 3746                        		__st.waxiq	-32, _list_chest_y_pos
         02:CC6C  A9 E0      			lda.l	#-32
         02:CC6E  9D B0 25   			sta.l	_list_chest_y_pos, x
         02:CC71  A9 FF      			lda.h	#-32
         02:CC73  9D B1 25   			sta.h	_list_chest_y_pos, x
 3747                        	
 3748                        		.dbg	line,	"include\routines_LEVELS.c", 206; }
 3749    02:CC76             	.LL43:
 3750                        	
 3751                        		.dbg	line,	"include\routines_LEVELS.c", 208; spr_set(i + chest_start_index);
 3752                        		__ld.um		__scroll_chest_end - 1  /* i */
         02:CC76  AD 45 26   			lda	__scroll_chest_end - 1
         02:CC79  C2         			cly
 3753                        		__add.um	_chest_start_index
         02:CC7A  18         			clc
         02:CC7B  6D 98 23   			adc	_chest_start_index
         02:CC7E  90 01      			bcc	!+
         02:CC80  C8         			iny
         02:CC81             	!:
 3754                        		__call		_spr_set.1
         02:CC81  20 DD E7   			call	_spr_set.1
 3755                        	
 3756                        		.dbg	line,	"include\routines_LEVELS.c", 210; spr_x(list_chest_x_pos[i]);
 3757                        		__ld2x.umq	__scroll_chest_end - 1  /* i */
         02:CC84  AD 45 26   			lda	__scroll_chest_end - 1
         02:CC87  0A         			asl	a
         02:CC88  AA         			tax
 3758                        		__ld.wax	_list_chest_x_pos
         02:CC89  BD A0 25   			lda.l	_list_chest_x_pos, x
         02:CC8C  BC A1 25   			ldy.h	_list_chest_x_pos, x
 3759                        		__call		_spr_x.1
         02:CC8F  20 0A E8   			call	_spr_x.1
 3760                        	
 3761                        		.dbg	line,	"include\routines_LEVELS.c", 211; spr_y(list_chest_y_pos[i]);
 3762                        		__ld2x.umq	__scroll_chest_end - 1  /* i */
         02:CC92  AD 45 26   			lda	__scroll_chest_end - 1
         02:CC95  0A         			asl	a
         02:CC96  AA         			tax
 3763                        		__ld.wax	_list_chest_y_pos
         02:CC97  BD B0 25   			lda.l	_list_chest_y_pos, x
         02:CC9A  BC B1 25   			ldy.h	_list_chest_y_pos, x
 3764                        		__call		_spr_y.1
         02:CC9D  20 19 E8   			call	_spr_y.1
 3765                        	
 3766                        		.dbg	line,	"include\routines_LEVELS.c", 212; }
 3767                        	
 3768                        		.dbg	line,	"include\routines_LEVELS.c", 213; }
 3769    02:CCA0             	.LL37	.alias		.LL34
 3770                        		__bra		.LL34
         02:CCA0  4C 54 CB   			bra	.LL34
 3771    02:CCA3             	.LL36:
 3772                        	
 3773                        		.dbg	line,	"include\routines_LEVELS.c", 214; }
 3774    02:CCA3             	.LL32:
 3775                        		__return	0
         02:CCA3  4C EF FF   			jmp	leave_proc
 3776                        		.dbg	clear
 3777                        		.endp
 3778                        		.pceas
 3779                        	
 3780                        		.dbg	line,	"include\routines_LEVELS.c", 217; void scroll_npc()
 3781                        		.dbg	line,	"include\routines_LEVELS.c", 218; {
 3782                        	;***********************
 3783                        	;***********************
 3784                        	
 3785                        		.hucc
 3786    02:CCA6             		.proc		_scroll_npc
 3787                        		__enter		_scroll_npc
 3788                        	
 3789                        		.dbg	line,	"include\routines_LEVELS.c", 219; char i;
 3790                        	
 3791                        		.dbg	line,	"include\routines_LEVELS.c", 220; onscreen_npc_number = 0;
 3792                        		__st.umiq	0, _onscreen_npc_number
         02:CCA6  9C AD 23   			stz	_onscreen_npc_number
 3793                        	
 3794                        		.dbg	line,	"include\routines_LEVELS.c", 222; for(i=0 ; i<level_npc_number ; i++)
 3795                        		__st.umiq	0, __scroll_npc_end - 1  /* i */
         02:CCA9  9C 45 26   			stz	__scroll_npc_end - 1
 3796    02:CCAC             	.LL45:
 3797                        		__ld.umq	__scroll_npc_end - 1  /* i */
         02:CCAC  AD 45 26   			lda	__scroll_npc_end - 1
 3798                        		__ult_b.umq	_level_npc_number
         02:CCAF  CD AC 23   			cmp	_level_npc_number		; Subtract memory from A.
         02:CCB2  6A         			ror	a		; CC if A < memory.
         02:CCB3  49 80      			eor	#$80
         02:CCB5  2A         			rol	a
 3799                        		__btrue		.LL47
         02:CCB6  B0 08      			bcs	.LL47
 3800                        		__bra		.LL48
         02:CCB8  4C 0A CE   			bra	.LL48
 3801    02:CCBB             	.LL46:
 3802                        		__inc.umq	__scroll_npc_end - 1  /* i */
         02:CCBB  EE 45 26   			inc	__scroll_npc_end - 1
 3803                        		__bra		.LL45
         02:CCBE  80 EC      			bra	.LL45
 3804    02:CCC0             	.LL47:
 3805                        	
 3806                        		.dbg	line,	"include\routines_LEVELS.c", 223; {
 3807                        	
 3808                        		.dbg	line,	"include\routines_LEVELS.c", 224; if(list_npc_state[i] != STATE_INACTIVE)
 3809                        		__ldx.umq	__scroll_npc_end - 1  /* i */
         02:CCC0  AE 45 26   			ldx	__scroll_npc_end - 1
 3810                        		__ld.uaxq	_list_npc_state
         02:CCC3  BD B7 23   			lda	_list_npc_state, x
 3811                        		__neq_b.uiq	1
         02:CCC6  38         			sec
         02:CCC7  49 01      			eor	#1
         02:CCC9  D0 01      			bne	!+
         02:CCCB  18         			clc
         02:CCCC             	!:
 3812                        		__bfalse	.LL49
         02:CCCC  90 ED      			bcc	.LL49
 3813                        	
 3814                        		.dbg	line,	"include\routines_LEVELS.c", 225; {
 3815                        	
 3816                        		.dbg	line,	"include\routines_LEVELS.c", 226; char scroll_allowed = FALSE;
 3817                        		__st.umiq	0, __scroll_npc_end - 2  /* scroll_allowed */
         02:CCCE  9C 44 26   			stz	__scroll_npc_end - 2
 3818                        	
 3819                        		.dbg	line,	"include\routines_LEVELS.c", 227; 
 3820                        	
 3821                        		.dbg	line,	"include\routines_LEVELS.c", 228; // IF NPC X POSITION IS INFERIOR TO SCREEN RIGHT SIDE //
 3822                        	
 3823                        		.dbg	line,	"include\routines_LEVELS.c", 229; if(list_npc_x_pos_ref[i] < sgx_map_pxl_x + 256)
 3824                        		__ld.wm		_sgx_map_pxl_x
         02:CCD1  AD 8A 26   			lda.l	_sgx_map_pxl_x
         02:CCD4  AC 8B 26   			ldy.h	_sgx_map_pxl_x
 3825                        		__add.wi	256
         02:CCD7  18         			clc
         02:CCD8  69 00      			adc.l	#256
         02:CCDA  42         			say
         02:CCDB  69 01      			adc.h	#256
         02:CCDD  42         			say
 3826                        		__ld2x.um	__scroll_npc_end - 1  /* i */
         02:CCDE  AA         			tax
         02:CCDF  AD 45 26   			lda	__scroll_npc_end - 1
         02:CCE2  0A         			asl	a
         02:CCE3  22         			sax
 3827                        		__ugt_w.wax	_list_npc_x_pos_ref
         02:CCE4  18         			clc			; Subtract memory+1 from Y:A.
         02:CCE5  FD 04 26   			sbc.l	_list_npc_x_pos_ref, x
         02:CCE8  98         			tya
         02:CCE9  FD 05 26   			sbc.h	_list_npc_x_pos_ref, x		; CS if Y:A > memory.
 3828                        		__bfalse	.LL50
         02:CCEC  B0 03 4C 71			bcc	.LL50
         02:CCF0  CD          
 3829                        	
 3830                        		.dbg	line,	"include\routines_LEVELS.c", 230; {
 3831                        	
 3832                        		.dbg	line,	"include\routines_LEVELS.c", 231; // IF NPC X POSITION IS SUPERIOR TO SCREEN LEFT SIDE PLUS 32 PX //
 3833                        	
 3834                        		.dbg	line,	"include\routines_LEVELS.c", 232; if(list_npc_x_pos_ref[i] - sgx_map_pxl_x + 32 > 0)
 3835                        		__ld2x.umq	__scroll_npc_end - 1  /* i */
         02:CCF1  AD 45 26   			lda	__scroll_npc_end - 1
         02:CCF4  0A         			asl	a
         02:CCF5  AA         			tax
 3836                        		__ld.wax	_list_npc_x_pos_ref
         02:CCF6  BD 04 26   			lda.l	_list_npc_x_pos_ref, x
         02:CCF9  BC 05 26   			ldy.h	_list_npc_x_pos_ref, x
 3837                        		__sub.wm	_sgx_map_pxl_x
         02:CCFC  38         			sec
         02:CCFD  ED 8A 26   			sbc.l	_sgx_map_pxl_x
         02:CD00  42         			say
         02:CD01  ED 8B 26   			sbc.h	_sgx_map_pxl_x
         02:CD04  42         			say
 3838                        		__add.wi	32
         02:CD05  18         			clc
         02:CD06  69 20      			adc.l	#32
         02:CD08  90 01      			bcc	!+
         02:CD0A  C8         			iny
         02:CD0B             	!:
 3839                        		__sgt_w.wi	0
         02:CD0B  18         			clc			; Subtract integer+1 from Y:A.
         02:CD0C  E9 00      			sbc.l	#0
         02:CD0E  98         			tya
         02:CD0F  E9 00      			sbc.h	#0
         02:CD11  50 02      			bvc	!+
         02:CD13  49 80      			eor	#$80		; +ve if Y:A > integer (signed).
         02:CD15  49 80      	!:		eor	#$80
         02:CD17  0A         			asl	a
 3840                        		__bfalse	.LL51
         02:CD18  90 57      			bcc	.LL51
 3841                        	
 3842                        		.dbg	line,	"include\routines_LEVELS.c", 233; {
 3843                        	
 3844                        		.dbg	line,	"include\routines_LEVELS.c", 234; // IF NPC Y POSITION IS INFERIOR TO SCREEN BOTTOM //
 3845                        	
 3846                        		.dbg	line,	"include\routines_LEVELS.c", 235; if(list_npc_y_pos_ref[i] < sgx_map_pxl_y + 224)
 3847                        		__ld.wm		_sgx_map_pxl_y
         02:CD1A  AD 8C 26   			lda.l	_sgx_map_pxl_y
         02:CD1D  AC 8D 26   			ldy.h	_sgx_map_pxl_y
 3848                        		__add.wi	224
         02:CD20  18         			clc
         02:CD21  69 E0      			adc.l	#224
         02:CD23  90 01      			bcc	!+
         02:CD25  C8         			iny
         02:CD26             	!:
 3849                        		__ld2x.um	__scroll_npc_end - 1  /* i */
         02:CD26  AA         			tax
         02:CD27  AD 45 26   			lda	__scroll_npc_end - 1
         02:CD2A  0A         			asl	a
         02:CD2B  22         			sax
 3850                        		__ugt_w.wax	_list_npc_y_pos_ref
         02:CD2C  18         			clc			; Subtract memory+1 from Y:A.
         02:CD2D  FD 16 26   			sbc.l	_list_npc_y_pos_ref, x
         02:CD30  98         			tya
         02:CD31  FD 17 26   			sbc.h	_list_npc_y_pos_ref, x		; CS if Y:A > memory.
 3851                        		__bfalse	.LL52
         02:CD34  90 3B      			bcc	.LL52
 3852                        	
 3853                        		.dbg	line,	"include\routines_LEVELS.c", 236; {
 3854                        	
 3855                        		.dbg	line,	"include\routines_LEVELS.c", 237; // IF NPC Y POSITION IS SUPERIOR TO SCREEN TOP PLUS 32 PX //
 3856                        	
 3857                        		.dbg	line,	"include\routines_LEVELS.c", 238; if(list_npc_y_pos_ref[i] - sgx_map_pxl_y + 32 > 0)
 3858                        		__ld2x.umq	__scroll_npc_end - 1  /* i */
         02:CD36  AD 45 26   			lda	__scroll_npc_end - 1
         02:CD39  0A         			asl	a
         02:CD3A  AA         			tax
 3859                        		__ld.wax	_list_npc_y_pos_ref
         02:CD3B  BD 16 26   			lda.l	_list_npc_y_pos_ref, x
         02:CD3E  BC 17 26   			ldy.h	_list_npc_y_pos_ref, x
 3860                        		__sub.wm	_sgx_map_pxl_y
         02:CD41  38         			sec
         02:CD42  ED 8C 26   			sbc.l	_sgx_map_pxl_y
         02:CD45  42         			say
         02:CD46  ED 8D 26   			sbc.h	_sgx_map_pxl_y
         02:CD49  42         			say
 3861                        		__add.wi	32
         02:CD4A  18         			clc
         02:CD4B  69 20      			adc.l	#32
         02:CD4D  90 01      			bcc	!+
         02:CD4F  C8         			iny
         02:CD50             	!:
 3862                        		__sgt_w.wi	0
         02:CD50  18         			clc			; Subtract integer+1 from Y:A.
         02:CD51  E9 00      			sbc.l	#0
         02:CD53  98         			tya
         02:CD54  E9 00      			sbc.h	#0
         02:CD56  50 02      			bvc	!+
         02:CD58  49 80      			eor	#$80		; +ve if Y:A > integer (signed).
         02:CD5A  49 80      	!:		eor	#$80
         02:CD5C  0A         			asl	a
 3863                        		__bfalse	.LL53
         02:CD5D  90 12      			bcc	.LL53
 3864                        	
 3865                        		.dbg	line,	"include\routines_LEVELS.c", 239; {
 3866                        	
 3867                        		.dbg	line,	"include\routines_LEVELS.c", 240; // WE STORE THE NPC ID //
 3868                        	
 3869                        		.dbg	line,	"include\routines_LEVELS.c", 241; list_onscreen_npc[onscreen_npc_number] = i;
 3870                        		__ldx.umq	_onscreen_npc_number
         02:CD5F  AE AD 23   			ldx	_onscreen_npc_number
 3871                        		__ld.um		__scroll_npc_end - 1  /* i */
         02:CD62  AD 45 26   			lda	__scroll_npc_end - 1
         02:CD65  C2         			cly
 3872                        		__st.uaxq	_list_onscreen_npc
         02:CD66  9D C0 23   			sta	_list_onscreen_npc, x
 3873                        	
 3874                        		.dbg	line,	"include\routines_LEVELS.c", 242; onscreen_npc_number += 1;
 3875                        		__add_st.umiq	1, _onscreen_npc_number
         02:CD69  EE AD 23   			inc	_onscreen_npc_number
 3876                        	
 3877                        		.dbg	line,	"include\routines_LEVELS.c", 243; 
 3878                        	
 3879                        		.dbg	line,	"include\routines_LEVELS.c", 244; scroll_allowed = TRUE;
 3880                        		__st.umiq	1, __scroll_npc_end - 2  /* scroll_allowed */
         02:CD6C  A9 01      			lda.l	#1
         02:CD6E  8D 44 26   			sta	__scroll_npc_end - 2
 3881                        	
 3882                        		.dbg	line,	"include\routines_LEVELS.c", 245; }
 3883                        	
 3884                        		.dbg	line,	"include\routines_LEVELS.c", 246; }
 3885    02:CD71             	.LL53:
 3886                        	
 3887                        		.dbg	line,	"include\routines_LEVELS.c", 247; }
 3888    02:CD71             	.LL52:
 3889                        	
 3890                        		.dbg	line,	"include\routines_LEVELS.c", 248; }
 3891    02:CD71             	.LL51:
 3892                        	
 3893                        		.dbg	line,	"include\routines_LEVELS.c", 250; // IF NPC IS WITHIN THE SCREEN LIMITS //
 3894                        	
 3895                        		.dbg	line,	"include\routines_LEVELS.c", 251; if(scroll_allowed == TRUE)
 3896    02:CD71             	.LL50:
 3897                        		__ld.umq	__scroll_npc_end - 2  /* scroll_allowed */
         02:CD71  AD 44 26   			lda	__scroll_npc_end - 2
 3898                        		__equ_b.uiq	1
         02:CD74  C9 01      			cmp	#1
         02:CD76  F0 01      			beq	!+
         02:CD78  18         			clc
         02:CD79             	!:
 3899                        		__bfalse	.LL54
         02:CD79  90 44      			bcc	.LL54
 3900                        	
 3901                        		.dbg	line,	"include\routines_LEVELS.c", 252; {
 3902                        	
 3903                        		.dbg	line,	"include\routines_LEVELS.c", 253; list_npc_x_pos[i] = list_npc_x_pos_ref[i] - sgx_map_pxl_x;
 3904                        		__ld2x.umq	__scroll_npc_end - 1  /* i */
         02:CD7B  AD 45 26   			lda	__scroll_npc_end - 1
         02:CD7E  0A         			asl	a
         02:CD7F  AA         			tax
 3905                        		__ld.wax	_list_npc_x_pos_ref
         02:CD80  BD 04 26   			lda.l	_list_npc_x_pos_ref, x
         02:CD83  BC 05 26   			ldy.h	_list_npc_x_pos_ref, x
 3906                        		__sub.wm	_sgx_map_pxl_x
         02:CD86  38         			sec
         02:CD87  ED 8A 26   			sbc.l	_sgx_map_pxl_x
         02:CD8A  42         			say
         02:CD8B  ED 8B 26   			sbc.h	_sgx_map_pxl_x
         02:CD8E  42         			say
 3907                        		__ld2x.um	__scroll_npc_end - 1  /* i */
         02:CD8F  AA         			tax
         02:CD90  AD 45 26   			lda	__scroll_npc_end - 1
         02:CD93  0A         			asl	a
         02:CD94  22         			sax
 3908                        		__st.waxq	_list_npc_x_pos
         02:CD95  9D E0 25   			sta.l	_list_npc_x_pos, x
         02:CD98  98         			tya
         02:CD99  9D E1 25   			sta.h	_list_npc_x_pos, x
 3909                        	
 3910                        		.dbg	line,	"include\routines_LEVELS.c", 254; list_npc_y_pos[i] = list_npc_y_pos_ref[i] - sgx_map_pxl_y;
 3911                        		__ld2x.umq	__scroll_npc_end - 1  /* i */
         02:CD9C  AD 45 26   			lda	__scroll_npc_end - 1
         02:CD9F  0A         			asl	a
         02:CDA0  AA         			tax
 3912                        		__ld.wax	_list_npc_y_pos_ref
         02:CDA1  BD 16 26   			lda.l	_list_npc_y_pos_ref, x
         02:CDA4  BC 17 26   			ldy.h	_list_npc_y_pos_ref, x
 3913                        		__sub.wm	_sgx_map_pxl_y
         02:CDA7  38         			sec
         02:CDA8  ED 8C 26   			sbc.l	_sgx_map_pxl_y
         02:CDAB  42         			say
         02:CDAC  ED 8D 26   			sbc.h	_sgx_map_pxl_y
         02:CDAF  42         			say
 3914                        		__ld2x.um	__scroll_npc_end - 1  /* i */
         02:CDB0  AA         			tax
         02:CDB1  AD 45 26   			lda	__scroll_npc_end - 1
         02:CDB4  0A         			asl	a
         02:CDB5  22         			sax
 3915                        		__st.waxq	_list_npc_y_pos
         02:CDB6  9D F2 25   			sta.l	_list_npc_y_pos, x
         02:CDB9  98         			tya
         02:CDBA  9D F3 25   			sta.h	_list_npc_y_pos, x
 3916                        	
 3917                        		.dbg	line,	"include\routines_LEVELS.c", 255; }
 3918                        	
 3919                        		.dbg	line,	"include\routines_LEVELS.c", 257; else
 3920                        		__bra		.LL55
         02:CDBD  80 1E      			bra	.LL55
 3921    02:CDBF             	.LL54:
 3922                        	
 3923                        		.dbg	line,	"include\routines_LEVELS.c", 258; {
 3924                        	
 3925                        		.dbg	line,	"include\routines_LEVELS.c", 259; list_npc_x_pos[i] = -32;
 3926                        		__ld2x.umq	__scroll_npc_end - 1  /* i */
         02:CDBF  AD 45 26   			lda	__scroll_npc_end - 1
         02:CDC2  0A         			asl	a
         02:CDC3  AA         			tax
 3927                        		__st.waxiq	-32, _list_npc_x_pos
         02:CDC4  A9 E0      			lda.l	#-32
         02:CDC6  9D E0 25   			sta.l	_list_npc_x_pos, x
         02:CDC9  A9 FF      			lda.h	#-32
         02:CDCB  9D E1 25   			sta.h	_list_npc_x_pos, x
 3928                        	
 3929                        		.dbg	line,	"include\routines_LEVELS.c", 260; list_npc_y_pos[i] = -32;
 3930                        		__ld2x.umq	__scroll_npc_end - 1  /* i */
         02:CDCE  AD 45 26   			lda	__scroll_npc_end - 1
         02:CDD1  0A         			asl	a
         02:CDD2  AA         			tax
 3931                        		__st.waxiq	-32, _list_npc_y_pos
         02:CDD3  A9 E0      			lda.l	#-32
         02:CDD5  9D F2 25   			sta.l	_list_npc_y_pos, x
         02:CDD8  A9 FF      			lda.h	#-32
         02:CDDA  9D F3 25   			sta.h	_list_npc_y_pos, x
 3932                        	
 3933                        		.dbg	line,	"include\routines_LEVELS.c", 261; }
 3934    02:CDDD             	.LL55:
 3935                        	
 3936                        		.dbg	line,	"include\routines_LEVELS.c", 263; spr_set(i + npc_start_index);
 3937                        		__ld.um		__scroll_npc_end - 1  /* i */
         02:CDDD  AD 45 26   			lda	__scroll_npc_end - 1
         02:CDE0  C2         			cly
 3938                        		__add.um	_npc_start_index
         02:CDE1  18         			clc
         02:CDE2  6D AB 23   			adc	_npc_start_index
         02:CDE5  90 01      			bcc	!+
         02:CDE7  C8         			iny
         02:CDE8             	!:
 3939                        		__call		_spr_set.1
         02:CDE8  20 DD E7   			call	_spr_set.1
 3940                        	
 3941                        		.dbg	line,	"include\routines_LEVELS.c", 265; spr_x(list_npc_x_pos[i]);
 3942                        		__ld2x.umq	__scroll_npc_end - 1  /* i */
         02:CDEB  AD 45 26   			lda	__scroll_npc_end - 1
         02:CDEE  0A         			asl	a
         02:CDEF  AA         			tax
 3943                        		__ld.wax	_list_npc_x_pos
         02:CDF0  BD E0 25   			lda.l	_list_npc_x_pos, x
         02:CDF3  BC E1 25   			ldy.h	_list_npc_x_pos, x
 3944                        		__call		_spr_x.1
         02:CDF6  20 0A E8   			call	_spr_x.1
 3945                        	
 3946                        		.dbg	line,	"include\routines_LEVELS.c", 266; spr_y(list_npc_y_pos[i]);
 3947                        		__ld2x.umq	__scroll_npc_end - 1  /* i */
         02:CDF9  AD 45 26   			lda	__scroll_npc_end - 1
         02:CDFC  0A         			asl	a
         02:CDFD  AA         			tax
 3948                        		__ld.wax	_list_npc_y_pos
         02:CDFE  BD F2 25   			lda.l	_list_npc_y_pos, x
         02:CE01  BC F3 25   			ldy.h	_list_npc_y_pos, x
 3949                        		__call		_spr_y.1
         02:CE04  20 19 E8   			call	_spr_y.1
 3950                        	
 3951                        		.dbg	line,	"include\routines_LEVELS.c", 267; }
 3952                        	
 3953                        		.dbg	line,	"include\routines_LEVELS.c", 268; }
 3954    02:CE07             	.LL49	.alias		.LL46
 3955                        		__bra		.LL46
         02:CE07  4C BB CC   			bra	.LL46
 3956    02:CE0A             	.LL48:
 3957                        	
 3958                        		.dbg	line,	"include\routines_LEVELS.c", 269; }
 3959    02:CE0A             	.LL44:
 3960                        		__return	0
         02:CE0A  4C EF FF   			jmp	leave_proc
 3961                        		.dbg	clear
 3962                        		.endp
 3963                        		.pceas
 3964                        	
 3965                        		.dbg	line,	"include\routines_LEVELS.c", 274; int check_TILE_DEPTH(signed char x_offset , signed char y_offset)
 3966                        		.dbg	line,	"include\routines_LEVELS.c", 275; {
 3967                        	;***********************
 3968                        	;***********************
 3969                        	
 3970                        		.hucc
 3971    02:D936             		.proc		_check_TILE_DEPTH
 3972                        		__enter		_check_TILE_DEPTH
 3973                        	
 3974                        		.dbg	line,	"include\routines_LEVELS.c", 276; int player_COLL_X;
 3975                        	
 3976                        		.dbg	line,	"include\routines_LEVELS.c", 277; int player_COLL_Y;
 3977                        	
 3978                        		.dbg	line,	"include\routines_LEVELS.c", 280; player_COLL_X = player_pos_x + x_offset;
 3979                        		__ld.bs		2  /* x_offset */
         02:D936  A6 8D      			ldx	<__sp
         02:D938  B5 0A      			lda	<__stack + 2, x
         02:D93A  C2         			cly
         02:D93B  10 01      			bpl	!+	; signed
         02:D93D  88         			dey
         02:D93E             	!:
 3980                        		__add.wm	_player_pos_x
         02:D93E  18         			clc
         02:D93F  6D CE 24   			adc.l	_player_pos_x
         02:D942  42         			say
         02:D943  6D CF 24   			adc.h	_player_pos_x
         02:D946  42         			say
 3981                        		__st.wmq	__check_TILE_DEPTH_end - 2  /* player_COLL_X */
         02:D947  8D 44 26   			sta.l	__check_TILE_DEPTH_end - 2
         02:D94A  8C 45 26   			sty.h	__check_TILE_DEPTH_end - 2
 3982                        	
 3983                        		.dbg	line,	"include\routines_LEVELS.c", 281; player_COLL_Y = player_pos_y + 32 - y_offset;//32
 3984                        		__ld.wm		_player_pos_y
         02:D94D  AD D0 24   			lda.l	_player_pos_y
         02:D950  AC D1 24   			ldy.h	_player_pos_y
 3985                        		__add.wi	32
         02:D953  18         			clc
         02:D954  69 20      			adc.l	#32
         02:D956  90 01      			bcc	!+
         02:D958  C8         			iny
         02:D959             	!:
 3986                        		__push.wr
         02:D959  5A         			phy
         02:D95A  48         			pha
 3987                        		__ld.bs		0  /* y_offset */
         02:D95B  A6 8D      			ldx	<__sp
         02:D95D  B5 08      			lda	<__stack + 0, x
         02:D95F  C2         			cly
         02:D960  10 01      			bpl	!+	; signed
         02:D962  88         			dey
         02:D963             	!:
 3988                        		__sub.wt
         02:D963  BA         			tsx
         02:D964  38         			sec
         02:D965  49 FF      			eor	#$FF
         02:D967  7D 01 21   			adc.l	__tos, x
         02:D96A  42         			say
         02:D96B  49 FF      			eor	#$FF
         02:D96D  7D 02 21   			adc.h	__tos, x
         02:D970  42         			say
         02:D971  E8         			inx
         02:D972  E8         			inx
         02:D973  9A         			txs
 3989                        		__st.wmq	__check_TILE_DEPTH_end - 4  /* player_COLL_Y */
         02:D974  8D 42 26   			sta.l	__check_TILE_DEPTH_end - 4
         02:D977  8C 43 26   			sty.h	__check_TILE_DEPTH_end - 4
 3990                        	
 3991                        		.dbg	line,	"include\routines_LEVELS.c", 283; get_map_block(player_COLL_X + sgx_map_pxl_x, player_COLL_Y + sgx_map_pxl_y);
 3992                        		__ld.wm		__check_TILE_DEPTH_end - 2  /* player_COLL_X */
         02:D97A  AD 44 26   			lda.l	__check_TILE_DEPTH_end - 2
         02:D97D  AC 45 26   			ldy.h	__check_TILE_DEPTH_end - 2
 3993                        		__add.wm	_sgx_map_pxl_x
         02:D980  18         			clc
         02:D981  6D 8A 26   			adc.l	_sgx_map_pxl_x
         02:D984  42         			say
         02:D985  6D 8B 26   			adc.h	_sgx_map_pxl_x
         02:D988  42         			say
 3994                        		__st.wmq	map_pxl_x
         02:D989  85 FC      			sta.l	map_pxl_x
         02:D98B  84 FD      			sty.h	map_pxl_x
 3995                        		__ld.wm		__check_TILE_DEPTH_end - 4  /* player_COLL_Y */
         02:D98D  AD 42 26   			lda.l	__check_TILE_DEPTH_end - 4
         02:D990  AC 43 26   			ldy.h	__check_TILE_DEPTH_end - 4
 3996                        		__add.wm	_sgx_map_pxl_y
         02:D993  18         			clc
         02:D994  6D 8C 26   			adc.l	_sgx_map_pxl_y
         02:D997  42         			say
         02:D998  6D 8D 26   			adc.h	_sgx_map_pxl_y
         02:D99B  42         			say
 3997                        		__st.wmq	map_pxl_y
         02:D99C  85 FE      			sta.l	map_pxl_y
         02:D99E  84 FF      			sty.h	map_pxl_y
 3998                        		__call		_get_map_block.2
         02:D9A0  20 95 FF   			call	_get_map_block.2
 3999                        	
 4000                        		.dbg	line,	"include\routines_LEVELS.c", 284; }
 4001    02:D9A3             	.LL56:
 4002                        		__modsp		4
         02:D9A3  AA         			tax
         02:D9A4  A5 8D      			lda	<__sp
         02:D9A6  18         			clc
         02:D9A7  69 04      			adc	#4
         02:D9A9  85 8D      			sta	<__sp
         02:D9AB  8A         			txa
 4003                        		__return	1
         02:D9AC  AA         			tax
         02:D9AD  4C EF FF   			jmp	leave_proc
 4004                        		.dbg	clear
 4005                        		.endp
 4006                        		.pceas
 4007                        	
 4008                        		.dbg	line,	"include\routines_LEVELS.c", 286; // CHECK COLLISION WITH BG //
 4009                        		.dbg	line,	"include\routines_LEVELS.c", 287; int check_BG(signed char x_offset , signed char y_offset)
 4010                        		.dbg	line,	"include\routines_LEVELS.c", 288; {
 4011                        	;***********************
 4012                        	;***********************
 4013                        	
 4014                        		.hucc
 4015    02:DA91             		.proc		_check_BG
 4016                        		__enter		_check_BG
 4017                        	
 4018                        		.dbg	line,	"include\routines_LEVELS.c", 289; int player_COLL_X;
 4019                        	
 4020                        		.dbg	line,	"include\routines_LEVELS.c", 290; int player_COLL_Y;
 4021                        	
 4022                        		.dbg	line,	"include\routines_LEVELS.c", 293; player_COLL_X = player_pos_x + x_offset;
 4023                        		__ld.bs		2  /* x_offset */
         02:DA91  A6 8D      			ldx	<__sp
         02:DA93  B5 0A      			lda	<__stack + 2, x
         02:DA95  C2         			cly
         02:DA96  10 01      			bpl	!+	; signed
         02:DA98  88         			dey
         02:DA99             	!:
 4024                        		__add.wm	_player_pos_x
         02:DA99  18         			clc
         02:DA9A  6D CE 24   			adc.l	_player_pos_x
         02:DA9D  42         			say
         02:DA9E  6D CF 24   			adc.h	_player_pos_x
         02:DAA1  42         			say
 4025                        		__st.wmq	__check_BG_end - 2  /* player_COLL_X */
         02:DAA2  8D 44 26   			sta.l	__check_BG_end - 2
         02:DAA5  8C 45 26   			sty.h	__check_BG_end - 2
 4026                        	
 4027                        		.dbg	line,	"include\routines_LEVELS.c", 294; player_COLL_Y = player_pos_y + y_offset;
 4028                        		__ld.bs		0  /* y_offset */
         02:DAA8  A6 8D      			ldx	<__sp
         02:DAAA  B5 08      			lda	<__stack + 0, x
         02:DAAC  C2         			cly
         02:DAAD  10 01      			bpl	!+	; signed
         02:DAAF  88         			dey
         02:DAB0             	!:
 4029                        		__add.wm	_player_pos_y
         02:DAB0  18         			clc
         02:DAB1  6D D0 24   			adc.l	_player_pos_y
         02:DAB4  42         			say
         02:DAB5  6D D1 24   			adc.h	_player_pos_y
         02:DAB8  42         			say
 4030                        		__st.wmq	__check_BG_end - 4  /* player_COLL_Y */
         02:DAB9  8D 42 26   			sta.l	__check_BG_end - 4
         02:DABC  8C 43 26   			sty.h	__check_BG_end - 4
 4031                        	
 4032                        		.dbg	line,	"include\routines_LEVELS.c", 296; get_map_block(player_COLL_X + sgx_map_pxl_x, player_COLL_Y + sgx_map_pxl_y);
 4033                        		__ld.wm		__check_BG_end - 2  /* player_COLL_X */
         02:DABF  AD 44 26   			lda.l	__check_BG_end - 2
         02:DAC2  AC 45 26   			ldy.h	__check_BG_end - 2
 4034                        		__add.wm	_sgx_map_pxl_x
         02:DAC5  18         			clc
         02:DAC6  6D 8A 26   			adc.l	_sgx_map_pxl_x
         02:DAC9  42         			say
         02:DACA  6D 8B 26   			adc.h	_sgx_map_pxl_x
         02:DACD  42         			say
 4035                        		__st.wmq	map_pxl_x
         02:DACE  85 FC      			sta.l	map_pxl_x
         02:DAD0  84 FD      			sty.h	map_pxl_x
 4036                        		__ld.wm		__check_BG_end - 4  /* player_COLL_Y */
         02:DAD2  AD 42 26   			lda.l	__check_BG_end - 4
         02:DAD5  AC 43 26   			ldy.h	__check_BG_end - 4
 4037                        		__add.wm	_sgx_map_pxl_y
         02:DAD8  18         			clc
         02:DAD9  6D 8C 26   			adc.l	_sgx_map_pxl_y
         02:DADC  42         			say
         02:DADD  6D 8D 26   			adc.h	_sgx_map_pxl_y
         02:DAE0  42         			say
 4038                        		__st.wmq	map_pxl_y
         02:DAE1  85 FE      			sta.l	map_pxl_y
         02:DAE3  84 FF      			sty.h	map_pxl_y
 4039                        		__call		_get_map_block.2
         02:DAE5  20 95 FF   			call	_get_map_block.2
 4040                        	
 4041                        		.dbg	line,	"include\routines_LEVELS.c", 297; }
 4042    02:DAE8             	.LL57:
 4043                        		__modsp		4
         02:DAE8  AA         			tax
         02:DAE9  A5 8D      			lda	<__sp
         02:DAEB  18         			clc
         02:DAEC  69 04      			adc	#4
         02:DAEE  85 8D      			sta	<__sp
         02:DAF0  8A         			txa
 4044                        		__return	1
         02:DAF1  AA         			tax
         02:DAF2  4C EF FF   			jmp	leave_proc
 4045                        		.dbg	clear
 4046                        		.endp
 4047                        		.pceas
 4048                        	
 4049                        		.dbg	line,	"include\routines_LEVELS.c", 299; // CHECK COLLISION WITH OBJECTS //
 4050                        		.dbg	line,	"include\routines_LEVELS.c", 300; void check_OBJECT()
 4051                        		.dbg	line,	"include\routines_LEVELS.c", 301; {
 4052                        	;***********************
 4053                        	;***********************
 4054                        	
 4055                        		.hucc
 4056    01:DE70             		.proc		_check_OBJECT
 4057                        		__enter		_check_OBJECT
 4058                        	
 4059                        		.dbg	line,	"include\routines_LEVELS.c", 302; if(onscreen_object_number != 0)
 4060                        		__tst.um	_onscreen_object_number
         01:DE70  AD 2B 23   			lda	_onscreen_object_number
         01:DE73  C9 01      			cmp	#1
 4061                        		__bfalse	.LL59
         01:DE75  B0 03 4C F1			bcc	.LL59
         01:DE79  DF          
 4062                        	
 4063                        		.dbg	line,	"include\routines_LEVELS.c", 303; {
 4064                        	
 4065                        		.dbg	line,	"include\routines_LEVELS.c", 304; char i;
 4066                        	
 4067                        		.dbg	line,	"include\routines_LEVELS.c", 305; char current_object_id;
 4068                        	
 4069                        		.dbg	line,	"include\routines_LEVELS.c", 306; char current_object_type;
 4070                        	
 4071                        		.dbg	line,	"include\routines_LEVELS.c", 308; for(i=0 ; i<onscreen_object_number ; i++)
 4072                        		__st.umiq	0, __check_OBJECT_end - 1  /* i */
         01:DE7A  9C 02 23   			stz	__check_OBJECT_end - 1
 4073    01:DE7D             	.LL60:
 4074                        		__ld.umq	__check_OBJECT_end - 1  /* i */
         01:DE7D  AD 02 23   			lda	__check_OBJECT_end - 1
 4075                        		__ult_b.umq	_onscreen_object_number
         01:DE80  CD 2B 23   			cmp	_onscreen_object_number		; Subtract memory from A.
         01:DE83  6A         			ror	a		; CC if A < memory.
         01:DE84  49 80      			eor	#$80
         01:DE86  2A         			rol	a
 4076                        		__btrue		.LL62
         01:DE87  B0 08      			bcs	.LL62
 4077                        		__bra		.LL63
         01:DE89  4C F1 DF   			bra	.LL63
 4078    01:DE8C             	.LL61:
 4079                        		__inc.umq	__check_OBJECT_end - 1  /* i */
         01:DE8C  EE 02 23   			inc	__check_OBJECT_end - 1
 4080                        		__bra		.LL60
         01:DE8F  80 EC      			bra	.LL60
 4081    01:DE91             	.LL62:
 4082                        	
 4083                        		.dbg	line,	"include\routines_LEVELS.c", 309; {
 4084                        	
 4085                        		.dbg	line,	"include\routines_LEVELS.c", 310; // RETRIEVE OBJECT INDEX IN THE LIST //
 4086                        	
 4087                        		.dbg	line,	"include\routines_LEVELS.c", 311; current_object_id = list_onscreen_object[i];
 4088                        		__ldx.umq	__check_OBJECT_end - 1  /* i */
         01:DE91  AE 02 23   			ldx	__check_OBJECT_end - 1
 4089                        		__ld.uax	_list_onscreen_object
         01:DE94  BD 90 23   			lda	_list_onscreen_object, x
         01:DE97  C2         			cly
 4090                        		__st.umq	__check_OBJECT_end - 2  /* current_object_id */
         01:DE98  8D 01 23   			sta	__check_OBJECT_end - 2
 4091                        	
 4092                        		.dbg	line,	"include\routines_LEVELS.c", 312; // RETRIEVE OBJECT TYPE //
 4093                        	
 4094                        		.dbg	line,	"include\routines_LEVELS.c", 313; current_object_type = list_object_type[current_object_id];
 4095                        		__ldx.umq	__check_OBJECT_end - 2  /* current_object_id */
         01:DE9B  AE 01 23   			ldx	__check_OBJECT_end - 2
 4096                        		__ld.uax	_list_object_type
         01:DE9E  BD 2C 23   			lda	_list_object_type, x
         01:DEA1  C2         			cly
 4097                        		__st.umq	__check_OBJECT_end - 3  /* current_object_type */
         01:DEA2  8D 00 23   			sta	__check_OBJECT_end - 3
 4098                        	
 4099                        		.dbg	line,	"include\routines_LEVELS.c", 315; if(current_object_type != TYPE_POT)
 4100                        		__ld.umq	__check_OBJECT_end - 3  /* current_object_type */
         01:DEA5  AD 00 23   			lda	__check_OBJECT_end - 3
 4101                        		__neq_b.uiq	1
         01:DEA8  38         			sec
         01:DEA9  49 01      			eor	#1
         01:DEAB  D0 01      			bne	!+
         01:DEAD  18         			clc
         01:DEAE             	!:
 4102                        		__bfalse	.LL64
         01:DEAE  90 DC      			bcc	.LL64
 4103                        	
 4104                        		.dbg	line,	"include\routines_LEVELS.c", 316; {
 4105                        	
 4106                        		.dbg	line,	"include\routines_LEVELS.c", 317; if(abs( (player_pos_x + 16) - (list_object_x_pos[current_object_id] + 8) ) < OBJECT_MARGIN)
 4107                        		__ld.wm		_player_pos_x
         01:DEB0  AD CE 24   			lda.l	_player_pos_x
         01:DEB3  AC CF 24   			ldy.h	_player_pos_x
 4108                        		__add.wi	16
         01:DEB6  18         			clc
         01:DEB7  69 10      			adc.l	#16
         01:DEB9  90 01      			bcc	!+
         01:DEBB  C8         			iny
         01:DEBC             	!:
 4109                        		__push.wr
         01:DEBC  5A         			phy
         01:DEBD  48         			pha
 4110                        		__ld2x.umq	__check_OBJECT_end - 2  /* current_object_id */
         01:DEBE  AD 01 23   			lda	__check_OBJECT_end - 2
         01:DEC1  0A         			asl	a
         01:DEC2  AA         			tax
 4111                        		__ld.wax	_list_object_x_pos
         01:DEC3  BD D8 24   			lda.l	_list_object_x_pos, x
         01:DEC6  BC D9 24   			ldy.h	_list_object_x_pos, x
 4112                        		__add.wi	8
         01:DEC9  18         			clc
         01:DECA  69 08      			adc.l	#8
         01:DECC  90 01      			bcc	!+
         01:DECE  C8         			iny
         01:DECF             	!:
 4113                        		__sub.wt
         01:DECF  BA         			tsx
         01:DED0  38         			sec
         01:DED1  49 FF      			eor	#$FF
         01:DED3  7D 01 21   			adc.l	__tos, x
         01:DED6  42         			say
         01:DED7  49 FF      			eor	#$FF
         01:DED9  7D 02 21   			adc.h	__tos, x
         01:DEDC  42         			say
         01:DEDD  E8         			inx
         01:DEDE  E8         			inx
         01:DEDF  9A         			txs
 4114                        		__call		_abs.1
         01:DEE0  20 09 E5   			call	_abs.1
 4115                        		__slt_w.wi	10
         01:DEE3  C9 0A      			cmp.l	#10		; Subtract integer from Y:A.
         01:DEE5  98         			tya
         01:DEE6  E9 00      			sbc.h	#10
         01:DEE8  50 02      			bvc	!+
         01:DEEA  49 80      			eor	#$80		; -ve if Y:A < integer (signed).
         01:DEEC  0A         	!:		asl	a
 4116                        		__bfalse	.LL65
         01:DEED  90 9D      			bcc	.LL65
 4117                        	
 4118                        		.dbg	line,	"include\routines_LEVELS.c", 318; {
 4119                        	
 4120                        		.dbg	line,	"include\routines_LEVELS.c", 319; if(abs( (player_pos_y + 16) - (list_object_y_pos[current_object_id] + 8) ) < OBJECT_MARGIN)
 4121                        		__ld.wm		_player_pos_y
         01:DEEF  AD D0 24   			lda.l	_player_pos_y
         01:DEF2  AC D1 24   			ldy.h	_player_pos_y
 4122                        		__add.wi	16
         01:DEF5  18         			clc
         01:DEF6  69 10      			adc.l	#16
         01:DEF8  90 01      			bcc	!+
         01:DEFA  C8         			iny
         01:DEFB             	!:
 4123                        		__push.wr
         01:DEFB  5A         			phy
         01:DEFC  48         			pha
 4124                        		__ld2x.umq	__check_OBJECT_end - 2  /* current_object_id */
         01:DEFD  AD 01 23   			lda	__check_OBJECT_end - 2
         01:DF00  0A         			asl	a
         01:DF01  AA         			tax
 4125                        		__ld.wax	_list_object_y_pos
         01:DF02  BD 0A 25   			lda.l	_list_object_y_pos, x
         01:DF05  BC 0B 25   			ldy.h	_list_object_y_pos, x
 4126                        		__add.wi	8
         01:DF08  18         			clc
         01:DF09  69 08      			adc.l	#8
         01:DF0B  90 01      			bcc	!+
         01:DF0D  C8         			iny
         01:DF0E             	!:
 4127                        		__sub.wt
         01:DF0E  BA         			tsx
         01:DF0F  38         			sec
         01:DF10  49 FF      			eor	#$FF
         01:DF12  7D 01 21   			adc.l	__tos, x
         01:DF15  42         			say
         01:DF16  49 FF      			eor	#$FF
         01:DF18  7D 02 21   			adc.h	__tos, x
         01:DF1B  42         			say
         01:DF1C  E8         			inx
         01:DF1D  E8         			inx
         01:DF1E  9A         			txs
 4128                        		__call		_abs.1
         01:DF1F  20 09 E5   			call	_abs.1
 4129                        		__slt_w.wi	10
         01:DF22  C9 0A      			cmp.l	#10		; Subtract integer from Y:A.
         01:DF24  98         			tya
         01:DF25  E9 00      			sbc.h	#10
         01:DF27  50 02      			bvc	!+
         01:DF29  49 80      			eor	#$80		; -ve if Y:A < integer (signed).
         01:DF2B  0A         	!:		asl	a
 4130                        		__bfalse	.LL66
         01:DF2C  B0 03 4C 8C			bcc	.LL66
         01:DF30  DE          
 4131                        	
 4132                        		.dbg	line,	"include\routines_LEVELS.c", 320; {
 4133                        	
 4134                        		.dbg	line,	"include\routines_LEVELS.c", 321; // THE OBJECT DISAPPEARS //
 4135                        	
 4136                        		.dbg	line,	"include\routines_LEVELS.c", 322; list_object_x_pos[current_object_id] = -16;
 4137                        		__ld2x.umq	__check_OBJECT_end - 2  /* current_object_id */
         01:DF31  AD 01 23   			lda	__check_OBJECT_end - 2
         01:DF34  0A         			asl	a
         01:DF35  AA         			tax
 4138                        		__st.waxiq	-16, _list_object_x_pos
         01:DF36  A9 F0      			lda.l	#-16
         01:DF38  9D D8 24   			sta.l	_list_object_x_pos, x
         01:DF3B  A9 FF      			lda.h	#-16
         01:DF3D  9D D9 24   			sta.h	_list_object_x_pos, x
 4139                        	
 4140                        		.dbg	line,	"include\routines_LEVELS.c", 323; list_object_y_pos[current_object_id] = -16;
 4141                        		__ld2x.umq	__check_OBJECT_end - 2  /* current_object_id */
         01:DF40  AD 01 23   			lda	__check_OBJECT_end - 2
         01:DF43  0A         			asl	a
         01:DF44  AA         			tax
 4142                        		__st.waxiq	-16, _list_object_y_pos
         01:DF45  A9 F0      			lda.l	#-16
         01:DF47  9D 0A 25   			sta.l	_list_object_y_pos, x
         01:DF4A  A9 FF      			lda.h	#-16
         01:DF4C  9D 0B 25   			sta.h	_list_object_y_pos, x
 4143                        	
 4144                        		.dbg	line,	"include\routines_LEVELS.c", 324; list_object_state[current_object_id] = STATE_INACTIVE;
 4145                        		__ldx.umq	__check_OBJECT_end - 2  /* current_object_id */
         01:DF4F  AE 01 23   			ldx	__check_OBJECT_end - 2
 4146                        		__st.uaxiq	1, _list_object_state
         01:DF52  A9 01      			lda.l	#1
         01:DF54  9D 45 23   			sta	_list_object_state, x
 4147                        	
 4148                        		.dbg	line,	"include\routines_LEVELS.c", 326; spr_set(current_object_id + object_start_index);
 4149                        		__ld.um		__check_OBJECT_end - 2  /* current_object_id */
         01:DF57  AD 01 23   			lda	__check_OBJECT_end - 2
         01:DF5A  C2         			cly
 4150                        		__add.um	_object_start_index
         01:DF5B  18         			clc
         01:DF5C  6D 29 23   			adc	_object_start_index
         01:DF5F  90 01      			bcc	!+
         01:DF61  C8         			iny
         01:DF62             	!:
 4151                        		__call		_spr_set.1
         01:DF62  20 DD E7   			call	_spr_set.1
 4152                        	
 4153                        		.dbg	line,	"include\routines_LEVELS.c", 327; spr_x(list_object_x_pos[current_object_id]);
 4154                        		__ld2x.umq	__check_OBJECT_end - 2  /* current_object_id */
         01:DF65  AD 01 23   			lda	__check_OBJECT_end - 2
         01:DF68  0A         			asl	a
         01:DF69  AA         			tax
 4155                        		__ld.wax	_list_object_x_pos
         01:DF6A  BD D8 24   			lda.l	_list_object_x_pos, x
         01:DF6D  BC D9 24   			ldy.h	_list_object_x_pos, x
 4156                        		__call		_spr_x.1
         01:DF70  20 0A E8   			call	_spr_x.1
 4157                        	
 4158                        		.dbg	line,	"include\routines_LEVELS.c", 328; spr_y(list_object_y_pos[current_object_id]);
 4159                        		__ld2x.umq	__check_OBJECT_end - 2  /* current_object_id */
         01:DF73  AD 01 23   			lda	__check_OBJECT_end - 2
         01:DF76  0A         			asl	a
         01:DF77  AA         			tax
 4160                        		__ld.wax	_list_object_y_pos
         01:DF78  BD 0A 25   			lda.l	_list_object_y_pos, x
         01:DF7B  BC 0B 25   			ldy.h	_list_object_y_pos, x
 4161                        		__call		_spr_y.1
         01:DF7E  20 19 E8   			call	_spr_y.1
 4162                        	
 4163                        		.dbg	line,	"include\routines_LEVELS.c", 329; 
 4164                        	
 4165                        		.dbg	line,	"include\routines_LEVELS.c", 331; switch(current_object_type)
 4166                        		__ld.umq	__check_OBJECT_end - 3  /* current_object_type */
         01:DF81  AD 00 23   			lda	__check_OBJECT_end - 3
 4167                        		__bra		.LL67
         01:DF84  80 4A      			bra	.LL67
 4168                        	
 4169                        		.dbg	line,	"include\routines_LEVELS.c", 332; {
 4170                        	
 4171                        		.dbg	line,	"include\routines_LEVELS.c", 333; case TYPE_HOURGLASS:
 4172    01:DF86             	.LL69:
 4173                        		__case		0
 4174                        	
 4175                        		.dbg	line,	"include\routines_LEVELS.c", 334; if(seconds + 30 > 59)
 4176                        		__ld.um		_seconds
         01:DF86  AD 25 23   			lda	_seconds
         01:DF89  C2         			cly
 4177                        		__add.wi	30
         01:DF8A  18         			clc
         01:DF8B  69 1E      			adc.l	#30
         01:DF8D  90 01      			bcc	!+
         01:DF8F  C8         			iny
         01:DF90             	!:
 4178                        		__sgt_w.wi	59
         01:DF90  18         			clc			; Subtract integer+1 from Y:A.
         01:DF91  E9 3B      			sbc.l	#59
         01:DF93  98         			tya
         01:DF94  E9 00      			sbc.h	#59
         01:DF96  50 02      			bvc	!+
         01:DF98  49 80      			eor	#$80		; +ve if Y:A > integer (signed).
         01:DF9A  49 80      	!:		eor	#$80
         01:DF9C  0A         			asl	a
 4179                        		__bfalse	.LL70
         01:DF9D  90 13      			bcc	.LL70
 4180                        	
 4181                        		.dbg	line,	"include\routines_LEVELS.c", 335; {
 4182                        	
 4183                        		.dbg	line,	"include\routines_LEVELS.c", 336; seconds = seconds + 30 - 60;
 4184                        		__ld.um		_seconds
         01:DF9F  AD 25 23   			lda	_seconds
         01:DFA2  C2         			cly
 4185                        		__sub.wi	30
         01:DFA3  38         			sec
         01:DFA4  E9 1E      			sbc.l	#30
         01:DFA6  B0 01      			bcs	!+
         01:DFA8  88         			dey
         01:DFA9             	!:
 4186                        		__st.umq	_seconds
         01:DFA9  8D 25 23   			sta	_seconds
 4187                        	
 4188                        		.dbg	line,	"include\routines_LEVELS.c", 337; minutes += 1;
 4189                        		__add_st.umiq	1, _minutes
         01:DFAC  EE 24 23   			inc	_minutes
 4190                        	
 4191                        		.dbg	line,	"include\routines_LEVELS.c", 338; }
 4192                        	
 4193                        		.dbg	line,	"include\routines_LEVELS.c", 340; else
 4194                        		__bra		.LL71
         01:DFAF  4C 8C DE   			bra	.LL71
 4195    01:DFB2             	.LL70:
 4196                        	
 4197                        		.dbg	line,	"include\routines_LEVELS.c", 341; {
 4198                        	
 4199                        		.dbg	line,	"include\routines_LEVELS.c", 342; seconds += 30;
 4200                        		__add_st.umiq	30, _seconds
         01:DFB2  18         			clc
         01:DFB3  AD 25 23   			lda	_seconds
         01:DFB6  69 1E      			adc	#30
         01:DFB8  8D 25 23   			sta	_seconds
 4201                        	
 4202                        		.dbg	line,	"include\routines_LEVELS.c", 343; }
 4203    01:DFBB             	.LL71	.alias		.LL68
 4204                        	
 4205                        		.dbg	line,	"include\routines_LEVELS.c", 345; break;
 4206                        		__bra		.LL68
         01:DFBB  4C 8C DE   			bra	.LL68
 4207                        	
 4208                        		.dbg	line,	"include\routines_LEVELS.c", 347; case TYPE_POW:
 4209    01:DFBE             	.LL72:
 4210                        		__case		2
 4211                        	
 4212                        		.dbg	line,	"include\routines_LEVELS.c", 348; //
 4213                        	
 4214                        		.dbg	line,	"include\routines_LEVELS.c", 349; break;
 4215                        		__bra		.LL68
         01:DFBE  4C 8C DE   			bra	.LL68
 4216                        	
 4217                        		.dbg	line,	"include\routines_LEVELS.c", 351; case TYPE_GRAY_KEY:
 4218    01:DFC1             	.LL73:
 4219                        		__case		4
 4220                        	
 4221                        		.dbg	line,	"include\routines_LEVELS.c", 352; key_amount += 1;
 4222                        		__add_st.umiq	1, _key_amount
         01:DFC1  EE 22 23   			inc	_key_amount
 4223                        	
 4224                        		.dbg	line,	"include\routines_LEVELS.c", 353; display_KEY();
 4225                        		__call		_display_KEY
         01:DFC4  20 8B FF   			call	_display_KEY
 4226                        	
 4227                        		.dbg	line,	"include\routines_LEVELS.c", 354; break;
 4228                        		__bra		.LL68
         01:DFC7  4C 8C DE   			bra	.LL68
 4229                        	
 4230                        		.dbg	line,	"include\routines_LEVELS.c", 356; case TYPE_YASHICHI:
 4231    01:DFCA             	.LL74:
 4232                        		__case		14
 4233                        	
 4234                        		.dbg	line,	"include\routines_LEVELS.c", 357; life_amount += 1;
 4235                        		__add_st.umiq	1, _life_amount
         01:DFCA  EE 21 23   			inc	_life_amount
 4236                        	
 4237                        		.dbg	line,	"include\routines_LEVELS.c", 358; break;
 4238                        		__bra		.LL68
         01:DFCD  4C 8C DE   			bra	.LL68
 4239                        	
 4240                        		.dbg	line,	"include\routines_LEVELS.c", 359; }
 4241    01:DFD0             	.LL67:
 4242                        		__switch_c.ur	4
         01:DFD0  A2 05      			ldx	#4 + 1
         01:DFD2  CA         	!loop:		dex
         01:DFD3  F0 05      			beq	!found+
         01:DFD5  DD DF DF   			cmp	!table+ - 1, x
         01:DFD8  D0 F8      			bne	!loop-
         01:DFDA  8A         	!found:		txa
         01:DFDB  0A         			asl	a
         01:DFDC  AA         			tax
         01:DFDD  7C E4 DF   			jmp	[!table+ + 4, x]
 4243                        	
 4244    01:DFE0  0E 04 02 00	!table:		db	14, 4, 2, 0
 4245    01:DFE4  8C DE      			dw	.LL68
 4246    01:DFE6  CA DF      			dw	.LL74, .LL73, .LL72, .LL69
         01:DFE8  C1 DF       
         01:DFEA  BE DF       
         01:DFEC  86 DF       
 4247                        	
 4248    01:DFEE             	.LL68	.alias		.LL61
 4249                        	
 4250                        		.dbg	line,	"include\routines_LEVELS.c", 360; }
 4251                        	
 4252                        		.dbg	line,	"include\routines_LEVELS.c", 361; }
 4253    01:DFEE             	.LL66	.alias		.LL61
 4254                        	
 4255                        		.dbg	line,	"include\routines_LEVELS.c", 362; }
 4256    01:DFEE             	.LL65	.alias		.LL61
 4257                        	
 4258                        		.dbg	line,	"include\routines_LEVELS.c", 363; }
 4259    01:DFEE             	.LL64	.alias		.LL61
 4260                        		__bra		.LL61
         01:DFEE  4C 8C DE   			bra	.LL61
 4261    01:DFF1             	.LL63:
 4262                        	
 4263                        		.dbg	line,	"include\routines_LEVELS.c", 364; }
 4264                        	
 4265                        		.dbg	line,	"include\routines_LEVELS.c", 365; }
 4266    01:DFF1             	.LL59:
 4267    01:DFF1             	.LL58:
 4268                        		__return	0
         01:DFF1  4C EF FF   			jmp	leave_proc
 4269                        		.dbg	clear
 4270                        		.endp
 4271               6760     		.data
 4272               2300     		.bss
 4273    F8:2300             	__check_OBJECT_loc:
 4274    F8:2300             			ds	3
 4275    F8:2303             	__check_OBJECT_end:
 4276               E309     		.code
 4277                        		.pceas
 4278                        	
 4279                        		.dbg	line,	"include\routines_LEVELS.c", 367; // CHECK COLLISION WITH NPCS //
 4280                        		.dbg	line,	"include\routines_LEVELS.c", 368; void check_NPC()
 4281                        		.dbg	line,	"include\routines_LEVELS.c", 369; {
 4282                        	;***********************
 4283                        	;***********************
 4284                        	
 4285                        		.hucc
 4286    02:CE0D             		.proc		_check_NPC
 4287                        		__enter		_check_NPC
 4288                        	
 4289                        		.dbg	line,	"include\routines_LEVELS.c", 370; if(onscreen_npc_number != 0)
 4290                        		__tst.um	_onscreen_npc_number
         02:CE0D  AD AD 23   			lda	_onscreen_npc_number
         02:CE10  C9 01      			cmp	#1
 4291                        		__bfalse	.LL76
         02:CE12  B0 03 4C 48			bcc	.LL76
         02:CE16  CF          
 4292                        	
 4293                        		.dbg	line,	"include\routines_LEVELS.c", 371; {
 4294                        	
 4295                        		.dbg	line,	"include\routines_LEVELS.c", 372; if(player_state == STATE_IDLE || player_state == STATE_WALK)
 4296                        		__not.um	_player_state
         02:CE17  AD 15 23   			lda	_player_state
         02:CE1A  18         			clc
         02:CE1B  D0 01      			bne	!+
         02:CE1D  38         			sec
         02:CE1E             	!:
 4297                        		__btrue		.LL78
         02:CE1E  B0 08      			bcs	.LL78
 4298                        		__ld.umq	_player_state
         02:CE20  AD 15 23   			lda	_player_state
 4299                        		__equ_b.uiq	1
         02:CE23  C9 01      			cmp	#1
         02:CE25  F0 01      			beq	!+
         02:CE27  18         			clc
         02:CE28             	!:
 4300    02:CE28             	.LL78:
 4301                        		__bfalse	.LL77
         02:CE28  B0 03 4C 48			bcc	.LL77
         02:CE2C  CF          
 4302                        	
 4303                        		.dbg	line,	"include\routines_LEVELS.c", 373; {
 4304                        	
 4305                        		.dbg	line,	"include\routines_LEVELS.c", 374; char i;
 4306                        	
 4307                        		.dbg	line,	"include\routines_LEVELS.c", 375; char current_npc_id;
 4308                        	
 4309                        		.dbg	line,	"include\routines_LEVELS.c", 376; char current_npc_type;
 4310                        	
 4311                        		.dbg	line,	"include\routines_LEVELS.c", 378; for(i=0 ; i<onscreen_npc_number ; i++)
 4312                        		__st.umiq	0, __check_NPC_end - 1  /* i */
         02:CE2D  9C 45 26   			stz	__check_NPC_end - 1
 4313    02:CE30             	.LL79:
 4314                        		__ld.umq	__check_NPC_end - 1  /* i */
         02:CE30  AD 45 26   			lda	__check_NPC_end - 1
 4315                        		__ult_b.umq	_onscreen_npc_number
         02:CE33  CD AD 23   			cmp	_onscreen_npc_number		; Subtract memory from A.
         02:CE36  6A         			ror	a		; CC if A < memory.
         02:CE37  49 80      			eor	#$80
         02:CE39  2A         			rol	a
 4316                        		__btrue		.LL81
         02:CE3A  B0 08      			bcs	.LL81
 4317                        		__bra		.LL82
         02:CE3C  4C 48 CF   			bra	.LL82
 4318    02:CE3F             	.LL80:
 4319                        		__inc.umq	__check_NPC_end - 1  /* i */
         02:CE3F  EE 45 26   			inc	__check_NPC_end - 1
 4320                        		__bra		.LL79
         02:CE42  80 EC      			bra	.LL79
 4321    02:CE44             	.LL81:
 4322                        	
 4323                        		.dbg	line,	"include\routines_LEVELS.c", 379; {
 4324                        	
 4325                        		.dbg	line,	"include\routines_LEVELS.c", 380; // RETRIEVE NPC INDEX IN THE LIST //
 4326                        	
 4327                        		.dbg	line,	"include\routines_LEVELS.c", 381; current_npc_id = list_onscreen_npc[i];
 4328                        		__ldx.umq	__check_NPC_end - 1  /* i */
         02:CE44  AE 45 26   			ldx	__check_NPC_end - 1
 4329                        		__ld.uax	_list_onscreen_npc
         02:CE47  BD C0 23   			lda	_list_onscreen_npc, x
         02:CE4A  C2         			cly
 4330                        		__st.umq	__check_NPC_end - 2  /* current_npc_id */
         02:CE4B  8D 44 26   			sta	__check_NPC_end - 2
 4331                        	
 4332                        		.dbg	line,	"include\routines_LEVELS.c", 383; if(list_npc_state[current_npc_id] == STATE_ACTIVE)
 4333                        		__ldx.umq	__check_NPC_end - 2  /* current_npc_id */
         02:CE4E  AE 44 26   			ldx	__check_NPC_end - 2
 4334                        		__not.uax	_list_npc_state
         02:CE51  BD B7 23   			lda	_list_npc_state, x
         02:CE54  18         			clc
         02:CE55  D0 01      			bne	!+
         02:CE57  38         			sec
         02:CE58             	!:
 4335                        		__bfalse	.LL83
         02:CE58  90 E5      			bcc	.LL83
 4336                        	
 4337                        		.dbg	line,	"include\routines_LEVELS.c", 384; {
 4338                        	
 4339                        		.dbg	line,	"include\routines_LEVELS.c", 385; // RETRIEVE NPC TYPE //
 4340                        	
 4341                        		.dbg	line,	"include\routines_LEVELS.c", 386; current_npc_type = list_npc_type[current_npc_id];
 4342                        		__ldx.umq	__check_NPC_end - 2  /* current_npc_id */
         02:CE5A  AE 44 26   			ldx	__check_NPC_end - 2
 4343                        		__ld.uax	_list_npc_type
         02:CE5D  BD AE 23   			lda	_list_npc_type, x
         02:CE60  C2         			cly
 4344                        		__st.umq	__check_NPC_end - 3  /* current_npc_type */
         02:CE61  8D 43 26   			sta	__check_NPC_end - 3
 4345                        	
 4346                        		.dbg	line,	"include\routines_LEVELS.c", 388; if(abs( (player_pos_x + 16) - (list_npc_x_pos[current_npc_id] + 16) ) < OBJECT_MARGIN)
 4347                        		__ld.wm		_player_pos_x
         02:CE64  AD CE 24   			lda.l	_player_pos_x
         02:CE67  AC CF 24   			ldy.h	_player_pos_x
 4348                        		__add.wi	16
         02:CE6A  18         			clc
         02:CE6B  69 10      			adc.l	#16
         02:CE6D  90 01      			bcc	!+
         02:CE6F  C8         			iny
         02:CE70             	!:
 4349                        		__push.wr
         02:CE70  5A         			phy
         02:CE71  48         			pha
 4350                        		__ld2x.umq	__check_NPC_end - 2  /* current_npc_id */
         02:CE72  AD 44 26   			lda	__check_NPC_end - 2
         02:CE75  0A         			asl	a
         02:CE76  AA         			tax
 4351                        		__ld.wax	_list_npc_x_pos
         02:CE77  BD E0 25   			lda.l	_list_npc_x_pos, x
         02:CE7A  BC E1 25   			ldy.h	_list_npc_x_pos, x
 4352                        		__add.wi	16
         02:CE7D  18         			clc
         02:CE7E  69 10      			adc.l	#16
         02:CE80  90 01      			bcc	!+
         02:CE82  C8         			iny
         02:CE83             	!:
 4353                        		__sub.wt
         02:CE83  BA         			tsx
         02:CE84  38         			sec
         02:CE85  49 FF      			eor	#$FF
         02:CE87  7D 01 21   			adc.l	__tos, x
         02:CE8A  42         			say
         02:CE8B  49 FF      			eor	#$FF
         02:CE8D  7D 02 21   			adc.h	__tos, x
         02:CE90  42         			say
         02:CE91  E8         			inx
         02:CE92  E8         			inx
         02:CE93  9A         			txs
 4354                        		__call		_abs.1
         02:CE94  20 09 E5   			call	_abs.1
 4355                        		__slt_w.wi	10
         02:CE97  C9 0A      			cmp.l	#10		; Subtract integer from Y:A.
         02:CE99  98         			tya
         02:CE9A  E9 00      			sbc.h	#10
         02:CE9C  50 02      			bvc	!+
         02:CE9E  49 80      			eor	#$80		; -ve if Y:A < integer (signed).
         02:CEA0  0A         	!:		asl	a
 4356                        		__bfalse	.LL84
         02:CEA1  90 9C      			bcc	.LL84
 4357                        	
 4358                        		.dbg	line,	"include\routines_LEVELS.c", 389; {
 4359                        	
 4360                        		.dbg	line,	"include\routines_LEVELS.c", 390; if(abs( (player_pos_y + 16) - (list_npc_y_pos[current_npc_id] + 16) ) < OBJECT_MARGIN)
 4361                        		__ld.wm		_player_pos_y
         02:CEA3  AD D0 24   			lda.l	_player_pos_y
         02:CEA6  AC D1 24   			ldy.h	_player_pos_y
 4362                        		__add.wi	16
         02:CEA9  18         			clc
         02:CEAA  69 10      			adc.l	#16
         02:CEAC  90 01      			bcc	!+
         02:CEAE  C8         			iny
         02:CEAF             	!:
 4363                        		__push.wr
         02:CEAF  5A         			phy
         02:CEB0  48         			pha
 4364                        		__ld2x.umq	__check_NPC_end - 2  /* current_npc_id */
         02:CEB1  AD 44 26   			lda	__check_NPC_end - 2
         02:CEB4  0A         			asl	a
         02:CEB5  AA         			tax
 4365                        		__ld.wax	_list_npc_y_pos
         02:CEB6  BD F2 25   			lda.l	_list_npc_y_pos, x
         02:CEB9  BC F3 25   			ldy.h	_list_npc_y_pos, x
 4366                        		__add.wi	16
         02:CEBC  18         			clc
         02:CEBD  69 10      			adc.l	#16
         02:CEBF  90 01      			bcc	!+
         02:CEC1  C8         			iny
         02:CEC2             	!:
 4367                        		__sub.wt
         02:CEC2  BA         			tsx
         02:CEC3  38         			sec
         02:CEC4  49 FF      			eor	#$FF
         02:CEC6  7D 01 21   			adc.l	__tos, x
         02:CEC9  42         			say
         02:CECA  49 FF      			eor	#$FF
         02:CECC  7D 02 21   			adc.h	__tos, x
         02:CECF  42         			say
         02:CED0  E8         			inx
         02:CED1  E8         			inx
         02:CED2  9A         			txs
 4368                        		__call		_abs.1
         02:CED3  20 09 E5   			call	_abs.1
 4369                        		__slt_w.wi	10
         02:CED6  C9 0A      			cmp.l	#10		; Subtract integer from Y:A.
         02:CED8  98         			tya
         02:CED9  E9 00      			sbc.h	#10
         02:CEDB  50 02      			bvc	!+
         02:CEDD  49 80      			eor	#$80		; -ve if Y:A < integer (signed).
         02:CEDF  0A         	!:		asl	a
 4370                        		__bfalse	.LL85
         02:CEE0  B0 03 4C 3F			bcc	.LL85
         02:CEE4  CE          
 4371                        	
 4372                        		.dbg	line,	"include\routines_LEVELS.c", 391; {               
 4373                        	
 4374                        		.dbg	line,	"include\routines_LEVELS.c", 392; switch(current_npc_type)
 4375                        		__ld.umq	__check_NPC_end - 3  /* current_npc_type */
         02:CEE5  AD 43 26   			lda	__check_NPC_end - 3
 4376                        		__bra		.LL86
         02:CEE8  80 4A      			bra	.LL86
 4377                        	
 4378                        		.dbg	line,	"include\routines_LEVELS.c", 393; {
 4379                        	
 4380                        		.dbg	line,	"include\routines_LEVELS.c", 394; case TYPE_NPC_REWARD:
 4381    02:CEEA             	.LL88:
 4382                        		__case		0
 4383                        	
 4384                        		.dbg	line,	"include\routines_LEVELS.c", 395; //
 4385                        	
 4386                        		.dbg	line,	"include\routines_LEVELS.c", 396; break;
 4387                        		__bra		.LL87
         02:CEEA  4C 3F CE   			bra	.LL87
 4388                        	
 4389                        		.dbg	line,	"include\routines_LEVELS.c", 398; case TYPE_NPC_SHOP:
 4390    02:CEED             	.LL89:
 4391                        		__case		1
 4392                        	
 4393                        		.dbg	line,	"include\routines_LEVELS.c", 399; disp_off();
 4394                        		__call		_disp_off
         02:CEED  20 29 E4   			call	_disp_off
 4395                        	
 4396                        		.dbg	line,	"include\routines_LEVELS.c", 400; minutes_backup = minutes;
 4397                        		__ld.um		_minutes
         02:CEF0  AD 24 23   			lda	_minutes
         02:CEF3  C2         			cly
 4398                        		__st.umq	_minutes_backup
         02:CEF4  8D 27 23   			sta	_minutes_backup
 4399                        	
 4400                        		.dbg	line,	"include\routines_LEVELS.c", 401; seconds_backup = seconds;
 4401                        		__ld.um		_seconds
         02:CEF7  AD 25 23   			lda	_seconds
         02:CEFA  C2         			cly
 4402                        		__st.umq	_seconds_backup
         02:CEFB  8D 28 23   			sta	_seconds_backup
 4403                        	
 4404                        		.dbg	line,	"include\routines_LEVELS.c", 402; list_npc_state[current_npc_id] = STATE_INACTIVE;
 4405                        		__ldx.umq	__check_NPC_end - 2  /* current_npc_id */
         02:CEFE  AE 44 26   			ldx	__check_NPC_end - 2
 4406                        		__st.uaxiq	1, _list_npc_state
         02:CF01  A9 01      			lda.l	#1
         02:CF03  9D B7 23   			sta	_list_npc_state, x
 4407                        	
 4408                        		.dbg	line,	"include\routines_LEVELS.c", 403; camera_pos_x_backup = sgx_map_pxl_x;
 4409                        		__ld.wm		_sgx_map_pxl_x
         02:CF06  AD 8A 26   			lda.l	_sgx_map_pxl_x
         02:CF09  AC 8B 26   			ldy.h	_sgx_map_pxl_x
 4410                        		__st.wmq	_camera_pos_x_backup
         02:CF0C  8D D4 24   			sta.l	_camera_pos_x_backup
         02:CF0F  8C D5 24   			sty.h	_camera_pos_x_backup
 4411                        	
 4412                        		.dbg	line,	"include\routines_LEVELS.c", 404; camera_pos_y_backup = list_npc_y_pos_ref[current_npc_id] - 128;                                    
 4413                        		__ld2x.umq	__check_NPC_end - 2  /* current_npc_id */
         02:CF12  AD 44 26   			lda	__check_NPC_end - 2
         02:CF15  0A         			asl	a
         02:CF16  AA         			tax
 4414                        		__ld.wax	_list_npc_y_pos_ref
         02:CF17  BD 16 26   			lda.l	_list_npc_y_pos_ref, x
         02:CF1A  BC 17 26   			ldy.h	_list_npc_y_pos_ref, x
 4415                        		__sub.wi	128
         02:CF1D  38         			sec
         02:CF1E  E9 80      			sbc.l	#128
         02:CF20  B0 01      			bcs	!+
         02:CF22  88         			dey
         02:CF23             	!:
 4416                        		__st.wmq	_camera_pos_y_backup
         02:CF23  8D D6 24   			sta.l	_camera_pos_y_backup
         02:CF26  8C D7 24   			sty.h	_camera_pos_y_backup
 4417                        	
 4418                        		.dbg	line,	"include\routines_LEVELS.c", 405; sequence_loaded = FALSE;
 4419                        		__st.umiq	0, _sequence_loaded
         02:CF29  9C 11 23   			stz	_sequence_loaded
 4420                        	
 4421                        		.dbg	line,	"include\routines_LEVELS.c", 406; sequence_id = SEQUENCE_SHOP;
 4422                        		__st.umiq	4, _sequence_id
         02:CF2C  A9 04      			lda.l	#4
         02:CF2E  8D 10 23   			sta	_sequence_id
 4423                        	
 4424                        		.dbg	line,	"include\routines_LEVELS.c", 407; break;
 4425                        		__bra		.LL87
         02:CF31  4C 3F CE   			bra	.LL87
 4426                        	
 4427                        		.dbg	line,	"include\routines_LEVELS.c", 408; }
 4428    02:CF34             	.LL86:
 4429                        		__switch_r.ur	0, 1
         02:CF34  C9 02      			cmp	#(1 - 0) + 1
         02:CF36  90 02      			bcc	!found+
         02:CF38  A9 02      	!default:	lda	#(1 - 0) + 1
         02:CF3A  0A         	!found:		asl	a
         02:CF3B  AA         			tax
         02:CF3C  7C 3F CF   			jmp	[!table+, x]
 4430                        	
 4431    02:CF3F  EA CE      	!table:		dw	.LL88, .LL89
         02:CF41  ED CE       
 4432    02:CF43  3F CE      			dw	.LL87
 4433    02:CF45             	.LL87	.alias		.LL80
 4434                        	
 4435                        		.dbg	line,	"include\routines_LEVELS.c", 409; }
 4436                        	
 4437                        		.dbg	line,	"include\routines_LEVELS.c", 410; }
 4438    02:CF45             	.LL85	.alias		.LL80
 4439                        	
 4440                        		.dbg	line,	"include\routines_LEVELS.c", 411; }
 4441    02:CF45             	.LL84	.alias		.LL80
 4442                        	
 4443                        		.dbg	line,	"include\routines_LEVELS.c", 412; }
 4444    02:CF45             	.LL83	.alias		.LL80
 4445                        		__bra		.LL80
         02:CF45  4C 3F CE   			bra	.LL80
 4446    02:CF48             	.LL82:
 4447                        	
 4448                        		.dbg	line,	"include\routines_LEVELS.c", 413; }
 4449                        	
 4450                        		.dbg	line,	"include\routines_LEVELS.c", 414; }
 4451    02:CF48             	.LL77:
 4452                        	
 4453                        		.dbg	line,	"include\routines_LEVELS.c", 415; }
 4454    02:CF48             	.LL76:
 4455    02:CF48             	.LL75:
 4456                        		__return	0
         02:CF48  4C EF FF   			jmp	leave_proc
 4457                        		.dbg	clear
 4458                        		.endp
 4459                        		.pceas
 4460                        	
 4461                        		.dbg	line,	"include\routines_LEVELS.c", 421; void scroll_BG()
 4462                        		.dbg	line,	"include\routines_LEVELS.c", 422; {
 4463                        	;***********************
 4464                        	;***********************
 4465                        	
 4466                        		.hucc
 4467    02:DD45             		.proc		_scroll_BG
 4468                        		__enter		_scroll_BG
 4469                        	
 4470                        		.dbg	line,	"include\routines_LEVELS.c", 423; // UPDATE VDC2 BG //
 4471                        	
 4472                        		.dbg	line,	"include\routines_LEVELS.c", 424; sgx_scroll_map();
 4473                        		__call		_sgx_scroll_map
         02:DD45  20 81 FF   			call	_sgx_scroll_map
 4474                        	
 4475                        		.dbg	line,	"include\routines_LEVELS.c", 426; //--------------------------------------------------------------------------------------//
 4476                        	
 4477                        		.dbg	line,	"include\routines_LEVELS.c", 427; //                                        VDC 2                                         //
 4478                        	
 4479                        		.dbg	line,	"include\routines_LEVELS.c", 428; //--------------------------------------------------------------------------------------//
 4480                        	
 4481                        		.dbg	line,	"include\routines_LEVELS.c", 430; sgx_scroll_split(0,   0, sgx_map_pxl_x & (BAT_SIZE_W - 1), sgx_map_pxl_y & (BAT_SIZE_H - 1), BKG_ON | SPR_ON);
 4482                        		__st.umiq	0, _al
         02:DD48  64 F8      			stz	_al
 4483                        		__st.umiq	0, _ah
         02:DD4A  64 F9      			stz	_ah
 4484                        		__ld.wm		_sgx_map_pxl_x
         02:DD4C  AD 8A 26   			lda.l	_sgx_map_pxl_x
         02:DD4F  AC 8B 26   			ldy.h	_sgx_map_pxl_x
 4485                        		__and.wi	2047
         02:DD52  29 FF      			and.l	#2047
         02:DD54  42         			say
         02:DD55  29 07      			and.h	#2047
         02:DD57  42         			say
 4486                        		__st.wmq	_bx
         02:DD58  85 FA      			sta.l	_bx
         02:DD5A  84 FB      			sty.h	_bx
 4487                        		__ld.wm		_sgx_map_pxl_y
         02:DD5C  AD 8C 26   			lda.l	_sgx_map_pxl_y
         02:DD5F  AC 8D 26   			ldy.h	_sgx_map_pxl_y
 4488                        		__and.wi	255
         02:DD62  29 FF      			and	#255
         02:DD64  C2         			cly
 4489                        		__st.wmq	_cx
         02:DD65  85 FC      			sta.l	_cx
         02:DD67  84 FD      			sty.h	_cx
 4490                        		__st.umiq	192, _dl
         02:DD69  A9 C0      			lda.l	#192
         02:DD6B  85 FE      			sta	_dl
 4491                        		__call		_sgx_scroll_split.5
         02:DD6D  20 77 FF   			call	_sgx_scroll_split.5
 4492                        	
 4493                        		.dbg	line,	"include\routines_LEVELS.c", 431; }
 4494    02:DD70             	.LL90:
 4495                        		__return	0
         02:DD70  4C EF FF   			jmp	leave_proc
 4496                        		.dbg	clear
 4497                        		.endp
 4498                        		.pceas
 4499                        	
 4500                        		.dbg	line,	"include\routines_LEVELS.c", 434; void recenter_CAMERA()
 4501                        		.dbg	line,	"include\routines_LEVELS.c", 435; {
 4502                        	;***********************
 4503                        	;***********************
 4504                        	
 4505                        		.hucc
 4506    02:D2AD             		.proc		_recenter_CAMERA
 4507                        		__enter		_recenter_CAMERA
 4508                        	
 4509                        		.dbg	line,	"include\routines_LEVELS.c", 436; signed char camera_y_move;
 4510                        	
 4511                        		.dbg	line,	"include\routines_LEVELS.c", 438; spr_set(player_id);
 4512                        		__ld.umq	_player_id
         02:D2AD  AD 14 23   			lda	_player_id
 4513                        		__call		_spr_set.1
         02:D2B0  20 DD E7   			call	_spr_set.1
 4514                        	
 4515                        		.dbg	line,	"include\routines_LEVELS.c", 441; if(player_pos_y < 128)
 4516                        		__ld.wm		_player_pos_y
         02:D2B3  AD D0 24   			lda.l	_player_pos_y
         02:D2B6  AC D1 24   			ldy.h	_player_pos_y
 4517                        		__slt_w.wi	128
         02:D2B9  C9 80      			cmp.l	#128		; Subtract integer from Y:A.
         02:D2BB  98         			tya
         02:D2BC  E9 00      			sbc.h	#128
         02:D2BE  50 02      			bvc	!+
         02:D2C0  49 80      			eor	#$80		; -ve if Y:A < integer (signed).
         02:D2C2  0A         	!:		asl	a
 4518                        		__bfalse	.LL92
         02:D2C3  90 70      			bcc	.LL92
 4519                        	
 4520                        		.dbg	line,	"include\routines_LEVELS.c", 442; {
 4521                        	
 4522                        		.dbg	line,	"include\routines_LEVELS.c", 443; player_pos_y += CAMERA_RECENTER_VELOCITY;
 4523                        		__add_st.wmiq	4, _player_pos_y
         02:D2C5  18         			clc
         02:D2C6  AD D0 24   			lda.l	_player_pos_y
         02:D2C9  69 04      			adc.l	#4
         02:D2CB  8D D0 24   			sta.l	_player_pos_y
         02:D2CE  90 03      			bcc	!+
         02:D2D0  EE D1 24   			inc.h	_player_pos_y
         02:D2D3             	!:
 4524                        	
 4525                        		.dbg	line,	"include\routines_LEVELS.c", 445; if(player_pos_y > 128)
 4526                        		__ld.wm		_player_pos_y
         02:D2D3  AD D0 24   			lda.l	_player_pos_y
         02:D2D6  AC D1 24   			ldy.h	_player_pos_y
 4527                        		__sgt_w.wi	128
         02:D2D9  18         			clc			; Subtract integer+1 from Y:A.
         02:D2DA  E9 80      			sbc.l	#128
         02:D2DC  98         			tya
         02:D2DD  E9 00      			sbc.h	#128
         02:D2DF  50 02      			bvc	!+
         02:D2E1  49 80      			eor	#$80		; +ve if Y:A > integer (signed).
         02:D2E3  49 80      	!:		eor	#$80
         02:D2E5  0A         			asl	a
 4528                        		__bfalse	.LL93
         02:D2E6  90 24      			bcc	.LL93
 4529                        	
 4530                        		.dbg	line,	"include\routines_LEVELS.c", 446; {
 4531                        	
 4532                        		.dbg	line,	"include\routines_LEVELS.c", 447; camera_y_move = CAMERA_RECENTER_VELOCITY - (player_pos_y - 128);
 4533                        		__ld.wm		_player_pos_y
         02:D2E8  AD D0 24   			lda.l	_player_pos_y
         02:D2EB  AC D1 24   			ldy.h	_player_pos_y
 4534                        		__sub.wi	128
         02:D2EE  38         			sec
         02:D2EF  E9 80      			sbc.l	#128
         02:D2F1  B0 01      			bcs	!+
         02:D2F3  88         			dey
         02:D2F4             	!:
 4535                        		__isub.wi	4
         02:D2F4  38         			sec
         02:D2F5  49 FF      			eor	#$FF
         02:D2F7  69 04      			adc.l	#4
         02:D2F9  42         			say
         02:D2FA  49 FF      			eor	#$FF
         02:D2FC  69 00      			adc.h	#4
         02:D2FE  42         			say
 4536                        		__st.umq	__recenter_CAMERA_end - 1  /* camera_y_move */
         02:D2FF  8D 45 26   			sta	__recenter_CAMERA_end - 1
 4537                        	
 4538                        		.dbg	line,	"include\routines_LEVELS.c", 449; player_pos_y = 128;
 4539                        		__st.wmiq	128, _player_pos_y
         02:D302  A9 80      			lda.l	#128
         02:D304  8D D0 24   			sta.l	_player_pos_y
         02:D307  9C D1 24   			stz.h	_player_pos_y
 4540                        	
 4541                        		.dbg	line,	"include\routines_LEVELS.c", 450; }
 4542                        	
 4543                        		.dbg	line,	"include\routines_LEVELS.c", 452; else
 4544                        		__bra		.LL94
         02:D30A  80 05      			bra	.LL94
 4545    02:D30C             	.LL93:
 4546                        	
 4547                        		.dbg	line,	"include\routines_LEVELS.c", 453; {
 4548                        	
 4549                        		.dbg	line,	"include\routines_LEVELS.c", 454; camera_y_move = CAMERA_RECENTER_VELOCITY;
 4550                        		__st.umiq	4, __recenter_CAMERA_end - 1  /* camera_y_move */
         02:D30C  A9 04      			lda.l	#4
         02:D30E  8D 45 26   			sta	__recenter_CAMERA_end - 1
 4551                        	
 4552                        		.dbg	line,	"include\routines_LEVELS.c", 455; }
 4553    02:D311             	.LL94:
 4554                        	
 4555                        		.dbg	line,	"include\routines_LEVELS.c", 457; spr_y(player_pos_y);
 4556                        		__ld.wm		_player_pos_y
         02:D311  AD D0 24   			lda.l	_player_pos_y
         02:D314  AC D1 24   			ldy.h	_player_pos_y
 4557                        		__call		_spr_y.1
         02:D317  20 19 E8   			call	_spr_y.1
 4558                        	
 4559                        		.dbg	line,	"include\routines_LEVELS.c", 459; sgx_map_pxl_y -= camera_y_move;
 4560                        		__ld.bm		__recenter_CAMERA_end - 1  /* camera_y_move */
         02:D31A  AD 45 26   			lda	__recenter_CAMERA_end - 1
         02:D31D  C2         			cly
         02:D31E  10 01      			bpl	!+
         02:D320  88         			dey
         02:D321             	!:
 4561                        		__isub_st.wmq	_sgx_map_pxl_y
         02:D321  38         			sec
         02:D322  49 FF      			eor	#$FF
         02:D324  6D 8C 26   			adc.l	_sgx_map_pxl_y
         02:D327  8D 8C 26   			sta.l	_sgx_map_pxl_y
         02:D32A  98         			tya
         02:D32B  49 FF      			eor	#$FF
         02:D32D  6D 8D 26   			adc.h	_sgx_map_pxl_y
         02:D330  8D 8D 26   			sta.h	_sgx_map_pxl_y
 4562                        	
 4563                        		.dbg	line,	"include\routines_LEVELS.c", 460; }
 4564                        	
 4565                        		.dbg	line,	"include\routines_LEVELS.c", 463; else if(player_pos_y > 128)
 4566                        		__bra		.LL95
         02:D333  80 7C      			bra	.LL95
 4567    02:D335             	.LL92:
 4568                        		__ld.wm		_player_pos_y
         02:D335  AD D0 24   			lda.l	_player_pos_y
         02:D338  AC D1 24   			ldy.h	_player_pos_y
 4569                        		__sgt_w.wi	128
         02:D33B  18         			clc			; Subtract integer+1 from Y:A.
         02:D33C  E9 80      			sbc.l	#128
         02:D33E  98         			tya
         02:D33F  E9 00      			sbc.h	#128
         02:D341  50 02      			bvc	!+
         02:D343  49 80      			eor	#$80		; +ve if Y:A > integer (signed).
         02:D345  49 80      	!:		eor	#$80
         02:D347  0A         			asl	a
 4570                        		__bfalse	.LL96
         02:D348  90 67      			bcc	.LL96
 4571                        	
 4572                        		.dbg	line,	"include\routines_LEVELS.c", 464; {
 4573                        	
 4574                        		.dbg	line,	"include\routines_LEVELS.c", 465; player_pos_y -= CAMERA_RECENTER_VELOCITY;
 4575                        		__sub_st.wmiq	4, _player_pos_y
         02:D34A  38         			sec
         02:D34B  AD D0 24   			lda.l	_player_pos_y
         02:D34E  E9 04      			sbc.l	#4
         02:D350  8D D0 24   			sta.l	_player_pos_y
         02:D353  B0 03      			bcs	!+
         02:D355  CE D1 24   			dec.h	_player_pos_y
         02:D358             	!:
 4576                        	
 4577                        		.dbg	line,	"include\routines_LEVELS.c", 467; if(player_pos_y < 128)
 4578                        		__ld.wm		_player_pos_y
         02:D358  AD D0 24   			lda.l	_player_pos_y
         02:D35B  AC D1 24   			ldy.h	_player_pos_y
 4579                        		__slt_w.wi	128
         02:D35E  C9 80      			cmp.l	#128		; Subtract integer from Y:A.
         02:D360  98         			tya
         02:D361  E9 00      			sbc.h	#128
         02:D363  50 02      			bvc	!+
         02:D365  49 80      			eor	#$80		; -ve if Y:A < integer (signed).
         02:D367  0A         	!:		asl	a
 4580                        		__bfalse	.LL97
         02:D368  90 24      			bcc	.LL97
 4581                        	
 4582                        		.dbg	line,	"include\routines_LEVELS.c", 468; {
 4583                        	
 4584                        		.dbg	line,	"include\routines_LEVELS.c", 469; camera_y_move = CAMERA_RECENTER_VELOCITY - (128 - player_pos_y);
 4585                        		__ld.wi		128
         02:D36A  A9 80      			lda.l	#128
         02:D36C  C2         			cly
 4586                        		__sub.wm	_player_pos_y
         02:D36D  38         			sec
         02:D36E  ED D0 24   			sbc.l	_player_pos_y
         02:D371  42         			say
         02:D372  ED D1 24   			sbc.h	_player_pos_y
         02:D375  42         			say
 4587                        		__isub.wi	4
         02:D376  38         			sec
         02:D377  49 FF      			eor	#$FF
         02:D379  69 04      			adc.l	#4
         02:D37B  42         			say
         02:D37C  49 FF      			eor	#$FF
         02:D37E  69 00      			adc.h	#4
         02:D380  42         			say
 4588                        		__st.umq	__recenter_CAMERA_end - 1  /* camera_y_move */
         02:D381  8D 45 26   			sta	__recenter_CAMERA_end - 1
 4589                        	
 4590                        		.dbg	line,	"include\routines_LEVELS.c", 471; player_pos_y = 128;
 4591                        		__st.wmiq	128, _player_pos_y
         02:D384  A9 80      			lda.l	#128
         02:D386  8D D0 24   			sta.l	_player_pos_y
         02:D389  9C D1 24   			stz.h	_player_pos_y
 4592                        	
 4593                        		.dbg	line,	"include\routines_LEVELS.c", 472; }
 4594                        	
 4595                        		.dbg	line,	"include\routines_LEVELS.c", 474; else
 4596                        		__bra		.LL98
         02:D38C  80 05      			bra	.LL98
 4597    02:D38E             	.LL97:
 4598                        	
 4599                        		.dbg	line,	"include\routines_LEVELS.c", 475; {
 4600                        	
 4601                        		.dbg	line,	"include\routines_LEVELS.c", 476; camera_y_move = CAMERA_RECENTER_VELOCITY;
 4602                        		__st.umiq	4, __recenter_CAMERA_end - 1  /* camera_y_move */
         02:D38E  A9 04      			lda.l	#4
         02:D390  8D 45 26   			sta	__recenter_CAMERA_end - 1
 4603                        	
 4604                        		.dbg	line,	"include\routines_LEVELS.c", 477; }
 4605    02:D393             	.LL98:
 4606                        	
 4607                        		.dbg	line,	"include\routines_LEVELS.c", 479; spr_y(player_pos_y);
 4608                        		__ld.wm		_player_pos_y
         02:D393  AD D0 24   			lda.l	_player_pos_y
         02:D396  AC D1 24   			ldy.h	_player_pos_y
 4609                        		__call		_spr_y.1
         02:D399  20 19 E8   			call	_spr_y.1
 4610                        	
 4611                        		.dbg	line,	"include\routines_LEVELS.c", 481; sgx_map_pxl_y += camera_y_move;
 4612                        		__ld.bm		__recenter_CAMERA_end - 1  /* camera_y_move */
         02:D39C  AD 45 26   			lda	__recenter_CAMERA_end - 1
         02:D39F  C2         			cly
         02:D3A0  10 01      			bpl	!+
         02:D3A2  88         			dey
         02:D3A3             	!:
 4613                        		__add_st.wmq	_sgx_map_pxl_y
         02:D3A3  18         			clc
         02:D3A4  6D 8C 26   			adc.l	_sgx_map_pxl_y
         02:D3A7  8D 8C 26   			sta.l	_sgx_map_pxl_y
         02:D3AA  98         			tya
         02:D3AB  6D 8D 26   			adc.h	_sgx_map_pxl_y
         02:D3AE  8D 8D 26   			sta.h	_sgx_map_pxl_y
 4614                        	
 4615                        		.dbg	line,	"include\routines_LEVELS.c", 482; }
 4616                        	
 4617                        		.dbg	line,	"include\routines_LEVELS.c", 483; }
 4618    02:D3B1             	.LL96:
 4619    02:D3B1             	.LL95:
 4620    02:D3B1             	.LL91:
 4621                        		__return	0
         02:D3B1  4C EF FF   			jmp	leave_proc
 4622                        		.dbg	clear
 4623                        		.endp
 4624                        		.pceas
 4625                        	
 4626                        		.dbg	line,	"include\routines_LEVELS.c", 492; void joypad_BUTTONS()
 4627                        		.dbg	line,	"include\routines_LEVELS.c", 493; {
 4628                        	;***********************
 4629                        	;***********************
 4630                        	
 4631                        		.hucc
 4632    02:D088             		.proc		_joypad_BUTTONS
 4633                        		__enter		_joypad_BUTTONS
 4634                        	
 4635                        		.dbg	line,	"include\routines_LEVELS.c", 494; if(joytrg(JOYPAD_1) == JOY_I)
 4636                        		__ld.uiq	0
         02:D088  62         			cla
 4637                        		 _joytrg.1
         02:D089  AA         			tax
         02:D08A  BD 2D 22   			lda	joytrg, x
         02:D08D  BC DD 22   			ldy	joy6trg, x
 4638                        		__equ_w.wi	1
         02:D090  C9 01      			cmp.l	#1
         02:D092  D0 04      			bne	!false+
         02:D094  C0 00      			cpy.h	#1
         02:D096  F0 01      			beq	!+
         02:D098  18         	!false:		clc
         02:D099             	!:
 4639                        		__bfalse	.LL100
         02:D099  B0 03 4C 60			bcc	.LL100
         02:D09D  D1          
 4640                        	
 4641                        		.dbg	line,	"include\routines_LEVELS.c", 495; {
 4642                        	
 4643                        		.dbg	line,	"include\routines_LEVELS.c", 496; if(player_state == STATE_IDLE)
 4644                        		__not.um	_player_state
         02:D09E  AD 15 23   			lda	_player_state
         02:D0A1  18         			clc
         02:D0A2  D0 01      			bne	!+
         02:D0A4  38         			sec
         02:D0A5             	!:
 4645                        		__bfalse	.LL101
         02:D0A5  90 0B      			bcc	.LL101
 4646                        	
 4647                        		.dbg	line,	"include\routines_LEVELS.c", 497; {
 4648                        	
 4649                        		.dbg	line,	"include\routines_LEVELS.c", 498; player_counter_anim = 0;
 4650                        		__st.umiq	0, _player_counter_anim
         02:D0A7  9C 18 23   			stz	_player_counter_anim
 4651                        	
 4652                        		.dbg	line,	"include\routines_LEVELS.c", 500; player_state = STATE_JUMP;
 4653                        		__st.umiq	4, _player_state
         02:D0AA  A9 04      			lda.l	#4
         02:D0AC  8D 15 23   			sta	_player_state
 4654                        	
 4655                        		.dbg	line,	"include\routines_LEVELS.c", 501; }
 4656                        	
 4657                        		.dbg	line,	"include\routines_LEVELS.c", 504; else if(player_state == STATE_WALK)
 4658                        		__bra		.LL102
         02:D0AF  4C A2 D1   			bra	.LL102
 4659    02:D0B2             	.LL101:
 4660                        		__ld.umq	_player_state
         02:D0B2  AD 15 23   			lda	_player_state
 4661                        		__equ_b.uiq	1
         02:D0B5  C9 01      			cmp	#1
         02:D0B7  F0 01      			beq	!+
         02:D0B9  18         			clc
         02:D0BA             	!:
 4662                        		__bfalse	.LL103
         02:D0BA  90 13      			bcc	.LL103
 4663                        	
 4664                        		.dbg	line,	"include\routines_LEVELS.c", 505; {
 4665                        	
 4666                        		.dbg	line,	"include\routines_LEVELS.c", 506; player_counter_anim = 0;
 4667                        		__st.umiq	0, _player_counter_anim
         02:D0BC  9C 18 23   			stz	_player_counter_anim
 4668                        	
 4669                        		.dbg	line,	"include\routines_LEVELS.c", 508; player_state = STATE_JUMP_RIGHT + player_axis;
 4670                        		__ld.wi		5
         02:D0BF  A9 05      			lda.l	#5
         02:D0C1  C2         			cly
 4671                        		__add.um	_player_axis
         02:D0C2  18         			clc
         02:D0C3  6D 16 23   			adc	_player_axis
         02:D0C6  90 01      			bcc	!+
         02:D0C8  C8         			iny
         02:D0C9             	!:
 4672                        		__st.umq	_player_state
         02:D0C9  8D 15 23   			sta	_player_state
 4673                        	
 4674                        		.dbg	line,	"include\routines_LEVELS.c", 509; }
 4675                        	
 4676                        		.dbg	line,	"include\routines_LEVELS.c", 512; else if(player_state == STATE_HANG || player_state == STATE_CLIMB_UP || player_state == STATE_CLIMB_DOWN)
 4677                        		__bra		.LL104
         02:D0CC  4C A2 D1   			bra	.LL104
 4678    02:D0CF             	.LL103:
 4679                        		__ld.umq	_player_state
         02:D0CF  AD 15 23   			lda	_player_state
 4680                        		__equ_b.uiq	10
         02:D0D2  C9 0A      			cmp	#10
         02:D0D4  F0 01      			beq	!+
         02:D0D6  18         			clc
         02:D0D7             	!:
 4681                        		__btrue		.LL106
         02:D0D7  B0 08      			bcs	.LL106
 4682                        		__ld.umq	_player_state
         02:D0D9  AD 15 23   			lda	_player_state
 4683                        		__equ_b.uiq	11
         02:D0DC  C9 0B      			cmp	#11
         02:D0DE  F0 01      			beq	!+
         02:D0E0  18         			clc
         02:D0E1             	!:
 4684    02:D0E1             	.LL106:
 4685                        		__btrue		.LL107
         02:D0E1  B0 08      			bcs	.LL107
 4686                        		__ld.umq	_player_state
         02:D0E3  AD 15 23   			lda	_player_state
 4687                        		__equ_b.uiq	12
         02:D0E6  C9 0C      			cmp	#12
         02:D0E8  F0 01      			beq	!+
         02:D0EA  18         			clc
         02:D0EB             	!:
 4688    02:D0EB             	.LL107:
 4689                        		__bfalse	.LL105
         02:D0EB  B0 03 4C A2			bcc	.LL105
         02:D0EF  D1          
 4690                        	
 4691                        		.dbg	line,	"include\routines_LEVELS.c", 513; {
 4692                        	
 4693                        		.dbg	line,	"include\routines_LEVELS.c", 514; if(joy(JOYPAD_1) & JOY_RIGHT)
 4694                        		__ld.uiq	0
         02:D0F0  62         			cla
 4695                        		 _joy.1
         02:D0F1  AA         			tax
         02:D0F2  BD 28 22   			lda	joynow, x
         02:D0F5  BC D3 22   			ldy	joy6now, x
 4696                        		__tand.wi	32
         02:D0F8  29 20      			and	#32
         02:D0FA  C9 01      	!:		cmp	#1
 4697                        		__bfalse	.LL108
         02:D0FC  90 0B      			bcc	.LL108
 4698                        	
 4699                        		.dbg	line,	"include\routines_LEVELS.c", 515; {
 4700                        	
 4701                        		.dbg	line,	"include\routines_LEVELS.c", 516; player_counter_anim = 0;
 4702                        		__st.umiq	0, _player_counter_anim
         02:D0FE  9C 18 23   			stz	_player_counter_anim
 4703                        	
 4704                        		.dbg	line,	"include\routines_LEVELS.c", 518; player_state = STATE_JUMP_RIGHT;
 4705                        		__st.umiq	5, _player_state
         02:D101  A9 05      			lda.l	#5
         02:D103  8D 15 23   			sta	_player_state
 4706                        	
 4707                        		.dbg	line,	"include\routines_LEVELS.c", 519; }
 4708                        	
 4709                        		.dbg	line,	"include\routines_LEVELS.c", 521; else if(joy(JOYPAD_1) & JOY_LEFT)
 4710                        		__bra		.LL109
         02:D106  4C A2 D1   			bra	.LL109
 4711    02:D109             	.LL108:
 4712                        		__ld.uiq	0
         02:D109  62         			cla
 4713                        		 _joy.1
         02:D10A  AA         			tax
         02:D10B  BD 28 22   			lda	joynow, x
         02:D10E  BC D3 22   			ldy	joy6now, x
 4714                        		__tand.wi	128
         02:D111  29 80      			and	#128
         02:D113  C9 01      	!:		cmp	#1
 4715                        		__bfalse	.LL110
         02:D115  90 0B      			bcc	.LL110
 4716                        	
 4717                        		.dbg	line,	"include\routines_LEVELS.c", 522; {
 4718                        	
 4719                        		.dbg	line,	"include\routines_LEVELS.c", 523; player_counter_anim = 0;
 4720                        		__st.umiq	0, _player_counter_anim
         02:D117  9C 18 23   			stz	_player_counter_anim
 4721                        	
 4722                        		.dbg	line,	"include\routines_LEVELS.c", 525; player_state = STATE_JUMP_LEFT;
 4723                        		__st.umiq	6, _player_state
         02:D11A  A9 06      			lda.l	#6
         02:D11C  8D 15 23   			sta	_player_state
 4724                        	
 4725                        		.dbg	line,	"include\routines_LEVELS.c", 526; }
 4726                        	
 4727                        		.dbg	line,	"include\routines_LEVELS.c", 528; else if(joy(JOYPAD_1) & JOY_UP)
 4728                        		__bra		.LL111
         02:D11F  4C A2 D1   			bra	.LL111
 4729    02:D122             	.LL110:
 4730                        		__ld.uiq	0
         02:D122  62         			cla
 4731                        		 _joy.1
         02:D123  AA         			tax
         02:D124  BD 28 22   			lda	joynow, x
         02:D127  BC D3 22   			ldy	joy6now, x
 4732                        		__tand.wi	16
         02:D12A  29 10      			and	#16
         02:D12C  C9 01      	!:		cmp	#1
 4733                        		__bfalse	.LL112
         02:D12E  90 72      			bcc	.LL112
 4734                        	
 4735                        		.dbg	line,	"include\routines_LEVELS.c", 529; {
 4736                        	
 4737                        		.dbg	line,	"include\routines_LEVELS.c", 530; player_counter_anim = 0;
 4738                        		__st.umiq	0, _player_counter_anim
         02:D130  9C 18 23   			stz	_player_counter_anim
 4739                        	
 4740                        		.dbg	line,	"include\routines_LEVELS.c", 532; check_BG( 15 , 8 );
 4741                        		__ld.wi		15
         02:D133  A9 0F      			lda.l	#15
         02:D135  C2         			cly
 4742                        		__pusharg.wr
         02:D136  A6 8D      			ldx	<__sp
         02:D138  CA         			dex
         02:D139  CA         			dex
         02:D13A  95 08      			sta.l	<__stack, x
         02:D13C  94 09      			sty.h	<__stack, x
         02:D13E  86 8D      			stx	<__sp
 4743                        		__ld.wi		8
         02:D140  A9 08      			lda.l	#8
         02:D142  C2         			cly
 4744                        		__pusharg.wr
         02:D143  A6 8D      			ldx	<__sp
         02:D145  CA         			dex
         02:D146  CA         			dex
         02:D147  95 08      			sta.l	<__stack, x
         02:D149  94 09      			sty.h	<__stack, x
         02:D14B  86 8D      			stx	<__sp
 4745                        		__call		_check_BG
         02:D14D  20 6D FF   			call	_check_BG
 4746                        	
 4747                        		.dbg	line,	"include\routines_LEVELS.c", 534; if(map_blk_flag == TILE_EMPTY)
 4748                        		__not.um	_map_blk_flag
         02:D150  AD AB 2B   			lda	_map_blk_flag
         02:D153  18         			clc
         02:D154  D0 01      			bne	!+
         02:D156  38         			sec
         02:D157             	!:
 4749                        		__bfalse	.LL113
         02:D157  90 49      			bcc	.LL113
 4750                        	
 4751                        		.dbg	line,	"include\routines_LEVELS.c", 535; {
 4752                        	
 4753                        		.dbg	line,	"include\routines_LEVELS.c", 536; player_state = STATE_JUMP_LADDER;
 4754                        		__st.umiq	13, _player_state
         02:D159  A9 0D      			lda.l	#13
         02:D15B  8D 15 23   			sta	_player_state
 4755                        	
 4756                        		.dbg	line,	"include\routines_LEVELS.c", 537; }
 4757                        	
 4758                        		.dbg	line,	"include\routines_LEVELS.c", 538; }
 4759    02:D15E             	.LL113	.alias		.LL114
 4760                        	
 4761                        		.dbg	line,	"include\routines_LEVELS.c", 539; }
 4762    02:D15E             	.LL112	.alias		.LL114
 4763    02:D15E             	.LL111	.alias		.LL114
 4764    02:D15E             	.LL109	.alias		.LL114
 4765                        	
 4766                        		.dbg	line,	"include\routines_LEVELS.c", 540; }
 4767    02:D15E             	.LL105	.alias		.LL114
 4768    02:D15E             	.LL104	.alias		.LL114
 4769    02:D15E             	.LL102	.alias		.LL114
 4770                        	
 4771                        		.dbg	line,	"include\routines_LEVELS.c", 542; else if(joytrg(JOYPAD_1) == JOY_II)
 4772                        		__bra		.LL114
         02:D15E  80 42      			bra	.LL114
 4773    02:D160             	.LL100:
 4774                        		__ld.uiq	0
         02:D160  62         			cla
 4775                        		 _joytrg.1
         02:D161  AA         			tax
         02:D162  BD 2D 22   			lda	joytrg, x
         02:D165  BC DD 22   			ldy	joy6trg, x
 4776                        		__equ_w.wi	2
         02:D168  C9 02      			cmp.l	#2
         02:D16A  D0 04      			bne	!false+
         02:D16C  C0 00      			cpy.h	#2
         02:D16E  F0 01      			beq	!+
         02:D170  18         	!false:		clc
         02:D171             	!:
 4777                        		__bfalse	.LL115
         02:D171  90 2F      			bcc	.LL115
 4778                        	
 4779                        		.dbg	line,	"include\routines_LEVELS.c", 543; {
 4780                        	
 4781                        		.dbg	line,	"include\routines_LEVELS.c", 544; if(player_state == STATE_IDLE || player_state == STATE_WALK)
 4782                        		__not.um	_player_state
         02:D173  AD 15 23   			lda	_player_state
         02:D176  18         			clc
         02:D177  D0 01      			bne	!+
         02:D179  38         			sec
         02:D17A             	!:
 4783                        		__btrue		.LL117
         02:D17A  B0 08      			bcs	.LL117
 4784                        		__ld.umq	_player_state
         02:D17C  AD 15 23   			lda	_player_state
 4785                        		__equ_b.uiq	1
         02:D17F  C9 01      			cmp	#1
         02:D181  F0 01      			beq	!+
         02:D183  18         			clc
         02:D184             	!:
 4786    02:D184             	.LL117:
 4787                        		__bfalse	.LL116
         02:D184  90 0A      			bcc	.LL116
 4788                        	
 4789                        		.dbg	line,	"include\routines_LEVELS.c", 545; {
 4790                        	
 4791                        		.dbg	line,	"include\routines_LEVELS.c", 546; player_counter_anim = 0;
 4792                        		__st.umiq	0, _player_counter_anim
         02:D186  9C 18 23   			stz	_player_counter_anim
 4793                        	
 4794                        		.dbg	line,	"include\routines_LEVELS.c", 547; player_state = STATE_ATTACK;
 4795                        		__st.umiq	2, _player_state
         02:D189  A9 02      			lda.l	#2
         02:D18B  8D 15 23   			sta	_player_state
 4796                        	
 4797                        		.dbg	line,	"include\routines_LEVELS.c", 548; }
 4798                        	
 4799                        		.dbg	line,	"include\routines_LEVELS.c", 550; else if(player_state == STATE_CROUCH)
 4800                        		__bra		.LL118
         02:D18E  80 12      			bra	.LL118
 4801    02:D190             	.LL116:
 4802                        		__ld.umq	_player_state
         02:D190  AD 15 23   			lda	_player_state
 4803                        		__equ_b.uiq	7
         02:D193  C9 07      			cmp	#7
         02:D195  F0 01      			beq	!+
         02:D197  18         			clc
         02:D198             	!:
 4804                        		__bfalse	.LL119
         02:D198  90 08      			bcc	.LL119
 4805                        	
 4806                        		.dbg	line,	"include\routines_LEVELS.c", 551; {
 4807                        	
 4808                        		.dbg	line,	"include\routines_LEVELS.c", 552; player_counter_anim = 0;
 4809                        		__st.umiq	0, _player_counter_anim
         02:D19A  9C 18 23   			stz	_player_counter_anim
 4810                        	
 4811                        		.dbg	line,	"include\routines_LEVELS.c", 553; player_state = STATE_CROUCH_ATTACK;
 4812                        		__st.umiq	8, _player_state
         02:D19D  A9 08      			lda.l	#8
         02:D19F  8D 15 23   			sta	_player_state
 4813                        	
 4814                        		.dbg	line,	"include\routines_LEVELS.c", 554; }
 4815                        	
 4816                        		.dbg	line,	"include\routines_LEVELS.c", 555; }
 4817    02:D1A2             	.LL119:
 4818    02:D1A2             	.LL118:
 4819                        	
 4820                        		.dbg	line,	"include\routines_LEVELS.c", 556; }
 4821    02:D1A2             	.LL115:
 4822    02:D1A2             	.LL114:
 4823    02:D1A2             	.LL99:
 4824                        		__return	0
         02:D1A2  4C EF FF   			jmp	leave_proc
 4825                        		.dbg	clear
 4826                        		.endp
 4827                        		.pceas
 4828                        	
 4829                        		.dbg	line,	"include\routines_LEVELS.c", 559; void joypad_DIR()
 4830                        		.dbg	line,	"include\routines_LEVELS.c", 560; {
 4831                        	;***********************
 4832                        	;***********************
 4833                        	
 4834                        		.hucc
 4835    01:CF83             		.proc		_joypad_DIR
 4836                        		__enter		_joypad_DIR
 4837                        	
 4838                        		.dbg	line,	"include\routines_LEVELS.c", 561; //--------------------------------------------------------------------------------------//
 4839                        	
 4840                        		.dbg	line,	"include\routines_LEVELS.c", 562; //                                        NO DIR                                        //
 4841                        	
 4842                        		.dbg	line,	"include\routines_LEVELS.c", 563; //--------------------------------------------------------------------------------------//
 4843                        	
 4844                        		.dbg	line,	"include\routines_LEVELS.c", 565; if(! (joy(JOYPAD_1) & JOY_DIR_PRESSED) )
 4845                        		__ld.uiq	0
         01:CF83  62         			cla
 4846                        		 _joy.1
         01:CF84  AA         			tax
         01:CF85  BD 28 22   			lda	joynow, x
         01:CF88  BC D3 22   			ldy	joy6now, x
 4847                        		__nand.wi	240
         01:CF8B  18         			clc
         01:CF8C  29 F0      			and	#240
         01:CF8E  D0 01      			bne	!+
         01:CF90  38         			sec
         01:CF91             	!:
 4848                        		__bfalse	.LL121
         01:CF91  90 4E      			bcc	.LL121
 4849                        	
 4850                        		.dbg	line,	"include\routines_LEVELS.c", 566; {
 4851                        	
 4852                        		.dbg	line,	"include\routines_LEVELS.c", 567; if(player_state == STATE_WALK || player_state == STATE_CROUCH)
 4853                        		__ld.umq	_player_state
         01:CF93  AD 15 23   			lda	_player_state
 4854                        		__equ_b.uiq	1
         01:CF96  C9 01      			cmp	#1
         01:CF98  F0 01      			beq	!+
         01:CF9A  18         			clc
         01:CF9B             	!:
 4855                        		__btrue		.LL123
         01:CF9B  B0 08      			bcs	.LL123
 4856                        		__ld.umq	_player_state
         01:CF9D  AD 15 23   			lda	_player_state
 4857                        		__equ_b.uiq	7
         01:CFA0  C9 07      			cmp	#7
         01:CFA2  F0 01      			beq	!+
         01:CFA4  18         			clc
         01:CFA5             	!:
 4858    01:CFA5             	.LL123:
 4859                        		__bfalse	.LL122
         01:CFA5  90 13      			bcc	.LL122
 4860                        	
 4861                        		.dbg	line,	"include\routines_LEVELS.c", 568; {
 4862                        	
 4863                        		.dbg	line,	"include\routines_LEVELS.c", 569; if(player_attack == FALSE)
 4864                        		__not.um	_player_attack
         01:CFA7  AD 1C 23   			lda	_player_attack
         01:CFAA  18         			clc
         01:CFAB  D0 01      			bne	!+
         01:CFAD  38         			sec
         01:CFAE             	!:
 4865                        		__bfalse	.LL124
         01:CFAE  90 31      			bcc	.LL124
 4866                        	
 4867                        		.dbg	line,	"include\routines_LEVELS.c", 570; {
 4868                        	
 4869                        		.dbg	line,	"include\routines_LEVELS.c", 571; player_counter_anim = 1;
 4870                        		__st.umiq	1, _player_counter_anim
         01:CFB0  A9 01      			lda.l	#1
         01:CFB2  8D 18 23   			sta	_player_counter_anim
 4871                        	
 4872                        		.dbg	line,	"include\routines_LEVELS.c", 572; player_state = STATE_IDLE;
 4873                        		__st.umiq	0, _player_state
         01:CFB5  9C 15 23   			stz	_player_state
 4874                        	
 4875                        		.dbg	line,	"include\routines_LEVELS.c", 573; }
 4876                        	
 4877                        		.dbg	line,	"include\routines_LEVELS.c", 574; }
 4878    01:CFB8             	.LL124	.alias		.LL125
 4879                        	
 4880                        		.dbg	line,	"include\routines_LEVELS.c", 577; else if(player_state == STATE_CLIMB_UP || player_state == STATE_CLIMB_DOWN)
 4881                        		__bra		.LL125
         01:CFB8  80 27      			bra	.LL125
 4882    01:CFBA             	.LL122:
 4883                        		__ld.umq	_player_state
         01:CFBA  AD 15 23   			lda	_player_state
 4884                        		__equ_b.uiq	11
         01:CFBD  C9 0B      			cmp	#11
         01:CFBF  F0 01      			beq	!+
         01:CFC1  18         			clc
         01:CFC2             	!:
 4885                        		__btrue		.LL127
         01:CFC2  B0 08      			bcs	.LL127
 4886                        		__ld.umq	_player_state
         01:CFC4  AD 15 23   			lda	_player_state
 4887                        		__equ_b.uiq	12
         01:CFC7  C9 0C      			cmp	#12
         01:CFC9  F0 01      			beq	!+
         01:CFCB  18         			clc
         01:CFCC             	!:
 4888    01:CFCC             	.LL127:
 4889                        		__bfalse	.LL126
         01:CFCC  90 13      			bcc	.LL126
 4890                        	
 4891                        		.dbg	line,	"include\routines_LEVELS.c", 578; {
 4892                        	
 4893                        		.dbg	line,	"include\routines_LEVELS.c", 579; if(player_attack == FALSE)
 4894                        		__not.um	_player_attack
         01:CFCE  AD 1C 23   			lda	_player_attack
         01:CFD1  18         			clc
         01:CFD2  D0 01      			bne	!+
         01:CFD4  38         			sec
         01:CFD5             	!:
 4895                        		__bfalse	.LL128
         01:CFD5  90 0A      			bcc	.LL128
 4896                        	
 4897                        		.dbg	line,	"include\routines_LEVELS.c", 580; {
 4898                        	
 4899                        		.dbg	line,	"include\routines_LEVELS.c", 581; player_counter_anim = 1;
 4900                        		__st.umiq	1, _player_counter_anim
         01:CFD7  A9 01      			lda.l	#1
         01:CFD9  8D 18 23   			sta	_player_counter_anim
 4901                        	
 4902                        		.dbg	line,	"include\routines_LEVELS.c", 582; player_state = STATE_HANG;
 4903                        		__st.umiq	10, _player_state
         01:CFDC  A9 0A      			lda.l	#10
         01:CFDE  8D 15 23   			sta	_player_state
 4904                        	
 4905                        		.dbg	line,	"include\routines_LEVELS.c", 583; }
 4906                        	
 4907                        		.dbg	line,	"include\routines_LEVELS.c", 584; }
 4908    01:CFE1             	.LL128:
 4909                        	
 4910                        		.dbg	line,	"include\routines_LEVELS.c", 585; }
 4911    01:CFE1             	.LL126:
 4912    01:CFE1             	.LL125:
 4913                        	
 4914                        		.dbg	line,	"include\routines_LEVELS.c", 588; //--------------------------------------------------------------------------------------//
 4915                        	
 4916                        		.dbg	line,	"include\routines_LEVELS.c", 589; //                                     RIGHT BUTTON                                     //
 4917                        	
 4918                        		.dbg	line,	"include\routines_LEVELS.c", 590; //--------------------------------------------------------------------------------------//
 4919                        	
 4920                        		.dbg	line,	"include\routines_LEVELS.c", 592; if(joy(JOYPAD_1) & JOY_RIGHT)
 4921    01:CFE1             	.LL121:
 4922                        		__ld.uiq	0
         01:CFE1  62         			cla
 4923                        		 _joy.1
         01:CFE2  AA         			tax
         01:CFE3  BD 28 22   			lda	joynow, x
         01:CFE6  BC D3 22   			ldy	joy6now, x
 4924                        		__tand.wi	32
         01:CFE9  29 20      			and	#32
         01:CFEB  C9 01      	!:		cmp	#1
 4925                        		__bfalse	.LL129
         01:CFED  B0 03 4C EF			bcc	.LL129
         01:CFF1  D0          
 4926                        	
 4927                        		.dbg	line,	"include\routines_LEVELS.c", 593; {
 4928                        	
 4929                        		.dbg	line,	"include\routines_LEVELS.c", 594; if(player_state == STATE_IDLE || player_state == STATE_WALK)
 4930                        		__not.um	_player_state
         01:CFF2  AD 15 23   			lda	_player_state
         01:CFF5  18         			clc
         01:CFF6  D0 01      			bne	!+
         01:CFF8  38         			sec
         01:CFF9             	!:
 4931                        		__btrue		.LL131
         01:CFF9  B0 08      			bcs	.LL131
 4932                        		__ld.umq	_player_state
         01:CFFB  AD 15 23   			lda	_player_state
 4933                        		__equ_b.uiq	1
         01:CFFE  C9 01      			cmp	#1
         01:D000  F0 01      			beq	!+
         01:D002  18         			clc
         01:D003             	!:
 4934    01:D003             	.LL131:
 4935                        		__bfalse	.LL130
         01:D003  90 47      			bcc	.LL130
 4936                        	
 4937                        		.dbg	line,	"include\routines_LEVELS.c", 595; {
 4938                        	
 4939                        		.dbg	line,	"include\routines_LEVELS.c", 596; player_axis = AXIS_RIGHT;
 4940                        		__st.umiq	0, _player_axis
         01:D005  9C 16 23   			stz	_player_axis
 4941                        	
 4942                        		.dbg	line,	"include\routines_LEVELS.c", 598; if(player_previous_axis != player_axis)
 4943                        		__ld.umq	_player_previous_axis
         01:D008  AD 17 23   			lda	_player_previous_axis
 4944                        		__neq_b.umq	_player_axis
         01:D00B  38         			sec
         01:D00C  4D 16 23   			eor	_player_axis
         01:D00F  D0 01      			bne	!+
         01:D011  18         			clc
         01:D012             	!:
 4945                        		__bfalse	.LL132
         01:D012  90 15      			bcc	.LL132
 4946                        	
 4947                        		.dbg	line,	"include\routines_LEVELS.c", 599; {
 4948                        	
 4949                        		.dbg	line,	"include\routines_LEVELS.c", 600; player_previous_axis = player_axis;
 4950                        		__ld.um		_player_axis
         01:D014  AD 16 23   			lda	_player_axis
         01:D017  C2         			cly
 4951                        		__st.umq	_player_previous_axis
         01:D018  8D 17 23   			sta	_player_previous_axis
 4952                        	
 4953                        		.dbg	line,	"include\routines_LEVELS.c", 602; spr_set(player_id);
 4954                        		__ld.umq	_player_id
         01:D01B  AD 14 23   			lda	_player_id
 4955                        		__call		_spr_set.1
         01:D01E  20 DD E7   			call	_spr_set.1
 4956                        	
 4957                        		.dbg	line,	"include\routines_LEVELS.c", 603; spr_ctrl(FLIP_MAS, NO_FLIP_X);
 4958                        		__st.umiq	136, _al
         01:D021  A9 88      			lda.l	#136
         01:D023  85 F8      			sta	_al
 4959                        		__ld.uiq	0
         01:D025  62         			cla
 4960                        		__call		_spr_ctrl.2
         01:D026  20 3C E8   			call	_spr_ctrl.2
 4961                        	
 4962                        		.dbg	line,	"include\routines_LEVELS.c", 604; }
 4963                        	
 4964                        		.dbg	line,	"include\routines_LEVELS.c", 606; if(joy(JOYPAD_1) & JOY_DOWN)
 4965    01:D029             	.LL132:
 4966                        		__ld.uiq	0
         01:D029  62         			cla
 4967                        		 _joy.1
         01:D02A  AA         			tax
         01:D02B  BD 28 22   			lda	joynow, x
         01:D02E  BC D3 22   			ldy	joy6now, x
 4968                        		__tand.wi	64
         01:D031  29 40      			and	#64
         01:D033  C9 01      	!:		cmp	#1
 4969                        		__bfalse	.LL133
         01:D035  90 0D      			bcc	.LL133
 4970                        	
 4971                        		.dbg	line,	"include\routines_LEVELS.c", 607; {
 4972                        	
 4973                        		.dbg	line,	"include\routines_LEVELS.c", 608; player_counter_anim = 1;
 4974                        		__st.umiq	1, _player_counter_anim
         01:D037  A9 01      			lda.l	#1
         01:D039  8D 18 23   			sta	_player_counter_anim
 4975                        	
 4976                        		.dbg	line,	"include\routines_LEVELS.c", 609; player_state = STATE_CROUCH;
 4977                        		__st.umiq	7, _player_state
         01:D03C  A9 07      			lda.l	#7
         01:D03E  8D 15 23   			sta	_player_state
 4978                        	
 4979                        		.dbg	line,	"include\routines_LEVELS.c", 610; return;
 4980                        		__bra		.LL120
         01:D041  4C 05 D4   			bra	.LL120
 4981                        	
 4982                        		.dbg	line,	"include\routines_LEVELS.c", 611; }
 4983                        	
 4984                        		.dbg	line,	"include\routines_LEVELS.c", 613; player_state = STATE_WALK;
 4985    01:D044             	.LL133:
 4986                        		__st.umiq	1, _player_state
         01:D044  A9 01      			lda.l	#1
         01:D046  8D 15 23   			sta	_player_state
 4987                        	
 4988                        		.dbg	line,	"include\routines_LEVELS.c", 614; }
 4989                        	
 4990                        		.dbg	line,	"include\routines_LEVELS.c", 617; else if(player_state == STATE_JUMP || player_state == STATE_JUMP_LEFT || player_state == STATE_CROUCH || player_state == STATE_FALL || player_state == STATE_HANG)
 4991                        		__bra		.LL134
         01:D049  4C 05 D4   			bra	.LL134
 4992    01:D04C             	.LL130:
 4993                        		__ld.umq	_player_state
         01:D04C  AD 15 23   			lda	_player_state
 4994                        		__equ_b.uiq	4
         01:D04F  C9 04      			cmp	#4
         01:D051  F0 01      			beq	!+
         01:D053  18         			clc
         01:D054             	!:
 4995                        		__btrue		.LL136
         01:D054  B0 08      			bcs	.LL136
 4996                        		__ld.umq	_player_state
         01:D056  AD 15 23   			lda	_player_state
 4997                        		__equ_b.uiq	6
         01:D059  C9 06      			cmp	#6
         01:D05B  F0 01      			beq	!+
         01:D05D  18         			clc
         01:D05E             	!:
 4998    01:D05E             	.LL136:
 4999                        		__btrue		.LL137
         01:D05E  B0 08      			bcs	.LL137
 5000                        		__ld.umq	_player_state
         01:D060  AD 15 23   			lda	_player_state
 5001                        		__equ_b.uiq	7
         01:D063  C9 07      			cmp	#7
         01:D065  F0 01      			beq	!+
         01:D067  18         			clc
         01:D068             	!:
 5002    01:D068             	.LL137:
 5003                        		__btrue		.LL138
         01:D068  B0 08      			bcs	.LL138
 5004                        		__ld.umq	_player_state
         01:D06A  AD 15 23   			lda	_player_state
 5005                        		__equ_b.uiq	9
         01:D06D  C9 09      			cmp	#9
         01:D06F  F0 01      			beq	!+
         01:D071  18         			clc
         01:D072             	!:
 5006    01:D072             	.LL138:
 5007                        		__btrue		.LL139
         01:D072  B0 08      			bcs	.LL139
 5008                        		__ld.umq	_player_state
         01:D074  AD 15 23   			lda	_player_state
 5009                        		__equ_b.uiq	10
         01:D077  C9 0A      			cmp	#10
         01:D079  F0 01      			beq	!+
         01:D07B  18         			clc
         01:D07C             	!:
 5010    01:D07C             	.LL139:
 5011                        		__bfalse	.LL135
         01:D07C  90 4D      			bcc	.LL135
 5012                        	
 5013                        		.dbg	line,	"include\routines_LEVELS.c", 618; {
 5014                        	
 5015                        		.dbg	line,	"include\routines_LEVELS.c", 619; if(player_axis == AXIS_LEFT)
 5016                        		__ld.umq	_player_axis
         01:D07E  AD 16 23   			lda	_player_axis
 5017                        		__equ_b.uiq	1
         01:D081  C9 01      			cmp	#1
         01:D083  F0 01      			beq	!+
         01:D085  18         			clc
         01:D086             	!:
 5018                        		__bfalse	.LL140
         01:D086  90 18      			bcc	.LL140
 5019                        	
 5020                        		.dbg	line,	"include\routines_LEVELS.c", 620; {
 5021                        	
 5022                        		.dbg	line,	"include\routines_LEVELS.c", 621; player_axis = AXIS_RIGHT;
 5023                        		__st.umiq	0, _player_axis
         01:D088  9C 16 23   			stz	_player_axis
 5024                        	
 5025                        		.dbg	line,	"include\routines_LEVELS.c", 622; player_previous_axis = player_axis;
 5026                        		__ld.um		_player_axis
         01:D08B  AD 16 23   			lda	_player_axis
         01:D08E  C2         			cly
 5027                        		__st.umq	_player_previous_axis
         01:D08F  8D 17 23   			sta	_player_previous_axis
 5028                        	
 5029                        		.dbg	line,	"include\routines_LEVELS.c", 624; spr_set(player_id);
 5030                        		__ld.umq	_player_id
         01:D092  AD 14 23   			lda	_player_id
 5031                        		__call		_spr_set.1
         01:D095  20 DD E7   			call	_spr_set.1
 5032                        	
 5033                        		.dbg	line,	"include\routines_LEVELS.c", 625; spr_ctrl(FLIP_MAS, NO_FLIP_X);
 5034                        		__st.umiq	136, _al
         01:D098  A9 88      			lda.l	#136
         01:D09A  85 F8      			sta	_al
 5035                        		__ld.uiq	0
         01:D09C  62         			cla
 5036                        		__call		_spr_ctrl.2
         01:D09D  20 3C E8   			call	_spr_ctrl.2
 5037                        	
 5038                        		.dbg	line,	"include\routines_LEVELS.c", 626; }
 5039                        	
 5040                        		.dbg	line,	"include\routines_LEVELS.c", 628; if(player_state == STATE_JUMP)
 5041    01:D0A0             	.LL140:
 5042                        		__ld.umq	_player_state
         01:D0A0  AD 15 23   			lda	_player_state
 5043                        		__equ_b.uiq	4
         01:D0A3  C9 04      			cmp	#4
         01:D0A5  F0 01      			beq	!+
         01:D0A7  18         			clc
         01:D0A8             	!:
 5044                        		__bfalse	.LL141
         01:D0A8  B0 03 4C 05			bcc	.LL141
         01:D0AC  D4          
 5045                        	
 5046                        		.dbg	line,	"include\routines_LEVELS.c", 629; {
 5047                        	
 5048                        		.dbg	line,	"include\routines_LEVELS.c", 630; if(player_index_jump > 11 && player_index_jump < 15)
 5049                        		__ld.umq	_player_index_jump
         01:D0AD  AD 19 23   			lda	_player_index_jump
 5050                        		__ugt_b.uiq	11
         01:D0B0  18         			clc			; Subtract integer+1 from A.
         01:D0B1  E9 0B      			sbc	#11		; CS if A > integer.
 5051                        		__bfalse	.LL143
         01:D0B3  90 09      			bcc	.LL143
 5052                        		__ld.umq	_player_index_jump
         01:D0B5  AD 19 23   			lda	_player_index_jump
 5053                        		__ult_b.uiq	15
         01:D0B8  C9 0F      			cmp	#15		; Subtract integer from A.
         01:D0BA  6A         			ror	a		; CC if A < integer.
         01:D0BB  49 80      			eor	#$80
         01:D0BD  2A         			rol	a
 5054    01:D0BE             	.LL143:
 5055                        		__bfalse	.LL142
         01:D0BE  B0 03 4C 05			bcc	.LL142
         01:D0C2  D4          
 5056                        	
 5057                        		.dbg	line,	"include\routines_LEVELS.c", 631; {
 5058                        	
 5059                        		.dbg	line,	"include\routines_LEVELS.c", 632; player_state = STATE_JUMP_RIGHT;                        
 5060                        		__st.umiq	5, _player_state
         01:D0C3  A9 05      			lda.l	#5
         01:D0C5  8D 15 23   			sta	_player_state
 5061                        	
 5062                        		.dbg	line,	"include\routines_LEVELS.c", 633; }
 5063                        	
 5064                        		.dbg	line,	"include\routines_LEVELS.c", 634; }
 5065    01:D0C8             	.LL142	.alias		.LL144
 5066                        	
 5067                        		.dbg	line,	"include\routines_LEVELS.c", 635; }
 5068    01:D0C8             	.LL141	.alias		.LL144
 5069                        	
 5070                        		.dbg	line,	"include\routines_LEVELS.c", 638; else if(player_state == STATE_CLIMB_UP || player_state == STATE_CLIMB_DOWN)
 5071                        		__bra		.LL144
         01:D0C8  4C 05 D4   			bra	.LL144
 5072    01:D0CB             	.LL135:
 5073                        		__ld.umq	_player_state
         01:D0CB  AD 15 23   			lda	_player_state
 5074                        		__equ_b.uiq	11
         01:D0CE  C9 0B      			cmp	#11
         01:D0D0  F0 01      			beq	!+
         01:D0D2  18         			clc
         01:D0D3             	!:
 5075                        		__btrue		.LL146
         01:D0D3  B0 08      			bcs	.LL146
 5076                        		__ld.umq	_player_state
         01:D0D5  AD 15 23   			lda	_player_state
 5077                        		__equ_b.uiq	12
         01:D0D8  C9 0C      			cmp	#12
         01:D0DA  F0 01      			beq	!+
         01:D0DC  18         			clc
         01:D0DD             	!:
 5078    01:D0DD             	.LL146:
 5079                        		__bfalse	.LL145
         01:D0DD  B0 03 4C 05			bcc	.LL145
         01:D0E1  D4          
 5080                        	
 5081                        		.dbg	line,	"include\routines_LEVELS.c", 639; {
 5082                        	
 5083                        		.dbg	line,	"include\routines_LEVELS.c", 640; player_counter_anim = 1;
 5084                        		__st.umiq	1, _player_counter_anim
         01:D0E2  A9 01      			lda.l	#1
         01:D0E4  8D 18 23   			sta	_player_counter_anim
 5085                        	
 5086                        		.dbg	line,	"include\routines_LEVELS.c", 641; player_state = STATE_HANG;
 5087                        		__st.umiq	10, _player_state
         01:D0E7  A9 0A      			lda.l	#10
         01:D0E9  8D 15 23   			sta	_player_state
 5088                        	
 5089                        		.dbg	line,	"include\routines_LEVELS.c", 642; }
 5090                        	
 5091                        		.dbg	line,	"include\routines_LEVELS.c", 643; }
 5092    01:D0EC             	.LL145	.alias		.LL147
 5093    01:D0EC             	.LL144	.alias		.LL147
 5094    01:D0EC             	.LL134	.alias		.LL147
 5095                        	
 5096                        		.dbg	line,	"include\routines_LEVELS.c", 646; //--------------------------------------------------------------------------------------//
 5097                        	
 5098                        		.dbg	line,	"include\routines_LEVELS.c", 647; //                                     LEFT BUTTON                                      //
 5099                        	
 5100                        		.dbg	line,	"include\routines_LEVELS.c", 648; //--------------------------------------------------------------------------------------//
 5101                        	
 5102                        		.dbg	line,	"include\routines_LEVELS.c", 650; else if(joy(JOYPAD_1) & JOY_LEFT)
 5103                        		__bra		.LL147
         01:D0EC  4C 05 D4   			bra	.LL147
 5104    01:D0EF             	.LL129:
 5105                        		__ld.uiq	0
         01:D0EF  62         			cla
 5106                        		 _joy.1
         01:D0F0  AA         			tax
         01:D0F1  BD 28 22   			lda	joynow, x
         01:D0F4  BC D3 22   			ldy	joy6now, x
 5107                        		__tand.wi	128
         01:D0F7  29 80      			and	#128
         01:D0F9  C9 01      	!:		cmp	#1
 5108                        		__bfalse	.LL148
         01:D0FB  B0 03 4C 02			bcc	.LL148
         01:D0FF  D2          
 5109                        	
 5110                        		.dbg	line,	"include\routines_LEVELS.c", 651; {
 5111                        	
 5112                        		.dbg	line,	"include\routines_LEVELS.c", 652; if(player_state == STATE_IDLE || player_state == STATE_WALK)
 5113                        		__not.um	_player_state
         01:D100  AD 15 23   			lda	_player_state
         01:D103  18         			clc
         01:D104  D0 01      			bne	!+
         01:D106  38         			sec
         01:D107             	!:
 5114                        		__btrue		.LL150
         01:D107  B0 08      			bcs	.LL150
 5115                        		__ld.umq	_player_state
         01:D109  AD 15 23   			lda	_player_state
 5116                        		__equ_b.uiq	1
         01:D10C  C9 01      			cmp	#1
         01:D10E  F0 01      			beq	!+
         01:D110  18         			clc
         01:D111             	!:
 5117    01:D111             	.LL150:
 5118                        		__bfalse	.LL149
         01:D111  90 4A      			bcc	.LL149
 5119                        	
 5120                        		.dbg	line,	"include\routines_LEVELS.c", 653; {
 5121                        	
 5122                        		.dbg	line,	"include\routines_LEVELS.c", 654; player_axis = AXIS_LEFT;
 5123                        		__st.umiq	1, _player_axis
         01:D113  A9 01      			lda.l	#1
         01:D115  8D 16 23   			sta	_player_axis
 5124                        	
 5125                        		.dbg	line,	"include\routines_LEVELS.c", 656; if(player_previous_axis != player_axis)
 5126                        		__ld.umq	_player_previous_axis
         01:D118  AD 17 23   			lda	_player_previous_axis
 5127                        		__neq_b.umq	_player_axis
         01:D11B  38         			sec
         01:D11C  4D 16 23   			eor	_player_axis
         01:D11F  D0 01      			bne	!+
         01:D121  18         			clc
         01:D122             	!:
 5128                        		__bfalse	.LL151
         01:D122  90 16      			bcc	.LL151
 5129                        	
 5130                        		.dbg	line,	"include\routines_LEVELS.c", 657; {
 5131                        	
 5132                        		.dbg	line,	"include\routines_LEVELS.c", 658; player_previous_axis = player_axis;
 5133                        		__ld.um		_player_axis
         01:D124  AD 16 23   			lda	_player_axis
         01:D127  C2         			cly
 5134                        		__st.umq	_player_previous_axis
         01:D128  8D 17 23   			sta	_player_previous_axis
 5135                        	
 5136                        		.dbg	line,	"include\routines_LEVELS.c", 660; spr_set(player_id);
 5137                        		__ld.umq	_player_id
         01:D12B  AD 14 23   			lda	_player_id
 5138                        		__call		_spr_set.1
         01:D12E  20 DD E7   			call	_spr_set.1
 5139                        	
 5140                        		.dbg	line,	"include\routines_LEVELS.c", 661; spr_ctrl(FLIP_MAS, FLIP_X);
 5141                        		__st.umiq	136, _al
         01:D131  A9 88      			lda.l	#136
         01:D133  85 F8      			sta	_al
 5142                        		__ld.uiq	8
         01:D135  A9 08      			lda	#8
 5143                        		__call		_spr_ctrl.2
         01:D137  20 3C E8   			call	_spr_ctrl.2
 5144                        	
 5145                        		.dbg	line,	"include\routines_LEVELS.c", 662; }
 5146                        	
 5147                        		.dbg	line,	"include\routines_LEVELS.c", 664; if(joy(JOYPAD_1) & JOY_DOWN)
 5148    01:D13A             	.LL151:
 5149                        		__ld.uiq	0
         01:D13A  62         			cla
 5150                        		 _joy.1
         01:D13B  AA         			tax
         01:D13C  BD 28 22   			lda	joynow, x
         01:D13F  BC D3 22   			ldy	joy6now, x
 5151                        		__tand.wi	64
         01:D142  29 40      			and	#64
         01:D144  C9 01      	!:		cmp	#1
 5152                        		__bfalse	.LL152
         01:D146  90 0D      			bcc	.LL152
 5153                        	
 5154                        		.dbg	line,	"include\routines_LEVELS.c", 665; {
 5155                        	
 5156                        		.dbg	line,	"include\routines_LEVELS.c", 666; player_counter_anim = 1;
 5157                        		__st.umiq	1, _player_counter_anim
         01:D148  A9 01      			lda.l	#1
         01:D14A  8D 18 23   			sta	_player_counter_anim
 5158                        	
 5159                        		.dbg	line,	"include\routines_LEVELS.c", 667; player_state = STATE_CROUCH;
 5160                        		__st.umiq	7, _player_state
         01:D14D  A9 07      			lda.l	#7
         01:D14F  8D 15 23   			sta	_player_state
 5161                        	
 5162                        		.dbg	line,	"include\routines_LEVELS.c", 668; return;
 5163                        		__bra		.LL120
         01:D152  4C 05 D4   			bra	.LL120
 5164                        	
 5165                        		.dbg	line,	"include\routines_LEVELS.c", 669; }
 5166                        	
 5167                        		.dbg	line,	"include\routines_LEVELS.c", 671; player_state = STATE_WALK;
 5168    01:D155             	.LL152:
 5169                        		__st.umiq	1, _player_state
         01:D155  A9 01      			lda.l	#1
         01:D157  8D 15 23   			sta	_player_state
 5170                        	
 5171                        		.dbg	line,	"include\routines_LEVELS.c", 672; }
 5172                        	
 5173                        		.dbg	line,	"include\routines_LEVELS.c", 675; else if(player_state == STATE_JUMP || player_state == STATE_JUMP_RIGHT || player_state == STATE_CROUCH || player_state == STATE_FALL || player_state == STATE_HANG)
 5174                        		__bra		.LL153
         01:D15A  4C 05 D4   			bra	.LL153
 5175    01:D15D             	.LL149:
 5176                        		__ld.umq	_player_state
         01:D15D  AD 15 23   			lda	_player_state
 5177                        		__equ_b.uiq	4
         01:D160  C9 04      			cmp	#4
         01:D162  F0 01      			beq	!+
         01:D164  18         			clc
         01:D165             	!:
 5178                        		__btrue		.LL155
         01:D165  B0 08      			bcs	.LL155
 5179                        		__ld.umq	_player_state
         01:D167  AD 15 23   			lda	_player_state
 5180                        		__equ_b.uiq	5
         01:D16A  C9 05      			cmp	#5
         01:D16C  F0 01      			beq	!+
         01:D16E  18         			clc
         01:D16F             	!:
 5181    01:D16F             	.LL155:
 5182                        		__btrue		.LL156
         01:D16F  B0 08      			bcs	.LL156
 5183                        		__ld.umq	_player_state
         01:D171  AD 15 23   			lda	_player_state
 5184                        		__equ_b.uiq	7
         01:D174  C9 07      			cmp	#7
         01:D176  F0 01      			beq	!+
         01:D178  18         			clc
         01:D179             	!:
 5185    01:D179             	.LL156:
 5186                        		__btrue		.LL157
         01:D179  B0 08      			bcs	.LL157
 5187                        		__ld.umq	_player_state
         01:D17B  AD 15 23   			lda	_player_state
 5188                        		__equ_b.uiq	9
         01:D17E  C9 09      			cmp	#9
         01:D180  F0 01      			beq	!+
         01:D182  18         			clc
         01:D183             	!:
 5189    01:D183             	.LL157:
 5190                        		__btrue		.LL158
         01:D183  B0 08      			bcs	.LL158
 5191                        		__ld.umq	_player_state
         01:D185  AD 15 23   			lda	_player_state
 5192                        		__equ_b.uiq	10
         01:D188  C9 0A      			cmp	#10
         01:D18A  F0 01      			beq	!+
         01:D18C  18         			clc
         01:D18D             	!:
 5193    01:D18D             	.LL158:
 5194                        		__bfalse	.LL154
         01:D18D  90 4F      			bcc	.LL154
 5195                        	
 5196                        		.dbg	line,	"include\routines_LEVELS.c", 676; {
 5197                        	
 5198                        		.dbg	line,	"include\routines_LEVELS.c", 677; if(player_axis == AXIS_RIGHT)
 5199                        		__not.um	_player_axis
         01:D18F  AD 16 23   			lda	_player_axis
         01:D192  18         			clc
         01:D193  D0 01      			bne	!+
         01:D195  38         			sec
         01:D196             	!:
 5200                        		__bfalse	.LL159
         01:D196  90 1B      			bcc	.LL159
 5201                        	
 5202                        		.dbg	line,	"include\routines_LEVELS.c", 678; {
 5203                        	
 5204                        		.dbg	line,	"include\routines_LEVELS.c", 679; player_axis = AXIS_LEFT;
 5205                        		__st.umiq	1, _player_axis
         01:D198  A9 01      			lda.l	#1
         01:D19A  8D 16 23   			sta	_player_axis
 5206                        	
 5207                        		.dbg	line,	"include\routines_LEVELS.c", 680; player_previous_axis = player_axis;
 5208                        		__ld.um		_player_axis
         01:D19D  AD 16 23   			lda	_player_axis
         01:D1A0  C2         			cly
 5209                        		__st.umq	_player_previous_axis
         01:D1A1  8D 17 23   			sta	_player_previous_axis
 5210                        	
 5211                        		.dbg	line,	"include\routines_LEVELS.c", 682; spr_set(player_id);
 5212                        		__ld.umq	_player_id
         01:D1A4  AD 14 23   			lda	_player_id
 5213                        		__call		_spr_set.1
         01:D1A7  20 DD E7   			call	_spr_set.1
 5214                        	
 5215                        		.dbg	line,	"include\routines_LEVELS.c", 683; spr_ctrl(FLIP_MAS, FLIP_X);
 5216                        		__st.umiq	136, _al
         01:D1AA  A9 88      			lda.l	#136
         01:D1AC  85 F8      			sta	_al
 5217                        		__ld.uiq	8
         01:D1AE  A9 08      			lda	#8
 5218                        		__call		_spr_ctrl.2
         01:D1B0  20 3C E8   			call	_spr_ctrl.2
 5219                        	
 5220                        		.dbg	line,	"include\routines_LEVELS.c", 684; }
 5221                        	
 5222                        		.dbg	line,	"include\routines_LEVELS.c", 686; if(player_state == STATE_JUMP)
 5223    01:D1B3             	.LL159:
 5224                        		__ld.umq	_player_state
         01:D1B3  AD 15 23   			lda	_player_state
 5225                        		__equ_b.uiq	4
         01:D1B6  C9 04      			cmp	#4
         01:D1B8  F0 01      			beq	!+
         01:D1BA  18         			clc
         01:D1BB             	!:
 5226                        		__bfalse	.LL160
         01:D1BB  B0 03 4C 05			bcc	.LL160
         01:D1BF  D4          
 5227                        	
 5228                        		.dbg	line,	"include\routines_LEVELS.c", 687; {
 5229                        	
 5230                        		.dbg	line,	"include\routines_LEVELS.c", 688; if(player_index_jump > 11 && player_index_jump < 15)
 5231                        		__ld.umq	_player_index_jump
         01:D1C0  AD 19 23   			lda	_player_index_jump
 5232                        		__ugt_b.uiq	11
         01:D1C3  18         			clc			; Subtract integer+1 from A.
         01:D1C4  E9 0B      			sbc	#11		; CS if A > integer.
 5233                        		__bfalse	.LL162
         01:D1C6  90 09      			bcc	.LL162
 5234                        		__ld.umq	_player_index_jump
         01:D1C8  AD 19 23   			lda	_player_index_jump
 5235                        		__ult_b.uiq	15
         01:D1CB  C9 0F      			cmp	#15		; Subtract integer from A.
         01:D1CD  6A         			ror	a		; CC if A < integer.
         01:D1CE  49 80      			eor	#$80
         01:D1D0  2A         			rol	a
 5236    01:D1D1             	.LL162:
 5237                        		__bfalse	.LL161
         01:D1D1  B0 03 4C 05			bcc	.LL161
         01:D1D5  D4          
 5238                        	
 5239                        		.dbg	line,	"include\routines_LEVELS.c", 689; {
 5240                        	
 5241                        		.dbg	line,	"include\routines_LEVELS.c", 690; player_state = STATE_JUMP_LEFT;                        
 5242                        		__st.umiq	6, _player_state
         01:D1D6  A9 06      			lda.l	#6
         01:D1D8  8D 15 23   			sta	_player_state
 5243                        	
 5244                        		.dbg	line,	"include\routines_LEVELS.c", 691; }
 5245                        	
 5246                        		.dbg	line,	"include\routines_LEVELS.c", 692; }
 5247    01:D1DB             	.LL161	.alias		.LL163
 5248                        	
 5249                        		.dbg	line,	"include\routines_LEVELS.c", 693; }
 5250    01:D1DB             	.LL160	.alias		.LL163
 5251                        	
 5252                        		.dbg	line,	"include\routines_LEVELS.c", 696; else if(player_state == STATE_CLIMB_UP || player_state == STATE_CLIMB_DOWN)
 5253                        		__bra		.LL163
         01:D1DB  4C 05 D4   			bra	.LL163
 5254    01:D1DE             	.LL154:
 5255                        		__ld.umq	_player_state
         01:D1DE  AD 15 23   			lda	_player_state
 5256                        		__equ_b.uiq	11
         01:D1E1  C9 0B      			cmp	#11
         01:D1E3  F0 01      			beq	!+
         01:D1E5  18         			clc
         01:D1E6             	!:
 5257                        		__btrue		.LL165
         01:D1E6  B0 08      			bcs	.LL165
 5258                        		__ld.umq	_player_state
         01:D1E8  AD 15 23   			lda	_player_state
 5259                        		__equ_b.uiq	12
         01:D1EB  C9 0C      			cmp	#12
         01:D1ED  F0 01      			beq	!+
         01:D1EF  18         			clc
         01:D1F0             	!:
 5260    01:D1F0             	.LL165:
 5261                        		__bfalse	.LL164
         01:D1F0  B0 03 4C 05			bcc	.LL164
         01:D1F4  D4          
 5262                        	
 5263                        		.dbg	line,	"include\routines_LEVELS.c", 697; {
 5264                        	
 5265                        		.dbg	line,	"include\routines_LEVELS.c", 698; player_counter_anim = 1;
 5266                        		__st.umiq	1, _player_counter_anim
         01:D1F5  A9 01      			lda.l	#1
         01:D1F7  8D 18 23   			sta	_player_counter_anim
 5267                        	
 5268                        		.dbg	line,	"include\routines_LEVELS.c", 699; player_state = STATE_HANG;
 5269                        		__st.umiq	10, _player_state
         01:D1FA  A9 0A      			lda.l	#10
         01:D1FC  8D 15 23   			sta	_player_state
 5270                        	
 5271                        		.dbg	line,	"include\routines_LEVELS.c", 700; }
 5272                        	
 5273                        		.dbg	line,	"include\routines_LEVELS.c", 701; }
 5274    01:D1FF             	.LL164	.alias		.LL166
 5275    01:D1FF             	.LL163	.alias		.LL166
 5276    01:D1FF             	.LL153	.alias		.LL166
 5277                        	
 5278                        		.dbg	line,	"include\routines_LEVELS.c", 704; //--------------------------------------------------------------------------------------//
 5279                        	
 5280                        		.dbg	line,	"include\routines_LEVELS.c", 705; //                                      UP BUTTON                                       //
 5281                        	
 5282                        		.dbg	line,	"include\routines_LEVELS.c", 706; //--------------------------------------------------------------------------------------//
 5283                        	
 5284                        		.dbg	line,	"include\routines_LEVELS.c", 708; else if(joy(JOYPAD_1) & JOY_UP)
 5285                        		__bra		.LL166
         01:D1FF  4C 05 D4   			bra	.LL166
 5286    01:D202             	.LL148:
 5287                        		__ld.uiq	0
         01:D202  62         			cla
 5288                        		 _joy.1
         01:D203  AA         			tax
         01:D204  BD 28 22   			lda	joynow, x
         01:D207  BC D3 22   			ldy	joy6now, x
 5289                        		__tand.wi	16
         01:D20A  29 10      			and	#16
         01:D20C  C9 01      	!:		cmp	#1
 5290                        		__bfalse	.LL167
         01:D20E  B0 03 4C D7			bcc	.LL167
         01:D212  D2          
 5291                        	
 5292                        		.dbg	line,	"include\routines_LEVELS.c", 709; {
 5293                        	
 5294                        		.dbg	line,	"include\routines_LEVELS.c", 710; if(player_state == STATE_HANG || player_state == STATE_CLIMB_UP || player_state == STATE_CLIMB_DOWN)
 5295                        		__ld.umq	_player_state
         01:D213  AD 15 23   			lda	_player_state
 5296                        		__equ_b.uiq	10
         01:D216  C9 0A      			cmp	#10
         01:D218  F0 01      			beq	!+
         01:D21A  18         			clc
         01:D21B             	!:
 5297                        		__btrue		.LL169
         01:D21B  B0 08      			bcs	.LL169
 5298                        		__ld.umq	_player_state
         01:D21D  AD 15 23   			lda	_player_state
 5299                        		__equ_b.uiq	11
         01:D220  C9 0B      			cmp	#11
         01:D222  F0 01      			beq	!+
         01:D224  18         			clc
         01:D225             	!:
 5300    01:D225             	.LL169:
 5301                        		__btrue		.LL170
         01:D225  B0 08      			bcs	.LL170
 5302                        		__ld.umq	_player_state
         01:D227  AD 15 23   			lda	_player_state
 5303                        		__equ_b.uiq	12
         01:D22A  C9 0C      			cmp	#12
         01:D22C  F0 01      			beq	!+
         01:D22E  18         			clc
         01:D22F             	!:
 5304    01:D22F             	.LL170:
 5305                        		__bfalse	.LL168
         01:D22F  B0 03 4C 05			bcc	.LL168
         01:D233  D4          
 5306                        	
 5307                        		.dbg	line,	"include\routines_LEVELS.c", 711; {
 5308                        	
 5309                        		.dbg	line,	"include\routines_LEVELS.c", 712; unsigned char i;
 5310                        	
 5311                        		.dbg	line,	"include\routines_LEVELS.c", 714; check_BG( 15 , 8 );
 5312                        		__ld.wi		15
         01:D234  A9 0F      			lda.l	#15
         01:D236  C2         			cly
 5313                        		__pusharg.wr
         01:D237  A6 8D      			ldx	<__sp
         01:D239  CA         			dex
         01:D23A  CA         			dex
         01:D23B  95 08      			sta.l	<__stack, x
         01:D23D  94 09      			sty.h	<__stack, x
         01:D23F  86 8D      			stx	<__sp
 5314                        		__ld.wi		8
         01:D241  A9 08      			lda.l	#8
         01:D243  C2         			cly
 5315                        		__pusharg.wr
         01:D244  A6 8D      			ldx	<__sp
         01:D246  CA         			dex
         01:D247  CA         			dex
         01:D248  95 08      			sta.l	<__stack, x
         01:D24A  94 09      			sty.h	<__stack, x
         01:D24C  86 8D      			stx	<__sp
 5316                        		__call		_check_BG
         01:D24E  20 6D FF   			call	_check_BG
 5317                        	
 5318                        		.dbg	line,	"include\routines_LEVELS.c", 716; if(map_blk_flag == TILE_EMPTY)
 5319                        		__not.um	_map_blk_flag
         01:D251  AD AB 2B   			lda	_map_blk_flag
         01:D254  18         			clc
         01:D255  D0 01      			bne	!+
         01:D257  38         			sec
         01:D258             	!:
 5320                        		__bfalse	.LL171
         01:D258  90 67      			bcc	.LL171
 5321                        	
 5322                        		.dbg	line,	"include\routines_LEVELS.c", 717; {
 5323                        	
 5324                        		.dbg	line,	"include\routines_LEVELS.c", 718; for(i=1 ; i<3 ; i++)
 5325                        		__st.umiq	1, __joypad_DIR_end - 1  /* i */
         01:D25A  A9 01      			lda.l	#1
         01:D25C  8D 04 23   			sta	__joypad_DIR_end - 1
 5326    01:D25F             	.LL172:
 5327                        		__ld.umq	__joypad_DIR_end - 1  /* i */
         01:D25F  AD 04 23   			lda	__joypad_DIR_end - 1
 5328                        		__ult_b.uiq	3
         01:D262  C9 03      			cmp	#3		; Subtract integer from A.
         01:D264  6A         			ror	a		; CC if A < integer.
         01:D265  49 80      			eor	#$80
         01:D267  2A         			rol	a
 5329                        		__btrue		.LL174
         01:D268  B0 07      			bcs	.LL174
 5330                        		__bra		.LL175
         01:D26A  80 63      			bra	.LL175
 5331    01:D26C             	.LL173:
 5332                        		__inc.umq	__joypad_DIR_end - 1  /* i */
         01:D26C  EE 04 23   			inc	__joypad_DIR_end - 1
 5333                        		__bra		.LL172
         01:D26F  80 EE      			bra	.LL172
 5334    01:D271             	.LL174:
 5335                        	
 5336                        		.dbg	line,	"include\routines_LEVELS.c", 719; {
 5337                        	
 5338                        		.dbg	line,	"include\routines_LEVELS.c", 720; check_BG( 15 , 8 + i );
 5339                        		__ld.wi		15
         01:D271  A9 0F      			lda.l	#15
         01:D273  C2         			cly
 5340                        		__pusharg.wr
         01:D274  A6 8D      			ldx	<__sp
         01:D276  CA         			dex
         01:D277  CA         			dex
         01:D278  95 08      			sta.l	<__stack, x
         01:D27A  94 09      			sty.h	<__stack, x
         01:D27C  86 8D      			stx	<__sp
 5341                        		__ld.wi		8
         01:D27E  A9 08      			lda.l	#8
         01:D280  C2         			cly
 5342                        		__add.um	__joypad_DIR_end - 1  /* i */
         01:D281  18         			clc
         01:D282  6D 04 23   			adc	__joypad_DIR_end - 1
         01:D285  90 01      			bcc	!+
         01:D287  C8         			iny
         01:D288             	!:
 5343                        		__pusharg.wr
         01:D288  A6 8D      			ldx	<__sp
         01:D28A  CA         			dex
         01:D28B  CA         			dex
         01:D28C  95 08      			sta.l	<__stack, x
         01:D28E  94 09      			sty.h	<__stack, x
         01:D290  86 8D      			stx	<__sp
 5344                        		__call		_check_BG
         01:D292  20 6D FF   			call	_check_BG
 5345                        	
 5346                        		.dbg	line,	"include\routines_LEVELS.c", 722; if(map_blk_flag == TILE_LADDER)
 5347                        		__ld.umq	_map_blk_flag
         01:D295  AD AB 2B   			lda	_map_blk_flag
 5348                        		__equ_b.uiq	2
         01:D298  C9 02      			cmp	#2
         01:D29A  F0 01      			beq	!+
         01:D29C  18         			clc
         01:D29D             	!:
 5349                        		__bfalse	.LL176
         01:D29D  90 CD      			bcc	.LL176
 5350                        	
 5351                        		.dbg	line,	"include\routines_LEVELS.c", 723; {
 5352                        	
 5353                        		.dbg	line,	"include\routines_LEVELS.c", 724; sgx_map_pxl_y -= (2 - i);
 5354                        		__ld.wi		2
         01:D29F  A9 02      			lda.l	#2
         01:D2A1  C2         			cly
 5355                        		__sub.um	__joypad_DIR_end - 1  /* i */
         01:D2A2  38         			sec
         01:D2A3  ED 04 23   			sbc	__joypad_DIR_end - 1
         01:D2A6  B0 01      			bcs	!+
         01:D2A8  88         			dey
         01:D2A9             	!:
 5356                        		__isub_st.wmq	_sgx_map_pxl_y
         01:D2A9  38         			sec
         01:D2AA  49 FF      			eor	#$FF
         01:D2AC  6D 8C 26   			adc.l	_sgx_map_pxl_y
         01:D2AF  8D 8C 26   			sta.l	_sgx_map_pxl_y
         01:D2B2  98         			tya
         01:D2B3  49 FF      			eor	#$FF
         01:D2B5  6D 8D 26   			adc.h	_sgx_map_pxl_y
         01:D2B8  8D 8D 26   			sta.h	_sgx_map_pxl_y
 5357                        	
 5358                        		.dbg	line,	"include\routines_LEVELS.c", 725; break;
 5359                        		__bra		.LL175
         01:D2BB  80 12      			bra	.LL175
 5360                        	
 5361                        		.dbg	line,	"include\routines_LEVELS.c", 726; }
 5362                        	
 5363                        		.dbg	line,	"include\routines_LEVELS.c", 727; }
 5364    01:D2BD             	.LL176	.alias		.LL173
 5365                        		__bra		.LL173
         01:D2BD  80 AD      			bra	.LL173
 5366    01:D2BF             	.LL175	.alias		.LL177
 5367                        	
 5368                        		.dbg	line,	"include\routines_LEVELS.c", 728; }
 5369                        	
 5370                        		.dbg	line,	"include\routines_LEVELS.c", 730; else
 5371                        		__bra		.LL177
         01:D2BF  80 0E      			bra	.LL177
 5372    01:D2C1             	.LL171:
 5373                        	
 5374                        		.dbg	line,	"include\routines_LEVELS.c", 731; {
 5375                        	
 5376                        		.dbg	line,	"include\routines_LEVELS.c", 732; sgx_map_pxl_y -= 2;
 5377                        		__sub_st.wmiq	2, _sgx_map_pxl_y
         01:D2C1  38         			sec
         01:D2C2  AD 8C 26   			lda.l	_sgx_map_pxl_y
         01:D2C5  E9 02      			sbc.l	#2
         01:D2C7  8D 8C 26   			sta.l	_sgx_map_pxl_y
         01:D2CA  B0 03      			bcs	!+
         01:D2CC  CE 8D 26   			dec.h	_sgx_map_pxl_y
         01:D2CF             	!:
 5378                        	
 5379                        		.dbg	line,	"include\routines_LEVELS.c", 733; }
 5380    01:D2CF             	.LL177:
 5381                        	
 5382                        		.dbg	line,	"include\routines_LEVELS.c", 735; player_state = STATE_CLIMB_UP;
 5383                        		__st.umiq	11, _player_state
         01:D2CF  A9 0B      			lda.l	#11
         01:D2D1  8D 15 23   			sta	_player_state
 5384                        	
 5385                        		.dbg	line,	"include\routines_LEVELS.c", 736; }
 5386                        	
 5387                        		.dbg	line,	"include\routines_LEVELS.c", 737; }
 5388    01:D2D4             	.LL168	.alias		.LL178
 5389                        	
 5390                        		.dbg	line,	"include\routines_LEVELS.c", 740; //--------------------------------------------------------------------------------------//
 5391                        	
 5392                        		.dbg	line,	"include\routines_LEVELS.c", 741; //                                     DOWN BUTTON                                      //
 5393                        	
 5394                        		.dbg	line,	"include\routines_LEVELS.c", 742; //--------------------------------------------------------------------------------------//
 5395                        	
 5396                        		.dbg	line,	"include\routines_LEVELS.c", 744; else if(joy(JOYPAD_1) & JOY_DOWN)
 5397                        		__bra		.LL178
         01:D2D4  4C 05 D4   			bra	.LL178
 5398    01:D2D7             	.LL167:
 5399                        		__ld.uiq	0
         01:D2D7  62         			cla
 5400                        		 _joy.1
         01:D2D8  AA         			tax
         01:D2D9  BD 28 22   			lda	joynow, x
         01:D2DC  BC D3 22   			ldy	joy6now, x
 5401                        		__tand.wi	64
         01:D2DF  29 40      			and	#64
         01:D2E1  C9 01      	!:		cmp	#1
 5402                        		__bfalse	.LL179
         01:D2E3  B0 03 4C 05			bcc	.LL179
         01:D2E7  D4          
 5403                        	
 5404                        		.dbg	line,	"include\routines_LEVELS.c", 745; {
 5405                        	
 5406                        		.dbg	line,	"include\routines_LEVELS.c", 746; if(player_state == STATE_IDLE || player_state == STATE_WALK)
 5407                        		__not.um	_player_state
         01:D2E8  AD 15 23   			lda	_player_state
         01:D2EB  18         			clc
         01:D2EC  D0 01      			bne	!+
         01:D2EE  38         			sec
         01:D2EF             	!:
 5408                        		__btrue		.LL181
         01:D2EF  B0 08      			bcs	.LL181
 5409                        		__ld.umq	_player_state
         01:D2F1  AD 15 23   			lda	_player_state
 5410                        		__equ_b.uiq	1
         01:D2F4  C9 01      			cmp	#1
         01:D2F6  F0 01      			beq	!+
         01:D2F8  18         			clc
         01:D2F9             	!:
 5411    01:D2F9             	.LL181:
 5412                        		__bfalse	.LL180
         01:D2F9  90 0D      			bcc	.LL180
 5413                        	
 5414                        		.dbg	line,	"include\routines_LEVELS.c", 747; {
 5415                        	
 5416                        		.dbg	line,	"include\routines_LEVELS.c", 748; player_counter_anim = 1;
 5417                        		__st.umiq	1, _player_counter_anim
         01:D2FB  A9 01      			lda.l	#1
         01:D2FD  8D 18 23   			sta	_player_counter_anim
 5418                        	
 5419                        		.dbg	line,	"include\routines_LEVELS.c", 749; player_state = STATE_CROUCH;
 5420                        		__st.umiq	7, _player_state
         01:D300  A9 07      			lda.l	#7
         01:D302  8D 15 23   			sta	_player_state
 5421                        	
 5422                        		.dbg	line,	"include\routines_LEVELS.c", 750; }
 5423                        	
 5424                        		.dbg	line,	"include\routines_LEVELS.c", 753; else if(player_state == STATE_HANG || player_state == STATE_CLIMB_UP || player_state == STATE_CLIMB_DOWN)
 5425                        		__bra		.LL182
         01:D305  4C 05 D4   			bra	.LL182
 5426    01:D308             	.LL180:
 5427                        		__ld.umq	_player_state
         01:D308  AD 15 23   			lda	_player_state
 5428                        		__equ_b.uiq	10
         01:D30B  C9 0A      			cmp	#10
         01:D30D  F0 01      			beq	!+
         01:D30F  18         			clc
         01:D310             	!:
 5429                        		__btrue		.LL184
         01:D310  B0 08      			bcs	.LL184
 5430                        		__ld.umq	_player_state
         01:D312  AD 15 23   			lda	_player_state
 5431                        		__equ_b.uiq	11
         01:D315  C9 0B      			cmp	#11
         01:D317  F0 01      			beq	!+
         01:D319  18         			clc
         01:D31A             	!:
 5432    01:D31A             	.LL184:
 5433                        		__btrue		.LL185
         01:D31A  B0 08      			bcs	.LL185
 5434                        		__ld.umq	_player_state
         01:D31C  AD 15 23   			lda	_player_state
 5435                        		__equ_b.uiq	12
         01:D31F  C9 0C      			cmp	#12
         01:D321  F0 01      			beq	!+
         01:D323  18         			clc
         01:D324             	!:
 5436    01:D324             	.LL185:
 5437                        		__bfalse	.LL183
         01:D324  B0 03 4C 05			bcc	.LL183
         01:D328  D4          
 5438                        	
 5439                        		.dbg	line,	"include\routines_LEVELS.c", 754; {
 5440                        	
 5441                        		.dbg	line,	"include\routines_LEVELS.c", 755; unsigned char i;
 5442                        	
 5443                        		.dbg	line,	"include\routines_LEVELS.c", 757; check_BG( 15 , 10 );
 5444                        		__ld.wi		15
         01:D329  A9 0F      			lda.l	#15
         01:D32B  C2         			cly
 5445                        		__pusharg.wr
         01:D32C  A6 8D      			ldx	<__sp
         01:D32E  CA         			dex
         01:D32F  CA         			dex
         01:D330  95 08      			sta.l	<__stack, x
         01:D332  94 09      			sty.h	<__stack, x
         01:D334  86 8D      			stx	<__sp
 5446                        		__ld.wi		10
         01:D336  A9 0A      			lda.l	#10
         01:D338  C2         			cly
 5447                        		__pusharg.wr
         01:D339  A6 8D      			ldx	<__sp
         01:D33B  CA         			dex
         01:D33C  CA         			dex
         01:D33D  95 08      			sta.l	<__stack, x
         01:D33F  94 09      			sty.h	<__stack, x
         01:D341  86 8D      			stx	<__sp
 5448                        		__call		_check_BG
         01:D343  20 6D FF   			call	_check_BG
 5449                        	
 5450                        		.dbg	line,	"include\routines_LEVELS.c", 759; if(map_blk_flag == TILE_EMPTY)
 5451                        		__not.um	_map_blk_flag
         01:D346  AD AB 2B   			lda	_map_blk_flag
         01:D349  18         			clc
         01:D34A  D0 01      			bne	!+
         01:D34C  38         			sec
         01:D34D             	!:
 5452                        		__bfalse	.LL186
         01:D34D  B0 03 4C F2			bcc	.LL186
         01:D351  D3          
 5453                        	
 5454                        		.dbg	line,	"include\routines_LEVELS.c", 760; {
 5455                        	
 5456                        		.dbg	line,	"include\routines_LEVELS.c", 761; for(i=1 ; i<3 ; i++)
 5457                        		__st.umiq	1, __joypad_DIR_end - 2  /* i */
         01:D352  A9 01      			lda.l	#1
         01:D354  8D 03 23   			sta	__joypad_DIR_end - 2
 5458    01:D357             	.LL187:
 5459                        		__ld.umq	__joypad_DIR_end - 2  /* i */
         01:D357  AD 03 23   			lda	__joypad_DIR_end - 2
 5460                        		__ult_b.uiq	3
         01:D35A  C9 03      			cmp	#3		; Subtract integer from A.
         01:D35C  6A         			ror	a		; CC if A < integer.
         01:D35D  49 80      			eor	#$80
         01:D35F  2A         			rol	a
 5461                        		__btrue		.LL189
         01:D360  B0 08      			bcs	.LL189
 5462                        		__bra		.LL190
         01:D362  4C 05 D4   			bra	.LL190
 5463    01:D365             	.LL188:
 5464                        		__inc.umq	__joypad_DIR_end - 2  /* i */
         01:D365  EE 03 23   			inc	__joypad_DIR_end - 2
 5465                        		__bra		.LL187
         01:D368  80 ED      			bra	.LL187
 5466    01:D36A             	.LL189:
 5467                        	
 5468                        		.dbg	line,	"include\routines_LEVELS.c", 762; {
 5469                        	
 5470                        		.dbg	line,	"include\routines_LEVELS.c", 763; check_BG( 15 , 22 + i );
 5471                        		__ld.wi		15
         01:D36A  A9 0F      			lda.l	#15
         01:D36C  C2         			cly
 5472                        		__pusharg.wr
         01:D36D  A6 8D      			ldx	<__sp
         01:D36F  CA         			dex
         01:D370  CA         			dex
         01:D371  95 08      			sta.l	<__stack, x
         01:D373  94 09      			sty.h	<__stack, x
         01:D375  86 8D      			stx	<__sp
 5473                        		__ld.wi		22
         01:D377  A9 16      			lda.l	#22
         01:D379  C2         			cly
 5474                        		__add.um	__joypad_DIR_end - 2  /* i */
         01:D37A  18         			clc
         01:D37B  6D 03 23   			adc	__joypad_DIR_end - 2
         01:D37E  90 01      			bcc	!+
         01:D380  C8         			iny
         01:D381             	!:
 5475                        		__pusharg.wr
         01:D381  A6 8D      			ldx	<__sp
         01:D383  CA         			dex
         01:D384  CA         			dex
         01:D385  95 08      			sta.l	<__stack, x
         01:D387  94 09      			sty.h	<__stack, x
         01:D389  86 8D      			stx	<__sp
 5476                        		__call		_check_BG
         01:D38B  20 6D FF   			call	_check_BG
 5477                        	
 5478                        		.dbg	line,	"include\routines_LEVELS.c", 765; if(map_blk_flag == TILE_LADDER)
 5479                        		__ld.umq	_map_blk_flag
         01:D38E  AD AB 2B   			lda	_map_blk_flag
 5480                        		__equ_b.uiq	2
         01:D391  C9 02      			cmp	#2
         01:D393  F0 01      			beq	!+
         01:D395  18         			clc
         01:D396             	!:
 5481                        		__bfalse	.LL191
         01:D396  90 1A      			bcc	.LL191
 5482                        	
 5483                        		.dbg	line,	"include\routines_LEVELS.c", 766; {
 5484                        	
 5485                        		.dbg	line,	"include\routines_LEVELS.c", 767; sgx_map_pxl_y += (2 - i);
 5486                        		__ld.wi		2
         01:D398  A9 02      			lda.l	#2
         01:D39A  C2         			cly
 5487                        		__sub.um	__joypad_DIR_end - 2  /* i */
         01:D39B  38         			sec
         01:D39C  ED 03 23   			sbc	__joypad_DIR_end - 2
         01:D39F  B0 01      			bcs	!+
         01:D3A1  88         			dey
         01:D3A2             	!:
 5488                        		__add_st.wmq	_sgx_map_pxl_y
         01:D3A2  18         			clc
         01:D3A3  6D 8C 26   			adc.l	_sgx_map_pxl_y
         01:D3A6  8D 8C 26   			sta.l	_sgx_map_pxl_y
         01:D3A9  98         			tya
         01:D3AA  6D 8D 26   			adc.h	_sgx_map_pxl_y
         01:D3AD  8D 8D 26   			sta.h	_sgx_map_pxl_y
 5489                        	
 5490                        		.dbg	line,	"include\routines_LEVELS.c", 768; break;
 5491                        		__bra		.LL190
         01:D3B0  80 53      			bra	.LL190
 5492                        	
 5493                        		.dbg	line,	"include\routines_LEVELS.c", 769; }
 5494                        	
 5495                        		.dbg	line,	"include\routines_LEVELS.c", 771; else
 5496    01:D3B2             	.LL191:
 5497                        	
 5498                        		.dbg	line,	"include\routines_LEVELS.c", 772; {
 5499                        	
 5500                        		.dbg	line,	"include\routines_LEVELS.c", 773; set_far_offset(OFFSET_PLAYER_FALL,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 5501                        		__st.wmiq	7680, _bp
         01:D3B2  64 EC      			stz.l	_bp
         01:D3B4  A9 1E      			lda.h	#7680
         01:D3B6  85 ED      			sta.h	_bp
 5502                        		__ldx.umq	_player_naked
         01:D3B8  AE 1B 23   			ldx	_player_naked
 5503                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         01:D3BB  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         01:D3BE  C2         			cly
 5504                        		__st.umq	_bp_bank
         01:D3BF  85 02      			sta	_bp_bank
 5505                        		__ld2x.umq	_player_naked
         01:D3C1  AD 1B 23   			lda	_player_naked
         01:D3C4  0A         			asl	a
         01:D3C5  AA         			tax
 5506                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         01:D3C6  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         01:D3C9  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 5507                        		__call		_set_far_offset.3
         01:D3CC  20 8C E2   			call	_set_far_offset.3
 5508                        	
 5509                        		.dbg	line,	"include\routines_LEVELS.c", 774; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 5510                        		__st.wmiq	6144, _di
         01:D3CF  64 F0      			stz.l	_di
         01:D3D1  A9 18      			lda.h	#6144
         01:D3D3  85 F1      			sta.h	_di
 5511                        		__st.wmiq	256, _ax
         01:D3D5  64 F8      			stz.l	_ax
         01:D3D7  A9 01      			lda.h	#256
         01:D3D9  85 F9      			sta.h	_ax
 5512                        		 _far_load_vram.2
         01:D3DB  82         			clx				; Offset to PCE VDC.
         01:D3DC  20 63 FF   			call	load_vram_x
 5513                        	
 5514                        		.dbg	line,	"include\routines_LEVELS.c", 776; jump_ladder = FALSE;
 5515                        		__st.umiq	0, _jump_ladder
         01:D3DF  9C 1D 23   			stz	_jump_ladder
 5516                        	
 5517                        		.dbg	line,	"include\routines_LEVELS.c", 777; player_index_jump = 0;
 5518                        		__st.umiq	0, _player_index_jump
         01:D3E2  9C 19 23   			stz	_player_index_jump
 5519                        	
 5520                        		.dbg	line,	"include\routines_LEVELS.c", 778; player_index_fall = 0;
 5521                        		__st.umiq	0, _player_index_fall
         01:D3E5  9C 1A 23   			stz	_player_index_fall
 5522                        	
 5523                        		.dbg	line,	"include\routines_LEVELS.c", 779; player_state = STATE_FALL;
 5524                        		__st.umiq	9, _player_state
         01:D3E8  A9 09      			lda.l	#9
         01:D3EA  8D 15 23   			sta	_player_state
 5525                        	
 5526                        		.dbg	line,	"include\routines_LEVELS.c", 780; }
 5527    01:D3ED             	.LL192	.alias		.LL188
 5528                        	
 5529                        		.dbg	line,	"include\routines_LEVELS.c", 781; }
 5530                        		__bra		.LL188
         01:D3ED  4C 65 D3   			bra	.LL188
 5531    01:D3F0             	.LL190	.alias		.LL193
 5532                        	
 5533                        		.dbg	line,	"include\routines_LEVELS.c", 782; }
 5534                        	
 5535                        		.dbg	line,	"include\routines_LEVELS.c", 784; else
 5536                        		__bra		.LL193
         01:D3F0  80 13      			bra	.LL193
 5537    01:D3F2             	.LL186:
 5538                        	
 5539                        		.dbg	line,	"include\routines_LEVELS.c", 785; {
 5540                        	
 5541                        		.dbg	line,	"include\routines_LEVELS.c", 786; sgx_map_pxl_y += 2;
 5542                        		__add_st.wmiq	2, _sgx_map_pxl_y
         01:D3F2  18         			clc
         01:D3F3  AD 8C 26   			lda.l	_sgx_map_pxl_y
         01:D3F6  69 02      			adc.l	#2
         01:D3F8  8D 8C 26   			sta.l	_sgx_map_pxl_y
         01:D3FB  90 03      			bcc	!+
         01:D3FD  EE 8D 26   			inc.h	_sgx_map_pxl_y
         01:D400             	!:
 5543                        	
 5544                        		.dbg	line,	"include\routines_LEVELS.c", 787; player_state = STATE_CLIMB_DOWN;
 5545                        		__st.umiq	12, _player_state
         01:D400  A9 0C      			lda.l	#12
         01:D402  8D 15 23   			sta	_player_state
 5546                        	
 5547                        		.dbg	line,	"include\routines_LEVELS.c", 788; }
 5548    01:D405             	.LL193:
 5549                        	
 5550                        		.dbg	line,	"include\routines_LEVELS.c", 789; }
 5551                        	
 5552                        		.dbg	line,	"include\routines_LEVELS.c", 790; }
 5553    01:D405             	.LL183:
 5554    01:D405             	.LL182:
 5555                        	
 5556                        		.dbg	line,	"include\routines_LEVELS.c", 791; }
 5557    01:D405             	.LL179:
 5558    01:D405             	.LL178:
 5559    01:D405             	.LL166:
 5560    01:D405             	.LL147:
 5561    01:D405             	.LL120:
 5562                        		__return	0
         01:D405  4C EF FF   			jmp	leave_proc
 5563                        		.dbg	clear
 5564                        		.endp
 5565               6760     		.data
 5566               2303     		.bss
 5567    F8:2303             	__joypad_DIR_loc:
 5568    F8:2303             			ds	2
 5569    F8:2305             	__joypad_DIR_end:
 5570               E309     		.code
 5571                        		.pceas
 5572                        	
 5573                        		.dbg	line,	"include\routines_LEVELS.c", 800; void update_PLAYER()
 5574                        		.dbg	line,	"include\routines_LEVELS.c", 801; {
 5575                        	;***********************
 5576                        	;***********************
 5577                        	
 5578                        		.hucc
 5579    12:C760             		.proc		_update_PLAYER
 5580                        		__enter		_update_PLAYER
 5581                        	
 5582                        		.dbg	line,	"include\routines_LEVELS.c", 802; if(player_state == STATE_IDLE)
 5583                        		__not.um	_player_state
         12:C760  AD 15 23   			lda	_player_state
         12:C763  18         			clc
         12:C764  D0 01      			bne	!+
         12:C766  38         			sec
         12:C767             	!:
 5584                        		__bfalse	.LL195
         12:C767  B0 03 4C 2F			bcc	.LL195
         12:C76B  C8          
 5585                        	
 5586                        		.dbg	line,	"include\routines_LEVELS.c", 803; {
 5587                        	
 5588                        		.dbg	line,	"include\routines_LEVELS.c", 804; if(player_counter_anim == 1)
 5589                        		__ld.umq	_player_counter_anim
         12:C76C  AD 18 23   			lda	_player_counter_anim
 5590                        		__equ_b.uiq	1
         12:C76F  C9 01      			cmp	#1
         12:C771  F0 01      			beq	!+
         12:C773  18         			clc
         12:C774             	!:
 5591                        		__bfalse	.LL196
         12:C774  90 2B      			bcc	.LL196
 5592                        	
 5593                        		.dbg	line,	"include\routines_LEVELS.c", 805; {
 5594                        	
 5595                        		.dbg	line,	"include\routines_LEVELS.c", 806; set_far_base(TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 5596                        		__ldx.umq	_player_naked
         12:C776  AE 1B 23   			ldx	_player_naked
 5597                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:C779  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:C77C  C2         			cly
 5598                        		__st.umq	_bp_bank
         12:C77D  85 02      			sta	_bp_bank
 5599                        		__ld2x.umq	_player_naked
         12:C77F  AD 1B 23   			lda	_player_naked
         12:C782  0A         			asl	a
         12:C783  AA         			tax
 5600                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:C784  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:C787  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 5601                        		__st.wmq	_bp
         12:C78A  85 EC      			sta.l	_bp
         12:C78C  84 ED      			sty.h	_bp
 5602                        	
 5603                        		.dbg	line,	"include\routines_LEVELS.c", 807; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 5604                        		__st.wmiq	6144, _di
         12:C78E  64 F0      			stz.l	_di
         12:C790  A9 18      			lda.h	#6144
         12:C792  85 F1      			sta.h	_di
 5605                        		__st.wmiq	256, _ax
         12:C794  64 F8      			stz.l	_ax
         12:C796  A9 01      			lda.h	#256
         12:C798  85 F9      			sta.h	_ax
 5606                        		 _far_load_vram.2
         12:C79A  82         			clx				; Offset to PCE VDC.
         12:C79B  20 63 FF   			call	load_vram_x
 5607                        	
 5608                        		.dbg	line,	"include\routines_LEVELS.c", 809; player_counter_anim = 0;
 5609                        		__st.umiq	0, _player_counter_anim
         12:C79E  9C 18 23   			stz	_player_counter_anim
 5610                        	
 5611                        		.dbg	line,	"include\routines_LEVELS.c", 810; }
 5612                        	
 5613                        		.dbg	line,	"include\routines_LEVELS.c", 812; recenter_CAMERA();
 5614    12:C7A1             	.LL196:
 5615                        		__call		_recenter_CAMERA
         12:C7A1  20 59 FF   			call	_recenter_CAMERA
 5616                        	
 5617                        		.dbg	line,	"include\routines_LEVELS.c", 815; // CHECK COLLISION WITH LEFT FLOOR //
 5618                        	
 5619                        		.dbg	line,	"include\routines_LEVELS.c", 816; check_BG( 10 , 32 );//8
 5620                        		__ld.wi		10
         12:C7A4  A9 0A      			lda.l	#10
         12:C7A6  C2         			cly
 5621                        		__pusharg.wr
         12:C7A7  A6 8D      			ldx	<__sp
         12:C7A9  CA         			dex
         12:C7AA  CA         			dex
         12:C7AB  95 08      			sta.l	<__stack, x
         12:C7AD  94 09      			sty.h	<__stack, x
         12:C7AF  86 8D      			stx	<__sp
 5622                        		__ld.wi		32
         12:C7B1  A9 20      			lda.l	#32
         12:C7B3  C2         			cly
 5623                        		__pusharg.wr
         12:C7B4  A6 8D      			ldx	<__sp
         12:C7B6  CA         			dex
         12:C7B7  CA         			dex
         12:C7B8  95 08      			sta.l	<__stack, x
         12:C7BA  94 09      			sty.h	<__stack, x
         12:C7BC  86 8D      			stx	<__sp
 5624                        		__call		_check_BG
         12:C7BE  20 6D FF   			call	_check_BG
 5625                        	
 5626                        		.dbg	line,	"include\routines_LEVELS.c", 818; if(map_blk_flag == TILE_EMPTY)
 5627                        		__not.um	_map_blk_flag
         12:C7C1  AD AB 2B   			lda	_map_blk_flag
         12:C7C4  18         			clc
         12:C7C5  D0 01      			bne	!+
         12:C7C7  38         			sec
         12:C7C8             	!:
 5628                        		__bfalse	.LL197
         12:C7C8  B0 03 4C A2			bcc	.LL197
         12:C7CC  DF          
 5629                        	
 5630                        		.dbg	line,	"include\routines_LEVELS.c", 819; {
 5631                        	
 5632                        		.dbg	line,	"include\routines_LEVELS.c", 820; // CHECK COLLISION WITH RIGHT FLOOR //
 5633                        	
 5634                        		.dbg	line,	"include\routines_LEVELS.c", 821; check_BG( 22 , 32 );//24
 5635                        		__ld.wi		22
         12:C7CD  A9 16      			lda.l	#22
         12:C7CF  C2         			cly
 5636                        		__pusharg.wr
         12:C7D0  A6 8D      			ldx	<__sp
         12:C7D2  CA         			dex
         12:C7D3  CA         			dex
         12:C7D4  95 08      			sta.l	<__stack, x
         12:C7D6  94 09      			sty.h	<__stack, x
         12:C7D8  86 8D      			stx	<__sp
 5637                        		__ld.wi		32
         12:C7DA  A9 20      			lda.l	#32
         12:C7DC  C2         			cly
 5638                        		__pusharg.wr
         12:C7DD  A6 8D      			ldx	<__sp
         12:C7DF  CA         			dex
         12:C7E0  CA         			dex
         12:C7E1  95 08      			sta.l	<__stack, x
         12:C7E3  94 09      			sty.h	<__stack, x
         12:C7E5  86 8D      			stx	<__sp
 5639                        		__call		_check_BG
         12:C7E7  20 6D FF   			call	_check_BG
 5640                        	
 5641                        		.dbg	line,	"include\routines_LEVELS.c", 823; if(map_blk_flag == TILE_EMPTY)
 5642                        		__not.um	_map_blk_flag
         12:C7EA  AD AB 2B   			lda	_map_blk_flag
         12:C7ED  18         			clc
         12:C7EE  D0 01      			bne	!+
         12:C7F0  38         			sec
         12:C7F1             	!:
 5643                        		__bfalse	.LL198
         12:C7F1  B0 03 4C A2			bcc	.LL198
         12:C7F5  DF          
 5644                        	
 5645                        		.dbg	line,	"include\routines_LEVELS.c", 824; {
 5646                        	
 5647                        		.dbg	line,	"include\routines_LEVELS.c", 825; set_far_base(TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 5648                        		__ldx.umq	_player_naked
         12:C7F6  AE 1B 23   			ldx	_player_naked
 5649                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:C7F9  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:C7FC  C2         			cly
 5650                        		__st.umq	_bp_bank
         12:C7FD  85 02      			sta	_bp_bank
 5651                        		__ld2x.umq	_player_naked
         12:C7FF  AD 1B 23   			lda	_player_naked
         12:C802  0A         			asl	a
         12:C803  AA         			tax
 5652                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:C804  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:C807  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 5653                        		__st.wmq	_bp
         12:C80A  85 EC      			sta.l	_bp
         12:C80C  84 ED      			sty.h	_bp
 5654                        	
 5655                        		.dbg	line,	"include\routines_LEVELS.c", 826; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 5656                        		__st.wmiq	6144, _di
         12:C80E  64 F0      			stz.l	_di
         12:C810  A9 18      			lda.h	#6144
         12:C812  85 F1      			sta.h	_di
 5657                        		__st.wmiq	256, _ax
         12:C814  64 F8      			stz.l	_ax
         12:C816  A9 01      			lda.h	#256
         12:C818  85 F9      			sta.h	_ax
 5658                        		 _far_load_vram.2
         12:C81A  82         			clx				; Offset to PCE VDC.
         12:C81B  20 63 FF   			call	load_vram_x
 5659                        	
 5660                        		.dbg	line,	"include\routines_LEVELS.c", 828; jump_ladder = FALSE;
 5661                        		__st.umiq	0, _jump_ladder
         12:C81E  9C 1D 23   			stz	_jump_ladder
 5662                        	
 5663                        		.dbg	line,	"include\routines_LEVELS.c", 829; player_index_jump = 0;
 5664                        		__st.umiq	0, _player_index_jump
         12:C821  9C 19 23   			stz	_player_index_jump
 5665                        	
 5666                        		.dbg	line,	"include\routines_LEVELS.c", 830; player_index_fall = 0;
 5667                        		__st.umiq	0, _player_index_fall
         12:C824  9C 1A 23   			stz	_player_index_fall
 5668                        	
 5669                        		.dbg	line,	"include\routines_LEVELS.c", 831; player_state = STATE_FALL;
 5670                        		__st.umiq	9, _player_state
         12:C827  A9 09      			lda.l	#9
         12:C829  8D 15 23   			sta	_player_state
 5671                        	
 5672                        		.dbg	line,	"include\routines_LEVELS.c", 832; }
 5673                        	
 5674                        		.dbg	line,	"include\routines_LEVELS.c", 833; }
 5675    12:C82C             	.LL198	.alias		.LL199
 5676                        	
 5677                        		.dbg	line,	"include\routines_LEVELS.c", 834; }
 5678    12:C82C             	.LL197	.alias		.LL199
 5679                        	
 5680                        		.dbg	line,	"include\routines_LEVELS.c", 837; else if(player_state == STATE_WALK)
 5681                        		__bra		.LL199
         12:C82C  4C A2 DF   			bra	.LL199
 5682    12:C82F             	.LL195:
 5683                        		__ld.umq	_player_state
         12:C82F  AD 15 23   			lda	_player_state
 5684                        		__equ_b.uiq	1
         12:C832  C9 01      			cmp	#1
         12:C834  F0 01      			beq	!+
         12:C836  18         			clc
         12:C837             	!:
 5685                        		__bfalse	.LL200
         12:C837  B0 03 4C 95			bcc	.LL200
         12:C83B  CB          
 5686                        	
 5687                        		.dbg	line,	"include\routines_LEVELS.c", 838; {
 5688                        	
 5689                        		.dbg	line,	"include\routines_LEVELS.c", 839; recenter_CAMERA();
 5690                        		__call		_recenter_CAMERA
         12:C83C  20 59 FF   			call	_recenter_CAMERA
 5691                        	
 5692                        		.dbg	line,	"include\routines_LEVELS.c", 842; //--------------------------------------------------------------------------------------//
 5693                        	
 5694                        		.dbg	line,	"include\routines_LEVELS.c", 843; //                                   FLOOR COLLISION                                    //
 5695                        	
 5696                        		.dbg	line,	"include\routines_LEVELS.c", 844; //--------------------------------------------------------------------------------------//
 5697                        	
 5698                        		.dbg	line,	"include\routines_LEVELS.c", 846; // CHECK COLLISION WITH LEFT FLOOR //
 5699                        	
 5700                        		.dbg	line,	"include\routines_LEVELS.c", 847; check_BG( 10 , 32 );//8
 5701                        		__ld.wi		10
         12:C83F  A9 0A      			lda.l	#10
         12:C841  C2         			cly
 5702                        		__pusharg.wr
         12:C842  A6 8D      			ldx	<__sp
         12:C844  CA         			dex
         12:C845  CA         			dex
         12:C846  95 08      			sta.l	<__stack, x
         12:C848  94 09      			sty.h	<__stack, x
         12:C84A  86 8D      			stx	<__sp
 5703                        		__ld.wi		32
         12:C84C  A9 20      			lda.l	#32
         12:C84E  C2         			cly
 5704                        		__pusharg.wr
         12:C84F  A6 8D      			ldx	<__sp
         12:C851  CA         			dex
         12:C852  CA         			dex
         12:C853  95 08      			sta.l	<__stack, x
         12:C855  94 09      			sty.h	<__stack, x
         12:C857  86 8D      			stx	<__sp
 5705                        		__call		_check_BG
         12:C859  20 6D FF   			call	_check_BG
 5706                        	
 5707                        		.dbg	line,	"include\routines_LEVELS.c", 849; if(map_blk_flag == TILE_EMPTY)
 5708                        		__not.um	_map_blk_flag
         12:C85C  AD AB 2B   			lda	_map_blk_flag
         12:C85F  18         			clc
         12:C860  D0 01      			bne	!+
         12:C862  38         			sec
         12:C863             	!:
 5709                        		__bfalse	.LL201
         12:C863  B0 03 4C 43			bcc	.LL201
         12:C867  C9          
 5710                        	
 5711                        		.dbg	line,	"include\routines_LEVELS.c", 850; {
 5712                        	
 5713                        		.dbg	line,	"include\routines_LEVELS.c", 851; // CHECK COLLISION WITH RIGHT FLOOR //
 5714                        	
 5715                        		.dbg	line,	"include\routines_LEVELS.c", 852; check_BG( 22 , 32 );//24
 5716                        		__ld.wi		22
         12:C868  A9 16      			lda.l	#22
         12:C86A  C2         			cly
 5717                        		__pusharg.wr
         12:C86B  A6 8D      			ldx	<__sp
         12:C86D  CA         			dex
         12:C86E  CA         			dex
         12:C86F  95 08      			sta.l	<__stack, x
         12:C871  94 09      			sty.h	<__stack, x
         12:C873  86 8D      			stx	<__sp
 5718                        		__ld.wi		32
         12:C875  A9 20      			lda.l	#32
         12:C877  C2         			cly
 5719                        		__pusharg.wr
         12:C878  A6 8D      			ldx	<__sp
         12:C87A  CA         			dex
         12:C87B  CA         			dex
         12:C87C  95 08      			sta.l	<__stack, x
         12:C87E  94 09      			sty.h	<__stack, x
         12:C880  86 8D      			stx	<__sp
 5720                        		__call		_check_BG
         12:C882  20 6D FF   			call	_check_BG
 5721                        	
 5722                        		.dbg	line,	"include\routines_LEVELS.c", 854; if(map_blk_flag == TILE_EMPTY)
 5723                        		__not.um	_map_blk_flag
         12:C885  AD AB 2B   			lda	_map_blk_flag
         12:C888  18         			clc
         12:C889  D0 01      			bne	!+
         12:C88B  38         			sec
         12:C88C             	!:
 5724                        		__bfalse	.LL202
         12:C88C  90 39      			bcc	.LL202
 5725                        	
 5726                        		.dbg	line,	"include\routines_LEVELS.c", 855; {
 5727                        	
 5728                        		.dbg	line,	"include\routines_LEVELS.c", 856; set_far_base(TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 5729                        		__ldx.umq	_player_naked
         12:C88E  AE 1B 23   			ldx	_player_naked
 5730                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:C891  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:C894  C2         			cly
 5731                        		__st.umq	_bp_bank
         12:C895  85 02      			sta	_bp_bank
 5732                        		__ld2x.umq	_player_naked
         12:C897  AD 1B 23   			lda	_player_naked
         12:C89A  0A         			asl	a
         12:C89B  AA         			tax
 5733                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:C89C  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:C89F  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 5734                        		__st.wmq	_bp
         12:C8A2  85 EC      			sta.l	_bp
         12:C8A4  84 ED      			sty.h	_bp
 5735                        	
 5736                        		.dbg	line,	"include\routines_LEVELS.c", 857; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 5737                        		__st.wmiq	6144, _di
         12:C8A6  64 F0      			stz.l	_di
         12:C8A8  A9 18      			lda.h	#6144
         12:C8AA  85 F1      			sta.h	_di
 5738                        		__st.wmiq	256, _ax
         12:C8AC  64 F8      			stz.l	_ax
         12:C8AE  A9 01      			lda.h	#256
         12:C8B0  85 F9      			sta.h	_ax
 5739                        		 _far_load_vram.2
         12:C8B2  82         			clx				; Offset to PCE VDC.
         12:C8B3  20 63 FF   			call	load_vram_x
 5740                        	
 5741                        		.dbg	line,	"include\routines_LEVELS.c", 859; jump_ladder = FALSE;
 5742                        		__st.umiq	0, _jump_ladder
         12:C8B6  9C 1D 23   			stz	_jump_ladder
 5743                        	
 5744                        		.dbg	line,	"include\routines_LEVELS.c", 860; player_index_jump = 0;
 5745                        		__st.umiq	0, _player_index_jump
         12:C8B9  9C 19 23   			stz	_player_index_jump
 5746                        	
 5747                        		.dbg	line,	"include\routines_LEVELS.c", 861; player_index_fall = 0;
 5748                        		__st.umiq	0, _player_index_fall
         12:C8BC  9C 1A 23   			stz	_player_index_fall
 5749                        	
 5750                        		.dbg	line,	"include\routines_LEVELS.c", 862; player_state = STATE_FALL;
 5751                        		__st.umiq	9, _player_state
         12:C8BF  A9 09      			lda.l	#9
         12:C8C1  8D 15 23   			sta	_player_state
 5752                        	
 5753                        		.dbg	line,	"include\routines_LEVELS.c", 863; }
 5754                        	
 5755                        		.dbg	line,	"include\routines_LEVELS.c", 865; else
 5756                        		__bra		.LL203
         12:C8C4  4C B6 C9   			bra	.LL203
 5757    12:C8C7             	.LL202:
 5758                        	
 5759                        		.dbg	line,	"include\routines_LEVELS.c", 866; {
 5760                        	
 5761                        		.dbg	line,	"include\routines_LEVELS.c", 867; if(player_axis == AXIS_RIGHT)
 5762                        		__not.um	_player_axis
         12:C8C7  AD 16 23   			lda	_player_axis
         12:C8CA  18         			clc
         12:C8CB  D0 01      			bne	!+
         12:C8CD  38         			sec
         12:C8CE             	!:
 5763                        		__bfalse	.LL204
         12:C8CE  90 3A      			bcc	.LL204
 5764                        	
 5765                        		.dbg	line,	"include\routines_LEVELS.c", 868; {
 5766                        	
 5767                        		.dbg	line,	"include\routines_LEVELS.c", 869; // CHECK COLLISION WITH RIGHT WALL //
 5768                        	
 5769                        		.dbg	line,	"include\routines_LEVELS.c", 870; check_BG( 24 , 31 ); // 24+2
 5770                        		__ld.wi		24
         12:C8D0  A9 18      			lda.l	#24
         12:C8D2  C2         			cly
 5771                        		__pusharg.wr
         12:C8D3  A6 8D      			ldx	<__sp
         12:C8D5  CA         			dex
         12:C8D6  CA         			dex
         12:C8D7  95 08      			sta.l	<__stack, x
         12:C8D9  94 09      			sty.h	<__stack, x
         12:C8DB  86 8D      			stx	<__sp
 5772                        		__ld.wi		31
         12:C8DD  A9 1F      			lda.l	#31
         12:C8DF  C2         			cly
 5773                        		__pusharg.wr
         12:C8E0  A6 8D      			ldx	<__sp
         12:C8E2  CA         			dex
         12:C8E3  CA         			dex
         12:C8E4  95 08      			sta.l	<__stack, x
         12:C8E6  94 09      			sty.h	<__stack, x
         12:C8E8  86 8D      			stx	<__sp
 5774                        		__call		_check_BG
         12:C8EA  20 6D FF   			call	_check_BG
 5775                        	
 5776                        		.dbg	line,	"include\routines_LEVELS.c", 872; if(map_blk_flag == TILE_EMPTY)
 5777                        		__not.um	_map_blk_flag
         12:C8ED  AD AB 2B   			lda	_map_blk_flag
         12:C8F0  18         			clc
         12:C8F1  D0 01      			bne	!+
         12:C8F3  38         			sec
         12:C8F4             	!:
 5778                        		__bfalse	.LL205
         12:C8F4  B0 03 4C B6			bcc	.LL205
         12:C8F8  C9          
 5779                        	
 5780                        		.dbg	line,	"include\routines_LEVELS.c", 873; {
 5781                        	
 5782                        		.dbg	line,	"include\routines_LEVELS.c", 874; sgx_map_pxl_x += 2;
 5783                        		__add_st.wmiq	2, _sgx_map_pxl_x
         12:C8F9  18         			clc
         12:C8FA  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:C8FD  69 02      			adc.l	#2
         12:C8FF  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:C902  90 03      			bcc	!+
         12:C904  EE 8B 26   			inc.h	_sgx_map_pxl_x
         12:C907             	!:
 5784                        	
 5785                        		.dbg	line,	"include\routines_LEVELS.c", 875; }
 5786                        	
 5787                        		.dbg	line,	"include\routines_LEVELS.c", 876; }
 5788    12:C907             	.LL205	.alias		.LL206
 5789                        	
 5790                        		.dbg	line,	"include\routines_LEVELS.c", 878; else
 5791                        		__bra		.LL206
         12:C907  4C B6 C9   			bra	.LL206
 5792    12:C90A             	.LL204:
 5793                        	
 5794                        		.dbg	line,	"include\routines_LEVELS.c", 879; {
 5795                        	
 5796                        		.dbg	line,	"include\routines_LEVELS.c", 880; // CHECK COLLISION WITH LEFT WALL //
 5797                        	
 5798                        		.dbg	line,	"include\routines_LEVELS.c", 881; check_BG( 8 , 31 ); // 8-2
 5799                        		__ld.wi		8
         12:C90A  A9 08      			lda.l	#8
         12:C90C  C2         			cly
 5800                        		__pusharg.wr
         12:C90D  A6 8D      			ldx	<__sp
         12:C90F  CA         			dex
         12:C910  CA         			dex
         12:C911  95 08      			sta.l	<__stack, x
         12:C913  94 09      			sty.h	<__stack, x
         12:C915  86 8D      			stx	<__sp
 5801                        		__ld.wi		31
         12:C917  A9 1F      			lda.l	#31
         12:C919  C2         			cly
 5802                        		__pusharg.wr
         12:C91A  A6 8D      			ldx	<__sp
         12:C91C  CA         			dex
         12:C91D  CA         			dex
         12:C91E  95 08      			sta.l	<__stack, x
         12:C920  94 09      			sty.h	<__stack, x
         12:C922  86 8D      			stx	<__sp
 5803                        		__call		_check_BG
         12:C924  20 6D FF   			call	_check_BG
 5804                        	
 5805                        		.dbg	line,	"include\routines_LEVELS.c", 883; if(map_blk_flag == TILE_EMPTY)
 5806                        		__not.um	_map_blk_flag
         12:C927  AD AB 2B   			lda	_map_blk_flag
         12:C92A  18         			clc
         12:C92B  D0 01      			bne	!+
         12:C92D  38         			sec
         12:C92E             	!:
 5807                        		__bfalse	.LL207
         12:C92E  B0 03 4C B6			bcc	.LL207
         12:C932  C9          
 5808                        	
 5809                        		.dbg	line,	"include\routines_LEVELS.c", 884; {
 5810                        	
 5811                        		.dbg	line,	"include\routines_LEVELS.c", 885; sgx_map_pxl_x -= 2;
 5812                        		__sub_st.wmiq	2, _sgx_map_pxl_x
         12:C933  38         			sec
         12:C934  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:C937  E9 02      			sbc.l	#2
         12:C939  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:C93C  B0 03      			bcs	!+
         12:C93E  CE 8B 26   			dec.h	_sgx_map_pxl_x
         12:C941             	!:
 5813                        	
 5814                        		.dbg	line,	"include\routines_LEVELS.c", 886; }
 5815                        	
 5816                        		.dbg	line,	"include\routines_LEVELS.c", 887; }
 5817    12:C941             	.LL207	.alias		.LL208
 5818    12:C941             	.LL206	.alias		.LL208
 5819                        	
 5820                        		.dbg	line,	"include\routines_LEVELS.c", 888; }
 5821    12:C941             	.LL203	.alias		.LL208
 5822                        	
 5823                        		.dbg	line,	"include\routines_LEVELS.c", 889; }
 5824                        	
 5825                        		.dbg	line,	"include\routines_LEVELS.c", 891; else
 5826                        		__bra		.LL208
         12:C941  80 73      			bra	.LL208
 5827    12:C943             	.LL201:
 5828                        	
 5829                        		.dbg	line,	"include\routines_LEVELS.c", 892; {
 5830                        	
 5831                        		.dbg	line,	"include\routines_LEVELS.c", 893; if(player_axis == AXIS_RIGHT)
 5832                        		__not.um	_player_axis
         12:C943  AD 16 23   			lda	_player_axis
         12:C946  18         			clc
         12:C947  D0 01      			bne	!+
         12:C949  38         			sec
         12:C94A             	!:
 5833                        		__bfalse	.LL209
         12:C94A  90 36      			bcc	.LL209
 5834                        	
 5835                        		.dbg	line,	"include\routines_LEVELS.c", 894; {
 5836                        	
 5837                        		.dbg	line,	"include\routines_LEVELS.c", 895; // CHECK COLLISION WITH RIGHT WALL //
 5838                        	
 5839                        		.dbg	line,	"include\routines_LEVELS.c", 896; check_BG( 24 , 31 ); // 24+2
 5840                        		__ld.wi		24
         12:C94C  A9 18      			lda.l	#24
         12:C94E  C2         			cly
 5841                        		__pusharg.wr
         12:C94F  A6 8D      			ldx	<__sp
         12:C951  CA         			dex
         12:C952  CA         			dex
         12:C953  95 08      			sta.l	<__stack, x
         12:C955  94 09      			sty.h	<__stack, x
         12:C957  86 8D      			stx	<__sp
 5842                        		__ld.wi		31
         12:C959  A9 1F      			lda.l	#31
         12:C95B  C2         			cly
 5843                        		__pusharg.wr
         12:C95C  A6 8D      			ldx	<__sp
         12:C95E  CA         			dex
         12:C95F  CA         			dex
         12:C960  95 08      			sta.l	<__stack, x
         12:C962  94 09      			sty.h	<__stack, x
         12:C964  86 8D      			stx	<__sp
 5844                        		__call		_check_BG
         12:C966  20 6D FF   			call	_check_BG
 5845                        	
 5846                        		.dbg	line,	"include\routines_LEVELS.c", 898; if(map_blk_flag == TILE_EMPTY)
 5847                        		__not.um	_map_blk_flag
         12:C969  AD AB 2B   			lda	_map_blk_flag
         12:C96C  18         			clc
         12:C96D  D0 01      			bne	!+
         12:C96F  38         			sec
         12:C970             	!:
 5848                        		__bfalse	.LL210
         12:C970  90 44      			bcc	.LL210
 5849                        	
 5850                        		.dbg	line,	"include\routines_LEVELS.c", 899; {
 5851                        	
 5852                        		.dbg	line,	"include\routines_LEVELS.c", 900; sgx_map_pxl_x += 2;
 5853                        		__add_st.wmiq	2, _sgx_map_pxl_x
         12:C972  18         			clc
         12:C973  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:C976  69 02      			adc.l	#2
         12:C978  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:C97B  90 03      			bcc	!+
         12:C97D  EE 8B 26   			inc.h	_sgx_map_pxl_x
         12:C980             	!:
 5854                        	
 5855                        		.dbg	line,	"include\routines_LEVELS.c", 901; }
 5856                        	
 5857                        		.dbg	line,	"include\routines_LEVELS.c", 902; }
 5858    12:C980             	.LL210	.alias		.LL211
 5859                        	
 5860                        		.dbg	line,	"include\routines_LEVELS.c", 904; else
 5861                        		__bra		.LL211
         12:C980  80 34      			bra	.LL211
 5862    12:C982             	.LL209:
 5863                        	
 5864                        		.dbg	line,	"include\routines_LEVELS.c", 905; {
 5865                        	
 5866                        		.dbg	line,	"include\routines_LEVELS.c", 906; // CHECK COLLISION WITH LEFT WALL //
 5867                        	
 5868                        		.dbg	line,	"include\routines_LEVELS.c", 907; check_BG( 8 , 31 ); // 8-2
 5869                        		__ld.wi		8
         12:C982  A9 08      			lda.l	#8
         12:C984  C2         			cly
 5870                        		__pusharg.wr
         12:C985  A6 8D      			ldx	<__sp
         12:C987  CA         			dex
         12:C988  CA         			dex
         12:C989  95 08      			sta.l	<__stack, x
         12:C98B  94 09      			sty.h	<__stack, x
         12:C98D  86 8D      			stx	<__sp
 5871                        		__ld.wi		31
         12:C98F  A9 1F      			lda.l	#31
         12:C991  C2         			cly
 5872                        		__pusharg.wr
         12:C992  A6 8D      			ldx	<__sp
         12:C994  CA         			dex
         12:C995  CA         			dex
         12:C996  95 08      			sta.l	<__stack, x
         12:C998  94 09      			sty.h	<__stack, x
         12:C99A  86 8D      			stx	<__sp
 5873                        		__call		_check_BG
         12:C99C  20 6D FF   			call	_check_BG
 5874                        	
 5875                        		.dbg	line,	"include\routines_LEVELS.c", 909; if(map_blk_flag == TILE_EMPTY)
 5876                        		__not.um	_map_blk_flag
         12:C99F  AD AB 2B   			lda	_map_blk_flag
         12:C9A2  18         			clc
         12:C9A3  D0 01      			bne	!+
         12:C9A5  38         			sec
         12:C9A6             	!:
 5877                        		__bfalse	.LL212
         12:C9A6  90 0E      			bcc	.LL212
 5878                        	
 5879                        		.dbg	line,	"include\routines_LEVELS.c", 910; {
 5880                        	
 5881                        		.dbg	line,	"include\routines_LEVELS.c", 911; sgx_map_pxl_x -= 2;
 5882                        		__sub_st.wmiq	2, _sgx_map_pxl_x
         12:C9A8  38         			sec
         12:C9A9  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:C9AC  E9 02      			sbc.l	#2
         12:C9AE  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:C9B1  B0 03      			bcs	!+
         12:C9B3  CE 8B 26   			dec.h	_sgx_map_pxl_x
         12:C9B6             	!:
 5883                        	
 5884                        		.dbg	line,	"include\routines_LEVELS.c", 912; }
 5885                        	
 5886                        		.dbg	line,	"include\routines_LEVELS.c", 913; }
 5887    12:C9B6             	.LL212:
 5888    12:C9B6             	.LL211:
 5889                        	
 5890                        		.dbg	line,	"include\routines_LEVELS.c", 914; }
 5891    12:C9B6             	.LL208:
 5892                        	
 5893                        		.dbg	line,	"include\routines_LEVELS.c", 919; spr_set(player_id);
 5894                        		__ld.umq	_player_id
         12:C9B6  AD 14 23   			lda	_player_id
 5895                        		__call		_spr_set.1
         12:C9B9  20 DD E7   			call	_spr_set.1
 5896                        	
 5897                        		.dbg	line,	"include\routines_LEVELS.c", 922; // UPDATE PLAYER TILES //
 5898                        	
 5899                        		.dbg	line,	"include\routines_LEVELS.c", 923; if(player_counter_anim == 0)
 5900                        		__not.um	_player_counter_anim
         12:C9BC  AD 18 23   			lda	_player_counter_anim
         12:C9BF  18         			clc
         12:C9C0  D0 01      			bne	!+
         12:C9C2  38         			sec
         12:C9C3             	!:
 5901                        		__bfalse	.LL213
         12:C9C3  90 2B      			bcc	.LL213
 5902                        	
 5903                        		.dbg	line,	"include\routines_LEVELS.c", 924; {
 5904                        	
 5905                        		.dbg	line,	"include\routines_LEVELS.c", 925; set_far_base(TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 5906                        		__ldx.umq	_player_naked
         12:C9C5  AE 1B 23   			ldx	_player_naked
 5907                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:C9C8  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:C9CB  C2         			cly
 5908                        		__st.umq	_bp_bank
         12:C9CC  85 02      			sta	_bp_bank
 5909                        		__ld2x.umq	_player_naked
         12:C9CE  AD 1B 23   			lda	_player_naked
         12:C9D1  0A         			asl	a
         12:C9D2  AA         			tax
 5910                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:C9D3  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:C9D6  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 5911                        		__st.wmq	_bp
         12:C9D9  85 EC      			sta.l	_bp
         12:C9DB  84 ED      			sty.h	_bp
 5912                        	
 5913                        		.dbg	line,	"include\routines_LEVELS.c", 926; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 5914                        		__st.wmiq	6144, _di
         12:C9DD  64 F0      			stz.l	_di
         12:C9DF  A9 18      			lda.h	#6144
         12:C9E1  85 F1      			sta.h	_di
 5915                        		__st.wmiq	256, _ax
         12:C9E3  64 F8      			stz.l	_ax
         12:C9E5  A9 01      			lda.h	#256
         12:C9E7  85 F9      			sta.h	_ax
 5916                        		 _far_load_vram.2
         12:C9E9  82         			clx				; Offset to PCE VDC.
         12:C9EA  20 63 FF   			call	load_vram_x
 5917                        	
 5918                        		.dbg	line,	"include\routines_LEVELS.c", 927; }
 5919                        	
 5920                        		.dbg	line,	"include\routines_LEVELS.c", 930; else if(player_counter_anim == 2)
 5921                        		__bra		.LL214
         12:C9ED  4C 8F CB   			bra	.LL214
 5922    12:C9F0             	.LL213:
 5923                        		__ld.umq	_player_counter_anim
         12:C9F0  AD 18 23   			lda	_player_counter_anim
 5924                        		__equ_b.uiq	2
         12:C9F3  C9 02      			cmp	#2
         12:C9F5  F0 01      			beq	!+
         12:C9F7  18         			clc
         12:C9F8             	!:
 5925                        		__bfalse	.LL215
         12:C9F8  90 30      			bcc	.LL215
 5926                        	
 5927                        		.dbg	line,	"include\routines_LEVELS.c", 931; {
 5928                        	
 5929                        		.dbg	line,	"include\routines_LEVELS.c", 932; set_far_offset(OFFSET_PLAYER_WALK_1,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 5930                        		__st.wmiq	512, _bp
         12:C9FA  64 EC      			stz.l	_bp
         12:C9FC  A9 02      			lda.h	#512
         12:C9FE  85 ED      			sta.h	_bp
 5931                        		__ldx.umq	_player_naked
         12:CA00  AE 1B 23   			ldx	_player_naked
 5932                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CA03  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CA06  C2         			cly
 5933                        		__st.umq	_bp_bank
         12:CA07  85 02      			sta	_bp_bank
 5934                        		__ld2x.umq	_player_naked
         12:CA09  AD 1B 23   			lda	_player_naked
         12:CA0C  0A         			asl	a
         12:CA0D  AA         			tax
 5935                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CA0E  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CA11  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 5936                        		__call		_set_far_offset.3
         12:CA14  20 8C E2   			call	_set_far_offset.3
 5937                        	
 5938                        		.dbg	line,	"include\routines_LEVELS.c", 933; far_load_vram(PLAYER_VRAM_ADR,TILES_16);            
 5939                        		__st.wmiq	6144, _di
         12:CA17  64 F0      			stz.l	_di
         12:CA19  A9 18      			lda.h	#6144
         12:CA1B  85 F1      			sta.h	_di
 5940                        		__st.wmiq	256, _ax
         12:CA1D  64 F8      			stz.l	_ax
         12:CA1F  A9 01      			lda.h	#256
         12:CA21  85 F9      			sta.h	_ax
 5941                        		 _far_load_vram.2
         12:CA23  82         			clx				; Offset to PCE VDC.
         12:CA24  20 63 FF   			call	load_vram_x
 5942                        	
 5943                        		.dbg	line,	"include\routines_LEVELS.c", 934; }
 5944                        	
 5945                        		.dbg	line,	"include\routines_LEVELS.c", 937; else if(player_counter_anim == 5)
 5946                        		__bra		.LL216
         12:CA27  4C 8F CB   			bra	.LL216
 5947    12:CA2A             	.LL215:
 5948                        		__ld.umq	_player_counter_anim
         12:CA2A  AD 18 23   			lda	_player_counter_anim
 5949                        		__equ_b.uiq	5
         12:CA2D  C9 05      			cmp	#5
         12:CA2F  F0 01      			beq	!+
         12:CA31  18         			clc
         12:CA32             	!:
 5950                        		__bfalse	.LL217
         12:CA32  90 30      			bcc	.LL217
 5951                        	
 5952                        		.dbg	line,	"include\routines_LEVELS.c", 938; {
 5953                        	
 5954                        		.dbg	line,	"include\routines_LEVELS.c", 939; set_far_offset(OFFSET_PLAYER_WALK_2,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 5955                        		__st.wmiq	1024, _bp
         12:CA34  64 EC      			stz.l	_bp
         12:CA36  A9 04      			lda.h	#1024
         12:CA38  85 ED      			sta.h	_bp
 5956                        		__ldx.umq	_player_naked
         12:CA3A  AE 1B 23   			ldx	_player_naked
 5957                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CA3D  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CA40  C2         			cly
 5958                        		__st.umq	_bp_bank
         12:CA41  85 02      			sta	_bp_bank
 5959                        		__ld2x.umq	_player_naked
         12:CA43  AD 1B 23   			lda	_player_naked
         12:CA46  0A         			asl	a
         12:CA47  AA         			tax
 5960                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CA48  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CA4B  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 5961                        		__call		_set_far_offset.3
         12:CA4E  20 8C E2   			call	_set_far_offset.3
 5962                        	
 5963                        		.dbg	line,	"include\routines_LEVELS.c", 940; far_load_vram(PLAYER_VRAM_ADR,TILES_16);             
 5964                        		__st.wmiq	6144, _di
         12:CA51  64 F0      			stz.l	_di
         12:CA53  A9 18      			lda.h	#6144
         12:CA55  85 F1      			sta.h	_di
 5965                        		__st.wmiq	256, _ax
         12:CA57  64 F8      			stz.l	_ax
         12:CA59  A9 01      			lda.h	#256
         12:CA5B  85 F9      			sta.h	_ax
 5966                        		 _far_load_vram.2
         12:CA5D  82         			clx				; Offset to PCE VDC.
         12:CA5E  20 63 FF   			call	load_vram_x
 5967                        	
 5968                        		.dbg	line,	"include\routines_LEVELS.c", 941; }
 5969                        	
 5970                        		.dbg	line,	"include\routines_LEVELS.c", 944; else if(player_counter_anim == 8)
 5971                        		__bra		.LL218
         12:CA61  4C 8F CB   			bra	.LL218
 5972    12:CA64             	.LL217:
 5973                        		__ld.umq	_player_counter_anim
         12:CA64  AD 18 23   			lda	_player_counter_anim
 5974                        		__equ_b.uiq	8
         12:CA67  C9 08      			cmp	#8
         12:CA69  F0 01      			beq	!+
         12:CA6B  18         			clc
         12:CA6C             	!:
 5975                        		__bfalse	.LL219
         12:CA6C  90 30      			bcc	.LL219
 5976                        	
 5977                        		.dbg	line,	"include\routines_LEVELS.c", 945; {
 5978                        	
 5979                        		.dbg	line,	"include\routines_LEVELS.c", 946; set_far_offset(OFFSET_PLAYER_WALK_3,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 5980                        		__st.wmiq	1536, _bp
         12:CA6E  64 EC      			stz.l	_bp
         12:CA70  A9 06      			lda.h	#1536
         12:CA72  85 ED      			sta.h	_bp
 5981                        		__ldx.umq	_player_naked
         12:CA74  AE 1B 23   			ldx	_player_naked
 5982                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CA77  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CA7A  C2         			cly
 5983                        		__st.umq	_bp_bank
         12:CA7B  85 02      			sta	_bp_bank
 5984                        		__ld2x.umq	_player_naked
         12:CA7D  AD 1B 23   			lda	_player_naked
         12:CA80  0A         			asl	a
         12:CA81  AA         			tax
 5985                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CA82  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CA85  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 5986                        		__call		_set_far_offset.3
         12:CA88  20 8C E2   			call	_set_far_offset.3
 5987                        	
 5988                        		.dbg	line,	"include\routines_LEVELS.c", 947; far_load_vram(PLAYER_VRAM_ADR,TILES_16);              
 5989                        		__st.wmiq	6144, _di
         12:CA8B  64 F0      			stz.l	_di
         12:CA8D  A9 18      			lda.h	#6144
         12:CA8F  85 F1      			sta.h	_di
 5990                        		__st.wmiq	256, _ax
         12:CA91  64 F8      			stz.l	_ax
         12:CA93  A9 01      			lda.h	#256
         12:CA95  85 F9      			sta.h	_ax
 5991                        		 _far_load_vram.2
         12:CA97  82         			clx				; Offset to PCE VDC.
         12:CA98  20 63 FF   			call	load_vram_x
 5992                        	
 5993                        		.dbg	line,	"include\routines_LEVELS.c", 948; }
 5994                        	
 5995                        		.dbg	line,	"include\routines_LEVELS.c", 951; else if(player_counter_anim == 11)
 5996                        		__bra		.LL220
         12:CA9B  4C 8F CB   			bra	.LL220
 5997    12:CA9E             	.LL219:
 5998                        		__ld.umq	_player_counter_anim
         12:CA9E  AD 18 23   			lda	_player_counter_anim
 5999                        		__equ_b.uiq	11
         12:CAA1  C9 0B      			cmp	#11
         12:CAA3  F0 01      			beq	!+
         12:CAA5  18         			clc
         12:CAA6             	!:
 6000                        		__bfalse	.LL221
         12:CAA6  90 2B      			bcc	.LL221
 6001                        	
 6002                        		.dbg	line,	"include\routines_LEVELS.c", 952; {
 6003                        	
 6004                        		.dbg	line,	"include\routines_LEVELS.c", 953; set_far_base(TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 6005                        		__ldx.umq	_player_naked
         12:CAA8  AE 1B 23   			ldx	_player_naked
 6006                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CAAB  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CAAE  C2         			cly
 6007                        		__st.umq	_bp_bank
         12:CAAF  85 02      			sta	_bp_bank
 6008                        		__ld2x.umq	_player_naked
         12:CAB1  AD 1B 23   			lda	_player_naked
         12:CAB4  0A         			asl	a
         12:CAB5  AA         			tax
 6009                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CAB6  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CAB9  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 6010                        		__st.wmq	_bp
         12:CABC  85 EC      			sta.l	_bp
         12:CABE  84 ED      			sty.h	_bp
 6011                        	
 6012                        		.dbg	line,	"include\routines_LEVELS.c", 954; far_load_vram(PLAYER_VRAM_ADR,TILES_16);            
 6013                        		__st.wmiq	6144, _di
         12:CAC0  64 F0      			stz.l	_di
         12:CAC2  A9 18      			lda.h	#6144
         12:CAC4  85 F1      			sta.h	_di
 6014                        		__st.wmiq	256, _ax
         12:CAC6  64 F8      			stz.l	_ax
         12:CAC8  A9 01      			lda.h	#256
         12:CACA  85 F9      			sta.h	_ax
 6015                        		 _far_load_vram.2
         12:CACC  82         			clx				; Offset to PCE VDC.
         12:CACD  20 63 FF   			call	load_vram_x
 6016                        	
 6017                        		.dbg	line,	"include\routines_LEVELS.c", 955; }
 6018                        	
 6019                        		.dbg	line,	"include\routines_LEVELS.c", 958; else if(player_counter_anim == 14)
 6020                        		__bra		.LL222
         12:CAD0  4C 8F CB   			bra	.LL222
 6021    12:CAD3             	.LL221:
 6022                        		__ld.umq	_player_counter_anim
         12:CAD3  AD 18 23   			lda	_player_counter_anim
 6023                        		__equ_b.uiq	14
         12:CAD6  C9 0E      			cmp	#14
         12:CAD8  F0 01      			beq	!+
         12:CADA  18         			clc
         12:CADB             	!:
 6024                        		__bfalse	.LL223
         12:CADB  90 30      			bcc	.LL223
 6025                        	
 6026                        		.dbg	line,	"include\routines_LEVELS.c", 959; {
 6027                        	
 6028                        		.dbg	line,	"include\routines_LEVELS.c", 960; set_far_offset(OFFSET_PLAYER_WALK_4,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 6029                        		__st.wmiq	2048, _bp
         12:CADD  64 EC      			stz.l	_bp
         12:CADF  A9 08      			lda.h	#2048
         12:CAE1  85 ED      			sta.h	_bp
 6030                        		__ldx.umq	_player_naked
         12:CAE3  AE 1B 23   			ldx	_player_naked
 6031                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CAE6  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CAE9  C2         			cly
 6032                        		__st.umq	_bp_bank
         12:CAEA  85 02      			sta	_bp_bank
 6033                        		__ld2x.umq	_player_naked
         12:CAEC  AD 1B 23   			lda	_player_naked
         12:CAEF  0A         			asl	a
         12:CAF0  AA         			tax
 6034                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CAF1  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CAF4  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 6035                        		__call		_set_far_offset.3
         12:CAF7  20 8C E2   			call	_set_far_offset.3
 6036                        	
 6037                        		.dbg	line,	"include\routines_LEVELS.c", 961; far_load_vram(PLAYER_VRAM_ADR,TILES_16);            
 6038                        		__st.wmiq	6144, _di
         12:CAFA  64 F0      			stz.l	_di
         12:CAFC  A9 18      			lda.h	#6144
         12:CAFE  85 F1      			sta.h	_di
 6039                        		__st.wmiq	256, _ax
         12:CB00  64 F8      			stz.l	_ax
         12:CB02  A9 01      			lda.h	#256
         12:CB04  85 F9      			sta.h	_ax
 6040                        		 _far_load_vram.2
         12:CB06  82         			clx				; Offset to PCE VDC.
         12:CB07  20 63 FF   			call	load_vram_x
 6041                        	
 6042                        		.dbg	line,	"include\routines_LEVELS.c", 962; }
 6043                        	
 6044                        		.dbg	line,	"include\routines_LEVELS.c", 965; else if(player_counter_anim == 17)
 6045                        		__bra		.LL224
         12:CB0A  4C 8F CB   			bra	.LL224
 6046    12:CB0D             	.LL223:
 6047                        		__ld.umq	_player_counter_anim
         12:CB0D  AD 18 23   			lda	_player_counter_anim
 6048                        		__equ_b.uiq	17
         12:CB10  C9 11      			cmp	#17
         12:CB12  F0 01      			beq	!+
         12:CB14  18         			clc
         12:CB15             	!:
 6049                        		__bfalse	.LL225
         12:CB15  90 2F      			bcc	.LL225
 6050                        	
 6051                        		.dbg	line,	"include\routines_LEVELS.c", 966; {
 6052                        	
 6053                        		.dbg	line,	"include\routines_LEVELS.c", 967; set_far_offset(OFFSET_PLAYER_WALK_5,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 6054                        		__st.wmiq	2560, _bp
         12:CB17  64 EC      			stz.l	_bp
         12:CB19  A9 0A      			lda.h	#2560
         12:CB1B  85 ED      			sta.h	_bp
 6055                        		__ldx.umq	_player_naked
         12:CB1D  AE 1B 23   			ldx	_player_naked
 6056                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CB20  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CB23  C2         			cly
 6057                        		__st.umq	_bp_bank
         12:CB24  85 02      			sta	_bp_bank
 6058                        		__ld2x.umq	_player_naked
         12:CB26  AD 1B 23   			lda	_player_naked
         12:CB29  0A         			asl	a
         12:CB2A  AA         			tax
 6059                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CB2B  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CB2E  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 6060                        		__call		_set_far_offset.3
         12:CB31  20 8C E2   			call	_set_far_offset.3
 6061                        	
 6062                        		.dbg	line,	"include\routines_LEVELS.c", 968; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 6063                        		__st.wmiq	6144, _di
         12:CB34  64 F0      			stz.l	_di
         12:CB36  A9 18      			lda.h	#6144
         12:CB38  85 F1      			sta.h	_di
 6064                        		__st.wmiq	256, _ax
         12:CB3A  64 F8      			stz.l	_ax
         12:CB3C  A9 01      			lda.h	#256
         12:CB3E  85 F9      			sta.h	_ax
 6065                        		 _far_load_vram.2
         12:CB40  82         			clx				; Offset to PCE VDC.
         12:CB41  20 63 FF   			call	load_vram_x
 6066                        	
 6067                        		.dbg	line,	"include\routines_LEVELS.c", 969; }
 6068                        	
 6069                        		.dbg	line,	"include\routines_LEVELS.c", 972; else if(player_counter_anim == 20)
 6070                        		__bra		.LL226
         12:CB44  80 49      			bra	.LL226
 6071    12:CB46             	.LL225:
 6072                        		__ld.umq	_player_counter_anim
         12:CB46  AD 18 23   			lda	_player_counter_anim
 6073                        		__equ_b.uiq	20
         12:CB49  C9 14      			cmp	#20
         12:CB4B  F0 01      			beq	!+
         12:CB4D  18         			clc
         12:CB4E             	!:
 6074                        		__bfalse	.LL227
         12:CB4E  90 2F      			bcc	.LL227
 6075                        	
 6076                        		.dbg	line,	"include\routines_LEVELS.c", 973; {
 6077                        	
 6078                        		.dbg	line,	"include\routines_LEVELS.c", 974; set_far_offset(OFFSET_PLAYER_WALK_6,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 6079                        		__st.wmiq	3072, _bp
         12:CB50  64 EC      			stz.l	_bp
         12:CB52  A9 0C      			lda.h	#3072
         12:CB54  85 ED      			sta.h	_bp
 6080                        		__ldx.umq	_player_naked
         12:CB56  AE 1B 23   			ldx	_player_naked
 6081                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CB59  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CB5C  C2         			cly
 6082                        		__st.umq	_bp_bank
         12:CB5D  85 02      			sta	_bp_bank
 6083                        		__ld2x.umq	_player_naked
         12:CB5F  AD 1B 23   			lda	_player_naked
         12:CB62  0A         			asl	a
         12:CB63  AA         			tax
 6084                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CB64  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CB67  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 6085                        		__call		_set_far_offset.3
         12:CB6A  20 8C E2   			call	_set_far_offset.3
 6086                        	
 6087                        		.dbg	line,	"include\routines_LEVELS.c", 975; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 6088                        		__st.wmiq	6144, _di
         12:CB6D  64 F0      			stz.l	_di
         12:CB6F  A9 18      			lda.h	#6144
         12:CB71  85 F1      			sta.h	_di
 6089                        		__st.wmiq	256, _ax
         12:CB73  64 F8      			stz.l	_ax
         12:CB75  A9 01      			lda.h	#256
         12:CB77  85 F9      			sta.h	_ax
 6090                        		 _far_load_vram.2
         12:CB79  82         			clx				; Offset to PCE VDC.
         12:CB7A  20 63 FF   			call	load_vram_x
 6091                        	
 6092                        		.dbg	line,	"include\routines_LEVELS.c", 976; }
 6093                        	
 6094                        		.dbg	line,	"include\routines_LEVELS.c", 979; else if(player_counter_anim == 22)
 6095                        		__bra		.LL228
         12:CB7D  80 10      			bra	.LL228
 6096    12:CB7F             	.LL227:
 6097                        		__ld.umq	_player_counter_anim
         12:CB7F  AD 18 23   			lda	_player_counter_anim
 6098                        		__equ_b.uiq	22
         12:CB82  C9 16      			cmp	#22
         12:CB84  F0 01      			beq	!+
         12:CB86  18         			clc
         12:CB87             	!:
 6099                        		__bfalse	.LL229
         12:CB87  90 06      			bcc	.LL229
 6100                        	
 6101                        		.dbg	line,	"include\routines_LEVELS.c", 980; {
 6102                        	
 6103                        		.dbg	line,	"include\routines_LEVELS.c", 981; player_counter_anim = 0;
 6104                        		__st.umiq	0, _player_counter_anim
         12:CB89  9C 18 23   			stz	_player_counter_anim
 6105                        	
 6106                        		.dbg	line,	"include\routines_LEVELS.c", 983; return;
 6107                        		__bra		.LL194
         12:CB8C  4C A2 DF   			bra	.LL194
 6108                        	
 6109                        		.dbg	line,	"include\routines_LEVELS.c", 984; }
 6110                        	
 6111                        		.dbg	line,	"include\routines_LEVELS.c", 987; player_counter_anim += 1;
 6112    12:CB8F             	.LL229:
 6113    12:CB8F             	.LL228:
 6114    12:CB8F             	.LL226:
 6115    12:CB8F             	.LL224:
 6116    12:CB8F             	.LL222:
 6117    12:CB8F             	.LL220:
 6118    12:CB8F             	.LL218:
 6119    12:CB8F             	.LL216:
 6120    12:CB8F             	.LL214:
 6121                        		__add_st.umiq	1, _player_counter_anim
         12:CB8F  EE 18 23   			inc	_player_counter_anim
 6122                        	
 6123                        		.dbg	line,	"include\routines_LEVELS.c", 989; }
 6124                        	
 6125                        		.dbg	line,	"include\routines_LEVELS.c", 992; else if(player_state == STATE_ATTACK)
 6126                        		__bra		.LL230
         12:CB92  4C A2 DF   			bra	.LL230
 6127    12:CB95             	.LL200:
 6128                        		__ld.umq	_player_state
         12:CB95  AD 15 23   			lda	_player_state
 6129                        		__equ_b.uiq	2
         12:CB98  C9 02      			cmp	#2
         12:CB9A  F0 01      			beq	!+
         12:CB9C  18         			clc
         12:CB9D             	!:
 6130                        		__bfalse	.LL231
         12:CB9D  B0 03 4C 31			bcc	.LL231
         12:CBA1  CC          
 6131                        	
 6132                        		.dbg	line,	"include\routines_LEVELS.c", 993; {
 6133                        	
 6134                        		.dbg	line,	"include\routines_LEVELS.c", 994; // UPDATE PLAYER TILES //
 6135                        	
 6136                        		.dbg	line,	"include\routines_LEVELS.c", 995; if(player_counter_anim == 0)
 6137                        		__not.um	_player_counter_anim
         12:CBA2  AD 18 23   			lda	_player_counter_anim
         12:CBA5  18         			clc
         12:CBA6  D0 01      			bne	!+
         12:CBA8  38         			sec
         12:CBA9             	!:
 6138                        		__bfalse	.LL232
         12:CBA9  90 2F      			bcc	.LL232
 6139                        	
 6140                        		.dbg	line,	"include\routines_LEVELS.c", 996; {
 6141                        	
 6142                        		.dbg	line,	"include\routines_LEVELS.c", 997; set_far_offset(OFFSET_PLAYER_ATTACK_1,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 6143                        		__st.wmiq	8192, _bp
         12:CBAB  64 EC      			stz.l	_bp
         12:CBAD  A9 20      			lda.h	#8192
         12:CBAF  85 ED      			sta.h	_bp
 6144                        		__ldx.umq	_player_naked
         12:CBB1  AE 1B 23   			ldx	_player_naked
 6145                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CBB4  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CBB7  C2         			cly
 6146                        		__st.umq	_bp_bank
         12:CBB8  85 02      			sta	_bp_bank
 6147                        		__ld2x.umq	_player_naked
         12:CBBA  AD 1B 23   			lda	_player_naked
         12:CBBD  0A         			asl	a
         12:CBBE  AA         			tax
 6148                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CBBF  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CBC2  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 6149                        		__call		_set_far_offset.3
         12:CBC5  20 8C E2   			call	_set_far_offset.3
 6150                        	
 6151                        		.dbg	line,	"include\routines_LEVELS.c", 998; far_load_vram(PLAYER_VRAM_ADR,TILES_16);  
 6152                        		__st.wmiq	6144, _di
         12:CBC8  64 F0      			stz.l	_di
         12:CBCA  A9 18      			lda.h	#6144
         12:CBCC  85 F1      			sta.h	_di
 6153                        		__st.wmiq	256, _ax
         12:CBCE  64 F8      			stz.l	_ax
         12:CBD0  A9 01      			lda.h	#256
         12:CBD2  85 F9      			sta.h	_ax
 6154                        		 _far_load_vram.2
         12:CBD4  82         			clx				; Offset to PCE VDC.
         12:CBD5  20 63 FF   			call	load_vram_x
 6155                        	
 6156                        		.dbg	line,	"include\routines_LEVELS.c", 999; }
 6157                        	
 6158                        		.dbg	line,	"include\routines_LEVELS.c", 1001; else if(player_counter_anim == 6)
 6159                        		__bra		.LL233
         12:CBD8  80 51      			bra	.LL233
 6160    12:CBDA             	.LL232:
 6161                        		__ld.umq	_player_counter_anim
         12:CBDA  AD 18 23   			lda	_player_counter_anim
 6162                        		__equ_b.uiq	6
         12:CBDD  C9 06      			cmp	#6
         12:CBDF  F0 01      			beq	!+
         12:CBE1  18         			clc
         12:CBE2             	!:
 6163                        		__bfalse	.LL234
         12:CBE2  90 2F      			bcc	.LL234
 6164                        	
 6165                        		.dbg	line,	"include\routines_LEVELS.c", 1002; {
 6166                        	
 6167                        		.dbg	line,	"include\routines_LEVELS.c", 1003; set_far_offset(OFFSET_PLAYER_ATTACK_2,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 6168                        		__st.wmiq	8704, _bp
         12:CBE4  64 EC      			stz.l	_bp
         12:CBE6  A9 22      			lda.h	#8704
         12:CBE8  85 ED      			sta.h	_bp
 6169                        		__ldx.umq	_player_naked
         12:CBEA  AE 1B 23   			ldx	_player_naked
 6170                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CBED  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CBF0  C2         			cly
 6171                        		__st.umq	_bp_bank
         12:CBF1  85 02      			sta	_bp_bank
 6172                        		__ld2x.umq	_player_naked
         12:CBF3  AD 1B 23   			lda	_player_naked
         12:CBF6  0A         			asl	a
         12:CBF7  AA         			tax
 6173                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CBF8  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CBFB  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 6174                        		__call		_set_far_offset.3
         12:CBFE  20 8C E2   			call	_set_far_offset.3
 6175                        	
 6176                        		.dbg	line,	"include\routines_LEVELS.c", 1004; far_load_vram(PLAYER_VRAM_ADR,TILES_16);  
 6177                        		__st.wmiq	6144, _di
         12:CC01  64 F0      			stz.l	_di
         12:CC03  A9 18      			lda.h	#6144
         12:CC05  85 F1      			sta.h	_di
 6178                        		__st.wmiq	256, _ax
         12:CC07  64 F8      			stz.l	_ax
         12:CC09  A9 01      			lda.h	#256
         12:CC0B  85 F9      			sta.h	_ax
 6179                        		 _far_load_vram.2
         12:CC0D  82         			clx				; Offset to PCE VDC.
         12:CC0E  20 63 FF   			call	load_vram_x
 6180                        	
 6181                        		.dbg	line,	"include\routines_LEVELS.c", 1005; }
 6182                        	
 6183                        		.dbg	line,	"include\routines_LEVELS.c", 1007; else if(player_counter_anim == 23)
 6184                        		__bra		.LL235
         12:CC11  80 18      			bra	.LL235
 6185    12:CC13             	.LL234:
 6186                        		__ld.umq	_player_counter_anim
         12:CC13  AD 18 23   			lda	_player_counter_anim
 6187                        		__equ_b.uiq	23
         12:CC16  C9 17      			cmp	#23
         12:CC18  F0 01      			beq	!+
         12:CC1A  18         			clc
         12:CC1B             	!:
 6188                        		__bfalse	.LL236
         12:CC1B  90 0E      			bcc	.LL236
 6189                        	
 6190                        		.dbg	line,	"include\routines_LEVELS.c", 1008; {
 6191                        	
 6192                        		.dbg	line,	"include\routines_LEVELS.c", 1009; player_attack = FALSE;
 6193                        		__st.umiq	0, _player_attack
         12:CC1D  9C 1C 23   			stz	_player_attack
 6194                        	
 6195                        		.dbg	line,	"include\routines_LEVELS.c", 1010; player_counter_anim = 1;
 6196                        		__st.umiq	1, _player_counter_anim
         12:CC20  A9 01      			lda.l	#1
         12:CC22  8D 18 23   			sta	_player_counter_anim
 6197                        	
 6198                        		.dbg	line,	"include\routines_LEVELS.c", 1011; player_state = STATE_IDLE;
 6199                        		__st.umiq	0, _player_state
         12:CC25  9C 15 23   			stz	_player_state
 6200                        	
 6201                        		.dbg	line,	"include\routines_LEVELS.c", 1012; return;
 6202                        		__bra		.LL194
         12:CC28  4C A2 DF   			bra	.LL194
 6203                        	
 6204                        		.dbg	line,	"include\routines_LEVELS.c", 1013; }
 6205                        	
 6206                        		.dbg	line,	"include\routines_LEVELS.c", 1016; player_counter_anim += 1;
 6207    12:CC2B             	.LL236:
 6208    12:CC2B             	.LL235:
 6209    12:CC2B             	.LL233:
 6210                        		__add_st.umiq	1, _player_counter_anim
         12:CC2B  EE 18 23   			inc	_player_counter_anim
 6211                        	
 6212                        		.dbg	line,	"include\routines_LEVELS.c", 1017; }
 6213                        	
 6214                        		.dbg	line,	"include\routines_LEVELS.c", 1020; else if(player_state == STATE_JUMP)
 6215                        		__bra		.LL237
         12:CC2E  4C A2 DF   			bra	.LL237
 6216    12:CC31             	.LL231:
 6217                        		__ld.umq	_player_state
         12:CC31  AD 15 23   			lda	_player_state
 6218                        		__equ_b.uiq	4
         12:CC34  C9 04      			cmp	#4
         12:CC36  F0 01      			beq	!+
         12:CC38  18         			clc
         12:CC39             	!:
 6219                        		__bfalse	.LL238
         12:CC39  B0 03 4C 5A			bcc	.LL238
         12:CC3D  CF          
 6220                        	
 6221                        		.dbg	line,	"include\routines_LEVELS.c", 1021; {
 6222                        	
 6223                        		.dbg	line,	"include\routines_LEVELS.c", 1022; unsigned char i;
 6224                        	
 6225                        		.dbg	line,	"include\routines_LEVELS.c", 1023; i = 1;
 6226                        		__st.umiq	1, __update_PLAYER_end - 1  /* i */
         12:CC3E  A9 01      			lda.l	#1
         12:CC40  8D 0C 23   			sta	__update_PLAYER_end - 1
 6227                        	
 6228                        		.dbg	line,	"include\routines_LEVELS.c", 1026; if(player_counter_anim == 0)
 6229                        		__not.um	_player_counter_anim
         12:CC43  AD 18 23   			lda	_player_counter_anim
         12:CC46  18         			clc
         12:CC47  D0 01      			bne	!+
         12:CC49  38         			sec
         12:CC4A             	!:
 6230                        		__bfalse	.LL239
         12:CC4A  90 32      			bcc	.LL239
 6231                        	
 6232                        		.dbg	line,	"include\routines_LEVELS.c", 1027; {
 6233                        	
 6234                        		.dbg	line,	"include\routines_LEVELS.c", 1028; set_far_offset(OFFSET_PLAYER_JUMP,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 6235                        		__st.wmiq	3584, _bp
         12:CC4C  64 EC      			stz.l	_bp
         12:CC4E  A9 0E      			lda.h	#3584
         12:CC50  85 ED      			sta.h	_bp
 6236                        		__ldx.umq	_player_naked
         12:CC52  AE 1B 23   			ldx	_player_naked
 6237                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CC55  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CC58  C2         			cly
 6238                        		__st.umq	_bp_bank
         12:CC59  85 02      			sta	_bp_bank
 6239                        		__ld2x.umq	_player_naked
         12:CC5B  AD 1B 23   			lda	_player_naked
         12:CC5E  0A         			asl	a
         12:CC5F  AA         			tax
 6240                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CC60  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CC63  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 6241                        		__call		_set_far_offset.3
         12:CC66  20 8C E2   			call	_set_far_offset.3
 6242                        	
 6243                        		.dbg	line,	"include\routines_LEVELS.c", 1029; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 6244                        		__st.wmiq	6144, _di
         12:CC69  64 F0      			stz.l	_di
         12:CC6B  A9 18      			lda.h	#6144
         12:CC6D  85 F1      			sta.h	_di
 6245                        		__st.wmiq	256, _ax
         12:CC6F  64 F8      			stz.l	_ax
         12:CC71  A9 01      			lda.h	#256
         12:CC73  85 F9      			sta.h	_ax
 6246                        		 _far_load_vram.2
         12:CC75  82         			clx				; Offset to PCE VDC.
         12:CC76  20 63 FF   			call	load_vram_x
 6247                        	
 6248                        		.dbg	line,	"include\routines_LEVELS.c", 1031; player_counter_anim = 1;
 6249                        		__st.umiq	1, _player_counter_anim
         12:CC79  A9 01      			lda.l	#1
         12:CC7B  8D 18 23   			sta	_player_counter_anim
 6250                        	
 6251                        		.dbg	line,	"include\routines_LEVELS.c", 1032; }
 6252                        	
 6253                        		.dbg	line,	"include\routines_LEVELS.c", 1035; player_pos_y += TABLE_PLAYER_JUMP_V[player_index_jump];
 6254    12:CC7E             	.LL239:
 6255                        		__ldx.umq	_player_index_jump
         12:CC7E  AE 19 23   			ldx	_player_index_jump
 6256                        		__ld.bax	_TABLE_PLAYER_JUMP_V
         12:CC81  BD F9 60   			lda	_TABLE_PLAYER_JUMP_V, x
         12:CC84  C2         			cly
         12:CC85  10 01      			bpl	!+
         12:CC87  88         			dey
         12:CC88             	!:
 6257                        		__add_st.wmq	_player_pos_y
         12:CC88  18         			clc
         12:CC89  6D D0 24   			adc.l	_player_pos_y
         12:CC8C  8D D0 24   			sta.l	_player_pos_y
         12:CC8F  98         			tya
         12:CC90  6D D1 24   			adc.h	_player_pos_y
         12:CC93  8D D1 24   			sta.h	_player_pos_y
 6258                        	
 6259                        		.dbg	line,	"include\routines_LEVELS.c", 1037; // CHECK COLLISION WITH CEILING //
 6260                        	
 6261                        		.dbg	line,	"include\routines_LEVELS.c", 1038; check_BG( 15 , 8 );
 6262                        		__ld.wi		15
         12:CC96  A9 0F      			lda.l	#15
         12:CC98  C2         			cly
 6263                        		__pusharg.wr
         12:CC99  A6 8D      			ldx	<__sp
         12:CC9B  CA         			dex
         12:CC9C  CA         			dex
         12:CC9D  95 08      			sta.l	<__stack, x
         12:CC9F  94 09      			sty.h	<__stack, x
         12:CCA1  86 8D      			stx	<__sp
 6264                        		__ld.wi		8
         12:CCA3  A9 08      			lda.l	#8
         12:CCA5  C2         			cly
 6265                        		__pusharg.wr
         12:CCA6  A6 8D      			ldx	<__sp
         12:CCA8  CA         			dex
         12:CCA9  CA         			dex
         12:CCAA  95 08      			sta.l	<__stack, x
         12:CCAC  94 09      			sty.h	<__stack, x
         12:CCAE  86 8D      			stx	<__sp
 6266                        		__call		_check_BG
         12:CCB0  20 6D FF   			call	_check_BG
 6267                        	
 6268                        		.dbg	line,	"include\routines_LEVELS.c", 1040; if(map_blk_flag == TILE_BG)
 6269                        		__ld.umq	_map_blk_flag
         12:CCB3  AD AB 2B   			lda	_map_blk_flag
 6270                        		__equ_b.uiq	1
         12:CCB6  C9 01      			cmp	#1
         12:CCB8  F0 01      			beq	!+
         12:CCBA  18         			clc
         12:CCBB             	!:
 6271                        		__bfalse	.LL240
         12:CCBB  90 5A      			bcc	.LL240
 6272                        	
 6273                        		.dbg	line,	"include\routines_LEVELS.c", 1041; {
 6274                        	
 6275                        		.dbg	line,	"include\routines_LEVELS.c", 1042; for(i=1 ; i<8 ; i++)
 6276                        		__st.umiq	1, __update_PLAYER_end - 1  /* i */
         12:CCBD  A9 01      			lda.l	#1
         12:CCBF  8D 0C 23   			sta	__update_PLAYER_end - 1
 6277    12:CCC2             	.LL241:
 6278                        		__ld.umq	__update_PLAYER_end - 1  /* i */
         12:CCC2  AD 0C 23   			lda	__update_PLAYER_end - 1
 6279                        		__ult_b.uiq	8
         12:CCC5  C9 08      			cmp	#8		; Subtract integer from A.
         12:CCC7  6A         			ror	a		; CC if A < integer.
         12:CCC8  49 80      			eor	#$80
         12:CCCA  2A         			rol	a
 6280                        		__btrue		.LL243
         12:CCCB  B0 07      			bcs	.LL243
 6281                        		__bra		.LL244
         12:CCCD  80 48      			bra	.LL244
 6282    12:CCCF             	.LL242:
 6283                        		__inc.umq	__update_PLAYER_end - 1  /* i */
         12:CCCF  EE 0C 23   			inc	__update_PLAYER_end - 1
 6284                        		__bra		.LL241
         12:CCD2  80 EE      			bra	.LL241
 6285    12:CCD4             	.LL243:
 6286                        	
 6287                        		.dbg	line,	"include\routines_LEVELS.c", 1043; {
 6288                        	
 6289                        		.dbg	line,	"include\routines_LEVELS.c", 1044; check_BG( 15 , 8 + i );
 6290                        		__ld.wi		15
         12:CCD4  A9 0F      			lda.l	#15
         12:CCD6  C2         			cly
 6291                        		__pusharg.wr
         12:CCD7  A6 8D      			ldx	<__sp
         12:CCD9  CA         			dex
         12:CCDA  CA         			dex
         12:CCDB  95 08      			sta.l	<__stack, x
         12:CCDD  94 09      			sty.h	<__stack, x
         12:CCDF  86 8D      			stx	<__sp
 6292                        		__ld.wi		8
         12:CCE1  A9 08      			lda.l	#8
         12:CCE3  C2         			cly
 6293                        		__add.um	__update_PLAYER_end - 1  /* i */
         12:CCE4  18         			clc
         12:CCE5  6D 0C 23   			adc	__update_PLAYER_end - 1
         12:CCE8  90 01      			bcc	!+
         12:CCEA  C8         			iny
         12:CCEB             	!:
 6294                        		__pusharg.wr
         12:CCEB  A6 8D      			ldx	<__sp
         12:CCED  CA         			dex
         12:CCEE  CA         			dex
         12:CCEF  95 08      			sta.l	<__stack, x
         12:CCF1  94 09      			sty.h	<__stack, x
         12:CCF3  86 8D      			stx	<__sp
 6295                        		__call		_check_BG
         12:CCF5  20 6D FF   			call	_check_BG
 6296                        	
 6297                        		.dbg	line,	"include\routines_LEVELS.c", 1045; {
 6298                        	
 6299                        		.dbg	line,	"include\routines_LEVELS.c", 1046; if(map_blk_flag == TILE_EMPTY)
 6300                        		__not.um	_map_blk_flag
         12:CCF8  AD AB 2B   			lda	_map_blk_flag
         12:CCFB  18         			clc
         12:CCFC  D0 01      			bne	!+
         12:CCFE  38         			sec
         12:CCFF             	!:
 6301                        		__bfalse	.LL245
         12:CCFF  90 CE      			bcc	.LL245
 6302                        	
 6303                        		.dbg	line,	"include\routines_LEVELS.c", 1047; {
 6304                        	
 6305                        		.dbg	line,	"include\routines_LEVELS.c", 1048; player_pos_y += i;
 6306                        		__ld.um		__update_PLAYER_end - 1  /* i */
         12:CD01  AD 0C 23   			lda	__update_PLAYER_end - 1
         12:CD04  C2         			cly
 6307                        		__add_st.wmq	_player_pos_y
         12:CD05  18         			clc
         12:CD06  6D D0 24   			adc.l	_player_pos_y
         12:CD09  8D D0 24   			sta.l	_player_pos_y
         12:CD0C  98         			tya
         12:CD0D  6D D1 24   			adc.h	_player_pos_y
         12:CD10  8D D1 24   			sta.h	_player_pos_y
 6308                        	
 6309                        		.dbg	line,	"include\routines_LEVELS.c", 1049; break;
 6310                        		__bra		.LL244
         12:CD13  80 02      			bra	.LL244
 6311                        	
 6312                        		.dbg	line,	"include\routines_LEVELS.c", 1050; }
 6313                        	
 6314                        		.dbg	line,	"include\routines_LEVELS.c", 1051; }
 6315    12:CD15             	.LL245	.alias		.LL242
 6316                        	
 6317                        		.dbg	line,	"include\routines_LEVELS.c", 1052; }
 6318                        		__bra		.LL242
         12:CD15  80 B8      			bra	.LL242
 6319    12:CD17             	.LL244:
 6320                        	
 6321                        		.dbg	line,	"include\routines_LEVELS.c", 1053; }
 6322                        	
 6323                        		.dbg	line,	"include\routines_LEVELS.c", 1055; spr_set(player_id);
 6324    12:CD17             	.LL240:
 6325                        		__ld.umq	_player_id
         12:CD17  AD 14 23   			lda	_player_id
 6326                        		__call		_spr_set.1
         12:CD1A  20 DD E7   			call	_spr_set.1
 6327                        	
 6328                        		.dbg	line,	"include\routines_LEVELS.c", 1056; spr_y(player_pos_y);
 6329                        		__ld.wm		_player_pos_y
         12:CD1D  AD D0 24   			lda.l	_player_pos_y
         12:CD20  AC D1 24   			ldy.h	_player_pos_y
 6330                        		__call		_spr_y.1
         12:CD23  20 19 E8   			call	_spr_y.1
 6331                        	
 6332                        		.dbg	line,	"include\routines_LEVELS.c", 1060; if(player_index_jump < 34)
 6333                        		__ld.umq	_player_index_jump
         12:CD26  AD 19 23   			lda	_player_index_jump
 6334                        		__ult_b.uiq	34
         12:CD29  C9 22      			cmp	#34		; Subtract integer from A.
         12:CD2B  6A         			ror	a		; CC if A < integer.
         12:CD2C  49 80      			eor	#$80
         12:CD2E  2A         			rol	a
 6335                        		__bfalse	.LL246
         12:CD2F  90 03      			bcc	.LL246
 6336                        	
 6337                        		.dbg	line,	"include\routines_LEVELS.c", 1061; {
 6338                        	
 6339                        		.dbg	line,	"include\routines_LEVELS.c", 1063; player_index_jump += 1;
 6340                        		__add_st.umiq	1, _player_index_jump
         12:CD31  EE 19 23   			inc	_player_index_jump
 6341                        	
 6342                        		.dbg	line,	"include\routines_LEVELS.c", 1064; }
 6343                        	
 6344                        		.dbg	line,	"include\routines_LEVELS.c", 1069; //--------------------------------------------------------------------------------------//
 6345                        	
 6346                        		.dbg	line,	"include\routines_LEVELS.c", 1070; //                                   FLOOR COLLISION                                    //
 6347                        	
 6348                        		.dbg	line,	"include\routines_LEVELS.c", 1071; //--------------------------------------------------------------------------------------//
 6349                        	
 6350                        		.dbg	line,	"include\routines_LEVELS.c", 1073; if(player_index_jump > 14)
 6351    12:CD34             	.LL246:
 6352                        		__ld.umq	_player_index_jump
         12:CD34  AD 19 23   			lda	_player_index_jump
 6353                        		__ugt_b.uiq	14
         12:CD37  18         			clc			; Subtract integer+1 from A.
         12:CD38  E9 0E      			sbc	#14		; CS if A > integer.
 6354                        		__bfalse	.LL247
         12:CD3A  B0 03 4C CD			bcc	.LL247
         12:CD3E  CE          
 6355                        	
 6356                        		.dbg	line,	"include\routines_LEVELS.c", 1074; {
 6357                        	
 6358                        		.dbg	line,	"include\routines_LEVELS.c", 1075; // CHECK COLLISION WITH LEFT FLOOR //
 6359                        	
 6360                        		.dbg	line,	"include\routines_LEVELS.c", 1076; check_BG( 10 , 32 );
 6361                        		__ld.wi		10
         12:CD3F  A9 0A      			lda.l	#10
         12:CD41  C2         			cly
 6362                        		__pusharg.wr
         12:CD42  A6 8D      			ldx	<__sp
         12:CD44  CA         			dex
         12:CD45  CA         			dex
         12:CD46  95 08      			sta.l	<__stack, x
         12:CD48  94 09      			sty.h	<__stack, x
         12:CD4A  86 8D      			stx	<__sp
 6363                        		__ld.wi		32
         12:CD4C  A9 20      			lda.l	#32
         12:CD4E  C2         			cly
 6364                        		__pusharg.wr
         12:CD4F  A6 8D      			ldx	<__sp
         12:CD51  CA         			dex
         12:CD52  CA         			dex
         12:CD53  95 08      			sta.l	<__stack, x
         12:CD55  94 09      			sty.h	<__stack, x
         12:CD57  86 8D      			stx	<__sp
 6365                        		__call		_check_BG
         12:CD59  20 6D FF   			call	_check_BG
 6366                        	
 6367                        		.dbg	line,	"include\routines_LEVELS.c", 1078; // IF PLAYER TOUCHES THE GROUND TO THE LEFT //
 6368                        	
 6369                        		.dbg	line,	"include\routines_LEVELS.c", 1079; if(map_blk_flag == TILE_BG)
 6370                        		__ld.umq	_map_blk_flag
         12:CD5C  AD AB 2B   			lda	_map_blk_flag
 6371                        		__equ_b.uiq	1
         12:CD5F  C9 01      			cmp	#1
         12:CD61  F0 01      			beq	!+
         12:CD63  18         			clc
         12:CD64             	!:
 6372                        		__bfalse	.LL248
         12:CD64  B0 03 4C 06			bcc	.LL248
         12:CD68  CE          
 6373                        	
 6374                        		.dbg	line,	"include\routines_LEVELS.c", 1080; {
 6375                        	
 6376                        		.dbg	line,	"include\routines_LEVELS.c", 1081; // CALCULATE HOW MANY PIXELS THE PLAYER MOVED INTO THE GROUND //
 6377                        	
 6378                        		.dbg	line,	"include\routines_LEVELS.c", 1082; for(i=1; i<11 ; i++ )
 6379                        		__st.umiq	1, __update_PLAYER_end - 1  /* i */
         12:CD69  A9 01      			lda.l	#1
         12:CD6B  8D 0C 23   			sta	__update_PLAYER_end - 1
 6380    12:CD6E             	.LL249:
 6381                        		__ld.umq	__update_PLAYER_end - 1  /* i */
         12:CD6E  AD 0C 23   			lda	__update_PLAYER_end - 1
 6382                        		__ult_b.uiq	11
         12:CD71  C9 0B      			cmp	#11		; Subtract integer from A.
         12:CD73  6A         			ror	a		; CC if A < integer.
         12:CD74  49 80      			eor	#$80
         12:CD76  2A         			rol	a
 6383                        		__btrue		.LL251
         12:CD77  B0 07      			bcs	.LL251
 6384                        		__bra		.LL252
         12:CD79  80 7D      			bra	.LL252
 6385    12:CD7B             	.LL250:
 6386                        		__inc.umq	__update_PLAYER_end - 1  /* i */
         12:CD7B  EE 0C 23   			inc	__update_PLAYER_end - 1
 6387                        		__bra		.LL249
         12:CD7E  80 EE      			bra	.LL249
 6388    12:CD80             	.LL251:
 6389                        	
 6390                        		.dbg	line,	"include\routines_LEVELS.c", 1083; {
 6391                        	
 6392                        		.dbg	line,	"include\routines_LEVELS.c", 1084; check_TILE_DEPTH( 10 , i);
 6393                        		__ld.wi		10
         12:CD80  A9 0A      			lda.l	#10
         12:CD82  C2         			cly
 6394                        		__pusharg.wr
         12:CD83  A6 8D      			ldx	<__sp
         12:CD85  CA         			dex
         12:CD86  CA         			dex
         12:CD87  95 08      			sta.l	<__stack, x
         12:CD89  94 09      			sty.h	<__stack, x
         12:CD8B  86 8D      			stx	<__sp
 6395                        		__ld.um		__update_PLAYER_end - 1  /* i */
         12:CD8D  AD 0C 23   			lda	__update_PLAYER_end - 1
         12:CD90  C2         			cly
 6396                        		__pusharg.wr
         12:CD91  A6 8D      			ldx	<__sp
         12:CD93  CA         			dex
         12:CD94  CA         			dex
         12:CD95  95 08      			sta.l	<__stack, x
         12:CD97  94 09      			sty.h	<__stack, x
         12:CD99  86 8D      			stx	<__sp
 6397                        		__call		_check_TILE_DEPTH
         12:CD9B  20 4F FF   			call	_check_TILE_DEPTH
 6398                        	
 6399                        		.dbg	line,	"include\routines_LEVELS.c", 1086; if(map_blk_flag == TILE_EMPTY)
 6400                        		__not.um	_map_blk_flag
         12:CD9E  AD AB 2B   			lda	_map_blk_flag
         12:CDA1  18         			clc
         12:CDA2  D0 01      			bne	!+
         12:CDA4  38         			sec
         12:CDA5             	!:
 6401                        		__bfalse	.LL253
         12:CDA5  90 D4      			bcc	.LL253
 6402                        	
 6403                        		.dbg	line,	"include\routines_LEVELS.c", 1087; {
 6404                        	
 6405                        		.dbg	line,	"include\routines_LEVELS.c", 1088; set_far_base(TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 6406                        		__ldx.umq	_player_naked
         12:CDA7  AE 1B 23   			ldx	_player_naked
 6407                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CDAA  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CDAD  C2         			cly
 6408                        		__st.umq	_bp_bank
         12:CDAE  85 02      			sta	_bp_bank
 6409                        		__ld2x.umq	_player_naked
         12:CDB0  AD 1B 23   			lda	_player_naked
         12:CDB3  0A         			asl	a
         12:CDB4  AA         			tax
 6410                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CDB5  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CDB8  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 6411                        		__st.wmq	_bp
         12:CDBB  85 EC      			sta.l	_bp
         12:CDBD  84 ED      			sty.h	_bp
 6412                        	
 6413                        		.dbg	line,	"include\routines_LEVELS.c", 1089; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 6414                        		__st.wmiq	6144, _di
         12:CDBF  64 F0      			stz.l	_di
         12:CDC1  A9 18      			lda.h	#6144
         12:CDC3  85 F1      			sta.h	_di
 6415                        		__st.wmiq	256, _ax
         12:CDC5  64 F8      			stz.l	_ax
         12:CDC7  A9 01      			lda.h	#256
         12:CDC9  85 F9      			sta.h	_ax
 6416                        		 _far_load_vram.2
         12:CDCB  82         			clx				; Offset to PCE VDC.
         12:CDCC  20 63 FF   			call	load_vram_x
 6417                        	
 6418                        		.dbg	line,	"include\routines_LEVELS.c", 1091; player_pos_y -= (i - 1);
 6419                        		__ld.um		__update_PLAYER_end - 1  /* i */
         12:CDCF  AD 0C 23   			lda	__update_PLAYER_end - 1
         12:CDD2  C2         			cly
 6420                        		__sub.wi	1
         12:CDD3  38         			sec
         12:CDD4  E9 01      			sbc.l	#1
         12:CDD6  B0 01      			bcs	!+
         12:CDD8  88         			dey
         12:CDD9             	!:
 6421                        		__isub_st.wmq	_player_pos_y
         12:CDD9  38         			sec
         12:CDDA  49 FF      			eor	#$FF
         12:CDDC  6D D0 24   			adc.l	_player_pos_y
         12:CDDF  8D D0 24   			sta.l	_player_pos_y
         12:CDE2  98         			tya
         12:CDE3  49 FF      			eor	#$FF
         12:CDE5  6D D1 24   			adc.h	_player_pos_y
         12:CDE8  8D D1 24   			sta.h	_player_pos_y
 6422                        	
 6423                        		.dbg	line,	"include\routines_LEVELS.c", 1092; spr_y(player_pos_y);
 6424                        		__ld.wm		_player_pos_y
         12:CDEB  AD D0 24   			lda.l	_player_pos_y
         12:CDEE  AC D1 24   			ldy.h	_player_pos_y
 6425                        		__call		_spr_y.1
         12:CDF1  20 19 E8   			call	_spr_y.1
 6426                        	
 6427                        		.dbg	line,	"include\routines_LEVELS.c", 1093; break;
 6428                        		__bra		.LL252
         12:CDF4  80 02      			bra	.LL252
 6429                        	
 6430                        		.dbg	line,	"include\routines_LEVELS.c", 1094; }
 6431                        	
 6432                        		.dbg	line,	"include\routines_LEVELS.c", 1096; }
 6433    12:CDF6             	.LL253	.alias		.LL250
 6434                        		__bra		.LL250
         12:CDF6  80 83      			bra	.LL250
 6435    12:CDF8             	.LL252:
 6436                        	
 6437                        		.dbg	line,	"include\routines_LEVELS.c", 1098; player_counter_anim = 1;
 6438                        		__st.umiq	1, _player_counter_anim
         12:CDF8  A9 01      			lda.l	#1
         12:CDFA  8D 18 23   			sta	_player_counter_anim
 6439                        	
 6440                        		.dbg	line,	"include\routines_LEVELS.c", 1099; player_index_jump = 0;
 6441                        		__st.umiq	0, _player_index_jump
         12:CDFD  9C 19 23   			stz	_player_index_jump
 6442                        	
 6443                        		.dbg	line,	"include\routines_LEVELS.c", 1100; player_state = STATE_IDLE;
 6444                        		__st.umiq	0, _player_state
         12:CE00  9C 15 23   			stz	_player_state
 6445                        	
 6446                        		.dbg	line,	"include\routines_LEVELS.c", 1101; return;
 6447                        		__bra		.LL194
         12:CE03  4C A2 DF   			bra	.LL194
 6448                        	
 6449                        		.dbg	line,	"include\routines_LEVELS.c", 1102; }
 6450                        	
 6451                        		.dbg	line,	"include\routines_LEVELS.c", 1104; // IF PLAYER TOUCHES THE GROUND TO THE RIGHT //
 6452                        	
 6453                        		.dbg	line,	"include\routines_LEVELS.c", 1105; else
 6454    12:CE06             	.LL248:
 6455                        	
 6456                        		.dbg	line,	"include\routines_LEVELS.c", 1106; {
 6457                        	
 6458                        		.dbg	line,	"include\routines_LEVELS.c", 1107; // CHECK COLLISION WITH RIGHT FLOOR //
 6459                        	
 6460                        		.dbg	line,	"include\routines_LEVELS.c", 1108; check_BG( 22 , 32 );
 6461                        		__ld.wi		22
         12:CE06  A9 16      			lda.l	#22
         12:CE08  C2         			cly
 6462                        		__pusharg.wr
         12:CE09  A6 8D      			ldx	<__sp
         12:CE0B  CA         			dex
         12:CE0C  CA         			dex
         12:CE0D  95 08      			sta.l	<__stack, x
         12:CE0F  94 09      			sty.h	<__stack, x
         12:CE11  86 8D      			stx	<__sp
 6463                        		__ld.wi		32
         12:CE13  A9 20      			lda.l	#32
         12:CE15  C2         			cly
 6464                        		__pusharg.wr
         12:CE16  A6 8D      			ldx	<__sp
         12:CE18  CA         			dex
         12:CE19  CA         			dex
         12:CE1A  95 08      			sta.l	<__stack, x
         12:CE1C  94 09      			sty.h	<__stack, x
         12:CE1E  86 8D      			stx	<__sp
 6465                        		__call		_check_BG
         12:CE20  20 6D FF   			call	_check_BG
 6466                        	
 6467                        		.dbg	line,	"include\routines_LEVELS.c", 1110; if(map_blk_flag == TILE_BG)
 6468                        		__ld.umq	_map_blk_flag
         12:CE23  AD AB 2B   			lda	_map_blk_flag
 6469                        		__equ_b.uiq	1
         12:CE26  C9 01      			cmp	#1
         12:CE28  F0 01      			beq	!+
         12:CE2A  18         			clc
         12:CE2B             	!:
 6470                        		__bfalse	.LL255
         12:CE2B  B0 03 4C CD			bcc	.LL255
         12:CE2F  CE          
 6471                        	
 6472                        		.dbg	line,	"include\routines_LEVELS.c", 1111; {
 6473                        	
 6474                        		.dbg	line,	"include\routines_LEVELS.c", 1112; // CALCULATE HOW MANY PIXELS THE PLAYER MOVED INTO THE GROUND //
 6475                        	
 6476                        		.dbg	line,	"include\routines_LEVELS.c", 1113; for(i=1; i<11 ; i++ )
 6477                        		__st.umiq	1, __update_PLAYER_end - 1  /* i */
         12:CE30  A9 01      			lda.l	#1
         12:CE32  8D 0C 23   			sta	__update_PLAYER_end - 1
 6478    12:CE35             	.LL256:
 6479                        		__ld.umq	__update_PLAYER_end - 1  /* i */
         12:CE35  AD 0C 23   			lda	__update_PLAYER_end - 1
 6480                        		__ult_b.uiq	11
         12:CE38  C9 0B      			cmp	#11		; Subtract integer from A.
         12:CE3A  6A         			ror	a		; CC if A < integer.
         12:CE3B  49 80      			eor	#$80
         12:CE3D  2A         			rol	a
 6481                        		__btrue		.LL258
         12:CE3E  B0 07      			bcs	.LL258
 6482                        		__bra		.LL259
         12:CE40  80 7D      			bra	.LL259
 6483    12:CE42             	.LL257:
 6484                        		__inc.umq	__update_PLAYER_end - 1  /* i */
         12:CE42  EE 0C 23   			inc	__update_PLAYER_end - 1
 6485                        		__bra		.LL256
         12:CE45  80 EE      			bra	.LL256
 6486    12:CE47             	.LL258:
 6487                        	
 6488                        		.dbg	line,	"include\routines_LEVELS.c", 1114; {
 6489                        	
 6490                        		.dbg	line,	"include\routines_LEVELS.c", 1115; check_TILE_DEPTH( 22 , i);
 6491                        		__ld.wi		22
         12:CE47  A9 16      			lda.l	#22
         12:CE49  C2         			cly
 6492                        		__pusharg.wr
         12:CE4A  A6 8D      			ldx	<__sp
         12:CE4C  CA         			dex
         12:CE4D  CA         			dex
         12:CE4E  95 08      			sta.l	<__stack, x
         12:CE50  94 09      			sty.h	<__stack, x
         12:CE52  86 8D      			stx	<__sp
 6493                        		__ld.um		__update_PLAYER_end - 1  /* i */
         12:CE54  AD 0C 23   			lda	__update_PLAYER_end - 1
         12:CE57  C2         			cly
 6494                        		__pusharg.wr
         12:CE58  A6 8D      			ldx	<__sp
         12:CE5A  CA         			dex
         12:CE5B  CA         			dex
         12:CE5C  95 08      			sta.l	<__stack, x
         12:CE5E  94 09      			sty.h	<__stack, x
         12:CE60  86 8D      			stx	<__sp
 6495                        		__call		_check_TILE_DEPTH
         12:CE62  20 4F FF   			call	_check_TILE_DEPTH
 6496                        	
 6497                        		.dbg	line,	"include\routines_LEVELS.c", 1117; if(map_blk_flag == TILE_EMPTY)
 6498                        		__not.um	_map_blk_flag
         12:CE65  AD AB 2B   			lda	_map_blk_flag
         12:CE68  18         			clc
         12:CE69  D0 01      			bne	!+
         12:CE6B  38         			sec
         12:CE6C             	!:
 6499                        		__bfalse	.LL260
         12:CE6C  90 D4      			bcc	.LL260
 6500                        	
 6501                        		.dbg	line,	"include\routines_LEVELS.c", 1118; {
 6502                        	
 6503                        		.dbg	line,	"include\routines_LEVELS.c", 1119; set_far_base(TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 6504                        		__ldx.umq	_player_naked
         12:CE6E  AE 1B 23   			ldx	_player_naked
 6505                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CE71  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CE74  C2         			cly
 6506                        		__st.umq	_bp_bank
         12:CE75  85 02      			sta	_bp_bank
 6507                        		__ld2x.umq	_player_naked
         12:CE77  AD 1B 23   			lda	_player_naked
         12:CE7A  0A         			asl	a
         12:CE7B  AA         			tax
 6508                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CE7C  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CE7F  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 6509                        		__st.wmq	_bp
         12:CE82  85 EC      			sta.l	_bp
         12:CE84  84 ED      			sty.h	_bp
 6510                        	
 6511                        		.dbg	line,	"include\routines_LEVELS.c", 1120; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 6512                        		__st.wmiq	6144, _di
         12:CE86  64 F0      			stz.l	_di
         12:CE88  A9 18      			lda.h	#6144
         12:CE8A  85 F1      			sta.h	_di
 6513                        		__st.wmiq	256, _ax
         12:CE8C  64 F8      			stz.l	_ax
         12:CE8E  A9 01      			lda.h	#256
         12:CE90  85 F9      			sta.h	_ax
 6514                        		 _far_load_vram.2
         12:CE92  82         			clx				; Offset to PCE VDC.
         12:CE93  20 63 FF   			call	load_vram_x
 6515                        	
 6516                        		.dbg	line,	"include\routines_LEVELS.c", 1122; player_pos_y -= (i - 1);
 6517                        		__ld.um		__update_PLAYER_end - 1  /* i */
         12:CE96  AD 0C 23   			lda	__update_PLAYER_end - 1
         12:CE99  C2         			cly
 6518                        		__sub.wi	1
         12:CE9A  38         			sec
         12:CE9B  E9 01      			sbc.l	#1
         12:CE9D  B0 01      			bcs	!+
         12:CE9F  88         			dey
         12:CEA0             	!:
 6519                        		__isub_st.wmq	_player_pos_y
         12:CEA0  38         			sec
         12:CEA1  49 FF      			eor	#$FF
         12:CEA3  6D D0 24   			adc.l	_player_pos_y
         12:CEA6  8D D0 24   			sta.l	_player_pos_y
         12:CEA9  98         			tya
         12:CEAA  49 FF      			eor	#$FF
         12:CEAC  6D D1 24   			adc.h	_player_pos_y
         12:CEAF  8D D1 24   			sta.h	_player_pos_y
 6520                        	
 6521                        		.dbg	line,	"include\routines_LEVELS.c", 1123; spr_y(player_pos_y);
 6522                        		__ld.wm		_player_pos_y
         12:CEB2  AD D0 24   			lda.l	_player_pos_y
         12:CEB5  AC D1 24   			ldy.h	_player_pos_y
 6523                        		__call		_spr_y.1
         12:CEB8  20 19 E8   			call	_spr_y.1
 6524                        	
 6525                        		.dbg	line,	"include\routines_LEVELS.c", 1124; break;
 6526                        		__bra		.LL259
         12:CEBB  80 02      			bra	.LL259
 6527                        	
 6528                        		.dbg	line,	"include\routines_LEVELS.c", 1125; }
 6529                        	
 6530                        		.dbg	line,	"include\routines_LEVELS.c", 1127; }
 6531    12:CEBD             	.LL260	.alias		.LL257
 6532                        		__bra		.LL257
         12:CEBD  80 83      			bra	.LL257
 6533    12:CEBF             	.LL259:
 6534                        	
 6535                        		.dbg	line,	"include\routines_LEVELS.c", 1129; player_counter_anim = 1;
 6536                        		__st.umiq	1, _player_counter_anim
         12:CEBF  A9 01      			lda.l	#1
         12:CEC1  8D 18 23   			sta	_player_counter_anim
 6537                        	
 6538                        		.dbg	line,	"include\routines_LEVELS.c", 1130; player_index_jump = 0;
 6539                        		__st.umiq	0, _player_index_jump
         12:CEC4  9C 19 23   			stz	_player_index_jump
 6540                        	
 6541                        		.dbg	line,	"include\routines_LEVELS.c", 1131; player_state = STATE_IDLE;
 6542                        		__st.umiq	0, _player_state
         12:CEC7  9C 15 23   			stz	_player_state
 6543                        	
 6544                        		.dbg	line,	"include\routines_LEVELS.c", 1132; return;
 6545                        		__bra		.LL194
         12:CECA  4C A2 DF   			bra	.LL194
 6546                        	
 6547                        		.dbg	line,	"include\routines_LEVELS.c", 1133; }
 6548                        	
 6549                        		.dbg	line,	"include\routines_LEVELS.c", 1134; }
 6550    12:CECD             	.LL255:
 6551    12:CECD             	.LL254:
 6552                        	
 6553                        		.dbg	line,	"include\routines_LEVELS.c", 1135; }
 6554                        	
 6555                        		.dbg	line,	"include\routines_LEVELS.c", 1139; // CHECK COLLISION WITH LADDERS //
 6556                        	
 6557                        		.dbg	line,	"include\routines_LEVELS.c", 1140; check_BG( 16 , 16 );
 6558    12:CECD             	.LL247:
 6559                        		__ld.wi		16
         12:CECD  A9 10      			lda.l	#16
         12:CECF  C2         			cly
 6560                        		__pusharg.wr
         12:CED0  A6 8D      			ldx	<__sp
         12:CED2  CA         			dex
         12:CED3  CA         			dex
         12:CED4  95 08      			sta.l	<__stack, x
         12:CED6  94 09      			sty.h	<__stack, x
         12:CED8  86 8D      			stx	<__sp
 6561                        		__ld.wi		16
         12:CEDA  A9 10      			lda.l	#16
         12:CEDC  C2         			cly
 6562                        		__pusharg.wr
         12:CEDD  A6 8D      			ldx	<__sp
         12:CEDF  CA         			dex
         12:CEE0  CA         			dex
         12:CEE1  95 08      			sta.l	<__stack, x
         12:CEE3  94 09      			sty.h	<__stack, x
         12:CEE5  86 8D      			stx	<__sp
 6563                        		__call		_check_BG
         12:CEE7  20 6D FF   			call	_check_BG
 6564                        	
 6565                        		.dbg	line,	"include\routines_LEVELS.c", 1142; // IF PLAYER HITS THE LADDER //
 6566                        	
 6567                        		.dbg	line,	"include\routines_LEVELS.c", 1143; if(map_blk_flag == TILE_LADDER)
 6568                        		__ld.umq	_map_blk_flag
         12:CEEA  AD AB 2B   			lda	_map_blk_flag
 6569                        		__equ_b.uiq	2
         12:CEED  C9 02      			cmp	#2
         12:CEEF  F0 01      			beq	!+
         12:CEF1  18         			clc
         12:CEF2             	!:
 6570                        		__bfalse	.LL261
         12:CEF2  B0 03 4C A2			bcc	.LL261
         12:CEF6  DF          
 6571                        	
 6572                        		.dbg	line,	"include\routines_LEVELS.c", 1144; {
 6573                        	
 6574                        		.dbg	line,	"include\routines_LEVELS.c", 1145; // CAMERA GOES 8 PX BACKWARD //
 6575                        	
 6576                        		.dbg	line,	"include\routines_LEVELS.c", 1146; sgx_map_pxl_x = ( (sgx_map_pxl_x >> 3) << 3 );
 6577                        		__ld.wm		_sgx_map_pxl_x
         12:CEF7  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:CEFA  AC 8B 26   			ldy.h	_sgx_map_pxl_x
 6578                        		__lsr.wi	3
         12:CEFD  84 00      			sty	__temp
         12:CEFF  20 3A E2   			jsr	lsrw3
 6579                        		__asl.wi	3
         12:CF02  84 00      			sty	__temp
         12:CF04  20 D7 E1   			jsr	aslw3
 6580                        		__st.wmq	_sgx_map_pxl_x
         12:CF07  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:CF0A  8C 8B 26   			sty.h	_sgx_map_pxl_x
 6581                        	
 6582                        		.dbg	line,	"include\routines_LEVELS.c", 1148; // SO WE UPDATE THE MAP //
 6583                        	
 6584                        		.dbg	line,	"include\routines_LEVELS.c", 1149; sgx_scroll_map();
 6585                        		__call		_sgx_scroll_map
         12:CF0D  20 81 FF   			call	_sgx_scroll_map
 6586                        	
 6587                        		.dbg	line,	"include\routines_LEVELS.c", 1151; // CHECK IF THE PLAYER STANDS RIGHT TO THE LADDER //
 6588                        	
 6589                        		.dbg	line,	"include\routines_LEVELS.c", 1152; check_BG( 31 , 16 );
 6590                        		__ld.wi		31
         12:CF10  A9 1F      			lda.l	#31
         12:CF12  C2         			cly
 6591                        		__pusharg.wr
         12:CF13  A6 8D      			ldx	<__sp
         12:CF15  CA         			dex
         12:CF16  CA         			dex
         12:CF17  95 08      			sta.l	<__stack, x
         12:CF19  94 09      			sty.h	<__stack, x
         12:CF1B  86 8D      			stx	<__sp
 6592                        		__ld.wi		16
         12:CF1D  A9 10      			lda.l	#16
         12:CF1F  C2         			cly
 6593                        		__pusharg.wr
         12:CF20  A6 8D      			ldx	<__sp
         12:CF22  CA         			dex
         12:CF23  CA         			dex
         12:CF24  95 08      			sta.l	<__stack, x
         12:CF26  94 09      			sty.h	<__stack, x
         12:CF28  86 8D      			stx	<__sp
 6594                        		__call		_check_BG
         12:CF2A  20 6D FF   			call	_check_BG
 6595                        	
 6596                        		.dbg	line,	"include\routines_LEVELS.c", 1154; if(map_blk_flag == TILE_LADDER)
 6597                        		__ld.umq	_map_blk_flag
         12:CF2D  AD AB 2B   			lda	_map_blk_flag
 6598                        		__equ_b.uiq	2
         12:CF30  C9 02      			cmp	#2
         12:CF32  F0 01      			beq	!+
         12:CF34  18         			clc
         12:CF35             	!:
 6599                        		__bfalse	.LL262
         12:CF35  90 0E      			bcc	.LL262
 6600                        	
 6601                        		.dbg	line,	"include\routines_LEVELS.c", 1155; {
 6602                        	
 6603                        		.dbg	line,	"include\routines_LEVELS.c", 1156; sgx_map_pxl_x += 8;
 6604                        		__add_st.wmiq	8, _sgx_map_pxl_x
         12:CF37  18         			clc
         12:CF38  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:CF3B  69 08      			adc.l	#8
         12:CF3D  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:CF40  90 03      			bcc	!+
         12:CF42  EE 8B 26   			inc.h	_sgx_map_pxl_x
         12:CF45             	!:
 6605                        	
 6606                        		.dbg	line,	"include\routines_LEVELS.c", 1157; }
 6607                        	
 6608                        		.dbg	line,	"include\routines_LEVELS.c", 1159; player_counter_anim = 1;
 6609    12:CF45             	.LL262:
 6610                        		__st.umiq	1, _player_counter_anim
         12:CF45  A9 01      			lda.l	#1
         12:CF47  8D 18 23   			sta	_player_counter_anim
 6611                        	
 6612                        		.dbg	line,	"include\routines_LEVELS.c", 1160; player_index_jump = 0;
 6613                        		__st.umiq	0, _player_index_jump
         12:CF4A  9C 19 23   			stz	_player_index_jump
 6614                        	
 6615                        		.dbg	line,	"include\routines_LEVELS.c", 1161; jump_ladder = TRUE;
 6616                        		__st.umiq	1, _jump_ladder
         12:CF4D  A9 01      			lda.l	#1
         12:CF4F  8D 1D 23   			sta	_jump_ladder
 6617                        	
 6618                        		.dbg	line,	"include\routines_LEVELS.c", 1162; player_state = STATE_HANG;
 6619                        		__st.umiq	10, _player_state
         12:CF52  A9 0A      			lda.l	#10
         12:CF54  8D 15 23   			sta	_player_state
 6620                        	
 6621                        		.dbg	line,	"include\routines_LEVELS.c", 1163; }
 6622                        	
 6623                        		.dbg	line,	"include\routines_LEVELS.c", 1164; }
 6624    12:CF57             	.LL261	.alias		.LL263
 6625                        	
 6626                        		.dbg	line,	"include\routines_LEVELS.c", 1167; else if(player_state == STATE_JUMP_RIGHT)
 6627                        		__bra		.LL263
         12:CF57  4C A2 DF   			bra	.LL263
 6628    12:CF5A             	.LL238:
 6629                        		__ld.umq	_player_state
         12:CF5A  AD 15 23   			lda	_player_state
 6630                        		__equ_b.uiq	5
         12:CF5D  C9 05      			cmp	#5
         12:CF5F  F0 01      			beq	!+
         12:CF61  18         			clc
         12:CF62             	!:
 6631                        		__bfalse	.LL264
         12:CF62  B0 03 4C 96			bcc	.LL264
         12:CF66  D3          
 6632                        	
 6633                        		.dbg	line,	"include\routines_LEVELS.c", 1168; {
 6634                        	
 6635                        		.dbg	line,	"include\routines_LEVELS.c", 1169; unsigned char i, camera_y_move;
 6636                        	
 6637                        		.dbg	line,	"include\routines_LEVELS.c", 1170; i = 1;
 6638                        		__st.umiq	1, __update_PLAYER_end - 2  /* i */
         12:CF67  A9 01      			lda.l	#1
         12:CF69  8D 0B 23   			sta	__update_PLAYER_end - 2
 6639                        	
 6640                        		.dbg	line,	"include\routines_LEVELS.c", 1173; // UPDATE PLAYER TILES //
 6641                        	
 6642                        		.dbg	line,	"include\routines_LEVELS.c", 1174; if(player_counter_anim == 0)
 6643                        		__not.um	_player_counter_anim
         12:CF6C  AD 18 23   			lda	_player_counter_anim
         12:CF6F  18         			clc
         12:CF70  D0 01      			bne	!+
         12:CF72  38         			sec
         12:CF73             	!:
 6644                        		__bfalse	.LL265
         12:CF73  90 32      			bcc	.LL265
 6645                        	
 6646                        		.dbg	line,	"include\routines_LEVELS.c", 1175; {
 6647                        	
 6648                        		.dbg	line,	"include\routines_LEVELS.c", 1176; set_far_offset(OFFSET_PLAYER_JUMP,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 6649                        		__st.wmiq	3584, _bp
         12:CF75  64 EC      			stz.l	_bp
         12:CF77  A9 0E      			lda.h	#3584
         12:CF79  85 ED      			sta.h	_bp
 6650                        		__ldx.umq	_player_naked
         12:CF7B  AE 1B 23   			ldx	_player_naked
 6651                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:CF7E  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:CF81  C2         			cly
 6652                        		__st.umq	_bp_bank
         12:CF82  85 02      			sta	_bp_bank
 6653                        		__ld2x.umq	_player_naked
         12:CF84  AD 1B 23   			lda	_player_naked
         12:CF87  0A         			asl	a
         12:CF88  AA         			tax
 6654                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:CF89  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:CF8C  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 6655                        		__call		_set_far_offset.3
         12:CF8F  20 8C E2   			call	_set_far_offset.3
 6656                        	
 6657                        		.dbg	line,	"include\routines_LEVELS.c", 1177; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 6658                        		__st.wmiq	6144, _di
         12:CF92  64 F0      			stz.l	_di
         12:CF94  A9 18      			lda.h	#6144
         12:CF96  85 F1      			sta.h	_di
 6659                        		__st.wmiq	256, _ax
         12:CF98  64 F8      			stz.l	_ax
         12:CF9A  A9 01      			lda.h	#256
         12:CF9C  85 F9      			sta.h	_ax
 6660                        		 _far_load_vram.2
         12:CF9E  82         			clx				; Offset to PCE VDC.
         12:CF9F  20 63 FF   			call	load_vram_x
 6661                        	
 6662                        		.dbg	line,	"include\routines_LEVELS.c", 1179; player_counter_anim = 1;
 6663                        		__st.umiq	1, _player_counter_anim
         12:CFA2  A9 01      			lda.l	#1
         12:CFA4  8D 18 23   			sta	_player_counter_anim
 6664                        	
 6665                        		.dbg	line,	"include\routines_LEVELS.c", 1180; }
 6666                        	
 6667                        		.dbg	line,	"include\routines_LEVELS.c", 1183; // SELECT PLAYER SPRITE //
 6668                        	
 6669                        		.dbg	line,	"include\routines_LEVELS.c", 1184; spr_set(player_id);
 6670    12:CFA7             	.LL265:
 6671                        		__ld.umq	_player_id
         12:CFA7  AD 14 23   			lda	_player_id
 6672                        		__call		_spr_set.1
         12:CFAA  20 DD E7   			call	_spr_set.1
 6673                        	
 6674                        		.dbg	line,	"include\routines_LEVELS.c", 1187; //**************************************************************************************//
 6675                        	
 6676                        		.dbg	line,	"include\routines_LEVELS.c", 1188; //                                        H MOVE                                        //
 6677                        	
 6678                        		.dbg	line,	"include\routines_LEVELS.c", 1189; //**************************************************************************************//
 6679                        	
 6680                        		.dbg	line,	"include\routines_LEVELS.c", 1191; //--------------------------------------------------------------------------------------//
 6681                        	
 6682                        		.dbg	line,	"include\routines_LEVELS.c", 1192; //                                    WALL COLLISION                                    //
 6683                        	
 6684                        		.dbg	line,	"include\routines_LEVELS.c", 1193; //--------------------------------------------------------------------------------------//
 6685                        	
 6686                        		.dbg	line,	"include\routines_LEVELS.c", 1195; // CHECK COLLISION WITH BOTTOM RIGHT WALL //
 6687                        	
 6688                        		.dbg	line,	"include\routines_LEVELS.c", 1196; check_BG( 24 , 31 );
 6689                        		__ld.wi		24
         12:CFAD  A9 18      			lda.l	#24
         12:CFAF  C2         			cly
 6690                        		__pusharg.wr
         12:CFB0  A6 8D      			ldx	<__sp
         12:CFB2  CA         			dex
         12:CFB3  CA         			dex
         12:CFB4  95 08      			sta.l	<__stack, x
         12:CFB6  94 09      			sty.h	<__stack, x
         12:CFB8  86 8D      			stx	<__sp
 6691                        		__ld.wi		31
         12:CFBA  A9 1F      			lda.l	#31
         12:CFBC  C2         			cly
 6692                        		__pusharg.wr
         12:CFBD  A6 8D      			ldx	<__sp
         12:CFBF  CA         			dex
         12:CFC0  CA         			dex
         12:CFC1  95 08      			sta.l	<__stack, x
         12:CFC3  94 09      			sty.h	<__stack, x
         12:CFC5  86 8D      			stx	<__sp
 6693                        		__call		_check_BG
         12:CFC7  20 6D FF   			call	_check_BG
 6694                        	
 6695                        		.dbg	line,	"include\routines_LEVELS.c", 1198; if(map_blk_flag != TILE_BG)
 6696                        		__ld.umq	_map_blk_flag
         12:CFCA  AD AB 2B   			lda	_map_blk_flag
 6697                        		__neq_b.uiq	1
         12:CFCD  38         			sec
         12:CFCE  49 01      			eor	#1
         12:CFD0  D0 01      			bne	!+
         12:CFD2  18         			clc
         12:CFD3             	!:
 6698                        		__bfalse	.LL266
         12:CFD3  90 78      			bcc	.LL266
 6699                        	
 6700                        		.dbg	line,	"include\routines_LEVELS.c", 1199; {
 6701                        	
 6702                        		.dbg	line,	"include\routines_LEVELS.c", 1200; // CHECK COLLISION WITH TOP RIGHT WALL //
 6703                        	
 6704                        		.dbg	line,	"include\routines_LEVELS.c", 1201; check_BG( 24 , 15 );
 6705                        		__ld.wi		24
         12:CFD5  A9 18      			lda.l	#24
         12:CFD7  C2         			cly
 6706                        		__pusharg.wr
         12:CFD8  A6 8D      			ldx	<__sp
         12:CFDA  CA         			dex
         12:CFDB  CA         			dex
         12:CFDC  95 08      			sta.l	<__stack, x
         12:CFDE  94 09      			sty.h	<__stack, x
         12:CFE0  86 8D      			stx	<__sp
 6707                        		__ld.wi		15
         12:CFE2  A9 0F      			lda.l	#15
         12:CFE4  C2         			cly
 6708                        		__pusharg.wr
         12:CFE5  A6 8D      			ldx	<__sp
         12:CFE7  CA         			dex
         12:CFE8  CA         			dex
         12:CFE9  95 08      			sta.l	<__stack, x
         12:CFEB  94 09      			sty.h	<__stack, x
         12:CFED  86 8D      			stx	<__sp
 6709                        		__call		_check_BG
         12:CFEF  20 6D FF   			call	_check_BG
 6710                        	
 6711                        		.dbg	line,	"include\routines_LEVELS.c", 1203; if(map_blk_flag == TILE_BG)
 6712                        		__ld.umq	_map_blk_flag
         12:CFF2  AD AB 2B   			lda	_map_blk_flag
 6713                        		__equ_b.uiq	1
         12:CFF5  C9 01      			cmp	#1
         12:CFF7  F0 01      			beq	!+
         12:CFF9  18         			clc
         12:CFFA             	!:
 6714                        		__bfalse	.LL267
         12:CFFA  90 41      			bcc	.LL267
 6715                        	
 6716                        		.dbg	line,	"include\routines_LEVELS.c", 1204; {
 6717                        	
 6718                        		.dbg	line,	"include\routines_LEVELS.c", 1205; check_TILE_DEPTH( 15 , -16 );
 6719                        		__ld.wi		15
         12:CFFC  A9 0F      			lda.l	#15
         12:CFFE  C2         			cly
 6720                        		__pusharg.wr
         12:CFFF  A6 8D      			ldx	<__sp
         12:D001  CA         			dex
         12:D002  CA         			dex
         12:D003  95 08      			sta.l	<__stack, x
         12:D005  94 09      			sty.h	<__stack, x
         12:D007  86 8D      			stx	<__sp
 6721                        		__ld.wi		-16
         12:D009  A9 F0      			lda.l	#-16
         12:D00B  A0 FF      			ldy.h	#-16
 6722                        		__pusharg.wr
         12:D00D  A6 8D      			ldx	<__sp
         12:D00F  CA         			dex
         12:D010  CA         			dex
         12:D011  95 08      			sta.l	<__stack, x
         12:D013  94 09      			sty.h	<__stack, x
         12:D015  86 8D      			stx	<__sp
 6723                        		__call		_check_TILE_DEPTH
         12:D017  20 4F FF   			call	_check_TILE_DEPTH
 6724                        	
 6725                        		.dbg	line,	"include\routines_LEVELS.c", 1207; if(map_blk_flag == TILE_EMPTY && jump_ladder == TRUE)
 6726                        		__not.um	_map_blk_flag
         12:D01A  AD AB 2B   			lda	_map_blk_flag
         12:D01D  18         			clc
         12:D01E  D0 01      			bne	!+
         12:D020  38         			sec
         12:D021             	!:
 6727                        		__bfalse	.LL269
         12:D021  90 08      			bcc	.LL269
 6728                        		__ld.umq	_jump_ladder
         12:D023  AD 1D 23   			lda	_jump_ladder
 6729                        		__equ_b.uiq	1
         12:D026  C9 01      			cmp	#1
         12:D028  F0 01      			beq	!+
         12:D02A  18         			clc
         12:D02B             	!:
 6730    12:D02B             	.LL269:
 6731                        		__bfalse	.LL268
         12:D02B  90 5F      			bcc	.LL268
 6732                        	
 6733                        		.dbg	line,	"include\routines_LEVELS.c", 1208; {
 6734                        	
 6735                        		.dbg	line,	"include\routines_LEVELS.c", 1209; jump_ladder = FALSE;
 6736                        		__st.umiq	0, _jump_ladder
         12:D02D  9C 1D 23   			stz	_jump_ladder
 6737                        	
 6738                        		.dbg	line,	"include\routines_LEVELS.c", 1210; player_index_fall = 0;
 6739                        		__st.umiq	0, _player_index_fall
         12:D030  9C 1A 23   			stz	_player_index_fall
 6740                        	
 6741                        		.dbg	line,	"include\routines_LEVELS.c", 1211; player_state = STATE_FALL;
 6742                        		__st.umiq	9, _player_state
         12:D033  A9 09      			lda.l	#9
         12:D035  8D 15 23   			sta	_player_state
 6743                        	
 6744                        		.dbg	line,	"include\routines_LEVELS.c", 1212; return;
 6745                        		__bra		.LL194
         12:D038  4C A2 DF   			bra	.LL194
 6746                        	
 6747                        		.dbg	line,	"include\routines_LEVELS.c", 1213; }
 6748                        	
 6749                        		.dbg	line,	"include\routines_LEVELS.c", 1214; }
 6750    12:D03B             	.LL268	.alias		.LL270
 6751                        	
 6752                        		.dbg	line,	"include\routines_LEVELS.c", 1216; else
 6753                        		__bra		.LL270
         12:D03B  80 4F      			bra	.LL270
 6754    12:D03D             	.LL267:
 6755                        	
 6756                        		.dbg	line,	"include\routines_LEVELS.c", 1217; {
 6757                        	
 6758                        		.dbg	line,	"include\routines_LEVELS.c", 1218; sgx_map_pxl_x += 2;
 6759                        		__add_st.wmiq	2, _sgx_map_pxl_x
         12:D03D  18         			clc
         12:D03E  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:D041  69 02      			adc.l	#2
         12:D043  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:D046  90 03      			bcc	!+
         12:D048  EE 8B 26   			inc.h	_sgx_map_pxl_x
         12:D04B             	!:
 6760                        	
 6761                        		.dbg	line,	"include\routines_LEVELS.c", 1219; }
 6762    12:D04B             	.LL270	.alias		.LL271
 6763                        	
 6764                        		.dbg	line,	"include\routines_LEVELS.c", 1220; }
 6765                        	
 6766                        		.dbg	line,	"include\routines_LEVELS.c", 1222; else
 6767                        		__bra		.LL271
         12:D04B  80 3F      			bra	.LL271
 6768    12:D04D             	.LL266:
 6769                        	
 6770                        		.dbg	line,	"include\routines_LEVELS.c", 1223; {
 6771                        	
 6772                        		.dbg	line,	"include\routines_LEVELS.c", 1224; check_TILE_DEPTH( 15 , -16 );
 6773                        		__ld.wi		15
         12:D04D  A9 0F      			lda.l	#15
         12:D04F  C2         			cly
 6774                        		__pusharg.wr
         12:D050  A6 8D      			ldx	<__sp
         12:D052  CA         			dex
         12:D053  CA         			dex
         12:D054  95 08      			sta.l	<__stack, x
         12:D056  94 09      			sty.h	<__stack, x
         12:D058  86 8D      			stx	<__sp
 6775                        		__ld.wi		-16
         12:D05A  A9 F0      			lda.l	#-16
         12:D05C  A0 FF      			ldy.h	#-16
 6776                        		__pusharg.wr
         12:D05E  A6 8D      			ldx	<__sp
         12:D060  CA         			dex
         12:D061  CA         			dex
         12:D062  95 08      			sta.l	<__stack, x
         12:D064  94 09      			sty.h	<__stack, x
         12:D066  86 8D      			stx	<__sp
 6777                        		__call		_check_TILE_DEPTH
         12:D068  20 4F FF   			call	_check_TILE_DEPTH
 6778                        	
 6779                        		.dbg	line,	"include\routines_LEVELS.c", 1226; if(map_blk_flag == TILE_EMPTY && jump_ladder == TRUE)
 6780                        		__not.um	_map_blk_flag
         12:D06B  AD AB 2B   			lda	_map_blk_flag
         12:D06E  18         			clc
         12:D06F  D0 01      			bne	!+
         12:D071  38         			sec
         12:D072             	!:
 6781                        		__bfalse	.LL273
         12:D072  90 08      			bcc	.LL273
 6782                        		__ld.umq	_jump_ladder
         12:D074  AD 1D 23   			lda	_jump_ladder
 6783                        		__equ_b.uiq	1
         12:D077  C9 01      			cmp	#1
         12:D079  F0 01      			beq	!+
         12:D07B  18         			clc
         12:D07C             	!:
 6784    12:D07C             	.LL273:
 6785                        		__bfalse	.LL272
         12:D07C  90 0E      			bcc	.LL272
 6786                        	
 6787                        		.dbg	line,	"include\routines_LEVELS.c", 1227; {
 6788                        	
 6789                        		.dbg	line,	"include\routines_LEVELS.c", 1228; jump_ladder = FALSE;
 6790                        		__st.umiq	0, _jump_ladder
         12:D07E  9C 1D 23   			stz	_jump_ladder
 6791                        	
 6792                        		.dbg	line,	"include\routines_LEVELS.c", 1229; player_index_fall = 0;
 6793                        		__st.umiq	0, _player_index_fall
         12:D081  9C 1A 23   			stz	_player_index_fall
 6794                        	
 6795                        		.dbg	line,	"include\routines_LEVELS.c", 1230; player_state = STATE_FALL;
 6796                        		__st.umiq	9, _player_state
         12:D084  A9 09      			lda.l	#9
         12:D086  8D 15 23   			sta	_player_state
 6797                        	
 6798                        		.dbg	line,	"include\routines_LEVELS.c", 1231; return;
 6799                        		__bra		.LL194
         12:D089  4C A2 DF   			bra	.LL194
 6800                        	
 6801                        		.dbg	line,	"include\routines_LEVELS.c", 1232; }
 6802                        	
 6803                        		.dbg	line,	"include\routines_LEVELS.c", 1233; }
 6804    12:D08C             	.LL272:
 6805    12:D08C             	.LL271:
 6806                        	
 6807                        		.dbg	line,	"include\routines_LEVELS.c", 1238; //**************************************************************************************//
 6808                        	
 6809                        		.dbg	line,	"include\routines_LEVELS.c", 1239; //                                        V MOVE                                        //
 6810                        	
 6811                        		.dbg	line,	"include\routines_LEVELS.c", 1240; //**************************************************************************************//
 6812                        	
 6813                        		.dbg	line,	"include\routines_LEVELS.c", 1242; // UPDATE PLAYER Y POSITION //
 6814                        	
 6815                        		.dbg	line,	"include\routines_LEVELS.c", 1243; if(jump_ladder == FALSE)
 6816                        		__not.um	_jump_ladder
         12:D08C  AD 1D 23   			lda	_jump_ladder
         12:D08F  18         			clc
         12:D090  D0 01      			bne	!+
         12:D092  38         			sec
         12:D093             	!:
 6817                        		__bfalse	.LL274
         12:D093  90 1A      			bcc	.LL274
 6818                        	
 6819                        		.dbg	line,	"include\routines_LEVELS.c", 1244; {
 6820                        	
 6821                        		.dbg	line,	"include\routines_LEVELS.c", 1245; player_pos_y += TABLE_PLAYER_JUMP_V[player_index_jump];
 6822                        		__ldx.umq	_player_index_jump
         12:D095  AE 19 23   			ldx	_player_index_jump
 6823                        		__ld.bax	_TABLE_PLAYER_JUMP_V
         12:D098  BD F9 60   			lda	_TABLE_PLAYER_JUMP_V, x
         12:D09B  C2         			cly
         12:D09C  10 01      			bpl	!+
         12:D09E  88         			dey
         12:D09F             	!:
 6824                        		__add_st.wmq	_player_pos_y
         12:D09F  18         			clc
         12:D0A0  6D D0 24   			adc.l	_player_pos_y
         12:D0A3  8D D0 24   			sta.l	_player_pos_y
         12:D0A6  98         			tya
         12:D0A7  6D D1 24   			adc.h	_player_pos_y
         12:D0AA  8D D1 24   			sta.h	_player_pos_y
 6825                        	
 6826                        		.dbg	line,	"include\routines_LEVELS.c", 1246; }
 6827                        	
 6828                        		.dbg	line,	"include\routines_LEVELS.c", 1248; else
 6829                        		__bra		.LL275
         12:D0AD  80 18      			bra	.LL275
 6830    12:D0AF             	.LL274:
 6831                        	
 6832                        		.dbg	line,	"include\routines_LEVELS.c", 1249; {
 6833                        	
 6834                        		.dbg	line,	"include\routines_LEVELS.c", 1250; player_pos_y += TABLE_PLAYER_JUMP_LADDER[player_index_jump];
 6835                        		__ldx.umq	_player_index_jump
         12:D0AF  AE 19 23   			ldx	_player_index_jump
 6836                        		__ld.bax	_TABLE_PLAYER_JUMP_LADDER
         12:D0B2  BD 31 61   			lda	_TABLE_PLAYER_JUMP_LADDER, x
         12:D0B5  C2         			cly
         12:D0B6  10 01      			bpl	!+
         12:D0B8  88         			dey
         12:D0B9             	!:
 6837                        		__add_st.wmq	_player_pos_y
         12:D0B9  18         			clc
         12:D0BA  6D D0 24   			adc.l	_player_pos_y
         12:D0BD  8D D0 24   			sta.l	_player_pos_y
         12:D0C0  98         			tya
         12:D0C1  6D D1 24   			adc.h	_player_pos_y
         12:D0C4  8D D1 24   			sta.h	_player_pos_y
 6838                        	
 6839                        		.dbg	line,	"include\routines_LEVELS.c", 1251; }
 6840    12:D0C7             	.LL275:
 6841                        	
 6842                        		.dbg	line,	"include\routines_LEVELS.c", 1255; // IF PLAYER GOES BELOW ITS BASE Y POSITION //
 6843                        	
 6844                        		.dbg	line,	"include\routines_LEVELS.c", 1256; if(player_pos_y >= PLAYER_BASE_Y_POS)
 6845                        		__ld.wm		_player_pos_y
         12:D0C7  AD D0 24   			lda.l	_player_pos_y
         12:D0CA  AC D1 24   			ldy.h	_player_pos_y
 6846                        		__sge_w.wi	128
         12:D0CD  C9 80      			cmp.l	#128		; Subtract integer from Y:A.
         12:D0CF  98         			tya
         12:D0D0  E9 00      			sbc.h	#128
         12:D0D2  50 02      			bvc	!+
         12:D0D4  49 80      			eor	#$80		; +ve if Y:A >= integer (signed).
         12:D0D6  49 80      	!:		eor	#$80
         12:D0D8  0A         			asl	a
 6847                        		__bfalse	.LL276
         12:D0D9  90 4E      			bcc	.LL276
 6848                        	
 6849                        		.dbg	line,	"include\routines_LEVELS.c", 1257; {
 6850                        	
 6851                        		.dbg	line,	"include\routines_LEVELS.c", 1258; // THE CAMERA MOVES //
 6852                        	
 6853                        		.dbg	line,	"include\routines_LEVELS.c", 1259; // CALCULATE HOW MANY PIXELS THE CAMERA HAS TO MOVE DOWN //
 6854                        	
 6855                        		.dbg	line,	"include\routines_LEVELS.c", 1260; camera_y_move = player_pos_y - PLAYER_BASE_Y_POS;
 6856                        		__ld.wm		_player_pos_y
         12:D0DB  AD D0 24   			lda.l	_player_pos_y
         12:D0DE  AC D1 24   			ldy.h	_player_pos_y
 6857                        		__sub.wi	128
         12:D0E1  38         			sec
         12:D0E2  E9 80      			sbc.l	#128
         12:D0E4  B0 01      			bcs	!+
         12:D0E6  88         			dey
         12:D0E7             	!:
 6858                        		__st.umq	__update_PLAYER_end - 3  /* camera_y_move */
         12:D0E7  8D 0A 23   			sta	__update_PLAYER_end - 3
 6859                        	
 6860                        		.dbg	line,	"include\routines_LEVELS.c", 1261; sgx_map_pxl_y += camera_y_move;
 6861                        		__ld.um		__update_PLAYER_end - 3  /* camera_y_move */
         12:D0EA  AD 0A 23   			lda	__update_PLAYER_end - 3
         12:D0ED  C2         			cly
 6862                        		__add_st.wmq	_sgx_map_pxl_y
         12:D0EE  18         			clc
         12:D0EF  6D 8C 26   			adc.l	_sgx_map_pxl_y
         12:D0F2  8D 8C 26   			sta.l	_sgx_map_pxl_y
         12:D0F5  98         			tya
         12:D0F6  6D 8D 26   			adc.h	_sgx_map_pxl_y
         12:D0F9  8D 8D 26   			sta.h	_sgx_map_pxl_y
 6863                        	
 6864                        		.dbg	line,	"include\routines_LEVELS.c", 1263; // IF THE CAMERA HAS REACHED ITS MAX (LOWEST) POSITION //
 6865                        	
 6866                        		.dbg	line,	"include\routines_LEVELS.c", 1264; if(sgx_map_pxl_y > camera_max_y_position)
 6867                        		__ld.wm		_sgx_map_pxl_y
         12:D0FC  AD 8C 26   			lda.l	_sgx_map_pxl_y
         12:D0FF  AC 8D 26   			ldy.h	_sgx_map_pxl_y
 6868                        		__ugt_w.wm	_camera_max_y_position
         12:D102  18         			clc			; Subtract memory+1 from Y:A.
         12:D103  ED D2 24   			sbc.l	_camera_max_y_position
         12:D106  98         			tya
         12:D107  ED D3 24   			sbc.h	_camera_max_y_position		; CS if Y:A > memory.
 6869                        		__bfalse	.LL277
         12:D10A  90 0C      			bcc	.LL277
 6870                        	
 6871                        		.dbg	line,	"include\routines_LEVELS.c", 1265; {
 6872                        	
 6873                        		.dbg	line,	"include\routines_LEVELS.c", 1266; // THE CAMERA CAN NOT MOVE LOWER //
 6874                        	
 6875                        		.dbg	line,	"include\routines_LEVELS.c", 1267; sgx_map_pxl_y = camera_max_y_position;
 6876                        		__ld.wm		_camera_max_y_position
         12:D10C  AD D2 24   			lda.l	_camera_max_y_position
         12:D10F  AC D3 24   			ldy.h	_camera_max_y_position
 6877                        		__st.wmq	_sgx_map_pxl_y
         12:D112  8D 8C 26   			sta.l	_sgx_map_pxl_y
         12:D115  8C 8D 26   			sty.h	_sgx_map_pxl_y
 6878                        	
 6879                        		.dbg	line,	"include\routines_LEVELS.c", 1268; }
 6880                        	
 6881                        		.dbg	line,	"include\routines_LEVELS.c", 1270; // THE PLAYER STAYS AT ITS BASE Y POSITION //
 6882                        	
 6883                        		.dbg	line,	"include\routines_LEVELS.c", 1271; player_pos_y = PLAYER_BASE_Y_POS;
 6884    12:D118             	.LL277:
 6885                        		__st.wmiq	128, _player_pos_y
         12:D118  A9 80      			lda.l	#128
         12:D11A  8D D0 24   			sta.l	_player_pos_y
         12:D11D  9C D1 24   			stz.h	_player_pos_y
 6886                        	
 6887                        		.dbg	line,	"include\routines_LEVELS.c", 1273; spr_y(player_pos_y);
 6888                        		__ld.wm		_player_pos_y
         12:D120  AD D0 24   			lda.l	_player_pos_y
         12:D123  AC D1 24   			ldy.h	_player_pos_y
 6889                        		__call		_spr_y.1
         12:D126  20 19 E8   			call	_spr_y.1
 6890                        	
 6891                        		.dbg	line,	"include\routines_LEVELS.c", 1274; }
 6892                        	
 6893                        		.dbg	line,	"include\routines_LEVELS.c", 1277; // UPDATE JUMP INDEX IN THE ARRAY //
 6894                        	
 6895                        		.dbg	line,	"include\routines_LEVELS.c", 1278; if(player_index_jump < jump_max_index)
 6896    12:D129             	.LL276:
 6897                        		__ld.umq	_player_index_jump
         12:D129  AD 19 23   			lda	_player_index_jump
 6898                        		__ult_b.umq	_jump_max_index
         12:D12C  CD 1E 23   			cmp	_jump_max_index		; Subtract memory from A.
         12:D12F  6A         			ror	a		; CC if A < memory.
         12:D130  49 80      			eor	#$80
         12:D132  2A         			rol	a
 6899                        		__bfalse	.LL278
         12:D133  90 03      			bcc	.LL278
 6900                        	
 6901                        		.dbg	line,	"include\routines_LEVELS.c", 1279; {
 6902                        	
 6903                        		.dbg	line,	"include\routines_LEVELS.c", 1280; player_index_jump += 1;
 6904                        		__add_st.umiq	1, _player_index_jump
         12:D135  EE 19 23   			inc	_player_index_jump
 6905                        	
 6906                        		.dbg	line,	"include\routines_LEVELS.c", 1281; }
 6907                        	
 6908                        		.dbg	line,	"include\routines_LEVELS.c", 1286; //--------------------------------------------------------------------------------------//
 6909                        	
 6910                        		.dbg	line,	"include\routines_LEVELS.c", 1287; //                                   FLOOR COLLISION                                    //
 6911                        	
 6912                        		.dbg	line,	"include\routines_LEVELS.c", 1288; //--------------------------------------------------------------------------------------//
 6913                        	
 6914                        		.dbg	line,	"include\routines_LEVELS.c", 1290; if(player_index_jump > 14)
 6915    12:D138             	.LL278:
 6916                        		__ld.umq	_player_index_jump
         12:D138  AD 19 23   			lda	_player_index_jump
 6917                        		__ugt_b.uiq	14
         12:D13B  18         			clc			; Subtract integer+1 from A.
         12:D13C  E9 0E      			sbc	#14		; CS if A > integer.
 6918                        		__bfalse	.LL279
         12:D13E  B0 03 4C F3			bcc	.LL279
         12:D142  D2          
 6919                        	
 6920                        		.dbg	line,	"include\routines_LEVELS.c", 1291; {
 6921                        	
 6922                        		.dbg	line,	"include\routines_LEVELS.c", 1292; // CHECK COLLISION WITH LEFT FLOOR //
 6923                        	
 6924                        		.dbg	line,	"include\routines_LEVELS.c", 1293; check_BG( 10 , 32 );
 6925                        		__ld.wi		10
         12:D143  A9 0A      			lda.l	#10
         12:D145  C2         			cly
 6926                        		__pusharg.wr
         12:D146  A6 8D      			ldx	<__sp
         12:D148  CA         			dex
         12:D149  CA         			dex
         12:D14A  95 08      			sta.l	<__stack, x
         12:D14C  94 09      			sty.h	<__stack, x
         12:D14E  86 8D      			stx	<__sp
 6927                        		__ld.wi		32
         12:D150  A9 20      			lda.l	#32
         12:D152  C2         			cly
 6928                        		__pusharg.wr
         12:D153  A6 8D      			ldx	<__sp
         12:D155  CA         			dex
         12:D156  CA         			dex
         12:D157  95 08      			sta.l	<__stack, x
         12:D159  94 09      			sty.h	<__stack, x
         12:D15B  86 8D      			stx	<__sp
 6929                        		__call		_check_BG
         12:D15D  20 6D FF   			call	_check_BG
 6930                        	
 6931                        		.dbg	line,	"include\routines_LEVELS.c", 1295; // IF PLAYER TOUCHES THE GROUND TO THE LEFT //
 6932                        	
 6933                        		.dbg	line,	"include\routines_LEVELS.c", 1296; if(map_blk_flag == TILE_BG)
 6934                        		__ld.umq	_map_blk_flag
         12:D160  AD AB 2B   			lda	_map_blk_flag
 6935                        		__equ_b.uiq	1
         12:D163  C9 01      			cmp	#1
         12:D165  F0 01      			beq	!+
         12:D167  18         			clc
         12:D168             	!:
 6936                        		__bfalse	.LL280
         12:D168  B0 03 4C 1B			bcc	.LL280
         12:D16C  D2          
 6937                        	
 6938                        		.dbg	line,	"include\routines_LEVELS.c", 1297; {
 6939                        	
 6940                        		.dbg	line,	"include\routines_LEVELS.c", 1298; // CALCULATE HOW MANY PIXELS THE PLAYER MOVED INTO THE GROUND //
 6941                        	
 6942                        		.dbg	line,	"include\routines_LEVELS.c", 1299; for(i=1; i<11 ; i++)
 6943                        		__st.umiq	1, __update_PLAYER_end - 2  /* i */
         12:D16D  A9 01      			lda.l	#1
         12:D16F  8D 0B 23   			sta	__update_PLAYER_end - 2
 6944    12:D172             	.LL281:
 6945                        		__ld.umq	__update_PLAYER_end - 2  /* i */
         12:D172  AD 0B 23   			lda	__update_PLAYER_end - 2
 6946                        		__ult_b.uiq	11
         12:D175  C9 0B      			cmp	#11		; Subtract integer from A.
         12:D177  6A         			ror	a		; CC if A < integer.
         12:D178  49 80      			eor	#$80
         12:D17A  2A         			rol	a
 6947                        		__btrue		.LL283
         12:D17B  B0 07      			bcs	.LL283
 6948                        		__bra		.LL284
         12:D17D  80 7D      			bra	.LL284
 6949    12:D17F             	.LL282:
 6950                        		__inc.umq	__update_PLAYER_end - 2  /* i */
         12:D17F  EE 0B 23   			inc	__update_PLAYER_end - 2
 6951                        		__bra		.LL281
         12:D182  80 EE      			bra	.LL281
 6952    12:D184             	.LL283:
 6953                        	
 6954                        		.dbg	line,	"include\routines_LEVELS.c", 1300; {
 6955                        	
 6956                        		.dbg	line,	"include\routines_LEVELS.c", 1301; check_TILE_DEPTH( 10 , i);
 6957                        		__ld.wi		10
         12:D184  A9 0A      			lda.l	#10
         12:D186  C2         			cly
 6958                        		__pusharg.wr
         12:D187  A6 8D      			ldx	<__sp
         12:D189  CA         			dex
         12:D18A  CA         			dex
         12:D18B  95 08      			sta.l	<__stack, x
         12:D18D  94 09      			sty.h	<__stack, x
         12:D18F  86 8D      			stx	<__sp
 6959                        		__ld.um		__update_PLAYER_end - 2  /* i */
         12:D191  AD 0B 23   			lda	__update_PLAYER_end - 2
         12:D194  C2         			cly
 6960                        		__pusharg.wr
         12:D195  A6 8D      			ldx	<__sp
         12:D197  CA         			dex
         12:D198  CA         			dex
         12:D199  95 08      			sta.l	<__stack, x
         12:D19B  94 09      			sty.h	<__stack, x
         12:D19D  86 8D      			stx	<__sp
 6961                        		__call		_check_TILE_DEPTH
         12:D19F  20 4F FF   			call	_check_TILE_DEPTH
 6962                        	
 6963                        		.dbg	line,	"include\routines_LEVELS.c", 1303; if(map_blk_flag == TILE_EMPTY)
 6964                        		__not.um	_map_blk_flag
         12:D1A2  AD AB 2B   			lda	_map_blk_flag
         12:D1A5  18         			clc
         12:D1A6  D0 01      			bne	!+
         12:D1A8  38         			sec
         12:D1A9             	!:
 6965                        		__bfalse	.LL285
         12:D1A9  90 D4      			bcc	.LL285
 6966                        	
 6967                        		.dbg	line,	"include\routines_LEVELS.c", 1304; {
 6968                        	
 6969                        		.dbg	line,	"include\routines_LEVELS.c", 1305; if(player_pos_y != PLAYER_BASE_Y_POS)
 6970                        		__ld.wm		_player_pos_y
         12:D1AB  AD D0 24   			lda.l	_player_pos_y
         12:D1AE  AC D1 24   			ldy.h	_player_pos_y
 6971                        		__neq_w.wi	128
         12:D1B1  38         			sec
         12:D1B2  49 80      			eor.l	#128
         12:D1B4  D0 06      			bne	!+
         12:D1B6  98         			tya
         12:D1B7  49 00      			eor.h	#128
         12:D1B9  D0 01      			bne	!+
         12:D1BB  18         			clc
         12:D1BC             	!:
 6972                        		__bfalse	.LL286
         12:D1BC  90 1E      			bcc	.LL286
 6973                        	
 6974                        		.dbg	line,	"include\routines_LEVELS.c", 1306; {
 6975                        	
 6976                        		.dbg	line,	"include\routines_LEVELS.c", 1307; player_pos_y -= (i - 1);
 6977                        		__ld.um		__update_PLAYER_end - 2  /* i */
         12:D1BE  AD 0B 23   			lda	__update_PLAYER_end - 2
         12:D1C1  C2         			cly
 6978                        		__sub.wi	1
         12:D1C2  38         			sec
         12:D1C3  E9 01      			sbc.l	#1
         12:D1C5  B0 01      			bcs	!+
         12:D1C7  88         			dey
         12:D1C8             	!:
 6979                        		__isub_st.wmq	_player_pos_y
         12:D1C8  38         			sec
         12:D1C9  49 FF      			eor	#$FF
         12:D1CB  6D D0 24   			adc.l	_player_pos_y
         12:D1CE  8D D0 24   			sta.l	_player_pos_y
         12:D1D1  98         			tya
         12:D1D2  49 FF      			eor	#$FF
         12:D1D4  6D D1 24   			adc.h	_player_pos_y
         12:D1D7  8D D1 24   			sta.h	_player_pos_y
 6980                        	
 6981                        		.dbg	line,	"include\routines_LEVELS.c", 1308; }
 6982                        	
 6983                        		.dbg	line,	"include\routines_LEVELS.c", 1310; else
 6984                        		__bra		.LL287
         12:D1DA  80 20      			bra	.LL287
 6985    12:D1DC             	.LL286:
 6986                        	
 6987                        		.dbg	line,	"include\routines_LEVELS.c", 1311; {
 6988                        	
 6989                        		.dbg	line,	"include\routines_LEVELS.c", 1312; sgx_map_pxl_y -= (i - 1);
 6990                        		__ld.um		__update_PLAYER_end - 2  /* i */
         12:D1DC  AD 0B 23   			lda	__update_PLAYER_end - 2
         12:D1DF  C2         			cly
 6991                        		__sub.wi	1
         12:D1E0  38         			sec
         12:D1E1  E9 01      			sbc.l	#1
         12:D1E3  B0 01      			bcs	!+
         12:D1E5  88         			dey
         12:D1E6             	!:
 6992                        		__isub_st.wmq	_sgx_map_pxl_y
         12:D1E6  38         			sec
         12:D1E7  49 FF      			eor	#$FF
         12:D1E9  6D 8C 26   			adc.l	_sgx_map_pxl_y
         12:D1EC  8D 8C 26   			sta.l	_sgx_map_pxl_y
         12:D1EF  98         			tya
         12:D1F0  49 FF      			eor	#$FF
         12:D1F2  6D 8D 26   			adc.h	_sgx_map_pxl_y
         12:D1F5  8D 8D 26   			sta.h	_sgx_map_pxl_y
 6993                        	
 6994                        		.dbg	line,	"include\routines_LEVELS.c", 1313; }
 6995    12:D1F8             	.LL287	.alias		.LL284
 6996                        	
 6997                        		.dbg	line,	"include\routines_LEVELS.c", 1315; break;
 6998                        		__bra		.LL284
         12:D1F8  80 02      			bra	.LL284
 6999                        	
 7000                        		.dbg	line,	"include\routines_LEVELS.c", 1316; }
 7001                        	
 7002                        		.dbg	line,	"include\routines_LEVELS.c", 1317; }
 7003    12:D1FA             	.LL285	.alias		.LL282
 7004                        		__bra		.LL282
         12:D1FA  80 83      			bra	.LL282
 7005    12:D1FC             	.LL284:
 7006                        	
 7007                        		.dbg	line,	"include\routines_LEVELS.c", 1319; // SET PLAYER SPRITE NEW POSITION //
 7008                        	
 7009                        		.dbg	line,	"include\routines_LEVELS.c", 1320; spr_y(player_pos_y);
 7010                        		__ld.wm		_player_pos_y
         12:D1FC  AD D0 24   			lda.l	_player_pos_y
         12:D1FF  AC D1 24   			ldy.h	_player_pos_y
 7011                        		__call		_spr_y.1
         12:D202  20 19 E8   			call	_spr_y.1
 7012                        	
 7013                        		.dbg	line,	"include\routines_LEVELS.c", 1322; player_counter_anim = 1;
 7014                        		__st.umiq	1, _player_counter_anim
         12:D205  A9 01      			lda.l	#1
         12:D207  8D 18 23   			sta	_player_counter_anim
 7015                        	
 7016                        		.dbg	line,	"include\routines_LEVELS.c", 1323; player_index_jump = 0;
 7017                        		__st.umiq	0, _player_index_jump
         12:D20A  9C 19 23   			stz	_player_index_jump
 7018                        	
 7019                        		.dbg	line,	"include\routines_LEVELS.c", 1324; jump_ladder = FALSE;
 7020                        		__st.umiq	0, _jump_ladder
         12:D20D  9C 1D 23   			stz	_jump_ladder
 7021                        	
 7022                        		.dbg	line,	"include\routines_LEVELS.c", 1325; jump_max_index = 34;
 7023                        		__st.umiq	34, _jump_max_index
         12:D210  A9 22      			lda.l	#34
         12:D212  8D 1E 23   			sta	_jump_max_index
 7024                        	
 7025                        		.dbg	line,	"include\routines_LEVELS.c", 1326; player_state = STATE_IDLE;
 7026                        		__st.umiq	0, _player_state
         12:D215  9C 15 23   			stz	_player_state
 7027                        	
 7028                        		.dbg	line,	"include\routines_LEVELS.c", 1327; return;
 7029                        		__bra		.LL194
         12:D218  4C A2 DF   			bra	.LL194
 7030                        	
 7031                        		.dbg	line,	"include\routines_LEVELS.c", 1328; }
 7032                        	
 7033                        		.dbg	line,	"include\routines_LEVELS.c", 1330; // IF PLAYER TOUCHES THE GROUND TO THE RIGHT //
 7034                        	
 7035                        		.dbg	line,	"include\routines_LEVELS.c", 1331; else
 7036    12:D21B             	.LL280:
 7037                        	
 7038                        		.dbg	line,	"include\routines_LEVELS.c", 1332; {
 7039                        	
 7040                        		.dbg	line,	"include\routines_LEVELS.c", 1333; // CHECK COLLISION WITH RIGHT FLOOR //
 7041                        	
 7042                        		.dbg	line,	"include\routines_LEVELS.c", 1334; check_BG( 22 , 32 );
 7043                        		__ld.wi		22
         12:D21B  A9 16      			lda.l	#22
         12:D21D  C2         			cly
 7044                        		__pusharg.wr
         12:D21E  A6 8D      			ldx	<__sp
         12:D220  CA         			dex
         12:D221  CA         			dex
         12:D222  95 08      			sta.l	<__stack, x
         12:D224  94 09      			sty.h	<__stack, x
         12:D226  86 8D      			stx	<__sp
 7045                        		__ld.wi		32
         12:D228  A9 20      			lda.l	#32
         12:D22A  C2         			cly
 7046                        		__pusharg.wr
         12:D22B  A6 8D      			ldx	<__sp
         12:D22D  CA         			dex
         12:D22E  CA         			dex
         12:D22F  95 08      			sta.l	<__stack, x
         12:D231  94 09      			sty.h	<__stack, x
         12:D233  86 8D      			stx	<__sp
 7047                        		__call		_check_BG
         12:D235  20 6D FF   			call	_check_BG
 7048                        	
 7049                        		.dbg	line,	"include\routines_LEVELS.c", 1336; if(map_blk_flag == TILE_BG)
 7050                        		__ld.umq	_map_blk_flag
         12:D238  AD AB 2B   			lda	_map_blk_flag
 7051                        		__equ_b.uiq	1
         12:D23B  C9 01      			cmp	#1
         12:D23D  F0 01      			beq	!+
         12:D23F  18         			clc
         12:D240             	!:
 7052                        		__bfalse	.LL289
         12:D240  B0 03 4C F3			bcc	.LL289
         12:D244  D2          
 7053                        	
 7054                        		.dbg	line,	"include\routines_LEVELS.c", 1337; {
 7055                        	
 7056                        		.dbg	line,	"include\routines_LEVELS.c", 1338; // CALCULATE HOW MANY PIXELS THE PLAYER MOVED INTO THE GROUND //
 7057                        	
 7058                        		.dbg	line,	"include\routines_LEVELS.c", 1339; for(i=1; i<11 ; i++)
 7059                        		__st.umiq	1, __update_PLAYER_end - 2  /* i */
         12:D245  A9 01      			lda.l	#1
         12:D247  8D 0B 23   			sta	__update_PLAYER_end - 2
 7060    12:D24A             	.LL290:
 7061                        		__ld.umq	__update_PLAYER_end - 2  /* i */
         12:D24A  AD 0B 23   			lda	__update_PLAYER_end - 2
 7062                        		__ult_b.uiq	11
         12:D24D  C9 0B      			cmp	#11		; Subtract integer from A.
         12:D24F  6A         			ror	a		; CC if A < integer.
         12:D250  49 80      			eor	#$80
         12:D252  2A         			rol	a
 7063                        		__btrue		.LL292
         12:D253  B0 07      			bcs	.LL292
 7064                        		__bra		.LL293
         12:D255  80 7D      			bra	.LL293
 7065    12:D257             	.LL291:
 7066                        		__inc.umq	__update_PLAYER_end - 2  /* i */
         12:D257  EE 0B 23   			inc	__update_PLAYER_end - 2
 7067                        		__bra		.LL290
         12:D25A  80 EE      			bra	.LL290
 7068    12:D25C             	.LL292:
 7069                        	
 7070                        		.dbg	line,	"include\routines_LEVELS.c", 1340; {
 7071                        	
 7072                        		.dbg	line,	"include\routines_LEVELS.c", 1341; check_TILE_DEPTH( 22 , i);
 7073                        		__ld.wi		22
         12:D25C  A9 16      			lda.l	#22
         12:D25E  C2         			cly
 7074                        		__pusharg.wr
         12:D25F  A6 8D      			ldx	<__sp
         12:D261  CA         			dex
         12:D262  CA         			dex
         12:D263  95 08      			sta.l	<__stack, x
         12:D265  94 09      			sty.h	<__stack, x
         12:D267  86 8D      			stx	<__sp
 7075                        		__ld.um		__update_PLAYER_end - 2  /* i */
         12:D269  AD 0B 23   			lda	__update_PLAYER_end - 2
         12:D26C  C2         			cly
 7076                        		__pusharg.wr
         12:D26D  A6 8D      			ldx	<__sp
         12:D26F  CA         			dex
         12:D270  CA         			dex
         12:D271  95 08      			sta.l	<__stack, x
         12:D273  94 09      			sty.h	<__stack, x
         12:D275  86 8D      			stx	<__sp
 7077                        		__call		_check_TILE_DEPTH
         12:D277  20 4F FF   			call	_check_TILE_DEPTH
 7078                        	
 7079                        		.dbg	line,	"include\routines_LEVELS.c", 1343; if(map_blk_flag == TILE_EMPTY)
 7080                        		__not.um	_map_blk_flag
         12:D27A  AD AB 2B   			lda	_map_blk_flag
         12:D27D  18         			clc
         12:D27E  D0 01      			bne	!+
         12:D280  38         			sec
         12:D281             	!:
 7081                        		__bfalse	.LL294
         12:D281  90 D4      			bcc	.LL294
 7082                        	
 7083                        		.dbg	line,	"include\routines_LEVELS.c", 1344; {
 7084                        	
 7085                        		.dbg	line,	"include\routines_LEVELS.c", 1345; if(player_pos_y != PLAYER_BASE_Y_POS)
 7086                        		__ld.wm		_player_pos_y
         12:D283  AD D0 24   			lda.l	_player_pos_y
         12:D286  AC D1 24   			ldy.h	_player_pos_y
 7087                        		__neq_w.wi	128
         12:D289  38         			sec
         12:D28A  49 80      			eor.l	#128
         12:D28C  D0 06      			bne	!+
         12:D28E  98         			tya
         12:D28F  49 00      			eor.h	#128
         12:D291  D0 01      			bne	!+
         12:D293  18         			clc
         12:D294             	!:
 7088                        		__bfalse	.LL295
         12:D294  90 1E      			bcc	.LL295
 7089                        	
 7090                        		.dbg	line,	"include\routines_LEVELS.c", 1346; {
 7091                        	
 7092                        		.dbg	line,	"include\routines_LEVELS.c", 1347; player_pos_y -= (i - 1);
 7093                        		__ld.um		__update_PLAYER_end - 2  /* i */
         12:D296  AD 0B 23   			lda	__update_PLAYER_end - 2
         12:D299  C2         			cly
 7094                        		__sub.wi	1
         12:D29A  38         			sec
         12:D29B  E9 01      			sbc.l	#1
         12:D29D  B0 01      			bcs	!+
         12:D29F  88         			dey
         12:D2A0             	!:
 7095                        		__isub_st.wmq	_player_pos_y
         12:D2A0  38         			sec
         12:D2A1  49 FF      			eor	#$FF
         12:D2A3  6D D0 24   			adc.l	_player_pos_y
         12:D2A6  8D D0 24   			sta.l	_player_pos_y
         12:D2A9  98         			tya
         12:D2AA  49 FF      			eor	#$FF
         12:D2AC  6D D1 24   			adc.h	_player_pos_y
         12:D2AF  8D D1 24   			sta.h	_player_pos_y
 7096                        	
 7097                        		.dbg	line,	"include\routines_LEVELS.c", 1348; }
 7098                        	
 7099                        		.dbg	line,	"include\routines_LEVELS.c", 1350; else
 7100                        		__bra		.LL296
         12:D2B2  80 20      			bra	.LL296
 7101    12:D2B4             	.LL295:
 7102                        	
 7103                        		.dbg	line,	"include\routines_LEVELS.c", 1351; {
 7104                        	
 7105                        		.dbg	line,	"include\routines_LEVELS.c", 1352; sgx_map_pxl_y -= (i - 1);
 7106                        		__ld.um		__update_PLAYER_end - 2  /* i */
         12:D2B4  AD 0B 23   			lda	__update_PLAYER_end - 2
         12:D2B7  C2         			cly
 7107                        		__sub.wi	1
         12:D2B8  38         			sec
         12:D2B9  E9 01      			sbc.l	#1
         12:D2BB  B0 01      			bcs	!+
         12:D2BD  88         			dey
         12:D2BE             	!:
 7108                        		__isub_st.wmq	_sgx_map_pxl_y
         12:D2BE  38         			sec
         12:D2BF  49 FF      			eor	#$FF
         12:D2C1  6D 8C 26   			adc.l	_sgx_map_pxl_y
         12:D2C4  8D 8C 26   			sta.l	_sgx_map_pxl_y
         12:D2C7  98         			tya
         12:D2C8  49 FF      			eor	#$FF
         12:D2CA  6D 8D 26   			adc.h	_sgx_map_pxl_y
         12:D2CD  8D 8D 26   			sta.h	_sgx_map_pxl_y
 7109                        	
 7110                        		.dbg	line,	"include\routines_LEVELS.c", 1353; }
 7111    12:D2D0             	.LL296	.alias		.LL293
 7112                        	
 7113                        		.dbg	line,	"include\routines_LEVELS.c", 1355; break;
 7114                        		__bra		.LL293
         12:D2D0  80 02      			bra	.LL293
 7115                        	
 7116                        		.dbg	line,	"include\routines_LEVELS.c", 1356; }
 7117                        	
 7118                        		.dbg	line,	"include\routines_LEVELS.c", 1357; }
 7119    12:D2D2             	.LL294	.alias		.LL291
 7120                        		__bra		.LL291
         12:D2D2  80 83      			bra	.LL291
 7121    12:D2D4             	.LL293:
 7122                        	
 7123                        		.dbg	line,	"include\routines_LEVELS.c", 1359; // SET PLAYER SPRITE NEW POSITION //
 7124                        	
 7125                        		.dbg	line,	"include\routines_LEVELS.c", 1360; spr_y(player_pos_y);
 7126                        		__ld.wm		_player_pos_y
         12:D2D4  AD D0 24   			lda.l	_player_pos_y
         12:D2D7  AC D1 24   			ldy.h	_player_pos_y
 7127                        		__call		_spr_y.1
         12:D2DA  20 19 E8   			call	_spr_y.1
 7128                        	
 7129                        		.dbg	line,	"include\routines_LEVELS.c", 1362; player_counter_anim = 1;
 7130                        		__st.umiq	1, _player_counter_anim
         12:D2DD  A9 01      			lda.l	#1
         12:D2DF  8D 18 23   			sta	_player_counter_anim
 7131                        	
 7132                        		.dbg	line,	"include\routines_LEVELS.c", 1363; player_index_jump = 0;
 7133                        		__st.umiq	0, _player_index_jump
         12:D2E2  9C 19 23   			stz	_player_index_jump
 7134                        	
 7135                        		.dbg	line,	"include\routines_LEVELS.c", 1364; jump_ladder = FALSE;
 7136                        		__st.umiq	0, _jump_ladder
         12:D2E5  9C 1D 23   			stz	_jump_ladder
 7137                        	
 7138                        		.dbg	line,	"include\routines_LEVELS.c", 1365; jump_max_index = 34;
 7139                        		__st.umiq	34, _jump_max_index
         12:D2E8  A9 22      			lda.l	#34
         12:D2EA  8D 1E 23   			sta	_jump_max_index
 7140                        	
 7141                        		.dbg	line,	"include\routines_LEVELS.c", 1366; player_state = STATE_IDLE;
 7142                        		__st.umiq	0, _player_state
         12:D2ED  9C 15 23   			stz	_player_state
 7143                        	
 7144                        		.dbg	line,	"include\routines_LEVELS.c", 1367; return;
 7145                        		__bra		.LL194
         12:D2F0  4C A2 DF   			bra	.LL194
 7146                        	
 7147                        		.dbg	line,	"include\routines_LEVELS.c", 1368; }
 7148                        	
 7149                        		.dbg	line,	"include\routines_LEVELS.c", 1369; }
 7150    12:D2F3             	.LL289:
 7151    12:D2F3             	.LL288:
 7152                        	
 7153                        		.dbg	line,	"include\routines_LEVELS.c", 1370; }
 7154                        	
 7155                        		.dbg	line,	"include\routines_LEVELS.c", 1375; //--------------------------------------------------------------------------------------//
 7156                        	
 7157                        		.dbg	line,	"include\routines_LEVELS.c", 1376; //                                   LADDER COLLISION                                   //
 7158                        	
 7159                        		.dbg	line,	"include\routines_LEVELS.c", 1377; //--------------------------------------------------------------------------------------//
 7160                        	
 7161                        		.dbg	line,	"include\routines_LEVELS.c", 1379; if(player_index_jump > 4)
 7162    12:D2F3             	.LL279:
 7163                        		__ld.umq	_player_index_jump
         12:D2F3  AD 19 23   			lda	_player_index_jump
 7164                        		__ugt_b.uiq	4
         12:D2F6  18         			clc			; Subtract integer+1 from A.
         12:D2F7  E9 04      			sbc	#4		; CS if A > integer.
 7165                        		__bfalse	.LL297
         12:D2F9  B0 03 4C 8A			bcc	.LL297
         12:D2FD  D3          
 7166                        	
 7167                        		.dbg	line,	"include\routines_LEVELS.c", 1380; {
 7168                        	
 7169                        		.dbg	line,	"include\routines_LEVELS.c", 1381; check_BG( 16 , 16 );
 7170                        		__ld.wi		16
         12:D2FE  A9 10      			lda.l	#16
         12:D300  C2         			cly
 7171                        		__pusharg.wr
         12:D301  A6 8D      			ldx	<__sp
         12:D303  CA         			dex
         12:D304  CA         			dex
         12:D305  95 08      			sta.l	<__stack, x
         12:D307  94 09      			sty.h	<__stack, x
         12:D309  86 8D      			stx	<__sp
 7172                        		__ld.wi		16
         12:D30B  A9 10      			lda.l	#16
         12:D30D  C2         			cly
 7173                        		__pusharg.wr
         12:D30E  A6 8D      			ldx	<__sp
         12:D310  CA         			dex
         12:D311  CA         			dex
         12:D312  95 08      			sta.l	<__stack, x
         12:D314  94 09      			sty.h	<__stack, x
         12:D316  86 8D      			stx	<__sp
 7174                        		__call		_check_BG
         12:D318  20 6D FF   			call	_check_BG
 7175                        	
 7176                        		.dbg	line,	"include\routines_LEVELS.c", 1383; // IF PLAYER HITS THE LADDER //
 7177                        	
 7178                        		.dbg	line,	"include\routines_LEVELS.c", 1384; if(map_blk_flag == TILE_LADDER)
 7179                        		__ld.umq	_map_blk_flag
         12:D31B  AD AB 2B   			lda	_map_blk_flag
 7180                        		__equ_b.uiq	2
         12:D31E  C9 02      			cmp	#2
         12:D320  F0 01      			beq	!+
         12:D322  18         			clc
         12:D323             	!:
 7181                        		__bfalse	.LL298
         12:D323  90 65      			bcc	.LL298
 7182                        	
 7183                        		.dbg	line,	"include\routines_LEVELS.c", 1385; {
 7184                        	
 7185                        		.dbg	line,	"include\routines_LEVELS.c", 1386; // CAMERA GOES 8 PX BACKWARD //
 7186                        	
 7187                        		.dbg	line,	"include\routines_LEVELS.c", 1387; sgx_map_pxl_x = ( (sgx_map_pxl_x >> 3) << 3 );
 7188                        		__ld.wm		_sgx_map_pxl_x
         12:D325  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:D328  AC 8B 26   			ldy.h	_sgx_map_pxl_x
 7189                        		__lsr.wi	3
         12:D32B  84 00      			sty	__temp
         12:D32D  20 3A E2   			jsr	lsrw3
 7190                        		__asl.wi	3
         12:D330  84 00      			sty	__temp
         12:D332  20 D7 E1   			jsr	aslw3
 7191                        		__st.wmq	_sgx_map_pxl_x
         12:D335  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:D338  8C 8B 26   			sty.h	_sgx_map_pxl_x
 7192                        	
 7193                        		.dbg	line,	"include\routines_LEVELS.c", 1389; // SO WE UPDATE THE MAP //
 7194                        	
 7195                        		.dbg	line,	"include\routines_LEVELS.c", 1390; sgx_scroll_map();
 7196                        		__call		_sgx_scroll_map
         12:D33B  20 81 FF   			call	_sgx_scroll_map
 7197                        	
 7198                        		.dbg	line,	"include\routines_LEVELS.c", 1392; // CHECK IF THE PLAYER STANDS RIGHT TO THE LADDER //
 7199                        	
 7200                        		.dbg	line,	"include\routines_LEVELS.c", 1393; check_BG( 31 , 16 );
 7201                        		__ld.wi		31
         12:D33E  A9 1F      			lda.l	#31
         12:D340  C2         			cly
 7202                        		__pusharg.wr
         12:D341  A6 8D      			ldx	<__sp
         12:D343  CA         			dex
         12:D344  CA         			dex
         12:D345  95 08      			sta.l	<__stack, x
         12:D347  94 09      			sty.h	<__stack, x
         12:D349  86 8D      			stx	<__sp
 7203                        		__ld.wi		16
         12:D34B  A9 10      			lda.l	#16
         12:D34D  C2         			cly
 7204                        		__pusharg.wr
         12:D34E  A6 8D      			ldx	<__sp
         12:D350  CA         			dex
         12:D351  CA         			dex
         12:D352  95 08      			sta.l	<__stack, x
         12:D354  94 09      			sty.h	<__stack, x
         12:D356  86 8D      			stx	<__sp
 7205                        		__call		_check_BG
         12:D358  20 6D FF   			call	_check_BG
 7206                        	
 7207                        		.dbg	line,	"include\routines_LEVELS.c", 1395; if(map_blk_flag == TILE_LADDER)
 7208                        		__ld.umq	_map_blk_flag
         12:D35B  AD AB 2B   			lda	_map_blk_flag
 7209                        		__equ_b.uiq	2
         12:D35E  C9 02      			cmp	#2
         12:D360  F0 01      			beq	!+
         12:D362  18         			clc
         12:D363             	!:
 7210                        		__bfalse	.LL299
         12:D363  90 0E      			bcc	.LL299
 7211                        	
 7212                        		.dbg	line,	"include\routines_LEVELS.c", 1396; {
 7213                        	
 7214                        		.dbg	line,	"include\routines_LEVELS.c", 1397; sgx_map_pxl_x += 8;
 7215                        		__add_st.wmiq	8, _sgx_map_pxl_x
         12:D365  18         			clc
         12:D366  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:D369  69 08      			adc.l	#8
         12:D36B  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:D36E  90 03      			bcc	!+
         12:D370  EE 8B 26   			inc.h	_sgx_map_pxl_x
         12:D373             	!:
 7216                        	
 7217                        		.dbg	line,	"include\routines_LEVELS.c", 1398; }
 7218                        	
 7219                        		.dbg	line,	"include\routines_LEVELS.c", 1400; player_counter_anim = 1;
 7220    12:D373             	.LL299:
 7221                        		__st.umiq	1, _player_counter_anim
         12:D373  A9 01      			lda.l	#1
         12:D375  8D 18 23   			sta	_player_counter_anim
 7222                        	
 7223                        		.dbg	line,	"include\routines_LEVELS.c", 1401; player_index_jump = 0;
 7224                        		__st.umiq	0, _player_index_jump
         12:D378  9C 19 23   			stz	_player_index_jump
 7225                        	
 7226                        		.dbg	line,	"include\routines_LEVELS.c", 1402; jump_ladder = TRUE;
 7227                        		__st.umiq	1, _jump_ladder
         12:D37B  A9 01      			lda.l	#1
         12:D37D  8D 1D 23   			sta	_jump_ladder
 7228                        	
 7229                        		.dbg	line,	"include\routines_LEVELS.c", 1403; jump_max_index = 29;
 7230                        		__st.umiq	29, _jump_max_index
         12:D380  A9 1D      			lda.l	#29
         12:D382  8D 1E 23   			sta	_jump_max_index
 7231                        	
 7232                        		.dbg	line,	"include\routines_LEVELS.c", 1404; player_state = STATE_HANG;
 7233                        		__st.umiq	10, _player_state
         12:D385  A9 0A      			lda.l	#10
         12:D387  8D 15 23   			sta	_player_state
 7234                        	
 7235                        		.dbg	line,	"include\routines_LEVELS.c", 1405; }
 7236                        	
 7237                        		.dbg	line,	"include\routines_LEVELS.c", 1406; }
 7238    12:D38A             	.LL298:
 7239                        	
 7240                        		.dbg	line,	"include\routines_LEVELS.c", 1409; // SET PLAYER SPRITE NEW POSITION //
 7241                        	
 7242                        		.dbg	line,	"include\routines_LEVELS.c", 1410; spr_y(player_pos_y);
 7243    12:D38A             	.LL297:
 7244                        		__ld.wm		_player_pos_y
         12:D38A  AD D0 24   			lda.l	_player_pos_y
         12:D38D  AC D1 24   			ldy.h	_player_pos_y
 7245                        		__call		_spr_y.1
         12:D390  20 19 E8   			call	_spr_y.1
 7246                        	
 7247                        		.dbg	line,	"include\routines_LEVELS.c", 1411; }
 7248                        	
 7249                        		.dbg	line,	"include\routines_LEVELS.c", 1414; else if(player_state == STATE_JUMP_LEFT)
 7250                        		__bra		.LL300
         12:D393  4C A2 DF   			bra	.LL300
 7251    12:D396             	.LL264:
 7252                        		__ld.umq	_player_state
         12:D396  AD 15 23   			lda	_player_state
 7253                        		__equ_b.uiq	6
         12:D399  C9 06      			cmp	#6
         12:D39B  F0 01      			beq	!+
         12:D39D  18         			clc
         12:D39E             	!:
 7254                        		__bfalse	.LL301
         12:D39E  B0 03 4C D2			bcc	.LL301
         12:D3A2  D7          
 7255                        	
 7256                        		.dbg	line,	"include\routines_LEVELS.c", 1415; {
 7257                        	
 7258                        		.dbg	line,	"include\routines_LEVELS.c", 1416; unsigned char i, camera_y_move;
 7259                        	
 7260                        		.dbg	line,	"include\routines_LEVELS.c", 1417; i = 1;
 7261                        		__st.umiq	1, __update_PLAYER_end - 4  /* i */
         12:D3A3  A9 01      			lda.l	#1
         12:D3A5  8D 09 23   			sta	__update_PLAYER_end - 4
 7262                        	
 7263                        		.dbg	line,	"include\routines_LEVELS.c", 1420; // UPDATE PLAYER TILES //
 7264                        	
 7265                        		.dbg	line,	"include\routines_LEVELS.c", 1421; if(player_counter_anim == 0)
 7266                        		__not.um	_player_counter_anim
         12:D3A8  AD 18 23   			lda	_player_counter_anim
         12:D3AB  18         			clc
         12:D3AC  D0 01      			bne	!+
         12:D3AE  38         			sec
         12:D3AF             	!:
 7267                        		__bfalse	.LL302
         12:D3AF  90 32      			bcc	.LL302
 7268                        	
 7269                        		.dbg	line,	"include\routines_LEVELS.c", 1422; {
 7270                        	
 7271                        		.dbg	line,	"include\routines_LEVELS.c", 1423; set_far_offset(OFFSET_PLAYER_JUMP,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 7272                        		__st.wmiq	3584, _bp
         12:D3B1  64 EC      			stz.l	_bp
         12:D3B3  A9 0E      			lda.h	#3584
         12:D3B5  85 ED      			sta.h	_bp
 7273                        		__ldx.umq	_player_naked
         12:D3B7  AE 1B 23   			ldx	_player_naked
 7274                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:D3BA  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:D3BD  C2         			cly
 7275                        		__st.umq	_bp_bank
         12:D3BE  85 02      			sta	_bp_bank
 7276                        		__ld2x.umq	_player_naked
         12:D3C0  AD 1B 23   			lda	_player_naked
         12:D3C3  0A         			asl	a
         12:D3C4  AA         			tax
 7277                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:D3C5  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:D3C8  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 7278                        		__call		_set_far_offset.3
         12:D3CB  20 8C E2   			call	_set_far_offset.3
 7279                        	
 7280                        		.dbg	line,	"include\routines_LEVELS.c", 1424; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 7281                        		__st.wmiq	6144, _di
         12:D3CE  64 F0      			stz.l	_di
         12:D3D0  A9 18      			lda.h	#6144
         12:D3D2  85 F1      			sta.h	_di
 7282                        		__st.wmiq	256, _ax
         12:D3D4  64 F8      			stz.l	_ax
         12:D3D6  A9 01      			lda.h	#256
         12:D3D8  85 F9      			sta.h	_ax
 7283                        		 _far_load_vram.2
         12:D3DA  82         			clx				; Offset to PCE VDC.
         12:D3DB  20 63 FF   			call	load_vram_x
 7284                        	
 7285                        		.dbg	line,	"include\routines_LEVELS.c", 1426; player_counter_anim = 1;
 7286                        		__st.umiq	1, _player_counter_anim
         12:D3DE  A9 01      			lda.l	#1
         12:D3E0  8D 18 23   			sta	_player_counter_anim
 7287                        	
 7288                        		.dbg	line,	"include\routines_LEVELS.c", 1427; }
 7289                        	
 7290                        		.dbg	line,	"include\routines_LEVELS.c", 1430; // SELECT PLAYER SPRITE //
 7291                        	
 7292                        		.dbg	line,	"include\routines_LEVELS.c", 1431; spr_set(player_id);
 7293    12:D3E3             	.LL302:
 7294                        		__ld.umq	_player_id
         12:D3E3  AD 14 23   			lda	_player_id
 7295                        		__call		_spr_set.1
         12:D3E6  20 DD E7   			call	_spr_set.1
 7296                        	
 7297                        		.dbg	line,	"include\routines_LEVELS.c", 1434; //**************************************************************************************//
 7298                        	
 7299                        		.dbg	line,	"include\routines_LEVELS.c", 1435; //                                        H MOVE                                        //
 7300                        	
 7301                        		.dbg	line,	"include\routines_LEVELS.c", 1436; //**************************************************************************************//
 7302                        	
 7303                        		.dbg	line,	"include\routines_LEVELS.c", 1438; //--------------------------------------------------------------------------------------//
 7304                        	
 7305                        		.dbg	line,	"include\routines_LEVELS.c", 1439; //                                    WALL COLLISION                                    //
 7306                        	
 7307                        		.dbg	line,	"include\routines_LEVELS.c", 1440; //--------------------------------------------------------------------------------------//
 7308                        	
 7309                        		.dbg	line,	"include\routines_LEVELS.c", 1442; // CHECK COLLISION WITH BOTTOM LEFT WALL //
 7310                        	
 7311                        		.dbg	line,	"include\routines_LEVELS.c", 1443; check_BG( 8 , 31 );
 7312                        		__ld.wi		8
         12:D3E9  A9 08      			lda.l	#8
         12:D3EB  C2         			cly
 7313                        		__pusharg.wr
         12:D3EC  A6 8D      			ldx	<__sp
         12:D3EE  CA         			dex
         12:D3EF  CA         			dex
         12:D3F0  95 08      			sta.l	<__stack, x
         12:D3F2  94 09      			sty.h	<__stack, x
         12:D3F4  86 8D      			stx	<__sp
 7314                        		__ld.wi		31
         12:D3F6  A9 1F      			lda.l	#31
         12:D3F8  C2         			cly
 7315                        		__pusharg.wr
         12:D3F9  A6 8D      			ldx	<__sp
         12:D3FB  CA         			dex
         12:D3FC  CA         			dex
         12:D3FD  95 08      			sta.l	<__stack, x
         12:D3FF  94 09      			sty.h	<__stack, x
         12:D401  86 8D      			stx	<__sp
 7316                        		__call		_check_BG
         12:D403  20 6D FF   			call	_check_BG
 7317                        	
 7318                        		.dbg	line,	"include\routines_LEVELS.c", 1445; if(map_blk_flag != TILE_BG)
 7319                        		__ld.umq	_map_blk_flag
         12:D406  AD AB 2B   			lda	_map_blk_flag
 7320                        		__neq_b.uiq	1
         12:D409  38         			sec
         12:D40A  49 01      			eor	#1
         12:D40C  D0 01      			bne	!+
         12:D40E  18         			clc
         12:D40F             	!:
 7321                        		__bfalse	.LL303
         12:D40F  90 78      			bcc	.LL303
 7322                        	
 7323                        		.dbg	line,	"include\routines_LEVELS.c", 1446; {
 7324                        	
 7325                        		.dbg	line,	"include\routines_LEVELS.c", 1447; // CHECK COLLISION WITH TOP RIGHT WALL //
 7326                        	
 7327                        		.dbg	line,	"include\routines_LEVELS.c", 1448; check_BG( 8 , 15 );
 7328                        		__ld.wi		8
         12:D411  A9 08      			lda.l	#8
         12:D413  C2         			cly
 7329                        		__pusharg.wr
         12:D414  A6 8D      			ldx	<__sp
         12:D416  CA         			dex
         12:D417  CA         			dex
         12:D418  95 08      			sta.l	<__stack, x
         12:D41A  94 09      			sty.h	<__stack, x
         12:D41C  86 8D      			stx	<__sp
 7330                        		__ld.wi		15
         12:D41E  A9 0F      			lda.l	#15
         12:D420  C2         			cly
 7331                        		__pusharg.wr
         12:D421  A6 8D      			ldx	<__sp
         12:D423  CA         			dex
         12:D424  CA         			dex
         12:D425  95 08      			sta.l	<__stack, x
         12:D427  94 09      			sty.h	<__stack, x
         12:D429  86 8D      			stx	<__sp
 7332                        		__call		_check_BG
         12:D42B  20 6D FF   			call	_check_BG
 7333                        	
 7334                        		.dbg	line,	"include\routines_LEVELS.c", 1450; if(map_blk_flag == TILE_BG)
 7335                        		__ld.umq	_map_blk_flag
         12:D42E  AD AB 2B   			lda	_map_blk_flag
 7336                        		__equ_b.uiq	1
         12:D431  C9 01      			cmp	#1
         12:D433  F0 01      			beq	!+
         12:D435  18         			clc
         12:D436             	!:
 7337                        		__bfalse	.LL304
         12:D436  90 41      			bcc	.LL304
 7338                        	
 7339                        		.dbg	line,	"include\routines_LEVELS.c", 1451; {
 7340                        	
 7341                        		.dbg	line,	"include\routines_LEVELS.c", 1452; check_TILE_DEPTH( 15 , -16 );
 7342                        		__ld.wi		15
         12:D438  A9 0F      			lda.l	#15
         12:D43A  C2         			cly
 7343                        		__pusharg.wr
         12:D43B  A6 8D      			ldx	<__sp
         12:D43D  CA         			dex
         12:D43E  CA         			dex
         12:D43F  95 08      			sta.l	<__stack, x
         12:D441  94 09      			sty.h	<__stack, x
         12:D443  86 8D      			stx	<__sp
 7344                        		__ld.wi		-16
         12:D445  A9 F0      			lda.l	#-16
         12:D447  A0 FF      			ldy.h	#-16
 7345                        		__pusharg.wr
         12:D449  A6 8D      			ldx	<__sp
         12:D44B  CA         			dex
         12:D44C  CA         			dex
         12:D44D  95 08      			sta.l	<__stack, x
         12:D44F  94 09      			sty.h	<__stack, x
         12:D451  86 8D      			stx	<__sp
 7346                        		__call		_check_TILE_DEPTH
         12:D453  20 4F FF   			call	_check_TILE_DEPTH
 7347                        	
 7348                        		.dbg	line,	"include\routines_LEVELS.c", 1454; if(map_blk_flag == TILE_EMPTY && jump_ladder == TRUE)
 7349                        		__not.um	_map_blk_flag
         12:D456  AD AB 2B   			lda	_map_blk_flag
         12:D459  18         			clc
         12:D45A  D0 01      			bne	!+
         12:D45C  38         			sec
         12:D45D             	!:
 7350                        		__bfalse	.LL306
         12:D45D  90 08      			bcc	.LL306
 7351                        		__ld.umq	_jump_ladder
         12:D45F  AD 1D 23   			lda	_jump_ladder
 7352                        		__equ_b.uiq	1
         12:D462  C9 01      			cmp	#1
         12:D464  F0 01      			beq	!+
         12:D466  18         			clc
         12:D467             	!:
 7353    12:D467             	.LL306:
 7354                        		__bfalse	.LL305
         12:D467  90 5F      			bcc	.LL305
 7355                        	
 7356                        		.dbg	line,	"include\routines_LEVELS.c", 1455; {
 7357                        	
 7358                        		.dbg	line,	"include\routines_LEVELS.c", 1456; jump_ladder = FALSE;
 7359                        		__st.umiq	0, _jump_ladder
         12:D469  9C 1D 23   			stz	_jump_ladder
 7360                        	
 7361                        		.dbg	line,	"include\routines_LEVELS.c", 1457; player_index_fall = 0;
 7362                        		__st.umiq	0, _player_index_fall
         12:D46C  9C 1A 23   			stz	_player_index_fall
 7363                        	
 7364                        		.dbg	line,	"include\routines_LEVELS.c", 1458; player_state = STATE_FALL;
 7365                        		__st.umiq	9, _player_state
         12:D46F  A9 09      			lda.l	#9
         12:D471  8D 15 23   			sta	_player_state
 7366                        	
 7367                        		.dbg	line,	"include\routines_LEVELS.c", 1459; return;
 7368                        		__bra		.LL194
         12:D474  4C A2 DF   			bra	.LL194
 7369                        	
 7370                        		.dbg	line,	"include\routines_LEVELS.c", 1460; }
 7371                        	
 7372                        		.dbg	line,	"include\routines_LEVELS.c", 1461; }
 7373    12:D477             	.LL305	.alias		.LL307
 7374                        	
 7375                        		.dbg	line,	"include\routines_LEVELS.c", 1463; else
 7376                        		__bra		.LL307
         12:D477  80 4F      			bra	.LL307
 7377    12:D479             	.LL304:
 7378                        	
 7379                        		.dbg	line,	"include\routines_LEVELS.c", 1464; {
 7380                        	
 7381                        		.dbg	line,	"include\routines_LEVELS.c", 1465; sgx_map_pxl_x -= 2;
 7382                        		__sub_st.wmiq	2, _sgx_map_pxl_x
         12:D479  38         			sec
         12:D47A  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:D47D  E9 02      			sbc.l	#2
         12:D47F  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:D482  B0 03      			bcs	!+
         12:D484  CE 8B 26   			dec.h	_sgx_map_pxl_x
         12:D487             	!:
 7383                        	
 7384                        		.dbg	line,	"include\routines_LEVELS.c", 1466; }
 7385    12:D487             	.LL307	.alias		.LL308
 7386                        	
 7387                        		.dbg	line,	"include\routines_LEVELS.c", 1467; }
 7388                        	
 7389                        		.dbg	line,	"include\routines_LEVELS.c", 1469; else
 7390                        		__bra		.LL308
         12:D487  80 3F      			bra	.LL308
 7391    12:D489             	.LL303:
 7392                        	
 7393                        		.dbg	line,	"include\routines_LEVELS.c", 1470; {
 7394                        	
 7395                        		.dbg	line,	"include\routines_LEVELS.c", 1471; check_TILE_DEPTH( 15 , -16 );
 7396                        		__ld.wi		15
         12:D489  A9 0F      			lda.l	#15
         12:D48B  C2         			cly
 7397                        		__pusharg.wr
         12:D48C  A6 8D      			ldx	<__sp
         12:D48E  CA         			dex
         12:D48F  CA         			dex
         12:D490  95 08      			sta.l	<__stack, x
         12:D492  94 09      			sty.h	<__stack, x
         12:D494  86 8D      			stx	<__sp
 7398                        		__ld.wi		-16
         12:D496  A9 F0      			lda.l	#-16
         12:D498  A0 FF      			ldy.h	#-16
 7399                        		__pusharg.wr
         12:D49A  A6 8D      			ldx	<__sp
         12:D49C  CA         			dex
         12:D49D  CA         			dex
         12:D49E  95 08      			sta.l	<__stack, x
         12:D4A0  94 09      			sty.h	<__stack, x
         12:D4A2  86 8D      			stx	<__sp
 7400                        		__call		_check_TILE_DEPTH
         12:D4A4  20 4F FF   			call	_check_TILE_DEPTH
 7401                        	
 7402                        		.dbg	line,	"include\routines_LEVELS.c", 1473; if(map_blk_flag == TILE_EMPTY && jump_ladder == TRUE)
 7403                        		__not.um	_map_blk_flag
         12:D4A7  AD AB 2B   			lda	_map_blk_flag
         12:D4AA  18         			clc
         12:D4AB  D0 01      			bne	!+
         12:D4AD  38         			sec
         12:D4AE             	!:
 7404                        		__bfalse	.LL310
         12:D4AE  90 08      			bcc	.LL310
 7405                        		__ld.umq	_jump_ladder
         12:D4B0  AD 1D 23   			lda	_jump_ladder
 7406                        		__equ_b.uiq	1
         12:D4B3  C9 01      			cmp	#1
         12:D4B5  F0 01      			beq	!+
         12:D4B7  18         			clc
         12:D4B8             	!:
 7407    12:D4B8             	.LL310:
 7408                        		__bfalse	.LL309
         12:D4B8  90 0E      			bcc	.LL309
 7409                        	
 7410                        		.dbg	line,	"include\routines_LEVELS.c", 1474; {
 7411                        	
 7412                        		.dbg	line,	"include\routines_LEVELS.c", 1475; jump_ladder = FALSE;
 7413                        		__st.umiq	0, _jump_ladder
         12:D4BA  9C 1D 23   			stz	_jump_ladder
 7414                        	
 7415                        		.dbg	line,	"include\routines_LEVELS.c", 1476; player_index_fall = 0;
 7416                        		__st.umiq	0, _player_index_fall
         12:D4BD  9C 1A 23   			stz	_player_index_fall
 7417                        	
 7418                        		.dbg	line,	"include\routines_LEVELS.c", 1477; player_state = STATE_FALL;
 7419                        		__st.umiq	9, _player_state
         12:D4C0  A9 09      			lda.l	#9
         12:D4C2  8D 15 23   			sta	_player_state
 7420                        	
 7421                        		.dbg	line,	"include\routines_LEVELS.c", 1478; return;
 7422                        		__bra		.LL194
         12:D4C5  4C A2 DF   			bra	.LL194
 7423                        	
 7424                        		.dbg	line,	"include\routines_LEVELS.c", 1479; }
 7425                        	
 7426                        		.dbg	line,	"include\routines_LEVELS.c", 1480; }
 7427    12:D4C8             	.LL309:
 7428    12:D4C8             	.LL308:
 7429                        	
 7430                        		.dbg	line,	"include\routines_LEVELS.c", 1485; //**************************************************************************************//
 7431                        	
 7432                        		.dbg	line,	"include\routines_LEVELS.c", 1486; //                                        V MOVE                                        //
 7433                        	
 7434                        		.dbg	line,	"include\routines_LEVELS.c", 1487; //**************************************************************************************//
 7435                        	
 7436                        		.dbg	line,	"include\routines_LEVELS.c", 1489; // UPDATE PLAYER Y POSITION //
 7437                        	
 7438                        		.dbg	line,	"include\routines_LEVELS.c", 1490; if(jump_ladder == FALSE)
 7439                        		__not.um	_jump_ladder
         12:D4C8  AD 1D 23   			lda	_jump_ladder
         12:D4CB  18         			clc
         12:D4CC  D0 01      			bne	!+
         12:D4CE  38         			sec
         12:D4CF             	!:
 7440                        		__bfalse	.LL311
         12:D4CF  90 1A      			bcc	.LL311
 7441                        	
 7442                        		.dbg	line,	"include\routines_LEVELS.c", 1491; {
 7443                        	
 7444                        		.dbg	line,	"include\routines_LEVELS.c", 1492; player_pos_y += TABLE_PLAYER_JUMP_V[player_index_jump];
 7445                        		__ldx.umq	_player_index_jump
         12:D4D1  AE 19 23   			ldx	_player_index_jump
 7446                        		__ld.bax	_TABLE_PLAYER_JUMP_V
         12:D4D4  BD F9 60   			lda	_TABLE_PLAYER_JUMP_V, x
         12:D4D7  C2         			cly
         12:D4D8  10 01      			bpl	!+
         12:D4DA  88         			dey
         12:D4DB             	!:
 7447                        		__add_st.wmq	_player_pos_y
         12:D4DB  18         			clc
         12:D4DC  6D D0 24   			adc.l	_player_pos_y
         12:D4DF  8D D0 24   			sta.l	_player_pos_y
         12:D4E2  98         			tya
         12:D4E3  6D D1 24   			adc.h	_player_pos_y
         12:D4E6  8D D1 24   			sta.h	_player_pos_y
 7448                        	
 7449                        		.dbg	line,	"include\routines_LEVELS.c", 1493; }
 7450                        	
 7451                        		.dbg	line,	"include\routines_LEVELS.c", 1495; else
 7452                        		__bra		.LL312
         12:D4E9  80 18      			bra	.LL312
 7453    12:D4EB             	.LL311:
 7454                        	
 7455                        		.dbg	line,	"include\routines_LEVELS.c", 1496; {
 7456                        	
 7457                        		.dbg	line,	"include\routines_LEVELS.c", 1497; player_pos_y += TABLE_PLAYER_JUMP_LADDER[player_index_jump];
 7458                        		__ldx.umq	_player_index_jump
         12:D4EB  AE 19 23   			ldx	_player_index_jump
 7459                        		__ld.bax	_TABLE_PLAYER_JUMP_LADDER
         12:D4EE  BD 31 61   			lda	_TABLE_PLAYER_JUMP_LADDER, x
         12:D4F1  C2         			cly
         12:D4F2  10 01      			bpl	!+
         12:D4F4  88         			dey
         12:D4F5             	!:
 7460                        		__add_st.wmq	_player_pos_y
         12:D4F5  18         			clc
         12:D4F6  6D D0 24   			adc.l	_player_pos_y
         12:D4F9  8D D0 24   			sta.l	_player_pos_y
         12:D4FC  98         			tya
         12:D4FD  6D D1 24   			adc.h	_player_pos_y
         12:D500  8D D1 24   			sta.h	_player_pos_y
 7461                        	
 7462                        		.dbg	line,	"include\routines_LEVELS.c", 1498; }
 7463    12:D503             	.LL312:
 7464                        	
 7465                        		.dbg	line,	"include\routines_LEVELS.c", 1501; // IF PLAYER GOES BELOW ITS BASE Y POSITION //
 7466                        	
 7467                        		.dbg	line,	"include\routines_LEVELS.c", 1502; if(player_pos_y >= PLAYER_BASE_Y_POS)
 7468                        		__ld.wm		_player_pos_y
         12:D503  AD D0 24   			lda.l	_player_pos_y
         12:D506  AC D1 24   			ldy.h	_player_pos_y
 7469                        		__sge_w.wi	128
         12:D509  C9 80      			cmp.l	#128		; Subtract integer from Y:A.
         12:D50B  98         			tya
         12:D50C  E9 00      			sbc.h	#128
         12:D50E  50 02      			bvc	!+
         12:D510  49 80      			eor	#$80		; +ve if Y:A >= integer (signed).
         12:D512  49 80      	!:		eor	#$80
         12:D514  0A         			asl	a
 7470                        		__bfalse	.LL313
         12:D515  90 4E      			bcc	.LL313
 7471                        	
 7472                        		.dbg	line,	"include\routines_LEVELS.c", 1503; {
 7473                        	
 7474                        		.dbg	line,	"include\routines_LEVELS.c", 1504; // THE CAMERA MOVES //
 7475                        	
 7476                        		.dbg	line,	"include\routines_LEVELS.c", 1505; // CALCULATE HOW MANY PIXELS THE CAMERA HAS TO MOVE DOWN //
 7477                        	
 7478                        		.dbg	line,	"include\routines_LEVELS.c", 1506; camera_y_move = player_pos_y - PLAYER_BASE_Y_POS;
 7479                        		__ld.wm		_player_pos_y
         12:D517  AD D0 24   			lda.l	_player_pos_y
         12:D51A  AC D1 24   			ldy.h	_player_pos_y
 7480                        		__sub.wi	128
         12:D51D  38         			sec
         12:D51E  E9 80      			sbc.l	#128
         12:D520  B0 01      			bcs	!+
         12:D522  88         			dey
         12:D523             	!:
 7481                        		__st.umq	__update_PLAYER_end - 5  /* camera_y_move */
         12:D523  8D 08 23   			sta	__update_PLAYER_end - 5
 7482                        	
 7483                        		.dbg	line,	"include\routines_LEVELS.c", 1507; sgx_map_pxl_y += camera_y_move;
 7484                        		__ld.um		__update_PLAYER_end - 5  /* camera_y_move */
         12:D526  AD 08 23   			lda	__update_PLAYER_end - 5
         12:D529  C2         			cly
 7485                        		__add_st.wmq	_sgx_map_pxl_y
         12:D52A  18         			clc
         12:D52B  6D 8C 26   			adc.l	_sgx_map_pxl_y
         12:D52E  8D 8C 26   			sta.l	_sgx_map_pxl_y
         12:D531  98         			tya
         12:D532  6D 8D 26   			adc.h	_sgx_map_pxl_y
         12:D535  8D 8D 26   			sta.h	_sgx_map_pxl_y
 7486                        	
 7487                        		.dbg	line,	"include\routines_LEVELS.c", 1509; // IF THE CAMERA HAS REACHED ITS MAX (LOWEST) POSITION //
 7488                        	
 7489                        		.dbg	line,	"include\routines_LEVELS.c", 1510; if(sgx_map_pxl_y > camera_max_y_position)
 7490                        		__ld.wm		_sgx_map_pxl_y
         12:D538  AD 8C 26   			lda.l	_sgx_map_pxl_y
         12:D53B  AC 8D 26   			ldy.h	_sgx_map_pxl_y
 7491                        		__ugt_w.wm	_camera_max_y_position
         12:D53E  18         			clc			; Subtract memory+1 from Y:A.
         12:D53F  ED D2 24   			sbc.l	_camera_max_y_position
         12:D542  98         			tya
         12:D543  ED D3 24   			sbc.h	_camera_max_y_position		; CS if Y:A > memory.
 7492                        		__bfalse	.LL314
         12:D546  90 0C      			bcc	.LL314
 7493                        	
 7494                        		.dbg	line,	"include\routines_LEVELS.c", 1511; {
 7495                        	
 7496                        		.dbg	line,	"include\routines_LEVELS.c", 1512; // THE CAMERA CAN NOT MOVE LOWER //
 7497                        	
 7498                        		.dbg	line,	"include\routines_LEVELS.c", 1513; sgx_map_pxl_y = camera_max_y_position;
 7499                        		__ld.wm		_camera_max_y_position
         12:D548  AD D2 24   			lda.l	_camera_max_y_position
         12:D54B  AC D3 24   			ldy.h	_camera_max_y_position
 7500                        		__st.wmq	_sgx_map_pxl_y
         12:D54E  8D 8C 26   			sta.l	_sgx_map_pxl_y
         12:D551  8C 8D 26   			sty.h	_sgx_map_pxl_y
 7501                        	
 7502                        		.dbg	line,	"include\routines_LEVELS.c", 1514; }
 7503                        	
 7504                        		.dbg	line,	"include\routines_LEVELS.c", 1516; // THE PLAYER STAYS AT ITS BASE Y POSITION //
 7505                        	
 7506                        		.dbg	line,	"include\routines_LEVELS.c", 1517; player_pos_y = PLAYER_BASE_Y_POS;
 7507    12:D554             	.LL314:
 7508                        		__st.wmiq	128, _player_pos_y
         12:D554  A9 80      			lda.l	#128
         12:D556  8D D0 24   			sta.l	_player_pos_y
         12:D559  9C D1 24   			stz.h	_player_pos_y
 7509                        	
 7510                        		.dbg	line,	"include\routines_LEVELS.c", 1519; spr_y(player_pos_y);
 7511                        		__ld.wm		_player_pos_y
         12:D55C  AD D0 24   			lda.l	_player_pos_y
         12:D55F  AC D1 24   			ldy.h	_player_pos_y
 7512                        		__call		_spr_y.1
         12:D562  20 19 E8   			call	_spr_y.1
 7513                        	
 7514                        		.dbg	line,	"include\routines_LEVELS.c", 1520; }
 7515                        	
 7516                        		.dbg	line,	"include\routines_LEVELS.c", 1523; // UPDATE JUMP INDEX IN THE ARRAY //
 7517                        	
 7518                        		.dbg	line,	"include\routines_LEVELS.c", 1524; if(player_index_jump < jump_max_index)
 7519    12:D565             	.LL313:
 7520                        		__ld.umq	_player_index_jump
         12:D565  AD 19 23   			lda	_player_index_jump
 7521                        		__ult_b.umq	_jump_max_index
         12:D568  CD 1E 23   			cmp	_jump_max_index		; Subtract memory from A.
         12:D56B  6A         			ror	a		; CC if A < memory.
         12:D56C  49 80      			eor	#$80
         12:D56E  2A         			rol	a
 7522                        		__bfalse	.LL315
         12:D56F  90 03      			bcc	.LL315
 7523                        	
 7524                        		.dbg	line,	"include\routines_LEVELS.c", 1525; {
 7525                        	
 7526                        		.dbg	line,	"include\routines_LEVELS.c", 1526; player_index_jump += 1;
 7527                        		__add_st.umiq	1, _player_index_jump
         12:D571  EE 19 23   			inc	_player_index_jump
 7528                        	
 7529                        		.dbg	line,	"include\routines_LEVELS.c", 1527; }
 7530                        	
 7531                        		.dbg	line,	"include\routines_LEVELS.c", 1532; //--------------------------------------------------------------------------------------//
 7532                        	
 7533                        		.dbg	line,	"include\routines_LEVELS.c", 1533; //                                   FLOOR COLLISION                                    //
 7534                        	
 7535                        		.dbg	line,	"include\routines_LEVELS.c", 1534; //--------------------------------------------------------------------------------------//
 7536                        	
 7537                        		.dbg	line,	"include\routines_LEVELS.c", 1536; if(player_index_jump > 14)
 7538    12:D574             	.LL315:
 7539                        		__ld.umq	_player_index_jump
         12:D574  AD 19 23   			lda	_player_index_jump
 7540                        		__ugt_b.uiq	14
         12:D577  18         			clc			; Subtract integer+1 from A.
         12:D578  E9 0E      			sbc	#14		; CS if A > integer.
 7541                        		__bfalse	.LL316
         12:D57A  B0 03 4C 2F			bcc	.LL316
         12:D57E  D7          
 7542                        	
 7543                        		.dbg	line,	"include\routines_LEVELS.c", 1537; {
 7544                        	
 7545                        		.dbg	line,	"include\routines_LEVELS.c", 1538; // CHECK COLLISION WITH LEFT FLOOR //
 7546                        	
 7547                        		.dbg	line,	"include\routines_LEVELS.c", 1539; check_BG( 10 , 32 );
 7548                        		__ld.wi		10
         12:D57F  A9 0A      			lda.l	#10
         12:D581  C2         			cly
 7549                        		__pusharg.wr
         12:D582  A6 8D      			ldx	<__sp
         12:D584  CA         			dex
         12:D585  CA         			dex
         12:D586  95 08      			sta.l	<__stack, x
         12:D588  94 09      			sty.h	<__stack, x
         12:D58A  86 8D      			stx	<__sp
 7550                        		__ld.wi		32
         12:D58C  A9 20      			lda.l	#32
         12:D58E  C2         			cly
 7551                        		__pusharg.wr
         12:D58F  A6 8D      			ldx	<__sp
         12:D591  CA         			dex
         12:D592  CA         			dex
         12:D593  95 08      			sta.l	<__stack, x
         12:D595  94 09      			sty.h	<__stack, x
         12:D597  86 8D      			stx	<__sp
 7552                        		__call		_check_BG
         12:D599  20 6D FF   			call	_check_BG
 7553                        	
 7554                        		.dbg	line,	"include\routines_LEVELS.c", 1541; if(map_blk_flag == TILE_BG)
 7555                        		__ld.umq	_map_blk_flag
         12:D59C  AD AB 2B   			lda	_map_blk_flag
 7556                        		__equ_b.uiq	1
         12:D59F  C9 01      			cmp	#1
         12:D5A1  F0 01      			beq	!+
         12:D5A3  18         			clc
         12:D5A4             	!:
 7557                        		__bfalse	.LL317
         12:D5A4  B0 03 4C 57			bcc	.LL317
         12:D5A8  D6          
 7558                        	
 7559                        		.dbg	line,	"include\routines_LEVELS.c", 1542; {
 7560                        	
 7561                        		.dbg	line,	"include\routines_LEVELS.c", 1543; // CALCULATE HOW MANY PIXELS THE PLAYER MOVED INTO THE GROUND //
 7562                        	
 7563                        		.dbg	line,	"include\routines_LEVELS.c", 1544; for(i=1; i<11 ; i++)
 7564                        		__st.umiq	1, __update_PLAYER_end - 4  /* i */
         12:D5A9  A9 01      			lda.l	#1
         12:D5AB  8D 09 23   			sta	__update_PLAYER_end - 4
 7565    12:D5AE             	.LL318:
 7566                        		__ld.umq	__update_PLAYER_end - 4  /* i */
         12:D5AE  AD 09 23   			lda	__update_PLAYER_end - 4
 7567                        		__ult_b.uiq	11
         12:D5B1  C9 0B      			cmp	#11		; Subtract integer from A.
         12:D5B3  6A         			ror	a		; CC if A < integer.
         12:D5B4  49 80      			eor	#$80
         12:D5B6  2A         			rol	a
 7568                        		__btrue		.LL320
         12:D5B7  B0 07      			bcs	.LL320
 7569                        		__bra		.LL321
         12:D5B9  80 7D      			bra	.LL321
 7570    12:D5BB             	.LL319:
 7571                        		__inc.umq	__update_PLAYER_end - 4  /* i */
         12:D5BB  EE 09 23   			inc	__update_PLAYER_end - 4
 7572                        		__bra		.LL318
         12:D5BE  80 EE      			bra	.LL318
 7573    12:D5C0             	.LL320:
 7574                        	
 7575                        		.dbg	line,	"include\routines_LEVELS.c", 1545; {
 7576                        	
 7577                        		.dbg	line,	"include\routines_LEVELS.c", 1546; check_TILE_DEPTH( 10 , i);
 7578                        		__ld.wi		10
         12:D5C0  A9 0A      			lda.l	#10
         12:D5C2  C2         			cly
 7579                        		__pusharg.wr
         12:D5C3  A6 8D      			ldx	<__sp
         12:D5C5  CA         			dex
         12:D5C6  CA         			dex
         12:D5C7  95 08      			sta.l	<__stack, x
         12:D5C9  94 09      			sty.h	<__stack, x
         12:D5CB  86 8D      			stx	<__sp
 7580                        		__ld.um		__update_PLAYER_end - 4  /* i */
         12:D5CD  AD 09 23   			lda	__update_PLAYER_end - 4
         12:D5D0  C2         			cly
 7581                        		__pusharg.wr
         12:D5D1  A6 8D      			ldx	<__sp
         12:D5D3  CA         			dex
         12:D5D4  CA         			dex
         12:D5D5  95 08      			sta.l	<__stack, x
         12:D5D7  94 09      			sty.h	<__stack, x
         12:D5D9  86 8D      			stx	<__sp
 7582                        		__call		_check_TILE_DEPTH
         12:D5DB  20 4F FF   			call	_check_TILE_DEPTH
 7583                        	
 7584                        		.dbg	line,	"include\routines_LEVELS.c", 1548; if(map_blk_flag == TILE_EMPTY)
 7585                        		__not.um	_map_blk_flag
         12:D5DE  AD AB 2B   			lda	_map_blk_flag
         12:D5E1  18         			clc
         12:D5E2  D0 01      			bne	!+
         12:D5E4  38         			sec
         12:D5E5             	!:
 7586                        		__bfalse	.LL322
         12:D5E5  90 D4      			bcc	.LL322
 7587                        	
 7588                        		.dbg	line,	"include\routines_LEVELS.c", 1549; {
 7589                        	
 7590                        		.dbg	line,	"include\routines_LEVELS.c", 1550; if(player_pos_y != PLAYER_BASE_Y_POS)
 7591                        		__ld.wm		_player_pos_y
         12:D5E7  AD D0 24   			lda.l	_player_pos_y
         12:D5EA  AC D1 24   			ldy.h	_player_pos_y
 7592                        		__neq_w.wi	128
         12:D5ED  38         			sec
         12:D5EE  49 80      			eor.l	#128
         12:D5F0  D0 06      			bne	!+
         12:D5F2  98         			tya
         12:D5F3  49 00      			eor.h	#128
         12:D5F5  D0 01      			bne	!+
         12:D5F7  18         			clc
         12:D5F8             	!:
 7593                        		__bfalse	.LL323
         12:D5F8  90 1E      			bcc	.LL323
 7594                        	
 7595                        		.dbg	line,	"include\routines_LEVELS.c", 1551; {
 7596                        	
 7597                        		.dbg	line,	"include\routines_LEVELS.c", 1552; player_pos_y -= (i - 1);
 7598                        		__ld.um		__update_PLAYER_end - 4  /* i */
         12:D5FA  AD 09 23   			lda	__update_PLAYER_end - 4
         12:D5FD  C2         			cly
 7599                        		__sub.wi	1
         12:D5FE  38         			sec
         12:D5FF  E9 01      			sbc.l	#1
         12:D601  B0 01      			bcs	!+
         12:D603  88         			dey
         12:D604             	!:
 7600                        		__isub_st.wmq	_player_pos_y
         12:D604  38         			sec
         12:D605  49 FF      			eor	#$FF
         12:D607  6D D0 24   			adc.l	_player_pos_y
         12:D60A  8D D0 24   			sta.l	_player_pos_y
         12:D60D  98         			tya
         12:D60E  49 FF      			eor	#$FF
         12:D610  6D D1 24   			adc.h	_player_pos_y
         12:D613  8D D1 24   			sta.h	_player_pos_y
 7601                        	
 7602                        		.dbg	line,	"include\routines_LEVELS.c", 1553; }
 7603                        	
 7604                        		.dbg	line,	"include\routines_LEVELS.c", 1555; else
 7605                        		__bra		.LL324
         12:D616  80 20      			bra	.LL324
 7606    12:D618             	.LL323:
 7607                        	
 7608                        		.dbg	line,	"include\routines_LEVELS.c", 1556; {
 7609                        	
 7610                        		.dbg	line,	"include\routines_LEVELS.c", 1557; sgx_map_pxl_y -= (i - 1);
 7611                        		__ld.um		__update_PLAYER_end - 4  /* i */
         12:D618  AD 09 23   			lda	__update_PLAYER_end - 4
         12:D61B  C2         			cly
 7612                        		__sub.wi	1
         12:D61C  38         			sec
         12:D61D  E9 01      			sbc.l	#1
         12:D61F  B0 01      			bcs	!+
         12:D621  88         			dey
         12:D622             	!:
 7613                        		__isub_st.wmq	_sgx_map_pxl_y
         12:D622  38         			sec
         12:D623  49 FF      			eor	#$FF
         12:D625  6D 8C 26   			adc.l	_sgx_map_pxl_y
         12:D628  8D 8C 26   			sta.l	_sgx_map_pxl_y
         12:D62B  98         			tya
         12:D62C  49 FF      			eor	#$FF
         12:D62E  6D 8D 26   			adc.h	_sgx_map_pxl_y
         12:D631  8D 8D 26   			sta.h	_sgx_map_pxl_y
 7614                        	
 7615                        		.dbg	line,	"include\routines_LEVELS.c", 1558; }
 7616    12:D634             	.LL324	.alias		.LL321
 7617                        	
 7618                        		.dbg	line,	"include\routines_LEVELS.c", 1560; break;
 7619                        		__bra		.LL321
         12:D634  80 02      			bra	.LL321
 7620                        	
 7621                        		.dbg	line,	"include\routines_LEVELS.c", 1561; }
 7622                        	
 7623                        		.dbg	line,	"include\routines_LEVELS.c", 1562; }
 7624    12:D636             	.LL322	.alias		.LL319
 7625                        		__bra		.LL319
         12:D636  80 83      			bra	.LL319
 7626    12:D638             	.LL321:
 7627                        	
 7628                        		.dbg	line,	"include\routines_LEVELS.c", 1564; // SET PLAYER SPRITE NEW POSITION //
 7629                        	
 7630                        		.dbg	line,	"include\routines_LEVELS.c", 1565; spr_y(player_pos_y);
 7631                        		__ld.wm		_player_pos_y
         12:D638  AD D0 24   			lda.l	_player_pos_y
         12:D63B  AC D1 24   			ldy.h	_player_pos_y
 7632                        		__call		_spr_y.1
         12:D63E  20 19 E8   			call	_spr_y.1
 7633                        	
 7634                        		.dbg	line,	"include\routines_LEVELS.c", 1567; player_counter_anim = 1;
 7635                        		__st.umiq	1, _player_counter_anim
         12:D641  A9 01      			lda.l	#1
         12:D643  8D 18 23   			sta	_player_counter_anim
 7636                        	
 7637                        		.dbg	line,	"include\routines_LEVELS.c", 1568; player_index_jump = 0;
 7638                        		__st.umiq	0, _player_index_jump
         12:D646  9C 19 23   			stz	_player_index_jump
 7639                        	
 7640                        		.dbg	line,	"include\routines_LEVELS.c", 1569; jump_ladder = FALSE;
 7641                        		__st.umiq	0, _jump_ladder
         12:D649  9C 1D 23   			stz	_jump_ladder
 7642                        	
 7643                        		.dbg	line,	"include\routines_LEVELS.c", 1570; jump_max_index = 34;
 7644                        		__st.umiq	34, _jump_max_index
         12:D64C  A9 22      			lda.l	#34
         12:D64E  8D 1E 23   			sta	_jump_max_index
 7645                        	
 7646                        		.dbg	line,	"include\routines_LEVELS.c", 1571; player_state = STATE_IDLE;
 7647                        		__st.umiq	0, _player_state
         12:D651  9C 15 23   			stz	_player_state
 7648                        	
 7649                        		.dbg	line,	"include\routines_LEVELS.c", 1572; return;
 7650                        		__bra		.LL194
         12:D654  4C A2 DF   			bra	.LL194
 7651                        	
 7652                        		.dbg	line,	"include\routines_LEVELS.c", 1573; }
 7653                        	
 7654                        		.dbg	line,	"include\routines_LEVELS.c", 1575; else
 7655    12:D657             	.LL317:
 7656                        	
 7657                        		.dbg	line,	"include\routines_LEVELS.c", 1576; {
 7658                        	
 7659                        		.dbg	line,	"include\routines_LEVELS.c", 1577; // CHECK COLLISION WITH RIGHT FLOOR //
 7660                        	
 7661                        		.dbg	line,	"include\routines_LEVELS.c", 1578; check_BG( 22 , 32 );
 7662                        		__ld.wi		22
         12:D657  A9 16      			lda.l	#22
         12:D659  C2         			cly
 7663                        		__pusharg.wr
         12:D65A  A6 8D      			ldx	<__sp
         12:D65C  CA         			dex
         12:D65D  CA         			dex
         12:D65E  95 08      			sta.l	<__stack, x
         12:D660  94 09      			sty.h	<__stack, x
         12:D662  86 8D      			stx	<__sp
 7664                        		__ld.wi		32
         12:D664  A9 20      			lda.l	#32
         12:D666  C2         			cly
 7665                        		__pusharg.wr
         12:D667  A6 8D      			ldx	<__sp
         12:D669  CA         			dex
         12:D66A  CA         			dex
         12:D66B  95 08      			sta.l	<__stack, x
         12:D66D  94 09      			sty.h	<__stack, x
         12:D66F  86 8D      			stx	<__sp
 7666                        		__call		_check_BG
         12:D671  20 6D FF   			call	_check_BG
 7667                        	
 7668                        		.dbg	line,	"include\routines_LEVELS.c", 1580; if(map_blk_flag == TILE_BG)
 7669                        		__ld.umq	_map_blk_flag
         12:D674  AD AB 2B   			lda	_map_blk_flag
 7670                        		__equ_b.uiq	1
         12:D677  C9 01      			cmp	#1
         12:D679  F0 01      			beq	!+
         12:D67B  18         			clc
         12:D67C             	!:
 7671                        		__bfalse	.LL326
         12:D67C  B0 03 4C 2F			bcc	.LL326
         12:D680  D7          
 7672                        	
 7673                        		.dbg	line,	"include\routines_LEVELS.c", 1581; {
 7674                        	
 7675                        		.dbg	line,	"include\routines_LEVELS.c", 1582; // CALCULATE HOW MANY PIXELS THE PLAYER MOVED INTO THE GROUND //
 7676                        	
 7677                        		.dbg	line,	"include\routines_LEVELS.c", 1583; for(i=1; i<11 ; i++)
 7678                        		__st.umiq	1, __update_PLAYER_end - 4  /* i */
         12:D681  A9 01      			lda.l	#1
         12:D683  8D 09 23   			sta	__update_PLAYER_end - 4
 7679    12:D686             	.LL327:
 7680                        		__ld.umq	__update_PLAYER_end - 4  /* i */
         12:D686  AD 09 23   			lda	__update_PLAYER_end - 4
 7681                        		__ult_b.uiq	11
         12:D689  C9 0B      			cmp	#11		; Subtract integer from A.
         12:D68B  6A         			ror	a		; CC if A < integer.
         12:D68C  49 80      			eor	#$80
         12:D68E  2A         			rol	a
 7682                        		__btrue		.LL329
         12:D68F  B0 07      			bcs	.LL329
 7683                        		__bra		.LL330
         12:D691  80 7D      			bra	.LL330
 7684    12:D693             	.LL328:
 7685                        		__inc.umq	__update_PLAYER_end - 4  /* i */
         12:D693  EE 09 23   			inc	__update_PLAYER_end - 4
 7686                        		__bra		.LL327
         12:D696  80 EE      			bra	.LL327
 7687    12:D698             	.LL329:
 7688                        	
 7689                        		.dbg	line,	"include\routines_LEVELS.c", 1584; {
 7690                        	
 7691                        		.dbg	line,	"include\routines_LEVELS.c", 1585; check_TILE_DEPTH( 22 , i);
 7692                        		__ld.wi		22
         12:D698  A9 16      			lda.l	#22
         12:D69A  C2         			cly
 7693                        		__pusharg.wr
         12:D69B  A6 8D      			ldx	<__sp
         12:D69D  CA         			dex
         12:D69E  CA         			dex
         12:D69F  95 08      			sta.l	<__stack, x
         12:D6A1  94 09      			sty.h	<__stack, x
         12:D6A3  86 8D      			stx	<__sp
 7694                        		__ld.um		__update_PLAYER_end - 4  /* i */
         12:D6A5  AD 09 23   			lda	__update_PLAYER_end - 4
         12:D6A8  C2         			cly
 7695                        		__pusharg.wr
         12:D6A9  A6 8D      			ldx	<__sp
         12:D6AB  CA         			dex
         12:D6AC  CA         			dex
         12:D6AD  95 08      			sta.l	<__stack, x
         12:D6AF  94 09      			sty.h	<__stack, x
         12:D6B1  86 8D      			stx	<__sp
 7696                        		__call		_check_TILE_DEPTH
         12:D6B3  20 4F FF   			call	_check_TILE_DEPTH
 7697                        	
 7698                        		.dbg	line,	"include\routines_LEVELS.c", 1587; if(map_blk_flag == TILE_EMPTY)
 7699                        		__not.um	_map_blk_flag
         12:D6B6  AD AB 2B   			lda	_map_blk_flag
         12:D6B9  18         			clc
         12:D6BA  D0 01      			bne	!+
         12:D6BC  38         			sec
         12:D6BD             	!:
 7700                        		__bfalse	.LL331
         12:D6BD  90 D4      			bcc	.LL331
 7701                        	
 7702                        		.dbg	line,	"include\routines_LEVELS.c", 1588; {
 7703                        	
 7704                        		.dbg	line,	"include\routines_LEVELS.c", 1589; if(player_pos_y != PLAYER_BASE_Y_POS)
 7705                        		__ld.wm		_player_pos_y
         12:D6BF  AD D0 24   			lda.l	_player_pos_y
         12:D6C2  AC D1 24   			ldy.h	_player_pos_y
 7706                        		__neq_w.wi	128
         12:D6C5  38         			sec
         12:D6C6  49 80      			eor.l	#128
         12:D6C8  D0 06      			bne	!+
         12:D6CA  98         			tya
         12:D6CB  49 00      			eor.h	#128
         12:D6CD  D0 01      			bne	!+
         12:D6CF  18         			clc
         12:D6D0             	!:
 7707                        		__bfalse	.LL332
         12:D6D0  90 1E      			bcc	.LL332
 7708                        	
 7709                        		.dbg	line,	"include\routines_LEVELS.c", 1590; {
 7710                        	
 7711                        		.dbg	line,	"include\routines_LEVELS.c", 1591; player_pos_y -= (i - 1);
 7712                        		__ld.um		__update_PLAYER_end - 4  /* i */
         12:D6D2  AD 09 23   			lda	__update_PLAYER_end - 4
         12:D6D5  C2         			cly
 7713                        		__sub.wi	1
         12:D6D6  38         			sec
         12:D6D7  E9 01      			sbc.l	#1
         12:D6D9  B0 01      			bcs	!+
         12:D6DB  88         			dey
         12:D6DC             	!:
 7714                        		__isub_st.wmq	_player_pos_y
         12:D6DC  38         			sec
         12:D6DD  49 FF      			eor	#$FF
         12:D6DF  6D D0 24   			adc.l	_player_pos_y
         12:D6E2  8D D0 24   			sta.l	_player_pos_y
         12:D6E5  98         			tya
         12:D6E6  49 FF      			eor	#$FF
         12:D6E8  6D D1 24   			adc.h	_player_pos_y
         12:D6EB  8D D1 24   			sta.h	_player_pos_y
 7715                        	
 7716                        		.dbg	line,	"include\routines_LEVELS.c", 1592; }
 7717                        	
 7718                        		.dbg	line,	"include\routines_LEVELS.c", 1594; else
 7719                        		__bra		.LL333
         12:D6EE  80 20      			bra	.LL333
 7720    12:D6F0             	.LL332:
 7721                        	
 7722                        		.dbg	line,	"include\routines_LEVELS.c", 1595; {
 7723                        	
 7724                        		.dbg	line,	"include\routines_LEVELS.c", 1596; sgx_map_pxl_y -= (i - 1);
 7725                        		__ld.um		__update_PLAYER_end - 4  /* i */
         12:D6F0  AD 09 23   			lda	__update_PLAYER_end - 4
         12:D6F3  C2         			cly
 7726                        		__sub.wi	1
         12:D6F4  38         			sec
         12:D6F5  E9 01      			sbc.l	#1
         12:D6F7  B0 01      			bcs	!+
         12:D6F9  88         			dey
         12:D6FA             	!:
 7727                        		__isub_st.wmq	_sgx_map_pxl_y
         12:D6FA  38         			sec
         12:D6FB  49 FF      			eor	#$FF
         12:D6FD  6D 8C 26   			adc.l	_sgx_map_pxl_y
         12:D700  8D 8C 26   			sta.l	_sgx_map_pxl_y
         12:D703  98         			tya
         12:D704  49 FF      			eor	#$FF
         12:D706  6D 8D 26   			adc.h	_sgx_map_pxl_y
         12:D709  8D 8D 26   			sta.h	_sgx_map_pxl_y
 7728                        	
 7729                        		.dbg	line,	"include\routines_LEVELS.c", 1597; }
 7730    12:D70C             	.LL333	.alias		.LL330
 7731                        	
 7732                        		.dbg	line,	"include\routines_LEVELS.c", 1599; break;
 7733                        		__bra		.LL330
         12:D70C  80 02      			bra	.LL330
 7734                        	
 7735                        		.dbg	line,	"include\routines_LEVELS.c", 1600; }
 7736                        	
 7737                        		.dbg	line,	"include\routines_LEVELS.c", 1601; }
 7738    12:D70E             	.LL331	.alias		.LL328
 7739                        		__bra		.LL328
         12:D70E  80 83      			bra	.LL328
 7740    12:D710             	.LL330:
 7741                        	
 7742                        		.dbg	line,	"include\routines_LEVELS.c", 1603; // SET PLAYER SPRITE NEW POSITION //
 7743                        	
 7744                        		.dbg	line,	"include\routines_LEVELS.c", 1604; spr_y(player_pos_y);
 7745                        		__ld.wm		_player_pos_y
         12:D710  AD D0 24   			lda.l	_player_pos_y
         12:D713  AC D1 24   			ldy.h	_player_pos_y
 7746                        		__call		_spr_y.1
         12:D716  20 19 E8   			call	_spr_y.1
 7747                        	
 7748                        		.dbg	line,	"include\routines_LEVELS.c", 1606; player_counter_anim = 1;
 7749                        		__st.umiq	1, _player_counter_anim
         12:D719  A9 01      			lda.l	#1
         12:D71B  8D 18 23   			sta	_player_counter_anim
 7750                        	
 7751                        		.dbg	line,	"include\routines_LEVELS.c", 1607; player_index_jump = 0;
 7752                        		__st.umiq	0, _player_index_jump
         12:D71E  9C 19 23   			stz	_player_index_jump
 7753                        	
 7754                        		.dbg	line,	"include\routines_LEVELS.c", 1608; jump_ladder = FALSE;
 7755                        		__st.umiq	0, _jump_ladder
         12:D721  9C 1D 23   			stz	_jump_ladder
 7756                        	
 7757                        		.dbg	line,	"include\routines_LEVELS.c", 1609; jump_max_index = 34;
 7758                        		__st.umiq	34, _jump_max_index
         12:D724  A9 22      			lda.l	#34
         12:D726  8D 1E 23   			sta	_jump_max_index
 7759                        	
 7760                        		.dbg	line,	"include\routines_LEVELS.c", 1610; player_state = STATE_IDLE;
 7761                        		__st.umiq	0, _player_state
         12:D729  9C 15 23   			stz	_player_state
 7762                        	
 7763                        		.dbg	line,	"include\routines_LEVELS.c", 1611; return;
 7764                        		__bra		.LL194
         12:D72C  4C A2 DF   			bra	.LL194
 7765                        	
 7766                        		.dbg	line,	"include\routines_LEVELS.c", 1612; }
 7767                        	
 7768                        		.dbg	line,	"include\routines_LEVELS.c", 1613; }
 7769    12:D72F             	.LL326:
 7770    12:D72F             	.LL325:
 7771                        	
 7772                        		.dbg	line,	"include\routines_LEVELS.c", 1614; }
 7773                        	
 7774                        		.dbg	line,	"include\routines_LEVELS.c", 1619; //--------------------------------------------------------------------------------------//
 7775                        	
 7776                        		.dbg	line,	"include\routines_LEVELS.c", 1620; //                                   LADDER COLLISION                                   //
 7777                        	
 7778                        		.dbg	line,	"include\routines_LEVELS.c", 1621; //--------------------------------------------------------------------------------------//
 7779                        	
 7780                        		.dbg	line,	"include\routines_LEVELS.c", 1623; if(player_index_jump > 4)
 7781    12:D72F             	.LL316:
 7782                        		__ld.umq	_player_index_jump
         12:D72F  AD 19 23   			lda	_player_index_jump
 7783                        		__ugt_b.uiq	4
         12:D732  18         			clc			; Subtract integer+1 from A.
         12:D733  E9 04      			sbc	#4		; CS if A > integer.
 7784                        		__bfalse	.LL334
         12:D735  B0 03 4C C6			bcc	.LL334
         12:D739  D7          
 7785                        	
 7786                        		.dbg	line,	"include\routines_LEVELS.c", 1624; {
 7787                        	
 7788                        		.dbg	line,	"include\routines_LEVELS.c", 1625; check_BG( 16 , 16 );
 7789                        		__ld.wi		16
         12:D73A  A9 10      			lda.l	#16
         12:D73C  C2         			cly
 7790                        		__pusharg.wr
         12:D73D  A6 8D      			ldx	<__sp
         12:D73F  CA         			dex
         12:D740  CA         			dex
         12:D741  95 08      			sta.l	<__stack, x
         12:D743  94 09      			sty.h	<__stack, x
         12:D745  86 8D      			stx	<__sp
 7791                        		__ld.wi		16
         12:D747  A9 10      			lda.l	#16
         12:D749  C2         			cly
 7792                        		__pusharg.wr
         12:D74A  A6 8D      			ldx	<__sp
         12:D74C  CA         			dex
         12:D74D  CA         			dex
         12:D74E  95 08      			sta.l	<__stack, x
         12:D750  94 09      			sty.h	<__stack, x
         12:D752  86 8D      			stx	<__sp
 7793                        		__call		_check_BG
         12:D754  20 6D FF   			call	_check_BG
 7794                        	
 7795                        		.dbg	line,	"include\routines_LEVELS.c", 1627; if(map_blk_flag == TILE_LADDER)
 7796                        		__ld.umq	_map_blk_flag
         12:D757  AD AB 2B   			lda	_map_blk_flag
 7797                        		__equ_b.uiq	2
         12:D75A  C9 02      			cmp	#2
         12:D75C  F0 01      			beq	!+
         12:D75E  18         			clc
         12:D75F             	!:
 7798                        		__bfalse	.LL335
         12:D75F  90 65      			bcc	.LL335
 7799                        	
 7800                        		.dbg	line,	"include\routines_LEVELS.c", 1628; {
 7801                        	
 7802                        		.dbg	line,	"include\routines_LEVELS.c", 1629; // CAMERA GOES 8 PX BACKWARD //
 7803                        	
 7804                        		.dbg	line,	"include\routines_LEVELS.c", 1630; sgx_map_pxl_x = ( (sgx_map_pxl_x >> 3) << 3 );
 7805                        		__ld.wm		_sgx_map_pxl_x
         12:D761  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:D764  AC 8B 26   			ldy.h	_sgx_map_pxl_x
 7806                        		__lsr.wi	3
         12:D767  84 00      			sty	__temp
         12:D769  20 3A E2   			jsr	lsrw3
 7807                        		__asl.wi	3
         12:D76C  84 00      			sty	__temp
         12:D76E  20 D7 E1   			jsr	aslw3
 7808                        		__st.wmq	_sgx_map_pxl_x
         12:D771  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:D774  8C 8B 26   			sty.h	_sgx_map_pxl_x
 7809                        	
 7810                        		.dbg	line,	"include\routines_LEVELS.c", 1632; // SO WE UPDATE THE MAP //
 7811                        	
 7812                        		.dbg	line,	"include\routines_LEVELS.c", 1633; sgx_scroll_map();
 7813                        		__call		_sgx_scroll_map
         12:D777  20 81 FF   			call	_sgx_scroll_map
 7814                        	
 7815                        		.dbg	line,	"include\routines_LEVELS.c", 1635; // CHECK IF THE PLAYER STANDS RIGHT TO THE LADDER //
 7816                        	
 7817                        		.dbg	line,	"include\routines_LEVELS.c", 1636; check_BG( 31 , 16 );
 7818                        		__ld.wi		31
         12:D77A  A9 1F      			lda.l	#31
         12:D77C  C2         			cly
 7819                        		__pusharg.wr
         12:D77D  A6 8D      			ldx	<__sp
         12:D77F  CA         			dex
         12:D780  CA         			dex
         12:D781  95 08      			sta.l	<__stack, x
         12:D783  94 09      			sty.h	<__stack, x
         12:D785  86 8D      			stx	<__sp
 7820                        		__ld.wi		16
         12:D787  A9 10      			lda.l	#16
         12:D789  C2         			cly
 7821                        		__pusharg.wr
         12:D78A  A6 8D      			ldx	<__sp
         12:D78C  CA         			dex
         12:D78D  CA         			dex
         12:D78E  95 08      			sta.l	<__stack, x
         12:D790  94 09      			sty.h	<__stack, x
         12:D792  86 8D      			stx	<__sp
 7822                        		__call		_check_BG
         12:D794  20 6D FF   			call	_check_BG
 7823                        	
 7824                        		.dbg	line,	"include\routines_LEVELS.c", 1638; if(map_blk_flag == TILE_LADDER)
 7825                        		__ld.umq	_map_blk_flag
         12:D797  AD AB 2B   			lda	_map_blk_flag
 7826                        		__equ_b.uiq	2
         12:D79A  C9 02      			cmp	#2
         12:D79C  F0 01      			beq	!+
         12:D79E  18         			clc
         12:D79F             	!:
 7827                        		__bfalse	.LL336
         12:D79F  90 0E      			bcc	.LL336
 7828                        	
 7829                        		.dbg	line,	"include\routines_LEVELS.c", 1639; {
 7830                        	
 7831                        		.dbg	line,	"include\routines_LEVELS.c", 1640; sgx_map_pxl_x += 8;
 7832                        		__add_st.wmiq	8, _sgx_map_pxl_x
         12:D7A1  18         			clc
         12:D7A2  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:D7A5  69 08      			adc.l	#8
         12:D7A7  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:D7AA  90 03      			bcc	!+
         12:D7AC  EE 8B 26   			inc.h	_sgx_map_pxl_x
         12:D7AF             	!:
 7833                        	
 7834                        		.dbg	line,	"include\routines_LEVELS.c", 1641; }
 7835                        	
 7836                        		.dbg	line,	"include\routines_LEVELS.c", 1643; player_counter_anim = 1;
 7837    12:D7AF             	.LL336:
 7838                        		__st.umiq	1, _player_counter_anim
         12:D7AF  A9 01      			lda.l	#1
         12:D7B1  8D 18 23   			sta	_player_counter_anim
 7839                        	
 7840                        		.dbg	line,	"include\routines_LEVELS.c", 1644; player_index_jump = 0;
 7841                        		__st.umiq	0, _player_index_jump
         12:D7B4  9C 19 23   			stz	_player_index_jump
 7842                        	
 7843                        		.dbg	line,	"include\routines_LEVELS.c", 1645; jump_ladder = TRUE;
 7844                        		__st.umiq	1, _jump_ladder
         12:D7B7  A9 01      			lda.l	#1
         12:D7B9  8D 1D 23   			sta	_jump_ladder
 7845                        	
 7846                        		.dbg	line,	"include\routines_LEVELS.c", 1646; jump_max_index = 29;
 7847                        		__st.umiq	29, _jump_max_index
         12:D7BC  A9 1D      			lda.l	#29
         12:D7BE  8D 1E 23   			sta	_jump_max_index
 7848                        	
 7849                        		.dbg	line,	"include\routines_LEVELS.c", 1647; player_state = STATE_HANG;
 7850                        		__st.umiq	10, _player_state
         12:D7C1  A9 0A      			lda.l	#10
         12:D7C3  8D 15 23   			sta	_player_state
 7851                        	
 7852                        		.dbg	line,	"include\routines_LEVELS.c", 1648; }
 7853                        	
 7854                        		.dbg	line,	"include\routines_LEVELS.c", 1649; }
 7855    12:D7C6             	.LL335:
 7856                        	
 7857                        		.dbg	line,	"include\routines_LEVELS.c", 1652; // SET PLAYER SPRITE NEW POSITION //
 7858                        	
 7859                        		.dbg	line,	"include\routines_LEVELS.c", 1653; spr_y(player_pos_y);
 7860    12:D7C6             	.LL334:
 7861                        		__ld.wm		_player_pos_y
         12:D7C6  AD D0 24   			lda.l	_player_pos_y
         12:D7C9  AC D1 24   			ldy.h	_player_pos_y
 7862                        		__call		_spr_y.1
         12:D7CC  20 19 E8   			call	_spr_y.1
 7863                        	
 7864                        		.dbg	line,	"include\routines_LEVELS.c", 1654; }
 7865                        	
 7866                        		.dbg	line,	"include\routines_LEVELS.c", 1657; else if(player_state == STATE_CROUCH)
 7867                        		__bra		.LL337
         12:D7CF  4C A2 DF   			bra	.LL337
 7868    12:D7D2             	.LL301:
 7869                        		__ld.umq	_player_state
         12:D7D2  AD 15 23   			lda	_player_state
 7870                        		__equ_b.uiq	7
         12:D7D5  C9 07      			cmp	#7
         12:D7D7  F0 01      			beq	!+
         12:D7D9  18         			clc
         12:D7DA             	!:
 7871                        		__bfalse	.LL338
         12:D7DA  90 40      			bcc	.LL338
 7872                        	
 7873                        		.dbg	line,	"include\routines_LEVELS.c", 1658; {
 7874                        	
 7875                        		.dbg	line,	"include\routines_LEVELS.c", 1659; if(player_counter_anim == 1)
 7876                        		__ld.umq	_player_counter_anim
         12:D7DC  AD 18 23   			lda	_player_counter_anim
 7877                        		__equ_b.uiq	1
         12:D7DF  C9 01      			cmp	#1
         12:D7E1  F0 01      			beq	!+
         12:D7E3  18         			clc
         12:D7E4             	!:
 7878                        		__bfalse	.LL339
         12:D7E4  90 30      			bcc	.LL339
 7879                        	
 7880                        		.dbg	line,	"include\routines_LEVELS.c", 1660; {
 7881                        	
 7882                        		.dbg	line,	"include\routines_LEVELS.c", 1661; set_far_offset(OFFSET_PLAYER_CROUCH,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 7883                        		__st.wmiq	4096, _bp
         12:D7E6  64 EC      			stz.l	_bp
         12:D7E8  A9 10      			lda.h	#4096
         12:D7EA  85 ED      			sta.h	_bp
 7884                        		__ldx.umq	_player_naked
         12:D7EC  AE 1B 23   			ldx	_player_naked
 7885                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:D7EF  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:D7F2  C2         			cly
 7886                        		__st.umq	_bp_bank
         12:D7F3  85 02      			sta	_bp_bank
 7887                        		__ld2x.umq	_player_naked
         12:D7F5  AD 1B 23   			lda	_player_naked
         12:D7F8  0A         			asl	a
         12:D7F9  AA         			tax
 7888                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:D7FA  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:D7FD  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 7889                        		__call		_set_far_offset.3
         12:D800  20 8C E2   			call	_set_far_offset.3
 7890                        	
 7891                        		.dbg	line,	"include\routines_LEVELS.c", 1662; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 7892                        		__st.wmiq	6144, _di
         12:D803  64 F0      			stz.l	_di
         12:D805  A9 18      			lda.h	#6144
         12:D807  85 F1      			sta.h	_di
 7893                        		__st.wmiq	256, _ax
         12:D809  64 F8      			stz.l	_ax
         12:D80B  A9 01      			lda.h	#256
         12:D80D  85 F9      			sta.h	_ax
 7894                        		 _far_load_vram.2
         12:D80F  82         			clx				; Offset to PCE VDC.
         12:D810  20 63 FF   			call	load_vram_x
 7895                        	
 7896                        		.dbg	line,	"include\routines_LEVELS.c", 1664; player_counter_anim = 0;
 7897                        		__st.umiq	0, _player_counter_anim
         12:D813  9C 18 23   			stz	_player_counter_anim
 7898                        	
 7899                        		.dbg	line,	"include\routines_LEVELS.c", 1665; }
 7900                        	
 7901                        		.dbg	line,	"include\routines_LEVELS.c", 1667; recenter_CAMERA();
 7902    12:D816             	.LL339:
 7903                        		__call		_recenter_CAMERA
         12:D816  20 59 FF   			call	_recenter_CAMERA
 7904                        	
 7905                        		.dbg	line,	"include\routines_LEVELS.c", 1668; }
 7906                        	
 7907                        		.dbg	line,	"include\routines_LEVELS.c", 1671; else if(player_state == STATE_CROUCH_ATTACK)
 7908                        		__bra		.LL340
         12:D819  4C A2 DF   			bra	.LL340
 7909    12:D81C             	.LL338:
 7910                        		__ld.umq	_player_state
         12:D81C  AD 15 23   			lda	_player_state
 7911                        		__equ_b.uiq	8
         12:D81F  C9 08      			cmp	#8
         12:D821  F0 01      			beq	!+
         12:D823  18         			clc
         12:D824             	!:
 7912                        		__bfalse	.LL341
         12:D824  B0 03 4C BA			bcc	.LL341
         12:D828  D8          
 7913                        	
 7914                        		.dbg	line,	"include\routines_LEVELS.c", 1672; {
 7915                        	
 7916                        		.dbg	line,	"include\routines_LEVELS.c", 1673; // UPDATE PLAYER TILES //
 7917                        	
 7918                        		.dbg	line,	"include\routines_LEVELS.c", 1674; if(player_counter_anim == 0)
 7919                        		__not.um	_player_counter_anim
         12:D829  AD 18 23   			lda	_player_counter_anim
         12:D82C  18         			clc
         12:D82D  D0 01      			bne	!+
         12:D82F  38         			sec
         12:D830             	!:
 7920                        		__bfalse	.LL342
         12:D830  90 2F      			bcc	.LL342
 7921                        	
 7922                        		.dbg	line,	"include\routines_LEVELS.c", 1675; {
 7923                        	
 7924                        		.dbg	line,	"include\routines_LEVELS.c", 1676; set_far_offset(OFFSET_PLAYER_ATTACK_CROUCH_1,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 7925                        		__st.wmiq	9216, _bp
         12:D832  64 EC      			stz.l	_bp
         12:D834  A9 24      			lda.h	#9216
         12:D836  85 ED      			sta.h	_bp
 7926                        		__ldx.umq	_player_naked
         12:D838  AE 1B 23   			ldx	_player_naked
 7927                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:D83B  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:D83E  C2         			cly
 7928                        		__st.umq	_bp_bank
         12:D83F  85 02      			sta	_bp_bank
 7929                        		__ld2x.umq	_player_naked
         12:D841  AD 1B 23   			lda	_player_naked
         12:D844  0A         			asl	a
         12:D845  AA         			tax
 7930                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:D846  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:D849  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 7931                        		__call		_set_far_offset.3
         12:D84C  20 8C E2   			call	_set_far_offset.3
 7932                        	
 7933                        		.dbg	line,	"include\routines_LEVELS.c", 1677; far_load_vram(PLAYER_VRAM_ADR,TILES_16);  
 7934                        		__st.wmiq	6144, _di
         12:D84F  64 F0      			stz.l	_di
         12:D851  A9 18      			lda.h	#6144
         12:D853  85 F1      			sta.h	_di
 7935                        		__st.wmiq	256, _ax
         12:D855  64 F8      			stz.l	_ax
         12:D857  A9 01      			lda.h	#256
         12:D859  85 F9      			sta.h	_ax
 7936                        		 _far_load_vram.2
         12:D85B  82         			clx				; Offset to PCE VDC.
         12:D85C  20 63 FF   			call	load_vram_x
 7937                        	
 7938                        		.dbg	line,	"include\routines_LEVELS.c", 1678; }
 7939                        	
 7940                        		.dbg	line,	"include\routines_LEVELS.c", 1680; else if(player_counter_anim == 6)
 7941                        		__bra		.LL343
         12:D85F  80 53      			bra	.LL343
 7942    12:D861             	.LL342:
 7943                        		__ld.umq	_player_counter_anim
         12:D861  AD 18 23   			lda	_player_counter_anim
 7944                        		__equ_b.uiq	6
         12:D864  C9 06      			cmp	#6
         12:D866  F0 01      			beq	!+
         12:D868  18         			clc
         12:D869             	!:
 7945                        		__bfalse	.LL344
         12:D869  90 2F      			bcc	.LL344
 7946                        	
 7947                        		.dbg	line,	"include\routines_LEVELS.c", 1681; {
 7948                        	
 7949                        		.dbg	line,	"include\routines_LEVELS.c", 1682; set_far_offset(OFFSET_PLAYER_ATTACK_CROUCH_2,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 7950                        		__st.wmiq	9728, _bp
         12:D86B  64 EC      			stz.l	_bp
         12:D86D  A9 26      			lda.h	#9728
         12:D86F  85 ED      			sta.h	_bp
 7951                        		__ldx.umq	_player_naked
         12:D871  AE 1B 23   			ldx	_player_naked
 7952                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:D874  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:D877  C2         			cly
 7953                        		__st.umq	_bp_bank
         12:D878  85 02      			sta	_bp_bank
 7954                        		__ld2x.umq	_player_naked
         12:D87A  AD 1B 23   			lda	_player_naked
         12:D87D  0A         			asl	a
         12:D87E  AA         			tax
 7955                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:D87F  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:D882  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 7956                        		__call		_set_far_offset.3
         12:D885  20 8C E2   			call	_set_far_offset.3
 7957                        	
 7958                        		.dbg	line,	"include\routines_LEVELS.c", 1683; far_load_vram(PLAYER_VRAM_ADR,TILES_16);  
 7959                        		__st.wmiq	6144, _di
         12:D888  64 F0      			stz.l	_di
         12:D88A  A9 18      			lda.h	#6144
         12:D88C  85 F1      			sta.h	_di
 7960                        		__st.wmiq	256, _ax
         12:D88E  64 F8      			stz.l	_ax
         12:D890  A9 01      			lda.h	#256
         12:D892  85 F9      			sta.h	_ax
 7961                        		 _far_load_vram.2
         12:D894  82         			clx				; Offset to PCE VDC.
         12:D895  20 63 FF   			call	load_vram_x
 7962                        	
 7963                        		.dbg	line,	"include\routines_LEVELS.c", 1684; }
 7964                        	
 7965                        		.dbg	line,	"include\routines_LEVELS.c", 1686; else if(player_counter_anim == 23)
 7966                        		__bra		.LL345
         12:D898  80 1A      			bra	.LL345
 7967    12:D89A             	.LL344:
 7968                        		__ld.umq	_player_counter_anim
         12:D89A  AD 18 23   			lda	_player_counter_anim
 7969                        		__equ_b.uiq	23
         12:D89D  C9 17      			cmp	#23
         12:D89F  F0 01      			beq	!+
         12:D8A1  18         			clc
         12:D8A2             	!:
 7970                        		__bfalse	.LL346
         12:D8A2  90 10      			bcc	.LL346
 7971                        	
 7972                        		.dbg	line,	"include\routines_LEVELS.c", 1687; {
 7973                        	
 7974                        		.dbg	line,	"include\routines_LEVELS.c", 1688; player_attack = FALSE;
 7975                        		__st.umiq	0, _player_attack
         12:D8A4  9C 1C 23   			stz	_player_attack
 7976                        	
 7977                        		.dbg	line,	"include\routines_LEVELS.c", 1689; player_counter_anim = 1;
 7978                        		__st.umiq	1, _player_counter_anim
         12:D8A7  A9 01      			lda.l	#1
         12:D8A9  8D 18 23   			sta	_player_counter_anim
 7979                        	
 7980                        		.dbg	line,	"include\routines_LEVELS.c", 1690; player_state = STATE_CROUCH;
 7981                        		__st.umiq	7, _player_state
         12:D8AC  A9 07      			lda.l	#7
         12:D8AE  8D 15 23   			sta	_player_state
 7982                        	
 7983                        		.dbg	line,	"include\routines_LEVELS.c", 1691; return;
 7984                        		__bra		.LL194
         12:D8B1  4C A2 DF   			bra	.LL194
 7985                        	
 7986                        		.dbg	line,	"include\routines_LEVELS.c", 1692; }
 7987                        	
 7988                        		.dbg	line,	"include\routines_LEVELS.c", 1695; player_counter_anim += 1;
 7989    12:D8B4             	.LL346:
 7990    12:D8B4             	.LL345:
 7991    12:D8B4             	.LL343:
 7992                        		__add_st.umiq	1, _player_counter_anim
         12:D8B4  EE 18 23   			inc	_player_counter_anim
 7993                        	
 7994                        		.dbg	line,	"include\routines_LEVELS.c", 1696; }
 7995                        	
 7996                        		.dbg	line,	"include\routines_LEVELS.c", 1699; else if(player_state == STATE_FALL)
 7997                        		__bra		.LL347
         12:D8B7  4C A2 DF   			bra	.LL347
 7998    12:D8BA             	.LL341:
 7999                        		__ld.umq	_player_state
         12:D8BA  AD 15 23   			lda	_player_state
 8000                        		__equ_b.uiq	9
         12:D8BD  C9 09      			cmp	#9
         12:D8BF  F0 01      			beq	!+
         12:D8C1  18         			clc
         12:D8C2             	!:
 8001                        		__bfalse	.LL348
         12:D8C2  B0 03 4C C9			bcc	.LL348
         12:D8C6  DA          
 8002                        	
 8003                        		.dbg	line,	"include\routines_LEVELS.c", 1700; {
 8004                        	
 8005                        		.dbg	line,	"include\routines_LEVELS.c", 1701; unsigned char i, camera_y_move;
 8006                        	
 8007                        		.dbg	line,	"include\routines_LEVELS.c", 1702; i = 1;
 8008                        		__st.umiq	1, __update_PLAYER_end - 6  /* i */
         12:D8C7  A9 01      			lda.l	#1
         12:D8C9  8D 07 23   			sta	__update_PLAYER_end - 6
 8009                        	
 8010                        		.dbg	line,	"include\routines_LEVELS.c", 1705; spr_set(player_id);
 8011                        		__ld.umq	_player_id
         12:D8CC  AD 14 23   			lda	_player_id
 8012                        		__call		_spr_set.1
         12:D8CF  20 DD E7   			call	_spr_set.1
 8013                        	
 8014                        		.dbg	line,	"include\routines_LEVELS.c", 1708; //--------------------------------------------------------------------------------------//
 8015                        	
 8016                        		.dbg	line,	"include\routines_LEVELS.c", 1709; //                                        V MOVE                                        //
 8017                        	
 8018                        		.dbg	line,	"include\routines_LEVELS.c", 1710; //--------------------------------------------------------------------------------------//
 8019                        	
 8020                        		.dbg	line,	"include\routines_LEVELS.c", 1712; // UPDATE PLAYER Y POSITION //
 8021                        	
 8022                        		.dbg	line,	"include\routines_LEVELS.c", 1713; player_pos_y += TABLE_PLAYER_FALL[player_index_fall];
 8023                        		__ldx.umq	_player_index_fall
         12:D8D2  AE 1A 23   			ldx	_player_index_fall
 8024                        		__ld.bax	_TABLE_PLAYER_FALL
         12:D8D5  BD 1C 61   			lda	_TABLE_PLAYER_FALL, x
         12:D8D8  C2         			cly
         12:D8D9  10 01      			bpl	!+
         12:D8DB  88         			dey
         12:D8DC             	!:
 8025                        		__add_st.wmq	_player_pos_y
         12:D8DC  18         			clc
         12:D8DD  6D D0 24   			adc.l	_player_pos_y
         12:D8E0  8D D0 24   			sta.l	_player_pos_y
         12:D8E3  98         			tya
         12:D8E4  6D D1 24   			adc.h	_player_pos_y
         12:D8E7  8D D1 24   			sta.h	_player_pos_y
 8026                        	
 8027                        		.dbg	line,	"include\routines_LEVELS.c", 1716; // IF PLAYER GOES BELOW ITS BASE Y POSITION //
 8028                        	
 8029                        		.dbg	line,	"include\routines_LEVELS.c", 1717; if(player_pos_y >= PLAYER_BASE_Y_POS)
 8030                        		__ld.wm		_player_pos_y
         12:D8EA  AD D0 24   			lda.l	_player_pos_y
         12:D8ED  AC D1 24   			ldy.h	_player_pos_y
 8031                        		__sge_w.wi	128
         12:D8F0  C9 80      			cmp.l	#128		; Subtract integer from Y:A.
         12:D8F2  98         			tya
         12:D8F3  E9 00      			sbc.h	#128
         12:D8F5  50 02      			bvc	!+
         12:D8F7  49 80      			eor	#$80		; +ve if Y:A >= integer (signed).
         12:D8F9  49 80      	!:		eor	#$80
         12:D8FB  0A         			asl	a
 8032                        		__bfalse	.LL349
         12:D8FC  90 45      			bcc	.LL349
 8033                        	
 8034                        		.dbg	line,	"include\routines_LEVELS.c", 1718; {
 8035                        	
 8036                        		.dbg	line,	"include\routines_LEVELS.c", 1719; // THE CAMERA MOVES //
 8037                        	
 8038                        		.dbg	line,	"include\routines_LEVELS.c", 1720; // CALCULATE HOW MANY PIXELS THE CAMERA HAS TO MOVE DOWN //
 8039                        	
 8040                        		.dbg	line,	"include\routines_LEVELS.c", 1721; camera_y_move = player_pos_y - PLAYER_BASE_Y_POS;
 8041                        		__ld.wm		_player_pos_y
         12:D8FE  AD D0 24   			lda.l	_player_pos_y
         12:D901  AC D1 24   			ldy.h	_player_pos_y
 8042                        		__sub.wi	128
         12:D904  38         			sec
         12:D905  E9 80      			sbc.l	#128
         12:D907  B0 01      			bcs	!+
         12:D909  88         			dey
         12:D90A             	!:
 8043                        		__st.umq	__update_PLAYER_end - 7  /* camera_y_move */
         12:D90A  8D 06 23   			sta	__update_PLAYER_end - 7
 8044                        	
 8045                        		.dbg	line,	"include\routines_LEVELS.c", 1722; sgx_map_pxl_y += camera_y_move;
 8046                        		__ld.um		__update_PLAYER_end - 7  /* camera_y_move */
         12:D90D  AD 06 23   			lda	__update_PLAYER_end - 7
         12:D910  C2         			cly
 8047                        		__add_st.wmq	_sgx_map_pxl_y
         12:D911  18         			clc
         12:D912  6D 8C 26   			adc.l	_sgx_map_pxl_y
         12:D915  8D 8C 26   			sta.l	_sgx_map_pxl_y
         12:D918  98         			tya
         12:D919  6D 8D 26   			adc.h	_sgx_map_pxl_y
         12:D91C  8D 8D 26   			sta.h	_sgx_map_pxl_y
 8048                        	
 8049                        		.dbg	line,	"include\routines_LEVELS.c", 1724; // IF THE CAMERA HAS REACHED ITS MAX (LOWEST) POSITION //
 8050                        	
 8051                        		.dbg	line,	"include\routines_LEVELS.c", 1725; if(sgx_map_pxl_y > camera_max_y_position)
 8052                        		__ld.wm		_sgx_map_pxl_y
         12:D91F  AD 8C 26   			lda.l	_sgx_map_pxl_y
         12:D922  AC 8D 26   			ldy.h	_sgx_map_pxl_y
 8053                        		__ugt_w.wm	_camera_max_y_position
         12:D925  18         			clc			; Subtract memory+1 from Y:A.
         12:D926  ED D2 24   			sbc.l	_camera_max_y_position
         12:D929  98         			tya
         12:D92A  ED D3 24   			sbc.h	_camera_max_y_position		; CS if Y:A > memory.
 8054                        		__bfalse	.LL350
         12:D92D  90 0C      			bcc	.LL350
 8055                        	
 8056                        		.dbg	line,	"include\routines_LEVELS.c", 1726; {
 8057                        	
 8058                        		.dbg	line,	"include\routines_LEVELS.c", 1727; // THE CAMERA CAN NOT MOVE LOWER //
 8059                        	
 8060                        		.dbg	line,	"include\routines_LEVELS.c", 1728; sgx_map_pxl_y = camera_max_y_position;
 8061                        		__ld.wm		_camera_max_y_position
         12:D92F  AD D2 24   			lda.l	_camera_max_y_position
         12:D932  AC D3 24   			ldy.h	_camera_max_y_position
 8062                        		__st.wmq	_sgx_map_pxl_y
         12:D935  8D 8C 26   			sta.l	_sgx_map_pxl_y
         12:D938  8C 8D 26   			sty.h	_sgx_map_pxl_y
 8063                        	
 8064                        		.dbg	line,	"include\routines_LEVELS.c", 1729; }
 8065                        	
 8066                        		.dbg	line,	"include\routines_LEVELS.c", 1731; // THE PLAYER STAYS AT ITS BASE Y POSITION //
 8067                        	
 8068                        		.dbg	line,	"include\routines_LEVELS.c", 1732; player_pos_y = PLAYER_BASE_Y_POS;
 8069    12:D93B             	.LL350:
 8070                        		__st.wmiq	128, _player_pos_y
         12:D93B  A9 80      			lda.l	#128
         12:D93D  8D D0 24   			sta.l	_player_pos_y
         12:D940  9C D1 24   			stz.h	_player_pos_y
 8071                        	
 8072                        		.dbg	line,	"include\routines_LEVELS.c", 1733; }
 8073                        	
 8074                        		.dbg	line,	"include\routines_LEVELS.c", 1736; // UPDATE JUMP INDEX IN THE ARRAY //
 8075                        	
 8076                        		.dbg	line,	"include\routines_LEVELS.c", 1737; // ARRAY MAX ENTRY : 20//
 8077                        	
 8078                        		.dbg	line,	"include\routines_LEVELS.c", 1738; if(player_index_fall < 20)
 8079    12:D943             	.LL349:
 8080                        		__ld.umq	_player_index_fall
         12:D943  AD 1A 23   			lda	_player_index_fall
 8081                        		__ult_b.uiq	20
         12:D946  C9 14      			cmp	#20		; Subtract integer from A.
         12:D948  6A         			ror	a		; CC if A < integer.
         12:D949  49 80      			eor	#$80
         12:D94B  2A         			rol	a
 8082                        		__bfalse	.LL351
         12:D94C  90 03      			bcc	.LL351
 8083                        	
 8084                        		.dbg	line,	"include\routines_LEVELS.c", 1739; {
 8085                        	
 8086                        		.dbg	line,	"include\routines_LEVELS.c", 1740; player_index_fall += 1;
 8087                        		__add_st.umiq	1, _player_index_fall
         12:D94E  EE 1A 23   			inc	_player_index_fall
 8088                        	
 8089                        		.dbg	line,	"include\routines_LEVELS.c", 1741; }
 8090                        	
 8091                        		.dbg	line,	"include\routines_LEVELS.c", 1744; check_TILE_DEPTH( 15 , 0);
 8092    12:D951             	.LL351:
 8093                        		__ld.wi		15
         12:D951  A9 0F      			lda.l	#15
         12:D953  C2         			cly
 8094                        		__pusharg.wr
         12:D954  A6 8D      			ldx	<__sp
         12:D956  CA         			dex
         12:D957  CA         			dex
         12:D958  95 08      			sta.l	<__stack, x
         12:D95A  94 09      			sty.h	<__stack, x
         12:D95C  86 8D      			stx	<__sp
 8095                        		__ld.wi		0
         12:D95E  62         			cla
         12:D95F  C2         			cly
 8096                        		__pusharg.wr
         12:D960  A6 8D      			ldx	<__sp
         12:D962  CA         			dex
         12:D963  CA         			dex
         12:D964  95 08      			sta.l	<__stack, x
         12:D966  94 09      			sty.h	<__stack, x
         12:D968  86 8D      			stx	<__sp
 8097                        		__call		_check_TILE_DEPTH
         12:D96A  20 4F FF   			call	_check_TILE_DEPTH
 8098                        	
 8099                        		.dbg	line,	"include\routines_LEVELS.c", 1747; if(map_blk_flag == TILE_BG)
 8100                        		__ld.umq	_map_blk_flag
         12:D96D  AD AB 2B   			lda	_map_blk_flag
 8101                        		__equ_b.uiq	1
         12:D970  C9 01      			cmp	#1
         12:D972  F0 01      			beq	!+
         12:D974  18         			clc
         12:D975             	!:
 8102                        		__bfalse	.LL352
         12:D975  B0 03 4C 2B			bcc	.LL352
         12:D979  DA          
 8103                        	
 8104                        		.dbg	line,	"include\routines_LEVELS.c", 1748; {
 8105                        	
 8106                        		.dbg	line,	"include\routines_LEVELS.c", 1749; // CALCULATE HOW MANY PIXELS THE PLAYER MOVED INTO THE GROUND //
 8107                        	
 8108                        		.dbg	line,	"include\routines_LEVELS.c", 1750; for(i=1; i<11 ; i++ )
 8109                        		__st.umiq	1, __update_PLAYER_end - 6  /* i */
         12:D97A  A9 01      			lda.l	#1
         12:D97C  8D 07 23   			sta	__update_PLAYER_end - 6
 8110    12:D97F             	.LL353:
 8111                        		__ld.umq	__update_PLAYER_end - 6  /* i */
         12:D97F  AD 07 23   			lda	__update_PLAYER_end - 6
 8112                        		__ult_b.uiq	11
         12:D982  C9 0B      			cmp	#11		; Subtract integer from A.
         12:D984  6A         			ror	a		; CC if A < integer.
         12:D985  49 80      			eor	#$80
         12:D987  2A         			rol	a
 8113                        		__btrue		.LL355
         12:D988  B0 07      			bcs	.LL355
 8114                        		__bra		.LL356
         12:D98A  80 7D      			bra	.LL356
 8115    12:D98C             	.LL354:
 8116                        		__inc.umq	__update_PLAYER_end - 6  /* i */
         12:D98C  EE 07 23   			inc	__update_PLAYER_end - 6
 8117                        		__bra		.LL353
         12:D98F  80 EE      			bra	.LL353
 8118    12:D991             	.LL355:
 8119                        	
 8120                        		.dbg	line,	"include\routines_LEVELS.c", 1751; {
 8121                        	
 8122                        		.dbg	line,	"include\routines_LEVELS.c", 1752; //if(player_axis == AXIS_RIGHT)
 8123                        	
 8124                        		.dbg	line,	"include\routines_LEVELS.c", 1753; //{
 8125                        	
 8126                        		.dbg	line,	"include\routines_LEVELS.c", 1754; check_TILE_DEPTH( 15 , i);//20
 8127                        		__ld.wi		15
         12:D991  A9 0F      			lda.l	#15
         12:D993  C2         			cly
 8128                        		__pusharg.wr
         12:D994  A6 8D      			ldx	<__sp
         12:D996  CA         			dex
         12:D997  CA         			dex
         12:D998  95 08      			sta.l	<__stack, x
         12:D99A  94 09      			sty.h	<__stack, x
         12:D99C  86 8D      			stx	<__sp
 8129                        		__ld.um		__update_PLAYER_end - 6  /* i */
         12:D99E  AD 07 23   			lda	__update_PLAYER_end - 6
         12:D9A1  C2         			cly
 8130                        		__pusharg.wr
         12:D9A2  A6 8D      			ldx	<__sp
         12:D9A4  CA         			dex
         12:D9A5  CA         			dex
         12:D9A6  95 08      			sta.l	<__stack, x
         12:D9A8  94 09      			sty.h	<__stack, x
         12:D9AA  86 8D      			stx	<__sp
 8131                        		__call		_check_TILE_DEPTH
         12:D9AC  20 4F FF   			call	_check_TILE_DEPTH
 8132                        	
 8133                        		.dbg	line,	"include\routines_LEVELS.c", 1755; //}
 8134                        	
 8135                        		.dbg	line,	"include\routines_LEVELS.c", 1757; /*else
 8136                        	
 8137                        		.dbg	line,	"include\routines_LEVELS.c", 1758; {
 8138                        	
 8139                        		.dbg	line,	"include\routines_LEVELS.c", 1759; check_TILE_DEPTH( 10 , i);
 8140                        	
 8141                        		.dbg	line,	"include\routines_LEVELS.c", 1760; }*/
 8142                        	
 8143                        		.dbg	line,	"include\routines_LEVELS.c", 1763; if(map_blk_flag == TILE_EMPTY)
 8144                        		__not.um	_map_blk_flag
         12:D9AF  AD AB 2B   			lda	_map_blk_flag
         12:D9B2  18         			clc
         12:D9B3  D0 01      			bne	!+
         12:D9B5  38         			sec
         12:D9B6             	!:
 8145                        		__bfalse	.LL357
         12:D9B6  90 D4      			bcc	.LL357
 8146                        	
 8147                        		.dbg	line,	"include\routines_LEVELS.c", 1764; {
 8148                        	
 8149                        		.dbg	line,	"include\routines_LEVELS.c", 1765; if(player_pos_y != PLAYER_BASE_Y_POS)
 8150                        		__ld.wm		_player_pos_y
         12:D9B8  AD D0 24   			lda.l	_player_pos_y
         12:D9BB  AC D1 24   			ldy.h	_player_pos_y
 8151                        		__neq_w.wi	128
         12:D9BE  38         			sec
         12:D9BF  49 80      			eor.l	#128
         12:D9C1  D0 06      			bne	!+
         12:D9C3  98         			tya
         12:D9C4  49 00      			eor.h	#128
         12:D9C6  D0 01      			bne	!+
         12:D9C8  18         			clc
         12:D9C9             	!:
 8152                        		__bfalse	.LL358
         12:D9C9  90 1E      			bcc	.LL358
 8153                        	
 8154                        		.dbg	line,	"include\routines_LEVELS.c", 1766; {
 8155                        	
 8156                        		.dbg	line,	"include\routines_LEVELS.c", 1767; player_pos_y -= (i - 1);
 8157                        		__ld.um		__update_PLAYER_end - 6  /* i */
         12:D9CB  AD 07 23   			lda	__update_PLAYER_end - 6
         12:D9CE  C2         			cly
 8158                        		__sub.wi	1
         12:D9CF  38         			sec
         12:D9D0  E9 01      			sbc.l	#1
         12:D9D2  B0 01      			bcs	!+
         12:D9D4  88         			dey
         12:D9D5             	!:
 8159                        		__isub_st.wmq	_player_pos_y
         12:D9D5  38         			sec
         12:D9D6  49 FF      			eor	#$FF
         12:D9D8  6D D0 24   			adc.l	_player_pos_y
         12:D9DB  8D D0 24   			sta.l	_player_pos_y
         12:D9DE  98         			tya
         12:D9DF  49 FF      			eor	#$FF
         12:D9E1  6D D1 24   			adc.h	_player_pos_y
         12:D9E4  8D D1 24   			sta.h	_player_pos_y
 8160                        	
 8161                        		.dbg	line,	"include\routines_LEVELS.c", 1768; }
 8162                        	
 8163                        		.dbg	line,	"include\routines_LEVELS.c", 1770; else
 8164                        		__bra		.LL359
         12:D9E7  80 20      			bra	.LL359
 8165    12:D9E9             	.LL358:
 8166                        	
 8167                        		.dbg	line,	"include\routines_LEVELS.c", 1771; {
 8168                        	
 8169                        		.dbg	line,	"include\routines_LEVELS.c", 1772; sgx_map_pxl_y -= (i - 1);
 8170                        		__ld.um		__update_PLAYER_end - 6  /* i */
         12:D9E9  AD 07 23   			lda	__update_PLAYER_end - 6
         12:D9EC  C2         			cly
 8171                        		__sub.wi	1
         12:D9ED  38         			sec
         12:D9EE  E9 01      			sbc.l	#1
         12:D9F0  B0 01      			bcs	!+
         12:D9F2  88         			dey
         12:D9F3             	!:
 8172                        		__isub_st.wmq	_sgx_map_pxl_y
         12:D9F3  38         			sec
         12:D9F4  49 FF      			eor	#$FF
         12:D9F6  6D 8C 26   			adc.l	_sgx_map_pxl_y
         12:D9F9  8D 8C 26   			sta.l	_sgx_map_pxl_y
         12:D9FC  98         			tya
         12:D9FD  49 FF      			eor	#$FF
         12:D9FF  6D 8D 26   			adc.h	_sgx_map_pxl_y
         12:DA02  8D 8D 26   			sta.h	_sgx_map_pxl_y
 8173                        	
 8174                        		.dbg	line,	"include\routines_LEVELS.c", 1773; }
 8175    12:DA05             	.LL359	.alias		.LL356
 8176                        	
 8177                        		.dbg	line,	"include\routines_LEVELS.c", 1776; break;
 8178                        		__bra		.LL356
         12:DA05  80 02      			bra	.LL356
 8179                        	
 8180                        		.dbg	line,	"include\routines_LEVELS.c", 1777; }
 8181                        	
 8182                        		.dbg	line,	"include\routines_LEVELS.c", 1779; }
 8183    12:DA07             	.LL357	.alias		.LL354
 8184                        		__bra		.LL354
         12:DA07  80 83      			bra	.LL354
 8185    12:DA09             	.LL356:
 8186                        	
 8187                        		.dbg	line,	"include\routines_LEVELS.c", 1781; spr_y(player_pos_y);
 8188                        		__ld.wm		_player_pos_y
         12:DA09  AD D0 24   			lda.l	_player_pos_y
         12:DA0C  AC D1 24   			ldy.h	_player_pos_y
 8189                        		__call		_spr_y.1
         12:DA0F  20 19 E8   			call	_spr_y.1
 8190                        	
 8191                        		.dbg	line,	"include\routines_LEVELS.c", 1783; player_counter_anim = 1;
 8192                        		__st.umiq	1, _player_counter_anim
         12:DA12  A9 01      			lda.l	#1
         12:DA14  8D 18 23   			sta	_player_counter_anim
 8193                        	
 8194                        		.dbg	line,	"include\routines_LEVELS.c", 1784; player_index_jump = 0;
 8195                        		__st.umiq	0, _player_index_jump
         12:DA17  9C 19 23   			stz	_player_index_jump
 8196                        	
 8197                        		.dbg	line,	"include\routines_LEVELS.c", 1785; player_index_fall = 0;
 8198                        		__st.umiq	0, _player_index_fall
         12:DA1A  9C 1A 23   			stz	_player_index_fall
 8199                        	
 8200                        		.dbg	line,	"include\routines_LEVELS.c", 1786; jump_ladder = FALSE;
 8201                        		__st.umiq	0, _jump_ladder
         12:DA1D  9C 1D 23   			stz	_jump_ladder
 8202                        	
 8203                        		.dbg	line,	"include\routines_LEVELS.c", 1787; jump_max_index = 34;
 8204                        		__st.umiq	34, _jump_max_index
         12:DA20  A9 22      			lda.l	#34
         12:DA22  8D 1E 23   			sta	_jump_max_index
 8205                        	
 8206                        		.dbg	line,	"include\routines_LEVELS.c", 1788; player_state = STATE_IDLE;
 8207                        		__st.umiq	0, _player_state
         12:DA25  9C 15 23   			stz	_player_state
 8208                        	
 8209                        		.dbg	line,	"include\routines_LEVELS.c", 1789; return;
 8210                        		__bra		.LL194
         12:DA28  4C A2 DF   			bra	.LL194
 8211                        	
 8212                        		.dbg	line,	"include\routines_LEVELS.c", 1790; }
 8213                        	
 8214                        		.dbg	line,	"include\routines_LEVELS.c", 1793; check_BG( 16 , 16 );
 8215    12:DA2B             	.LL352:
 8216                        		__ld.wi		16
         12:DA2B  A9 10      			lda.l	#16
         12:DA2D  C2         			cly
 8217                        		__pusharg.wr
         12:DA2E  A6 8D      			ldx	<__sp
         12:DA30  CA         			dex
         12:DA31  CA         			dex
         12:DA32  95 08      			sta.l	<__stack, x
         12:DA34  94 09      			sty.h	<__stack, x
         12:DA36  86 8D      			stx	<__sp
 8218                        		__ld.wi		16
         12:DA38  A9 10      			lda.l	#16
         12:DA3A  C2         			cly
 8219                        		__pusharg.wr
         12:DA3B  A6 8D      			ldx	<__sp
         12:DA3D  CA         			dex
         12:DA3E  CA         			dex
         12:DA3F  95 08      			sta.l	<__stack, x
         12:DA41  94 09      			sty.h	<__stack, x
         12:DA43  86 8D      			stx	<__sp
 8220                        		__call		_check_BG
         12:DA45  20 6D FF   			call	_check_BG
 8221                        	
 8222                        		.dbg	line,	"include\routines_LEVELS.c", 1795; // IF PLAYER HITS THE LADDER //
 8223                        	
 8224                        		.dbg	line,	"include\routines_LEVELS.c", 1796; if(map_blk_flag == TILE_LADDER)
 8225                        		__ld.umq	_map_blk_flag
         12:DA48  AD AB 2B   			lda	_map_blk_flag
 8226                        		__equ_b.uiq	2
         12:DA4B  C9 02      			cmp	#2
         12:DA4D  F0 01      			beq	!+
         12:DA4F  18         			clc
         12:DA50             	!:
 8227                        		__bfalse	.LL360
         12:DA50  90 6B      			bcc	.LL360
 8228                        	
 8229                        		.dbg	line,	"include\routines_LEVELS.c", 1797; {
 8230                        	
 8231                        		.dbg	line,	"include\routines_LEVELS.c", 1798; // CAMERA GOES 8 PX BACKWARD //
 8232                        	
 8233                        		.dbg	line,	"include\routines_LEVELS.c", 1799; sgx_map_pxl_x = ( (sgx_map_pxl_x >> 3) << 3 );
 8234                        		__ld.wm		_sgx_map_pxl_x
         12:DA52  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:DA55  AC 8B 26   			ldy.h	_sgx_map_pxl_x
 8235                        		__lsr.wi	3
         12:DA58  84 00      			sty	__temp
         12:DA5A  20 3A E2   			jsr	lsrw3
 8236                        		__asl.wi	3
         12:DA5D  84 00      			sty	__temp
         12:DA5F  20 D7 E1   			jsr	aslw3
 8237                        		__st.wmq	_sgx_map_pxl_x
         12:DA62  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:DA65  8C 8B 26   			sty.h	_sgx_map_pxl_x
 8238                        	
 8239                        		.dbg	line,	"include\routines_LEVELS.c", 1801; // SO WE UPDATE THE MAP //
 8240                        	
 8241                        		.dbg	line,	"include\routines_LEVELS.c", 1802; sgx_scroll_map();
 8242                        		__call		_sgx_scroll_map
         12:DA68  20 81 FF   			call	_sgx_scroll_map
 8243                        	
 8244                        		.dbg	line,	"include\routines_LEVELS.c", 1804; // CHECK IF THE PLAYER STANDS RIGHT TO THE LADDER //
 8245                        	
 8246                        		.dbg	line,	"include\routines_LEVELS.c", 1805; check_BG( 31 , 16 );
 8247                        		__ld.wi		31
         12:DA6B  A9 1F      			lda.l	#31
         12:DA6D  C2         			cly
 8248                        		__pusharg.wr
         12:DA6E  A6 8D      			ldx	<__sp
         12:DA70  CA         			dex
         12:DA71  CA         			dex
         12:DA72  95 08      			sta.l	<__stack, x
         12:DA74  94 09      			sty.h	<__stack, x
         12:DA76  86 8D      			stx	<__sp
 8249                        		__ld.wi		16
         12:DA78  A9 10      			lda.l	#16
         12:DA7A  C2         			cly
 8250                        		__pusharg.wr
         12:DA7B  A6 8D      			ldx	<__sp
         12:DA7D  CA         			dex
         12:DA7E  CA         			dex
         12:DA7F  95 08      			sta.l	<__stack, x
         12:DA81  94 09      			sty.h	<__stack, x
         12:DA83  86 8D      			stx	<__sp
 8251                        		__call		_check_BG
         12:DA85  20 6D FF   			call	_check_BG
 8252                        	
 8253                        		.dbg	line,	"include\routines_LEVELS.c", 1807; if(map_blk_flag == TILE_LADDER)
 8254                        		__ld.umq	_map_blk_flag
         12:DA88  AD AB 2B   			lda	_map_blk_flag
 8255                        		__equ_b.uiq	2
         12:DA8B  C9 02      			cmp	#2
         12:DA8D  F0 01      			beq	!+
         12:DA8F  18         			clc
         12:DA90             	!:
 8256                        		__bfalse	.LL361
         12:DA90  90 0E      			bcc	.LL361
 8257                        	
 8258                        		.dbg	line,	"include\routines_LEVELS.c", 1808; {
 8259                        	
 8260                        		.dbg	line,	"include\routines_LEVELS.c", 1809; sgx_map_pxl_x += 8;
 8261                        		__add_st.wmiq	8, _sgx_map_pxl_x
         12:DA92  18         			clc
         12:DA93  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:DA96  69 08      			adc.l	#8
         12:DA98  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:DA9B  90 03      			bcc	!+
         12:DA9D  EE 8B 26   			inc.h	_sgx_map_pxl_x
         12:DAA0             	!:
 8262                        	
 8263                        		.dbg	line,	"include\routines_LEVELS.c", 1810; }
 8264                        	
 8265                        		.dbg	line,	"include\routines_LEVELS.c", 1812; player_counter_anim = 1;
 8266    12:DAA0             	.LL361:
 8267                        		__st.umiq	1, _player_counter_anim
         12:DAA0  A9 01      			lda.l	#1
         12:DAA2  8D 18 23   			sta	_player_counter_anim
 8268                        	
 8269                        		.dbg	line,	"include\routines_LEVELS.c", 1813; player_index_jump = 0;
 8270                        		__st.umiq	0, _player_index_jump
         12:DAA5  9C 19 23   			stz	_player_index_jump
 8271                        	
 8272                        		.dbg	line,	"include\routines_LEVELS.c", 1814; player_index_fall = 0;
 8273                        		__st.umiq	0, _player_index_fall
         12:DAA8  9C 1A 23   			stz	_player_index_fall
 8274                        	
 8275                        		.dbg	line,	"include\routines_LEVELS.c", 1815; jump_ladder = TRUE;
 8276                        		__st.umiq	1, _jump_ladder
         12:DAAB  A9 01      			lda.l	#1
         12:DAAD  8D 1D 23   			sta	_jump_ladder
 8277                        	
 8278                        		.dbg	line,	"include\routines_LEVELS.c", 1816; jump_max_index = 29;
 8279                        		__st.umiq	29, _jump_max_index
         12:DAB0  A9 1D      			lda.l	#29
         12:DAB2  8D 1E 23   			sta	_jump_max_index
 8280                        	
 8281                        		.dbg	line,	"include\routines_LEVELS.c", 1817; player_state = STATE_HANG;
 8282                        		__st.umiq	10, _player_state
         12:DAB5  A9 0A      			lda.l	#10
         12:DAB7  8D 15 23   			sta	_player_state
 8283                        	
 8284                        		.dbg	line,	"include\routines_LEVELS.c", 1818; return;
 8285                        		__bra		.LL194
         12:DABA  4C A2 DF   			bra	.LL194
 8286                        	
 8287                        		.dbg	line,	"include\routines_LEVELS.c", 1819; }
 8288                        	
 8289                        		.dbg	line,	"include\routines_LEVELS.c", 1822; spr_y(player_pos_y);
 8290    12:DABD             	.LL360:
 8291                        		__ld.wm		_player_pos_y
         12:DABD  AD D0 24   			lda.l	_player_pos_y
         12:DAC0  AC D1 24   			ldy.h	_player_pos_y
 8292                        		__call		_spr_y.1
         12:DAC3  20 19 E8   			call	_spr_y.1
 8293                        	
 8294                        		.dbg	line,	"include\routines_LEVELS.c", 1823; }
 8295                        	
 8296                        		.dbg	line,	"include\routines_LEVELS.c", 1826; else if(player_state == STATE_HANG)
 8297                        		__bra		.LL362
         12:DAC6  4C A2 DF   			bra	.LL362
 8298    12:DAC9             	.LL348:
 8299                        		__ld.umq	_player_state
         12:DAC9  AD 15 23   			lda	_player_state
 8300                        		__equ_b.uiq	10
         12:DACC  C9 0A      			cmp	#10
         12:DACE  F0 01      			beq	!+
         12:DAD0  18         			clc
         12:DAD1             	!:
 8301                        		__bfalse	.LL363
         12:DAD1  90 43      			bcc	.LL363
 8302                        	
 8303                        		.dbg	line,	"include\routines_LEVELS.c", 1827; {
 8304                        	
 8305                        		.dbg	line,	"include\routines_LEVELS.c", 1828; recenter_CAMERA();
 8306                        		__call		_recenter_CAMERA
         12:DAD3  20 59 FF   			call	_recenter_CAMERA
 8307                        	
 8308                        		.dbg	line,	"include\routines_LEVELS.c", 1830; if(player_counter_anim == 1)
 8309                        		__ld.umq	_player_counter_anim
         12:DAD6  AD 18 23   			lda	_player_counter_anim
 8310                        		__equ_b.uiq	1
         12:DAD9  C9 01      			cmp	#1
         12:DADB  F0 01      			beq	!+
         12:DADD  18         			clc
         12:DADE             	!:
 8311                        		__bfalse	.LL364
         12:DADE  B0 03 4C A2			bcc	.LL364
         12:DAE2  DF          
 8312                        	
 8313                        		.dbg	line,	"include\routines_LEVELS.c", 1831; {
 8314                        	
 8315                        		.dbg	line,	"include\routines_LEVELS.c", 1832; set_far_offset(OFFSET_PLAYER_HANG,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8316                        		__st.wmiq	4608, _bp
         12:DAE3  64 EC      			stz.l	_bp
         12:DAE5  A9 12      			lda.h	#4608
         12:DAE7  85 ED      			sta.h	_bp
 8317                        		__ldx.umq	_player_naked
         12:DAE9  AE 1B 23   			ldx	_player_naked
 8318                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DAEC  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DAEF  C2         			cly
 8319                        		__st.umq	_bp_bank
         12:DAF0  85 02      			sta	_bp_bank
 8320                        		__ld2x.umq	_player_naked
         12:DAF2  AD 1B 23   			lda	_player_naked
         12:DAF5  0A         			asl	a
         12:DAF6  AA         			tax
 8321                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DAF7  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DAFA  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8322                        		__call		_set_far_offset.3
         12:DAFD  20 8C E2   			call	_set_far_offset.3
 8323                        	
 8324                        		.dbg	line,	"include\routines_LEVELS.c", 1833; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8325                        		__st.wmiq	6144, _di
         12:DB00  64 F0      			stz.l	_di
         12:DB02  A9 18      			lda.h	#6144
         12:DB04  85 F1      			sta.h	_di
 8326                        		__st.wmiq	256, _ax
         12:DB06  64 F8      			stz.l	_ax
         12:DB08  A9 01      			lda.h	#256
         12:DB0A  85 F9      			sta.h	_ax
 8327                        		 _far_load_vram.2
         12:DB0C  82         			clx				; Offset to PCE VDC.
         12:DB0D  20 63 FF   			call	load_vram_x
 8328                        	
 8329                        		.dbg	line,	"include\routines_LEVELS.c", 1835; player_counter_anim = 0;
 8330                        		__st.umiq	0, _player_counter_anim
         12:DB10  9C 18 23   			stz	_player_counter_anim
 8331                        	
 8332                        		.dbg	line,	"include\routines_LEVELS.c", 1836; }
 8333                        	
 8334                        		.dbg	line,	"include\routines_LEVELS.c", 1837; }
 8335    12:DB13             	.LL364	.alias		.LL365
 8336                        	
 8337                        		.dbg	line,	"include\routines_LEVELS.c", 1840; else if(player_state == STATE_CLIMB_UP)
 8338                        		__bra		.LL365
         12:DB13  4C A2 DF   			bra	.LL365
 8339    12:DB16             	.LL363:
 8340                        		__ld.umq	_player_state
         12:DB16  AD 15 23   			lda	_player_state
 8341                        		__equ_b.uiq	11
         12:DB19  C9 0B      			cmp	#11
         12:DB1B  F0 01      			beq	!+
         12:DB1D  18         			clc
         12:DB1E             	!:
 8342                        		__bfalse	.LL366
         12:DB1E  B0 03 4C 8F			bcc	.LL366
         12:DB22  DC          
 8343                        	
 8344                        		.dbg	line,	"include\routines_LEVELS.c", 1841; {
 8345                        	
 8346                        		.dbg	line,	"include\routines_LEVELS.c", 1842; if(player_counter_anim == 0)
 8347                        		__not.um	_player_counter_anim
         12:DB23  AD 18 23   			lda	_player_counter_anim
         12:DB26  18         			clc
         12:DB27  D0 01      			bne	!+
         12:DB29  38         			sec
         12:DB2A             	!:
 8348                        		__bfalse	.LL367
         12:DB2A  90 30      			bcc	.LL367
 8349                        	
 8350                        		.dbg	line,	"include\routines_LEVELS.c", 1843; {
 8351                        	
 8352                        		.dbg	line,	"include\routines_LEVELS.c", 1844; set_far_offset(OFFSET_PLAYER_CLIMB_1,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8353                        		__st.wmiq	5120, _bp
         12:DB2C  64 EC      			stz.l	_bp
         12:DB2E  A9 14      			lda.h	#5120
         12:DB30  85 ED      			sta.h	_bp
 8354                        		__ldx.umq	_player_naked
         12:DB32  AE 1B 23   			ldx	_player_naked
 8355                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DB35  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DB38  C2         			cly
 8356                        		__st.umq	_bp_bank
         12:DB39  85 02      			sta	_bp_bank
 8357                        		__ld2x.umq	_player_naked
         12:DB3B  AD 1B 23   			lda	_player_naked
         12:DB3E  0A         			asl	a
         12:DB3F  AA         			tax
 8358                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DB40  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DB43  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8359                        		__call		_set_far_offset.3
         12:DB46  20 8C E2   			call	_set_far_offset.3
 8360                        	
 8361                        		.dbg	line,	"include\routines_LEVELS.c", 1845; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8362                        		__st.wmiq	6144, _di
         12:DB49  64 F0      			stz.l	_di
         12:DB4B  A9 18      			lda.h	#6144
         12:DB4D  85 F1      			sta.h	_di
 8363                        		__st.wmiq	256, _ax
         12:DB4F  64 F8      			stz.l	_ax
         12:DB51  A9 01      			lda.h	#256
         12:DB53  85 F9      			sta.h	_ax
 8364                        		 _far_load_vram.2
         12:DB55  82         			clx				; Offset to PCE VDC.
         12:DB56  20 63 FF   			call	load_vram_x
 8365                        	
 8366                        		.dbg	line,	"include\routines_LEVELS.c", 1846; }
 8367                        	
 8368                        		.dbg	line,	"include\routines_LEVELS.c", 1848; else if(player_counter_anim == 3)
 8369                        		__bra		.LL368
         12:DB59  4C 79 DC   			bra	.LL368
 8370    12:DB5C             	.LL367:
 8371                        		__ld.umq	_player_counter_anim
         12:DB5C  AD 18 23   			lda	_player_counter_anim
 8372                        		__equ_b.uiq	3
         12:DB5F  C9 03      			cmp	#3
         12:DB61  F0 01      			beq	!+
         12:DB63  18         			clc
         12:DB64             	!:
 8373                        		__bfalse	.LL369
         12:DB64  90 30      			bcc	.LL369
 8374                        	
 8375                        		.dbg	line,	"include\routines_LEVELS.c", 1849; {
 8376                        	
 8377                        		.dbg	line,	"include\routines_LEVELS.c", 1850; set_far_offset(OFFSET_PLAYER_CLIMB_2,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8378                        		__st.wmiq	5632, _bp
         12:DB66  64 EC      			stz.l	_bp
         12:DB68  A9 16      			lda.h	#5632
         12:DB6A  85 ED      			sta.h	_bp
 8379                        		__ldx.umq	_player_naked
         12:DB6C  AE 1B 23   			ldx	_player_naked
 8380                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DB6F  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DB72  C2         			cly
 8381                        		__st.umq	_bp_bank
         12:DB73  85 02      			sta	_bp_bank
 8382                        		__ld2x.umq	_player_naked
         12:DB75  AD 1B 23   			lda	_player_naked
         12:DB78  0A         			asl	a
         12:DB79  AA         			tax
 8383                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DB7A  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DB7D  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8384                        		__call		_set_far_offset.3
         12:DB80  20 8C E2   			call	_set_far_offset.3
 8385                        	
 8386                        		.dbg	line,	"include\routines_LEVELS.c", 1851; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8387                        		__st.wmiq	6144, _di
         12:DB83  64 F0      			stz.l	_di
         12:DB85  A9 18      			lda.h	#6144
         12:DB87  85 F1      			sta.h	_di
 8388                        		__st.wmiq	256, _ax
         12:DB89  64 F8      			stz.l	_ax
         12:DB8B  A9 01      			lda.h	#256
         12:DB8D  85 F9      			sta.h	_ax
 8389                        		 _far_load_vram.2
         12:DB8F  82         			clx				; Offset to PCE VDC.
         12:DB90  20 63 FF   			call	load_vram_x
 8390                        	
 8391                        		.dbg	line,	"include\routines_LEVELS.c", 1852; }
 8392                        	
 8393                        		.dbg	line,	"include\routines_LEVELS.c", 1854; else if(player_counter_anim == 6)
 8394                        		__bra		.LL370
         12:DB93  4C 79 DC   			bra	.LL370
 8395    12:DB96             	.LL369:
 8396                        		__ld.umq	_player_counter_anim
         12:DB96  AD 18 23   			lda	_player_counter_anim
 8397                        		__equ_b.uiq	6
         12:DB99  C9 06      			cmp	#6
         12:DB9B  F0 01      			beq	!+
         12:DB9D  18         			clc
         12:DB9E             	!:
 8398                        		__bfalse	.LL371
         12:DB9E  90 30      			bcc	.LL371
 8399                        	
 8400                        		.dbg	line,	"include\routines_LEVELS.c", 1855; {
 8401                        	
 8402                        		.dbg	line,	"include\routines_LEVELS.c", 1856; set_far_offset(OFFSET_PLAYER_CLIMB_3,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8403                        		__st.wmiq	6144, _bp
         12:DBA0  64 EC      			stz.l	_bp
         12:DBA2  A9 18      			lda.h	#6144
         12:DBA4  85 ED      			sta.h	_bp
 8404                        		__ldx.umq	_player_naked
         12:DBA6  AE 1B 23   			ldx	_player_naked
 8405                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DBA9  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DBAC  C2         			cly
 8406                        		__st.umq	_bp_bank
         12:DBAD  85 02      			sta	_bp_bank
 8407                        		__ld2x.umq	_player_naked
         12:DBAF  AD 1B 23   			lda	_player_naked
         12:DBB2  0A         			asl	a
         12:DBB3  AA         			tax
 8408                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DBB4  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DBB7  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8409                        		__call		_set_far_offset.3
         12:DBBA  20 8C E2   			call	_set_far_offset.3
 8410                        	
 8411                        		.dbg	line,	"include\routines_LEVELS.c", 1857; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8412                        		__st.wmiq	6144, _di
         12:DBBD  64 F0      			stz.l	_di
         12:DBBF  A9 18      			lda.h	#6144
         12:DBC1  85 F1      			sta.h	_di
 8413                        		__st.wmiq	256, _ax
         12:DBC3  64 F8      			stz.l	_ax
         12:DBC5  A9 01      			lda.h	#256
         12:DBC7  85 F9      			sta.h	_ax
 8414                        		 _far_load_vram.2
         12:DBC9  82         			clx				; Offset to PCE VDC.
         12:DBCA  20 63 FF   			call	load_vram_x
 8415                        	
 8416                        		.dbg	line,	"include\routines_LEVELS.c", 1858; }
 8417                        	
 8418                        		.dbg	line,	"include\routines_LEVELS.c", 1860; else if(player_counter_anim == 9)
 8419                        		__bra		.LL372
         12:DBCD  4C 79 DC   			bra	.LL372
 8420    12:DBD0             	.LL371:
 8421                        		__ld.umq	_player_counter_anim
         12:DBD0  AD 18 23   			lda	_player_counter_anim
 8422                        		__equ_b.uiq	9
         12:DBD3  C9 09      			cmp	#9
         12:DBD5  F0 01      			beq	!+
         12:DBD7  18         			clc
         12:DBD8             	!:
 8423                        		__bfalse	.LL373
         12:DBD8  90 2F      			bcc	.LL373
 8424                        	
 8425                        		.dbg	line,	"include\routines_LEVELS.c", 1861; {
 8426                        	
 8427                        		.dbg	line,	"include\routines_LEVELS.c", 1862; set_far_offset(OFFSET_PLAYER_CLIMB_4,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8428                        		__st.wmiq	6656, _bp
         12:DBDA  64 EC      			stz.l	_bp
         12:DBDC  A9 1A      			lda.h	#6656
         12:DBDE  85 ED      			sta.h	_bp
 8429                        		__ldx.umq	_player_naked
         12:DBE0  AE 1B 23   			ldx	_player_naked
 8430                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DBE3  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DBE6  C2         			cly
 8431                        		__st.umq	_bp_bank
         12:DBE7  85 02      			sta	_bp_bank
 8432                        		__ld2x.umq	_player_naked
         12:DBE9  AD 1B 23   			lda	_player_naked
         12:DBEC  0A         			asl	a
         12:DBED  AA         			tax
 8433                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DBEE  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DBF1  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8434                        		__call		_set_far_offset.3
         12:DBF4  20 8C E2   			call	_set_far_offset.3
 8435                        	
 8436                        		.dbg	line,	"include\routines_LEVELS.c", 1863; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8437                        		__st.wmiq	6144, _di
         12:DBF7  64 F0      			stz.l	_di
         12:DBF9  A9 18      			lda.h	#6144
         12:DBFB  85 F1      			sta.h	_di
 8438                        		__st.wmiq	256, _ax
         12:DBFD  64 F8      			stz.l	_ax
         12:DBFF  A9 01      			lda.h	#256
         12:DC01  85 F9      			sta.h	_ax
 8439                        		 _far_load_vram.2
         12:DC03  82         			clx				; Offset to PCE VDC.
         12:DC04  20 63 FF   			call	load_vram_x
 8440                        	
 8441                        		.dbg	line,	"include\routines_LEVELS.c", 1864; }
 8442                        	
 8443                        		.dbg	line,	"include\routines_LEVELS.c", 1866; else if(player_counter_anim == 12)
 8444                        		__bra		.LL374
         12:DC07  80 70      			bra	.LL374
 8445    12:DC09             	.LL373:
 8446                        		__ld.umq	_player_counter_anim
         12:DC09  AD 18 23   			lda	_player_counter_anim
 8447                        		__equ_b.uiq	12
         12:DC0C  C9 0C      			cmp	#12
         12:DC0E  F0 01      			beq	!+
         12:DC10  18         			clc
         12:DC11             	!:
 8448                        		__bfalse	.LL375
         12:DC11  90 2F      			bcc	.LL375
 8449                        	
 8450                        		.dbg	line,	"include\routines_LEVELS.c", 1867; {
 8451                        	
 8452                        		.dbg	line,	"include\routines_LEVELS.c", 1868; set_far_offset(OFFSET_PLAYER_CLIMB_3,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8453                        		__st.wmiq	6144, _bp
         12:DC13  64 EC      			stz.l	_bp
         12:DC15  A9 18      			lda.h	#6144
         12:DC17  85 ED      			sta.h	_bp
 8454                        		__ldx.umq	_player_naked
         12:DC19  AE 1B 23   			ldx	_player_naked
 8455                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DC1C  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DC1F  C2         			cly
 8456                        		__st.umq	_bp_bank
         12:DC20  85 02      			sta	_bp_bank
 8457                        		__ld2x.umq	_player_naked
         12:DC22  AD 1B 23   			lda	_player_naked
         12:DC25  0A         			asl	a
         12:DC26  AA         			tax
 8458                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DC27  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DC2A  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8459                        		__call		_set_far_offset.3
         12:DC2D  20 8C E2   			call	_set_far_offset.3
 8460                        	
 8461                        		.dbg	line,	"include\routines_LEVELS.c", 1869; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8462                        		__st.wmiq	6144, _di
         12:DC30  64 F0      			stz.l	_di
         12:DC32  A9 18      			lda.h	#6144
         12:DC34  85 F1      			sta.h	_di
 8463                        		__st.wmiq	256, _ax
         12:DC36  64 F8      			stz.l	_ax
         12:DC38  A9 01      			lda.h	#256
         12:DC3A  85 F9      			sta.h	_ax
 8464                        		 _far_load_vram.2
         12:DC3C  82         			clx				; Offset to PCE VDC.
         12:DC3D  20 63 FF   			call	load_vram_x
 8465                        	
 8466                        		.dbg	line,	"include\routines_LEVELS.c", 1870; }
 8467                        	
 8468                        		.dbg	line,	"include\routines_LEVELS.c", 1872; else if(player_counter_anim == 15)
 8469                        		__bra		.LL376
         12:DC40  80 37      			bra	.LL376
 8470    12:DC42             	.LL375:
 8471                        		__ld.umq	_player_counter_anim
         12:DC42  AD 18 23   			lda	_player_counter_anim
 8472                        		__equ_b.uiq	15
         12:DC45  C9 0F      			cmp	#15
         12:DC47  F0 01      			beq	!+
         12:DC49  18         			clc
         12:DC4A             	!:
 8473                        		__bfalse	.LL377
         12:DC4A  90 2D      			bcc	.LL377
 8474                        	
 8475                        		.dbg	line,	"include\routines_LEVELS.c", 1873; {
 8476                        	
 8477                        		.dbg	line,	"include\routines_LEVELS.c", 1874; set_far_offset(OFFSET_PLAYER_CLIMB_2,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8478                        		__st.wmiq	5632, _bp
         12:DC4C  64 EC      			stz.l	_bp
         12:DC4E  A9 16      			lda.h	#5632
         12:DC50  85 ED      			sta.h	_bp
 8479                        		__ldx.umq	_player_naked
         12:DC52  AE 1B 23   			ldx	_player_naked
 8480                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DC55  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DC58  C2         			cly
 8481                        		__st.umq	_bp_bank
         12:DC59  85 02      			sta	_bp_bank
 8482                        		__ld2x.umq	_player_naked
         12:DC5B  AD 1B 23   			lda	_player_naked
         12:DC5E  0A         			asl	a
         12:DC5F  AA         			tax
 8483                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DC60  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DC63  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8484                        		__call		_set_far_offset.3
         12:DC66  20 8C E2   			call	_set_far_offset.3
 8485                        	
 8486                        		.dbg	line,	"include\routines_LEVELS.c", 1875; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8487                        		__st.wmiq	6144, _di
         12:DC69  64 F0      			stz.l	_di
         12:DC6B  A9 18      			lda.h	#6144
         12:DC6D  85 F1      			sta.h	_di
 8488                        		__st.wmiq	256, _ax
         12:DC6F  64 F8      			stz.l	_ax
         12:DC71  A9 01      			lda.h	#256
         12:DC73  85 F9      			sta.h	_ax
 8489                        		 _far_load_vram.2
         12:DC75  82         			clx				; Offset to PCE VDC.
         12:DC76  20 63 FF   			call	load_vram_x
 8490                        	
 8491                        		.dbg	line,	"include\routines_LEVELS.c", 1876; }
 8492                        	
 8493                        		.dbg	line,	"include\routines_LEVELS.c", 1879; player_counter_anim += 1;
 8494    12:DC79             	.LL377:
 8495    12:DC79             	.LL376:
 8496    12:DC79             	.LL374:
 8497    12:DC79             	.LL372:
 8498    12:DC79             	.LL370:
 8499    12:DC79             	.LL368:
 8500                        		__add_st.umiq	1, _player_counter_anim
         12:DC79  EE 18 23   			inc	_player_counter_anim
 8501                        	
 8502                        		.dbg	line,	"include\routines_LEVELS.c", 1881; if(player_counter_anim == 17)
 8503                        		__ld.umq	_player_counter_anim
         12:DC7C  AD 18 23   			lda	_player_counter_anim
 8504                        		__equ_b.uiq	17
         12:DC7F  C9 11      			cmp	#17
         12:DC81  F0 01      			beq	!+
         12:DC83  18         			clc
         12:DC84             	!:
 8505                        		__bfalse	.LL378
         12:DC84  90 03      			bcc	.LL378
 8506                        	
 8507                        		.dbg	line,	"include\routines_LEVELS.c", 1882; {
 8508                        	
 8509                        		.dbg	line,	"include\routines_LEVELS.c", 1883; player_counter_anim = 0;
 8510                        		__st.umiq	0, _player_counter_anim
         12:DC86  9C 18 23   			stz	_player_counter_anim
 8511                        	
 8512                        		.dbg	line,	"include\routines_LEVELS.c", 1884; }
 8513                        	
 8514                        		.dbg	line,	"include\routines_LEVELS.c", 1886; recenter_CAMERA();
 8515    12:DC89             	.LL378:
 8516                        		__call		_recenter_CAMERA
         12:DC89  20 59 FF   			call	_recenter_CAMERA
 8517                        	
 8518                        		.dbg	line,	"include\routines_LEVELS.c", 1887; }
 8519                        	
 8520                        		.dbg	line,	"include\routines_LEVELS.c", 1890; else if(player_state == STATE_CLIMB_DOWN)
 8521                        		__bra		.LL379
         12:DC8C  4C A2 DF   			bra	.LL379
 8522    12:DC8F             	.LL366:
 8523                        		__ld.umq	_player_state
         12:DC8F  AD 15 23   			lda	_player_state
 8524                        		__equ_b.uiq	12
         12:DC92  C9 0C      			cmp	#12
         12:DC94  F0 01      			beq	!+
         12:DC96  18         			clc
         12:DC97             	!:
 8525                        		__bfalse	.LL380
         12:DC97  B0 03 4C 08			bcc	.LL380
         12:DC9B  DE          
 8526                        	
 8527                        		.dbg	line,	"include\routines_LEVELS.c", 1891; {
 8528                        	
 8529                        		.dbg	line,	"include\routines_LEVELS.c", 1892; if(player_counter_anim == 0)
 8530                        		__not.um	_player_counter_anim
         12:DC9C  AD 18 23   			lda	_player_counter_anim
         12:DC9F  18         			clc
         12:DCA0  D0 01      			bne	!+
         12:DCA2  38         			sec
         12:DCA3             	!:
 8531                        		__bfalse	.LL381
         12:DCA3  90 30      			bcc	.LL381
 8532                        	
 8533                        		.dbg	line,	"include\routines_LEVELS.c", 1893; {
 8534                        	
 8535                        		.dbg	line,	"include\routines_LEVELS.c", 1894; set_far_offset(OFFSET_PLAYER_CLIMB_2,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8536                        		__st.wmiq	5632, _bp
         12:DCA5  64 EC      			stz.l	_bp
         12:DCA7  A9 16      			lda.h	#5632
         12:DCA9  85 ED      			sta.h	_bp
 8537                        		__ldx.umq	_player_naked
         12:DCAB  AE 1B 23   			ldx	_player_naked
 8538                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DCAE  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DCB1  C2         			cly
 8539                        		__st.umq	_bp_bank
         12:DCB2  85 02      			sta	_bp_bank
 8540                        		__ld2x.umq	_player_naked
         12:DCB4  AD 1B 23   			lda	_player_naked
         12:DCB7  0A         			asl	a
         12:DCB8  AA         			tax
 8541                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DCB9  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DCBC  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8542                        		__call		_set_far_offset.3
         12:DCBF  20 8C E2   			call	_set_far_offset.3
 8543                        	
 8544                        		.dbg	line,	"include\routines_LEVELS.c", 1895; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8545                        		__st.wmiq	6144, _di
         12:DCC2  64 F0      			stz.l	_di
         12:DCC4  A9 18      			lda.h	#6144
         12:DCC6  85 F1      			sta.h	_di
 8546                        		__st.wmiq	256, _ax
         12:DCC8  64 F8      			stz.l	_ax
         12:DCCA  A9 01      			lda.h	#256
         12:DCCC  85 F9      			sta.h	_ax
 8547                        		 _far_load_vram.2
         12:DCCE  82         			clx				; Offset to PCE VDC.
         12:DCCF  20 63 FF   			call	load_vram_x
 8548                        	
 8549                        		.dbg	line,	"include\routines_LEVELS.c", 1896; }
 8550                        	
 8551                        		.dbg	line,	"include\routines_LEVELS.c", 1898; else if(player_counter_anim == 3)
 8552                        		__bra		.LL382
         12:DCD2  4C F2 DD   			bra	.LL382
 8553    12:DCD5             	.LL381:
 8554                        		__ld.umq	_player_counter_anim
         12:DCD5  AD 18 23   			lda	_player_counter_anim
 8555                        		__equ_b.uiq	3
         12:DCD8  C9 03      			cmp	#3
         12:DCDA  F0 01      			beq	!+
         12:DCDC  18         			clc
         12:DCDD             	!:
 8556                        		__bfalse	.LL383
         12:DCDD  90 30      			bcc	.LL383
 8557                        	
 8558                        		.dbg	line,	"include\routines_LEVELS.c", 1899; {
 8559                        	
 8560                        		.dbg	line,	"include\routines_LEVELS.c", 1900; set_far_offset(OFFSET_PLAYER_CLIMB_3,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8561                        		__st.wmiq	6144, _bp
         12:DCDF  64 EC      			stz.l	_bp
         12:DCE1  A9 18      			lda.h	#6144
         12:DCE3  85 ED      			sta.h	_bp
 8562                        		__ldx.umq	_player_naked
         12:DCE5  AE 1B 23   			ldx	_player_naked
 8563                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DCE8  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DCEB  C2         			cly
 8564                        		__st.umq	_bp_bank
         12:DCEC  85 02      			sta	_bp_bank
 8565                        		__ld2x.umq	_player_naked
         12:DCEE  AD 1B 23   			lda	_player_naked
         12:DCF1  0A         			asl	a
         12:DCF2  AA         			tax
 8566                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DCF3  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DCF6  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8567                        		__call		_set_far_offset.3
         12:DCF9  20 8C E2   			call	_set_far_offset.3
 8568                        	
 8569                        		.dbg	line,	"include\routines_LEVELS.c", 1901; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8570                        		__st.wmiq	6144, _di
         12:DCFC  64 F0      			stz.l	_di
         12:DCFE  A9 18      			lda.h	#6144
         12:DD00  85 F1      			sta.h	_di
 8571                        		__st.wmiq	256, _ax
         12:DD02  64 F8      			stz.l	_ax
         12:DD04  A9 01      			lda.h	#256
         12:DD06  85 F9      			sta.h	_ax
 8572                        		 _far_load_vram.2
         12:DD08  82         			clx				; Offset to PCE VDC.
         12:DD09  20 63 FF   			call	load_vram_x
 8573                        	
 8574                        		.dbg	line,	"include\routines_LEVELS.c", 1902; }
 8575                        	
 8576                        		.dbg	line,	"include\routines_LEVELS.c", 1904; else if(player_counter_anim == 6)
 8577                        		__bra		.LL384
         12:DD0C  4C F2 DD   			bra	.LL384
 8578    12:DD0F             	.LL383:
 8579                        		__ld.umq	_player_counter_anim
         12:DD0F  AD 18 23   			lda	_player_counter_anim
 8580                        		__equ_b.uiq	6
         12:DD12  C9 06      			cmp	#6
         12:DD14  F0 01      			beq	!+
         12:DD16  18         			clc
         12:DD17             	!:
 8581                        		__bfalse	.LL385
         12:DD17  90 30      			bcc	.LL385
 8582                        	
 8583                        		.dbg	line,	"include\routines_LEVELS.c", 1905; {
 8584                        	
 8585                        		.dbg	line,	"include\routines_LEVELS.c", 1906; set_far_offset(OFFSET_PLAYER_CLIMB_4,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8586                        		__st.wmiq	6656, _bp
         12:DD19  64 EC      			stz.l	_bp
         12:DD1B  A9 1A      			lda.h	#6656
         12:DD1D  85 ED      			sta.h	_bp
 8587                        		__ldx.umq	_player_naked
         12:DD1F  AE 1B 23   			ldx	_player_naked
 8588                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DD22  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DD25  C2         			cly
 8589                        		__st.umq	_bp_bank
         12:DD26  85 02      			sta	_bp_bank
 8590                        		__ld2x.umq	_player_naked
         12:DD28  AD 1B 23   			lda	_player_naked
         12:DD2B  0A         			asl	a
         12:DD2C  AA         			tax
 8591                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DD2D  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DD30  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8592                        		__call		_set_far_offset.3
         12:DD33  20 8C E2   			call	_set_far_offset.3
 8593                        	
 8594                        		.dbg	line,	"include\routines_LEVELS.c", 1907; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8595                        		__st.wmiq	6144, _di
         12:DD36  64 F0      			stz.l	_di
         12:DD38  A9 18      			lda.h	#6144
         12:DD3A  85 F1      			sta.h	_di
 8596                        		__st.wmiq	256, _ax
         12:DD3C  64 F8      			stz.l	_ax
         12:DD3E  A9 01      			lda.h	#256
         12:DD40  85 F9      			sta.h	_ax
 8597                        		 _far_load_vram.2
         12:DD42  82         			clx				; Offset to PCE VDC.
         12:DD43  20 63 FF   			call	load_vram_x
 8598                        	
 8599                        		.dbg	line,	"include\routines_LEVELS.c", 1908; }
 8600                        	
 8601                        		.dbg	line,	"include\routines_LEVELS.c", 1910; else if(player_counter_anim == 9)
 8602                        		__bra		.LL386
         12:DD46  4C F2 DD   			bra	.LL386
 8603    12:DD49             	.LL385:
 8604                        		__ld.umq	_player_counter_anim
         12:DD49  AD 18 23   			lda	_player_counter_anim
 8605                        		__equ_b.uiq	9
         12:DD4C  C9 09      			cmp	#9
         12:DD4E  F0 01      			beq	!+
         12:DD50  18         			clc
         12:DD51             	!:
 8606                        		__bfalse	.LL387
         12:DD51  90 2F      			bcc	.LL387
 8607                        	
 8608                        		.dbg	line,	"include\routines_LEVELS.c", 1911; {
 8609                        	
 8610                        		.dbg	line,	"include\routines_LEVELS.c", 1912; set_far_offset(OFFSET_PLAYER_CLIMB_3,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8611                        		__st.wmiq	6144, _bp
         12:DD53  64 EC      			stz.l	_bp
         12:DD55  A9 18      			lda.h	#6144
         12:DD57  85 ED      			sta.h	_bp
 8612                        		__ldx.umq	_player_naked
         12:DD59  AE 1B 23   			ldx	_player_naked
 8613                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DD5C  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DD5F  C2         			cly
 8614                        		__st.umq	_bp_bank
         12:DD60  85 02      			sta	_bp_bank
 8615                        		__ld2x.umq	_player_naked
         12:DD62  AD 1B 23   			lda	_player_naked
         12:DD65  0A         			asl	a
         12:DD66  AA         			tax
 8616                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DD67  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DD6A  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8617                        		__call		_set_far_offset.3
         12:DD6D  20 8C E2   			call	_set_far_offset.3
 8618                        	
 8619                        		.dbg	line,	"include\routines_LEVELS.c", 1913; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8620                        		__st.wmiq	6144, _di
         12:DD70  64 F0      			stz.l	_di
         12:DD72  A9 18      			lda.h	#6144
         12:DD74  85 F1      			sta.h	_di
 8621                        		__st.wmiq	256, _ax
         12:DD76  64 F8      			stz.l	_ax
         12:DD78  A9 01      			lda.h	#256
         12:DD7A  85 F9      			sta.h	_ax
 8622                        		 _far_load_vram.2
         12:DD7C  82         			clx				; Offset to PCE VDC.
         12:DD7D  20 63 FF   			call	load_vram_x
 8623                        	
 8624                        		.dbg	line,	"include\routines_LEVELS.c", 1914; }
 8625                        	
 8626                        		.dbg	line,	"include\routines_LEVELS.c", 1916; else if(player_counter_anim == 12)
 8627                        		__bra		.LL388
         12:DD80  80 70      			bra	.LL388
 8628    12:DD82             	.LL387:
 8629                        		__ld.umq	_player_counter_anim
         12:DD82  AD 18 23   			lda	_player_counter_anim
 8630                        		__equ_b.uiq	12
         12:DD85  C9 0C      			cmp	#12
         12:DD87  F0 01      			beq	!+
         12:DD89  18         			clc
         12:DD8A             	!:
 8631                        		__bfalse	.LL389
         12:DD8A  90 2F      			bcc	.LL389
 8632                        	
 8633                        		.dbg	line,	"include\routines_LEVELS.c", 1917; {
 8634                        	
 8635                        		.dbg	line,	"include\routines_LEVELS.c", 1918; set_far_offset(OFFSET_PLAYER_CLIMB_2,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8636                        		__st.wmiq	5632, _bp
         12:DD8C  64 EC      			stz.l	_bp
         12:DD8E  A9 16      			lda.h	#5632
         12:DD90  85 ED      			sta.h	_bp
 8637                        		__ldx.umq	_player_naked
         12:DD92  AE 1B 23   			ldx	_player_naked
 8638                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DD95  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DD98  C2         			cly
 8639                        		__st.umq	_bp_bank
         12:DD99  85 02      			sta	_bp_bank
 8640                        		__ld2x.umq	_player_naked
         12:DD9B  AD 1B 23   			lda	_player_naked
         12:DD9E  0A         			asl	a
         12:DD9F  AA         			tax
 8641                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DDA0  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DDA3  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8642                        		__call		_set_far_offset.3
         12:DDA6  20 8C E2   			call	_set_far_offset.3
 8643                        	
 8644                        		.dbg	line,	"include\routines_LEVELS.c", 1919; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8645                        		__st.wmiq	6144, _di
         12:DDA9  64 F0      			stz.l	_di
         12:DDAB  A9 18      			lda.h	#6144
         12:DDAD  85 F1      			sta.h	_di
 8646                        		__st.wmiq	256, _ax
         12:DDAF  64 F8      			stz.l	_ax
         12:DDB1  A9 01      			lda.h	#256
         12:DDB3  85 F9      			sta.h	_ax
 8647                        		 _far_load_vram.2
         12:DDB5  82         			clx				; Offset to PCE VDC.
         12:DDB6  20 63 FF   			call	load_vram_x
 8648                        	
 8649                        		.dbg	line,	"include\routines_LEVELS.c", 1920; }
 8650                        	
 8651                        		.dbg	line,	"include\routines_LEVELS.c", 1922; else if(player_counter_anim == 15)
 8652                        		__bra		.LL390
         12:DDB9  80 37      			bra	.LL390
 8653    12:DDBB             	.LL389:
 8654                        		__ld.umq	_player_counter_anim
         12:DDBB  AD 18 23   			lda	_player_counter_anim
 8655                        		__equ_b.uiq	15
         12:DDBE  C9 0F      			cmp	#15
         12:DDC0  F0 01      			beq	!+
         12:DDC2  18         			clc
         12:DDC3             	!:
 8656                        		__bfalse	.LL391
         12:DDC3  90 2D      			bcc	.LL391
 8657                        	
 8658                        		.dbg	line,	"include\routines_LEVELS.c", 1923; {
 8659                        	
 8660                        		.dbg	line,	"include\routines_LEVELS.c", 1924; set_far_offset(OFFSET_PLAYER_CLIMB_1,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8661                        		__st.wmiq	5120, _bp
         12:DDC5  64 EC      			stz.l	_bp
         12:DDC7  A9 14      			lda.h	#5120
         12:DDC9  85 ED      			sta.h	_bp
 8662                        		__ldx.umq	_player_naked
         12:DDCB  AE 1B 23   			ldx	_player_naked
 8663                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DDCE  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DDD1  C2         			cly
 8664                        		__st.umq	_bp_bank
         12:DDD2  85 02      			sta	_bp_bank
 8665                        		__ld2x.umq	_player_naked
         12:DDD4  AD 1B 23   			lda	_player_naked
         12:DDD7  0A         			asl	a
         12:DDD8  AA         			tax
 8666                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DDD9  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DDDC  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8667                        		__call		_set_far_offset.3
         12:DDDF  20 8C E2   			call	_set_far_offset.3
 8668                        	
 8669                        		.dbg	line,	"include\routines_LEVELS.c", 1925; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8670                        		__st.wmiq	6144, _di
         12:DDE2  64 F0      			stz.l	_di
         12:DDE4  A9 18      			lda.h	#6144
         12:DDE6  85 F1      			sta.h	_di
 8671                        		__st.wmiq	256, _ax
         12:DDE8  64 F8      			stz.l	_ax
         12:DDEA  A9 01      			lda.h	#256
         12:DDEC  85 F9      			sta.h	_ax
 8672                        		 _far_load_vram.2
         12:DDEE  82         			clx				; Offset to PCE VDC.
         12:DDEF  20 63 FF   			call	load_vram_x
 8673                        	
 8674                        		.dbg	line,	"include\routines_LEVELS.c", 1926; }
 8675                        	
 8676                        		.dbg	line,	"include\routines_LEVELS.c", 1929; player_counter_anim += 1;
 8677    12:DDF2             	.LL391:
 8678    12:DDF2             	.LL390:
 8679    12:DDF2             	.LL388:
 8680    12:DDF2             	.LL386:
 8681    12:DDF2             	.LL384:
 8682    12:DDF2             	.LL382:
 8683                        		__add_st.umiq	1, _player_counter_anim
         12:DDF2  EE 18 23   			inc	_player_counter_anim
 8684                        	
 8685                        		.dbg	line,	"include\routines_LEVELS.c", 1931; if(player_counter_anim == 17)
 8686                        		__ld.umq	_player_counter_anim
         12:DDF5  AD 18 23   			lda	_player_counter_anim
 8687                        		__equ_b.uiq	17
         12:DDF8  C9 11      			cmp	#17
         12:DDFA  F0 01      			beq	!+
         12:DDFC  18         			clc
         12:DDFD             	!:
 8688                        		__bfalse	.LL392
         12:DDFD  90 03      			bcc	.LL392
 8689                        	
 8690                        		.dbg	line,	"include\routines_LEVELS.c", 1932; {
 8691                        	
 8692                        		.dbg	line,	"include\routines_LEVELS.c", 1933; player_counter_anim = 0;
 8693                        		__st.umiq	0, _player_counter_anim
         12:DDFF  9C 18 23   			stz	_player_counter_anim
 8694                        	
 8695                        		.dbg	line,	"include\routines_LEVELS.c", 1934; }
 8696                        	
 8697                        		.dbg	line,	"include\routines_LEVELS.c", 1936; recenter_CAMERA();
 8698    12:DE02             	.LL392:
 8699                        		__call		_recenter_CAMERA
         12:DE02  20 59 FF   			call	_recenter_CAMERA
 8700                        	
 8701                        		.dbg	line,	"include\routines_LEVELS.c", 1937; }
 8702                        	
 8703                        		.dbg	line,	"include\routines_LEVELS.c", 1940; else if(player_state == STATE_JUMP_LADDER)
 8704                        		__bra		.LL393
         12:DE05  4C A2 DF   			bra	.LL393
 8705    12:DE08             	.LL380:
 8706                        		__ld.umq	_player_state
         12:DE08  AD 15 23   			lda	_player_state
 8707                        		__equ_b.uiq	13
         12:DE0B  C9 0D      			cmp	#13
         12:DE0D  F0 01      			beq	!+
         12:DE0F  18         			clc
         12:DE10             	!:
 8708                        		__bfalse	.LL394
         12:DE10  B0 03 4C A2			bcc	.LL394
         12:DE14  DF          
 8709                        	
 8710                        		.dbg	line,	"include\routines_LEVELS.c", 1941; {
 8711                        	
 8712                        		.dbg	line,	"include\routines_LEVELS.c", 1942; unsigned char i;
 8713                        	
 8714                        		.dbg	line,	"include\routines_LEVELS.c", 1943; i = 1;
 8715                        		__st.umiq	1, __update_PLAYER_end - 8  /* i */
         12:DE15  A9 01      			lda.l	#1
         12:DE17  8D 05 23   			sta	__update_PLAYER_end - 8
 8716                        	
 8717                        		.dbg	line,	"include\routines_LEVELS.c", 1946; if(player_counter_anim == 0)
 8718                        		__not.um	_player_counter_anim
         12:DE1A  AD 18 23   			lda	_player_counter_anim
         12:DE1D  18         			clc
         12:DE1E  D0 01      			bne	!+
         12:DE20  38         			sec
         12:DE21             	!:
 8719                        		__bfalse	.LL395
         12:DE21  90 32      			bcc	.LL395
 8720                        	
 8721                        		.dbg	line,	"include\routines_LEVELS.c", 1947; {
 8722                        	
 8723                        		.dbg	line,	"include\routines_LEVELS.c", 1948; set_far_offset(OFFSET_PLAYER_JUMP,TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
 8724                        		__st.wmiq	3584, _bp
         12:DE23  64 EC      			stz.l	_bp
         12:DE25  A9 0E      			lda.h	#3584
         12:DE27  85 ED      			sta.h	_bp
 8725                        		__ldx.umq	_player_naked
         12:DE29  AE 1B 23   			ldx	_player_naked
 8726                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         12:DE2C  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         12:DE2F  C2         			cly
 8727                        		__st.umq	_bp_bank
         12:DE30  85 02      			sta	_bp_bank
 8728                        		__ld2x.umq	_player_naked
         12:DE32  AD 1B 23   			lda	_player_naked
         12:DE35  0A         			asl	a
         12:DE36  AA         			tax
 8729                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         12:DE37  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         12:DE3A  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
 8730                        		__call		_set_far_offset.3
         12:DE3D  20 8C E2   			call	_set_far_offset.3
 8731                        	
 8732                        		.dbg	line,	"include\routines_LEVELS.c", 1949; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
 8733                        		__st.wmiq	6144, _di
         12:DE40  64 F0      			stz.l	_di
         12:DE42  A9 18      			lda.h	#6144
         12:DE44  85 F1      			sta.h	_di
 8734                        		__st.wmiq	256, _ax
         12:DE46  64 F8      			stz.l	_ax
         12:DE48  A9 01      			lda.h	#256
         12:DE4A  85 F9      			sta.h	_ax
 8735                        		 _far_load_vram.2
         12:DE4C  82         			clx				; Offset to PCE VDC.
         12:DE4D  20 63 FF   			call	load_vram_x
 8736                        	
 8737                        		.dbg	line,	"include\routines_LEVELS.c", 1951; player_counter_anim = 1;
 8738                        		__st.umiq	1, _player_counter_anim
         12:DE50  A9 01      			lda.l	#1
         12:DE52  8D 18 23   			sta	_player_counter_anim
 8739                        	
 8740                        		.dbg	line,	"include\routines_LEVELS.c", 1952; }
 8741                        	
 8742                        		.dbg	line,	"include\routines_LEVELS.c", 1955; player_pos_y += TABLE_PLAYER_JUMP_V[player_index_jump];
 8743    12:DE55             	.LL395:
 8744                        		__ldx.umq	_player_index_jump
         12:DE55  AE 19 23   			ldx	_player_index_jump
 8745                        		__ld.bax	_TABLE_PLAYER_JUMP_V
         12:DE58  BD F9 60   			lda	_TABLE_PLAYER_JUMP_V, x
         12:DE5B  C2         			cly
         12:DE5C  10 01      			bpl	!+
         12:DE5E  88         			dey
         12:DE5F             	!:
 8746                        		__add_st.wmq	_player_pos_y
         12:DE5F  18         			clc
         12:DE60  6D D0 24   			adc.l	_player_pos_y
         12:DE63  8D D0 24   			sta.l	_player_pos_y
         12:DE66  98         			tya
         12:DE67  6D D1 24   			adc.h	_player_pos_y
         12:DE6A  8D D1 24   			sta.h	_player_pos_y
 8747                        	
 8748                        		.dbg	line,	"include\routines_LEVELS.c", 1957; // CHECK COLLISION WITH CEILING //
 8749                        	
 8750                        		.dbg	line,	"include\routines_LEVELS.c", 1958; check_BG( 15 , 8 );
 8751                        		__ld.wi		15
         12:DE6D  A9 0F      			lda.l	#15
         12:DE6F  C2         			cly
 8752                        		__pusharg.wr
         12:DE70  A6 8D      			ldx	<__sp
         12:DE72  CA         			dex
         12:DE73  CA         			dex
         12:DE74  95 08      			sta.l	<__stack, x
         12:DE76  94 09      			sty.h	<__stack, x
         12:DE78  86 8D      			stx	<__sp
 8753                        		__ld.wi		8
         12:DE7A  A9 08      			lda.l	#8
         12:DE7C  C2         			cly
 8754                        		__pusharg.wr
         12:DE7D  A6 8D      			ldx	<__sp
         12:DE7F  CA         			dex
         12:DE80  CA         			dex
         12:DE81  95 08      			sta.l	<__stack, x
         12:DE83  94 09      			sty.h	<__stack, x
         12:DE85  86 8D      			stx	<__sp
 8755                        		__call		_check_BG
         12:DE87  20 6D FF   			call	_check_BG
 8756                        	
 8757                        		.dbg	line,	"include\routines_LEVELS.c", 1960; if(map_blk_flag == TILE_BG)
 8758                        		__ld.umq	_map_blk_flag
         12:DE8A  AD AB 2B   			lda	_map_blk_flag
 8759                        		__equ_b.uiq	1
         12:DE8D  C9 01      			cmp	#1
         12:DE8F  F0 01      			beq	!+
         12:DE91  18         			clc
         12:DE92             	!:
 8760                        		__bfalse	.LL396
         12:DE92  90 5A      			bcc	.LL396
 8761                        	
 8762                        		.dbg	line,	"include\routines_LEVELS.c", 1961; {
 8763                        	
 8764                        		.dbg	line,	"include\routines_LEVELS.c", 1962; for(i=1 ; i<8 ; i++)
 8765                        		__st.umiq	1, __update_PLAYER_end - 8  /* i */
         12:DE94  A9 01      			lda.l	#1
         12:DE96  8D 05 23   			sta	__update_PLAYER_end - 8
 8766    12:DE99             	.LL397:
 8767                        		__ld.umq	__update_PLAYER_end - 8  /* i */
         12:DE99  AD 05 23   			lda	__update_PLAYER_end - 8
 8768                        		__ult_b.uiq	8
         12:DE9C  C9 08      			cmp	#8		; Subtract integer from A.
         12:DE9E  6A         			ror	a		; CC if A < integer.
         12:DE9F  49 80      			eor	#$80
         12:DEA1  2A         			rol	a
 8769                        		__btrue		.LL399
         12:DEA2  B0 07      			bcs	.LL399
 8770                        		__bra		.LL400
         12:DEA4  80 48      			bra	.LL400
 8771    12:DEA6             	.LL398:
 8772                        		__inc.umq	__update_PLAYER_end - 8  /* i */
         12:DEA6  EE 05 23   			inc	__update_PLAYER_end - 8
 8773                        		__bra		.LL397
         12:DEA9  80 EE      			bra	.LL397
 8774    12:DEAB             	.LL399:
 8775                        	
 8776                        		.dbg	line,	"include\routines_LEVELS.c", 1963; {
 8777                        	
 8778                        		.dbg	line,	"include\routines_LEVELS.c", 1964; check_BG( 15 , 8 + i );
 8779                        		__ld.wi		15
         12:DEAB  A9 0F      			lda.l	#15
         12:DEAD  C2         			cly
 8780                        		__pusharg.wr
         12:DEAE  A6 8D      			ldx	<__sp
         12:DEB0  CA         			dex
         12:DEB1  CA         			dex
         12:DEB2  95 08      			sta.l	<__stack, x
         12:DEB4  94 09      			sty.h	<__stack, x
         12:DEB6  86 8D      			stx	<__sp
 8781                        		__ld.wi		8
         12:DEB8  A9 08      			lda.l	#8
         12:DEBA  C2         			cly
 8782                        		__add.um	__update_PLAYER_end - 8  /* i */
         12:DEBB  18         			clc
         12:DEBC  6D 05 23   			adc	__update_PLAYER_end - 8
         12:DEBF  90 01      			bcc	!+
         12:DEC1  C8         			iny
         12:DEC2             	!:
 8783                        		__pusharg.wr
         12:DEC2  A6 8D      			ldx	<__sp
         12:DEC4  CA         			dex
         12:DEC5  CA         			dex
         12:DEC6  95 08      			sta.l	<__stack, x
         12:DEC8  94 09      			sty.h	<__stack, x
         12:DECA  86 8D      			stx	<__sp
 8784                        		__call		_check_BG
         12:DECC  20 6D FF   			call	_check_BG
 8785                        	
 8786                        		.dbg	line,	"include\routines_LEVELS.c", 1965; {
 8787                        	
 8788                        		.dbg	line,	"include\routines_LEVELS.c", 1966; if(map_blk_flag == TILE_EMPTY)
 8789                        		__not.um	_map_blk_flag
         12:DECF  AD AB 2B   			lda	_map_blk_flag
         12:DED2  18         			clc
         12:DED3  D0 01      			bne	!+
         12:DED5  38         			sec
         12:DED6             	!:
 8790                        		__bfalse	.LL401
         12:DED6  90 CE      			bcc	.LL401
 8791                        	
 8792                        		.dbg	line,	"include\routines_LEVELS.c", 1967; {
 8793                        	
 8794                        		.dbg	line,	"include\routines_LEVELS.c", 1968; player_pos_y += i;
 8795                        		__ld.um		__update_PLAYER_end - 8  /* i */
         12:DED8  AD 05 23   			lda	__update_PLAYER_end - 8
         12:DEDB  C2         			cly
 8796                        		__add_st.wmq	_player_pos_y
         12:DEDC  18         			clc
         12:DEDD  6D D0 24   			adc.l	_player_pos_y
         12:DEE0  8D D0 24   			sta.l	_player_pos_y
         12:DEE3  98         			tya
         12:DEE4  6D D1 24   			adc.h	_player_pos_y
         12:DEE7  8D D1 24   			sta.h	_player_pos_y
 8797                        	
 8798                        		.dbg	line,	"include\routines_LEVELS.c", 1969; break;
 8799                        		__bra		.LL400
         12:DEEA  80 02      			bra	.LL400
 8800                        	
 8801                        		.dbg	line,	"include\routines_LEVELS.c", 1970; }
 8802                        	
 8803                        		.dbg	line,	"include\routines_LEVELS.c", 1971; }
 8804    12:DEEC             	.LL401	.alias		.LL398
 8805                        	
 8806                        		.dbg	line,	"include\routines_LEVELS.c", 1972; }
 8807                        		__bra		.LL398
         12:DEEC  80 B8      			bra	.LL398
 8808    12:DEEE             	.LL400:
 8809                        	
 8810                        		.dbg	line,	"include\routines_LEVELS.c", 1973; }
 8811                        	
 8812                        		.dbg	line,	"include\routines_LEVELS.c", 1975; spr_set(player_id);
 8813    12:DEEE             	.LL396:
 8814                        		__ld.umq	_player_id
         12:DEEE  AD 14 23   			lda	_player_id
 8815                        		__call		_spr_set.1
         12:DEF1  20 DD E7   			call	_spr_set.1
 8816                        	
 8817                        		.dbg	line,	"include\routines_LEVELS.c", 1976; spr_y(player_pos_y);
 8818                        		__ld.wm		_player_pos_y
         12:DEF4  AD D0 24   			lda.l	_player_pos_y
         12:DEF7  AC D1 24   			ldy.h	_player_pos_y
 8819                        		__call		_spr_y.1
         12:DEFA  20 19 E8   			call	_spr_y.1
 8820                        	
 8821                        		.dbg	line,	"include\routines_LEVELS.c", 1980; if(player_index_jump < 34)
 8822                        		__ld.umq	_player_index_jump
         12:DEFD  AD 19 23   			lda	_player_index_jump
 8823                        		__ult_b.uiq	34
         12:DF00  C9 22      			cmp	#34		; Subtract integer from A.
         12:DF02  6A         			ror	a		; CC if A < integer.
         12:DF03  49 80      			eor	#$80
         12:DF05  2A         			rol	a
 8824                        		__bfalse	.LL402
         12:DF06  90 03      			bcc	.LL402
 8825                        	
 8826                        		.dbg	line,	"include\routines_LEVELS.c", 1981; {
 8827                        	
 8828                        		.dbg	line,	"include\routines_LEVELS.c", 1982; player_index_jump += 1;
 8829                        		__add_st.umiq	1, _player_index_jump
         12:DF08  EE 19 23   			inc	_player_index_jump
 8830                        	
 8831                        		.dbg	line,	"include\routines_LEVELS.c", 1983; }
 8832                        	
 8833                        		.dbg	line,	"include\routines_LEVELS.c", 1988; //--------------------------------------------------------------------------------------//
 8834                        	
 8835                        		.dbg	line,	"include\routines_LEVELS.c", 1989; //                                   LADDER COLLISION                                   //
 8836                        	
 8837                        		.dbg	line,	"include\routines_LEVELS.c", 1990; //--------------------------------------------------------------------------------------//
 8838                        	
 8839                        		.dbg	line,	"include\routines_LEVELS.c", 1992; if(player_index_jump > 18)
 8840    12:DF0B             	.LL402:
 8841                        		__ld.umq	_player_index_jump
         12:DF0B  AD 19 23   			lda	_player_index_jump
 8842                        		__ugt_b.uiq	18
         12:DF0E  18         			clc			; Subtract integer+1 from A.
         12:DF0F  E9 12      			sbc	#18		; CS if A > integer.
 8843                        		__bfalse	.LL403
         12:DF11  B0 03 4C A2			bcc	.LL403
         12:DF15  DF          
 8844                        	
 8845                        		.dbg	line,	"include\routines_LEVELS.c", 1993; {
 8846                        	
 8847                        		.dbg	line,	"include\routines_LEVELS.c", 1994; // CHECK COLLISION WITH LADDERS //
 8848                        	
 8849                        		.dbg	line,	"include\routines_LEVELS.c", 1995; check_BG( 16 , 8 );
 8850                        		__ld.wi		16
         12:DF16  A9 10      			lda.l	#16
         12:DF18  C2         			cly
 8851                        		__pusharg.wr
         12:DF19  A6 8D      			ldx	<__sp
         12:DF1B  CA         			dex
         12:DF1C  CA         			dex
         12:DF1D  95 08      			sta.l	<__stack, x
         12:DF1F  94 09      			sty.h	<__stack, x
         12:DF21  86 8D      			stx	<__sp
 8852                        		__ld.wi		8
         12:DF23  A9 08      			lda.l	#8
         12:DF25  C2         			cly
 8853                        		__pusharg.wr
         12:DF26  A6 8D      			ldx	<__sp
         12:DF28  CA         			dex
         12:DF29  CA         			dex
         12:DF2A  95 08      			sta.l	<__stack, x
         12:DF2C  94 09      			sty.h	<__stack, x
         12:DF2E  86 8D      			stx	<__sp
 8854                        		__call		_check_BG
         12:DF30  20 6D FF   			call	_check_BG
 8855                        	
 8856                        		.dbg	line,	"include\routines_LEVELS.c", 1997; // IF PLAYER HITS THE LADDER //
 8857                        	
 8858                        		.dbg	line,	"include\routines_LEVELS.c", 1998; if(map_blk_flag == TILE_LADDER)
 8859                        		__ld.umq	_map_blk_flag
         12:DF33  AD AB 2B   			lda	_map_blk_flag
 8860                        		__equ_b.uiq	2
         12:DF36  C9 02      			cmp	#2
         12:DF38  F0 01      			beq	!+
         12:DF3A  18         			clc
         12:DF3B             	!:
 8861                        		__bfalse	.LL404
         12:DF3B  90 65      			bcc	.LL404
 8862                        	
 8863                        		.dbg	line,	"include\routines_LEVELS.c", 1999; {
 8864                        	
 8865                        		.dbg	line,	"include\routines_LEVELS.c", 2000; // CAMERA GOES 8 PX BACKWARD //
 8866                        	
 8867                        		.dbg	line,	"include\routines_LEVELS.c", 2001; sgx_map_pxl_x = ( (sgx_map_pxl_x >> 3) << 3 );
 8868                        		__ld.wm		_sgx_map_pxl_x
         12:DF3D  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:DF40  AC 8B 26   			ldy.h	_sgx_map_pxl_x
 8869                        		__lsr.wi	3
         12:DF43  84 00      			sty	__temp
         12:DF45  20 3A E2   			jsr	lsrw3
 8870                        		__asl.wi	3
         12:DF48  84 00      			sty	__temp
         12:DF4A  20 D7 E1   			jsr	aslw3
 8871                        		__st.wmq	_sgx_map_pxl_x
         12:DF4D  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:DF50  8C 8B 26   			sty.h	_sgx_map_pxl_x
 8872                        	
 8873                        		.dbg	line,	"include\routines_LEVELS.c", 2003; // SO WE UPDATE THE MAP //
 8874                        	
 8875                        		.dbg	line,	"include\routines_LEVELS.c", 2004; sgx_scroll_map();
 8876                        		__call		_sgx_scroll_map
         12:DF53  20 81 FF   			call	_sgx_scroll_map
 8877                        	
 8878                        		.dbg	line,	"include\routines_LEVELS.c", 2006; // CHECK IF THE PLAYER STANDS RIGHT TO THE LADDER //
 8879                        	
 8880                        		.dbg	line,	"include\routines_LEVELS.c", 2007; check_BG( 31 , 8 );
 8881                        		__ld.wi		31
         12:DF56  A9 1F      			lda.l	#31
         12:DF58  C2         			cly
 8882                        		__pusharg.wr
         12:DF59  A6 8D      			ldx	<__sp
         12:DF5B  CA         			dex
         12:DF5C  CA         			dex
         12:DF5D  95 08      			sta.l	<__stack, x
         12:DF5F  94 09      			sty.h	<__stack, x
         12:DF61  86 8D      			stx	<__sp
 8883                        		__ld.wi		8
         12:DF63  A9 08      			lda.l	#8
         12:DF65  C2         			cly
 8884                        		__pusharg.wr
         12:DF66  A6 8D      			ldx	<__sp
         12:DF68  CA         			dex
         12:DF69  CA         			dex
         12:DF6A  95 08      			sta.l	<__stack, x
         12:DF6C  94 09      			sty.h	<__stack, x
         12:DF6E  86 8D      			stx	<__sp
 8885                        		__call		_check_BG
         12:DF70  20 6D FF   			call	_check_BG
 8886                        	
 8887                        		.dbg	line,	"include\routines_LEVELS.c", 2009; if(map_blk_flag == TILE_LADDER)
 8888                        		__ld.umq	_map_blk_flag
         12:DF73  AD AB 2B   			lda	_map_blk_flag
 8889                        		__equ_b.uiq	2
         12:DF76  C9 02      			cmp	#2
         12:DF78  F0 01      			beq	!+
         12:DF7A  18         			clc
         12:DF7B             	!:
 8890                        		__bfalse	.LL405
         12:DF7B  90 0E      			bcc	.LL405
 8891                        	
 8892                        		.dbg	line,	"include\routines_LEVELS.c", 2010; {
 8893                        	
 8894                        		.dbg	line,	"include\routines_LEVELS.c", 2011; sgx_map_pxl_x += 8;
 8895                        		__add_st.wmiq	8, _sgx_map_pxl_x
         12:DF7D  18         			clc
         12:DF7E  AD 8A 26   			lda.l	_sgx_map_pxl_x
         12:DF81  69 08      			adc.l	#8
         12:DF83  8D 8A 26   			sta.l	_sgx_map_pxl_x
         12:DF86  90 03      			bcc	!+
         12:DF88  EE 8B 26   			inc.h	_sgx_map_pxl_x
         12:DF8B             	!:
 8896                        	
 8897                        		.dbg	line,	"include\routines_LEVELS.c", 2012; }
 8898                        	
 8899                        		.dbg	line,	"include\routines_LEVELS.c", 2014; player_counter_anim = 1;
 8900    12:DF8B             	.LL405:
 8901                        		__st.umiq	1, _player_counter_anim
         12:DF8B  A9 01      			lda.l	#1
         12:DF8D  8D 18 23   			sta	_player_counter_anim
 8902                        	
 8903                        		.dbg	line,	"include\routines_LEVELS.c", 2015; player_index_jump = 0;
 8904                        		__st.umiq	0, _player_index_jump
         12:DF90  9C 19 23   			stz	_player_index_jump
 8905                        	
 8906                        		.dbg	line,	"include\routines_LEVELS.c", 2016; jump_ladder = TRUE;
 8907                        		__st.umiq	1, _jump_ladder
         12:DF93  A9 01      			lda.l	#1
         12:DF95  8D 1D 23   			sta	_jump_ladder
 8908                        	
 8909                        		.dbg	line,	"include\routines_LEVELS.c", 2017; jump_max_index = 29;
 8910                        		__st.umiq	29, _jump_max_index
         12:DF98  A9 1D      			lda.l	#29
         12:DF9A  8D 1E 23   			sta	_jump_max_index
 8911                        	
 8912                        		.dbg	line,	"include\routines_LEVELS.c", 2018; player_state = STATE_HANG;
 8913                        		__st.umiq	10, _player_state
         12:DF9D  A9 0A      			lda.l	#10
         12:DF9F  8D 15 23   			sta	_player_state
 8914                        	
 8915                        		.dbg	line,	"include\routines_LEVELS.c", 2019; }
 8916                        	
 8917                        		.dbg	line,	"include\routines_LEVELS.c", 2020; }
 8918    12:DFA2             	.LL404:
 8919                        	
 8920                        		.dbg	line,	"include\routines_LEVELS.c", 2021; }
 8921    12:DFA2             	.LL403:
 8922                        	
 8923                        		.dbg	line,	"include\routines_LEVELS.c", 2023; }
 8924    12:DFA2             	.LL394:
 8925    12:DFA2             	.LL393:
 8926    12:DFA2             	.LL379:
 8927    12:DFA2             	.LL365:
 8928    12:DFA2             	.LL362:
 8929    12:DFA2             	.LL347:
 8930    12:DFA2             	.LL340:
 8931    12:DFA2             	.LL337:
 8932    12:DFA2             	.LL300:
 8933    12:DFA2             	.LL263:
 8934    12:DFA2             	.LL237:
 8935    12:DFA2             	.LL230:
 8936    12:DFA2             	.LL199:
 8937    12:DFA2             	.LL194:
 8938                        		__return	0
         12:DFA2  4C EF FF   			jmp	leave_proc
 8939                        		.dbg	clear
 8940                        		.endp
 8941               6760     		.data
 8942               2305     		.bss
 8943    F8:2305             	__update_PLAYER_loc:
 8944    F8:2305             			ds	8
 8945    F8:230D             	__update_PLAYER_end:
 8946               E309     		.code
 8947                        		.pceas
 8948                        	
 8949                        		.dbg	line,	"main.c", 23; #include "include/routines_SHOP.c"
 8950                        		.dbg	line,	"include\routines_SHOP.c", 1; #include "huc.h"
 8951                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 1; #ifndef _hucc_legacy_h
 8952                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 2; #define _hucc_legacy_h
 8953                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 4; /****************************************************************************
 8954                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 5; ; ***************************************************************************
 8955                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 6; ;
 8956                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 7; ; huc.h
 8957                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 8; ;
 8958                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 9; ; HuCC wrapper file to include a default set of HuC-compatible functions.
 8959                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 10; ;
 8960                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 11; ; Copyright John Brandwood 2024.
 8961                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 12; ;
 8962                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 8963                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 8964                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 8965                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 16; ;
 8966                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 17; ; ***************************************************************************
 8967                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 18; ; ***************************************************************************
 8968                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 19; ;
 8969                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 20; ; When the HuCC compiler is invoked with the "--legacy" option to compile old
 8970                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 21; ; projects, then this "huc.h" file is automatically included.
 8971                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 22; ;
 8972                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 23; ; This file includes a set of the individual HuCC headers which correspond to
 8973                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 24; ; HuC's built-in functions and MagicKit library.
 8974                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 25; ;
 8975                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 26; ; New HuCC projects should, preferably, include the specific headers that are
 8976                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 27; ; needed, which will then allow them to replace parts of the standard library
 8977                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 28; ; with newer functions, or they can just manually include this "huc.h" file.
 8978                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 29; ;
 8979                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 30; ; ***************************************************************************
 8980                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 31; ; **************************************************************************/
 8981                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 33; #include "hucc-systemcard.h"
 8982                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 34; #include "hucc-baselib.h"
 8983                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 35; #include "hucc-gfx.h"
 8984                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 36; #include "hucc-string.h"
 8985                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 37; #include "hucc-old-scroll.h"
 8986                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 38; #include "hucc-old-spr.h"
 8987                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 39; #include "hucc-old-map.h"
 8988                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 40; #include "hucc-old-line.h"
 8989                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 42; #endif // _hucc_legacy_h
 8990                        		.dbg	line,	"include\routines_SHOP.c", 2; #include "hucc-scroll.h"
 8991                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 1; #ifndef _hucc_scroll_h
 8992                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 2; #define _hucc_scroll_h
 8993                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 4; /****************************************************************************
 8994                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 5; ; ***************************************************************************
 8995                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 6; ;
 8996                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 7; ; hucc-scroll.h
 8997                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 8; ;
 8998                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 9; ; Routines for a fast split-screen scrolling system.
 8999                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 10; ;
 9000                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 11; ; Copyright John Brandwood 2024.
 9001                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 12; ;
 9002                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 9003                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 9004                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 9005                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 16; ;
 9006                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 17; ; ***************************************************************************
 9007                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 18; ; ***************************************************************************
 9008                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 19; ;
 9009                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 20; ; The maximum number of splits for each screen layer is set in your project's
 9010                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 21; ; "hucc-config.inc" file, with the library having a limit of 128-per-layer.
 9011                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 22; ;
 9012                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 23; ; Your first active split must be defined to start at screen line 0, and then
 9013                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 24; ; the rest of the active splits must be in increasing line order to match the
 9014                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 25; ; way that the PC Engine displays the output image.
 9015                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 26; ;
 9016                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 27; ; You can have disabled splits interleaved with your active splits.
 9017                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 28; ;
 9018                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 29; ; Splits that are normally disabled can be used to create full screen effects
 9019                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 30; ; such as bouncing the screen up and down by adding blank areas at the top or
 9020                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 31; ; bottom of the screen, and then rapidly changing the height of those areas.
 9021                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 32; ;
 9022                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 33; ; ***************************************************************************
 9023                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 34; ; **************************************************************************/
 9024                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 36; // *************
 9025                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 37; // VDC bits for display_flags ...
 9026                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 38; // *************
 9027                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 40; #ifndef BKG_OFF
 9028                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 41; #define BKG_OFF 0x00
 9029                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 42; #endif
 9030                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 44; #ifndef SPR_OFF
 9031                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 45; #define SPR_OFF 0x00
 9032                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 46; #endif
 9033                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 48; #ifndef BKG_ON
 9034                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 49; #define BKG_ON 0x80
 9035                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 50; #endif
 9036                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 52; #ifndef SPR_ON
 9037                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 53; #define SPR_ON 0x40
 9038                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 54; #endif
 9039                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 56; // *************
 9040                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 57; // Functions in hucc-scroll.asm ...
 9041                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 58; // *************
 9042                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 60; #ifdef __HUCC__
 9043                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 62; #asmdef	HUCC_USES_NEW_SCROLL 1
 9044                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 64; extern void __fastcall scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
 9045                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 65; extern void __fastcall sgx_scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
 9046                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 67; extern void __fastcall disable_split( unsigned char index<acc> );
 9047                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 68; extern void __fastcall sgx_disable_split( unsigned char index<acc> );
 9048                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 70; extern void __fastcall __macro disable_all_splits( void );
 9049                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 71; extern void __fastcall __macro sgx_disable_all_splits( void );
 9050                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 73; #asm
 9051                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 74; .macro	_disable_all_splits
 9052                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 75; ldy	#HUCC_PCE_SPLITS - 1
 9053                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 76; !loop:		tya
 9054                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 77; call	_disable_split.1
 9055                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 78; dey
 9056                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 79; bpl	!loop-
 9057                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 80; .endm
 9058                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 82; .macro	_sgx_disable_all_splits
 9059                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 83; ldy	#HUCC_SGX_SPLITS - 1
 9060                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 84; !loop:		tya
 9061                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 85; call	_sgx_disable_split.1
 9062                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 86; dey
 9063                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 87; bpl	!loop-
 9064                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 88; .endm
 9065                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 89; #endasm
 9066                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 91; #endif // __HUCC__
 9067                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 93; #endif // _hucc_scroll_h
 9068                        		.dbg	line,	"include\routines_SHOP.c", 3; #include "hucc-chrmap.h"
 9069                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 1; #ifndef _hucc_chrmap_h
 9070                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 2; #define _hucc_chrmap_h
 9071                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 4; /****************************************************************************
 9072                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 5; ; ***************************************************************************
 9073                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 6; ;
 9074                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 7; ; hucc-chrmap.h
 9075                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 8; ;
 9076                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 9; ; A simple map system based on 8x8 characters (aka "tiles") in BAT format.
 9077                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 10; ;
 9078                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 11; ; Copyright John Brandwood 2025.
 9079                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 12; ;
 9080                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 9081                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 9082                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 9083                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 16; ;
 9084                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 17; ; ***************************************************************************
 9085                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 18; ; ***************************************************************************
 9086                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 19; ;
 9087                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 20; ; The maximum X and Y size for chrmaps is 256 characters (2048 pixels).
 9088                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 21; ;
 9089                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 22; ; The maximum total size for a chrmap is 16KBytes, which allows for maps up
 9090                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 23; ; to 256x32 tiles (2048x256 pixels).
 9091                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 24; ;
 9092                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 25; ; ***************************************************************************
 9093                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 26; ; **************************************************************************/
 9094                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 28; // *************
 9095                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 29; // This code extends the blkmap library ...
 9096                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 30; // *************
 9097                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 32; #include "hucc-blkmap.h"
 9098                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 34; // *************
 9099                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 35; // Functions in chrmap.asm ...
 9100                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 36; // *************
 9101                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 38; #ifdef __HUCC__
 9102                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 40; #asmdef	HUCC_USES_CHRMAP 1
 9103                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 42; extern void __fastcall __nop set_chrmap( unsigned char __far *chrmap<vdc_map_bank:vdc_map_addr>, unsigned char tiles_w<vdc_map_line_w> );
 9104                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 44; extern void __fastcall draw_bat( void );
 9105                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 45; extern void __fastcall scroll_bat( void );
 9106                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 47; extern void __fastcall blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 9107                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 49; #ifdef _SGX
 9108                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 51; extern void __fastcall __nop sgx_set_chrmap( unsigned char __far *chrmap<sgx_map_bank:sgx_map_addr>, unsigned char tiles_w<sgx_map_line_w> );
 9109                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 53; extern void __fastcall sgx_draw_bat( void );
 9110                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 54; extern void __fastcall sgx_scroll_bat( void );
 9111                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 56; extern void __fastcall sgx_blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 9112                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 58; #endif
 9113                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 60; #endif // __HUCC__
 9114                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 62; #endif // _hucc_chrmap_h
 9115                        		.dbg	line,	"include\routines_SHOP.c", 4; #include "hucc-blkmap.h"
 9116                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 1; #ifndef _hucc_blkmap_h
 9117                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 2; #define _hucc_blkmap_h
 9118                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 4; /****************************************************************************
 9119                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 5; ; ***************************************************************************
 9120                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 6; ;
 9121                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 7; ; hucc-blkmap.h
 9122                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 8; ;
 9123                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 9; ; A map system based on 16x16 meta-tiles (aka "blocks", aka CHR/BLK/MAP).
 9124                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 10; ;
 9125                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 11; ; Copyright John Brandwood 2025.
 9126                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 12; ;
 9127                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
 9128                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
 9129                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
 9130                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 16; ;
 9131                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 17; ; ***************************************************************************
 9132                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 18; ; ***************************************************************************
 9133                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 19; ;
 9134                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 20; ; The maximum X and Y size for blkmaps is 128 blocks (2048 pixels).
 9135                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 21; ;
 9136                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 22; ; The maximum total size for a blkmap is 16KBytes, which allows for maps up
 9137                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 23; ; to 128x128 blocks (2048x2048 pixels).
 9138                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 24; ;
 9139                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 25; ; Huge multi-screen blkmaps are also supported (optionally).
 9140                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 26; ;
 9141                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 27; ; The maximum X and Y for multi-screen maps is 128 screens (32768 pixels).
 9142                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 28; ;
 9143                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 29; ; The maximum total size for a multi-screen map is 8KBytes, which allows for
 9144                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 30; ; a total of 1024 screens.
 9145                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 31; ;
 9146                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 32; ; ***************************************************************************
 9147                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 33; ; **************************************************************************/
 9148                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 35; // *************
 9149                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 36; // Functions in blkmap.asm ...
 9150                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 37; // *************
 9151                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 39; #ifdef __HUCC__
 9152                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 41; #asmdef	HUCC_USES_BLKMAP 1
 9153                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 43; // Current top-left of drawn map in pixels.
 9154                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 44; extern unsigned int   vdc_map_pxl_x;
 9155                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 45; extern unsigned int   vdc_map_pxl_y;
 9156                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 47; // Width and height to draw/scroll in characters (not tiles).
 9157                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 48; extern unsigned char  vdc_map_draw_w;
 9158                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 49; extern unsigned char  vdc_map_draw_h;
 9159                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 51; // Width of map (or multi-screen BAT) in tiles.
 9160                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 52; extern unsigned char  vdc_map_line_w;
 9161                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 54; // Width of map in screens (if multi-screen map).
 9162                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 55; extern unsigned char  vdc_map_scrn_w;
 9163                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 57; // Extra information returned by get_map_block() and sgx_get_map_block(),
 9164                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 58; // which are the collision flags and the mask/overlay sprite for the BLK.
 9165                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 59; extern unsigned char  map_blk_flag;
 9166                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 60; extern unsigned char  map_blk_mask;
 9167                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 62; extern unsigned char  vdc_scr_bank;
 9168                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 63; extern unsigned char *vdc_scr_addr;
 9169                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 65; extern unsigned char  vdc_map_bank;
 9170                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 66; extern unsigned char *vdc_map_addr;
 9171                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 68; extern unsigned char  vdc_blk_bank;
 9172                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 69; extern unsigned char *vdc_blk_addr;
 9173                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 71; extern unsigned char  vdc_tbl_bank;
 9174                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 72; extern unsigned char *vdc_tbl_addr;
 9175                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 74; extern void __fastcall set_blocks( unsigned char __far *blk_def<vdc_blk_bank:vdc_blk_addr>, unsigned char __far *flg_def<vdc_tbl_bank:vdc_tbl_addr>, unsigned char number_of_blocks<_al> );
 9176                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 75; extern void __fastcall __macro set_blkmap( unsigned char __far *blk_map<vdc_map_bank:vdc_map_addr>, unsigned char blocks_w<vdc_map_line_w> );
 9177                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 76; extern void __fastcall __macro set_multimap( unsigned char __far *multi_map<vdc_scr_bank:vdc_scr_addr>, unsigned char screens_w<vdc_map_scrn_w> );
 9178                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 78; extern void __fastcall draw_map( void );
 9179                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 79; extern void __fastcall scroll_map( void );
 9180                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 81; extern void __fastcall blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 9181                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 83; extern unsigned char __fastcall get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
 9182                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 85; #asm
 9183                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 86; .macro	_set_blkmap.2
 9184                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 87; stz	vdc_scr_bank
 9185                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 88; .endm
 9186                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 90; .macro	_set_multimap.2
 9187                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 91; lda	vdc_bat_width
 9188                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 92; lsr	a
 9189                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 93; sta	vdc_map_line_w
 9190                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 94; .endm
 9191                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 96; .macro	SCREEN
 9192                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 97; db	(((\1) & $1FFF) | $6000) >> 8, bank(\1)
 9193                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 98; db	(((\2) & $1FFF) | $4000) >> 8, bank(\2)
 9194                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 99; db	(((\3) & $1FFF) | $6000) >> 8, bank(\3)
 9195                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 100; dw	(\4)
 9196                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 101; .endm
 9197                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 102; #endasm
 9198                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 104; #ifdef _SGX
 9199                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 106; // Current top-left of drawn map in pixels.
 9200                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 107; extern unsigned int   sgx_map_pxl_x;
 9201                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 108; extern unsigned int   sgx_map_pxl_y;
 9202                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 110; // Width and height to draw/scroll in characters (not tiles).
 9203                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 111; extern unsigned char  sgx_map_draw_w;
 9204                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 112; extern unsigned char  sgx_map_draw_h;
 9205                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 114; // Width of map (or multi-screen BAT) in tiles.
 9206                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 115; extern unsigned char  sgx_map_line_w;
 9207                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 117; // Width of map in screens (if multi-screen map).
 9208                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 118; extern unsigned char  sgx_map_scrn_w;
 9209                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 120; extern unsigned char  sgx_scr_bank;
 9210                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 121; extern unsigned char *sgx_scr_addr;
 9211                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 123; extern unsigned char  sgx_map_bank;
 9212                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 124; extern unsigned char *sgx_map_addr;
 9213                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 126; extern unsigned char  sgx_blk_bank;
 9214                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 127; extern unsigned char *sgx_blk_addr;
 9215                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 129; extern unsigned char  sgx_tbl_bank;
 9216                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 130; extern unsigned char *sgx_tbl_addr;
 9217                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 132; extern void __fastcall sgx_set_blocks( unsigned char __far *blk_def<sgx_blk_bank:sgx_blk_addr>, unsigned char __far *flg_def<sgx_tbl_bank:sgx_tbl_addr>, unsigned char number_of_blocks<_al> );
 9218                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 133; extern void __fastcall __macro sgx_set_blkmap( unsigned char __far *blk_map<sgx_map_bank:sgx_map_addr>, unsigned char blocks_w<sgx_map_line_w> );
 9219                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 134; extern void __fastcall __macro sgx_set_multimap( unsigned char __far *multi_map<sgx_scr_bank:sgx_scr_addr>, unsigned char screens_w<sgx_map_scrn_w> );
 9220                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 136; extern void __fastcall sgx_draw_map( void );
 9221                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 137; extern void __fastcall sgx_scroll_map( void );
 9222                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 139; extern void __fastcall sgx_blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
 9223                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 141; extern unsigned char __fastcall sgx_get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
 9224                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 143; #asm
 9225                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 144; .macro	_sgx_set_blkmap.2
 9226                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 145; stz	sgx_scr_bank
 9227                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 146; .endm
 9228                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 148; .macro	_sgx_set_multimap.2
 9229                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 149; lda	sgx_bat_width
 9230                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 150; lsr	a
 9231                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 151; sta	sgx_map_line_w
 9232                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 152; .endm
 9233                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 153; #endasm
 9234                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 155; #endif
 9235                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 157; #endif // __HUCC__
 9236                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 159; #endif // _hucc_blkmap_h
 9237                        		.dbg	line,	"include\routines_SHOP.c", 12; void display_TIME_SHOP()
 9238                        		.dbg	line,	"include\routines_SHOP.c", 13; {
 9239                        	;***********************
 9240                        	;***********************
 9241                        	
 9242                        		.hucc
 9243    02:D6ED             		.proc		_display_TIME_SHOP
 9244                        		__enter		_display_TIME_SHOP
 9245                        	
 9246                        		.dbg	line,	"include\routines_SHOP.c", 14; put_number(minutes,1,1,3);
 9247                        		__ld.um		_minutes
         02:D6ED  AD 24 23   			lda	_minutes
         02:D6F0  C2         			cly
 9248                        		__st.wmq	_bx
         02:D6F1  85 FA      			sta.l	_bx
         02:D6F3  84 FB      			sty.h	_bx
 9249                        		__st.umiq	1, _cl
         02:D6F5  A9 01      			lda.l	#1
         02:D6F7  85 FC      			sta	_cl
 9250                        		__st.umiq	1, _dil
         02:D6F9  A9 01      			lda.l	#1
         02:D6FB  85 F0      			sta	_dil
 9251                        		__st.umiq	3, _dih
         02:D6FD  A9 03      			lda.l	#3
         02:D6FF  85 F1      			sta	_dih
 9252                        		__call		_put_number.4
         02:D701  20 9F FF   			call	_put_number.4
 9253                        	
 9254                        		.dbg	line,	"include\routines_SHOP.c", 16; if(seconds < 10)
 9255                        		__ld.umq	_seconds
         02:D704  AD 25 23   			lda	_seconds
 9256                        		__ult_b.uiq	10
         02:D707  C9 0A      			cmp	#10		; Subtract integer from A.
         02:D709  6A         			ror	a		; CC if A < integer.
         02:D70A  49 80      			eor	#$80
         02:D70C  2A         			rol	a
 9257                        		__bfalse	.LL407
         02:D70D  90 2C      			bcc	.LL407
 9258                        	
 9259                        		.dbg	line,	"include\routines_SHOP.c", 17; {
 9260                        	
 9261                        		.dbg	line,	"include\routines_SHOP.c", 18; put_number(0,1,3,3);
 9262                        		__st.wmiq	0, _bx
         02:D70F  64 FA      			stz.l	_bx
         02:D711  64 FB      			stz.h	_bx
 9263                        		__st.umiq	1, _cl
         02:D713  A9 01      			lda.l	#1
         02:D715  85 FC      			sta	_cl
 9264                        		__st.umiq	3, _dil
         02:D717  A9 03      			lda.l	#3
         02:D719  85 F0      			sta	_dil
 9265                        		__st.umiq	3, _dih
         02:D71B  A9 03      			lda.l	#3
         02:D71D  85 F1      			sta	_dih
 9266                        		__call		_put_number.4
         02:D71F  20 9F FF   			call	_put_number.4
 9267                        	
 9268                        		.dbg	line,	"include\routines_SHOP.c", 19; put_number(seconds,1,4,3);
 9269                        		__ld.um		_seconds
         02:D722  AD 25 23   			lda	_seconds
         02:D725  C2         			cly
 9270                        		__st.wmq	_bx
         02:D726  85 FA      			sta.l	_bx
         02:D728  84 FB      			sty.h	_bx
 9271                        		__st.umiq	1, _cl
         02:D72A  A9 01      			lda.l	#1
         02:D72C  85 FC      			sta	_cl
 9272                        		__st.umiq	4, _dil
         02:D72E  A9 04      			lda.l	#4
         02:D730  85 F0      			sta	_dil
 9273                        		__st.umiq	3, _dih
         02:D732  A9 03      			lda.l	#3
         02:D734  85 F1      			sta	_dih
 9274                        		__call		_put_number.4
         02:D736  20 9F FF   			call	_put_number.4
 9275                        	
 9276                        		.dbg	line,	"include\routines_SHOP.c", 20; }
 9277                        	
 9278                        		.dbg	line,	"include\routines_SHOP.c", 22; else
 9279                        		__bra		.LL408
         02:D739  80 17      			bra	.LL408
 9280    02:D73B             	.LL407:
 9281                        	
 9282                        		.dbg	line,	"include\routines_SHOP.c", 23; {
 9283                        	
 9284                        		.dbg	line,	"include\routines_SHOP.c", 24; put_number(seconds,2,3,3);
 9285                        		__ld.um		_seconds
         02:D73B  AD 25 23   			lda	_seconds
         02:D73E  C2         			cly
 9286                        		__st.wmq	_bx
         02:D73F  85 FA      			sta.l	_bx
         02:D741  84 FB      			sty.h	_bx
 9287                        		__st.umiq	2, _cl
         02:D743  A9 02      			lda.l	#2
         02:D745  85 FC      			sta	_cl
 9288                        		__st.umiq	3, _dil
         02:D747  A9 03      			lda.l	#3
         02:D749  85 F0      			sta	_dil
 9289                        		__st.umiq	3, _dih
         02:D74B  A9 03      			lda.l	#3
         02:D74D  85 F1      			sta	_dih
 9290                        		__call		_put_number.4
         02:D74F  20 9F FF   			call	_put_number.4
 9291                        	
 9292                        		.dbg	line,	"include\routines_SHOP.c", 25; }
 9293    02:D752             	.LL408:
 9294                        	
 9295                        		.dbg	line,	"include\routines_SHOP.c", 27; time_counter += 1;
 9296                        		__add_st.umiq	1, _time_counter
         02:D752  EE 26 23   			inc	_time_counter
 9297                        	
 9298                        		.dbg	line,	"include\routines_SHOP.c", 29; if(time_counter == 60)
 9299                        		__ld.umq	_time_counter
         02:D755  AD 26 23   			lda	_time_counter
 9300                        		__equ_b.uiq	60
         02:D758  C9 3C      			cmp	#60
         02:D75A  F0 01      			beq	!+
         02:D75C  18         			clc
         02:D75D             	!:
 9301                        		__bfalse	.LL409
         02:D75D  90 30      			bcc	.LL409
 9302                        	
 9303                        		.dbg	line,	"include\routines_SHOP.c", 30; {
 9304                        	
 9305                        		.dbg	line,	"include\routines_SHOP.c", 31; time_counter = 0;
 9306                        		__st.umiq	0, _time_counter
         02:D75F  9C 26 23   			stz	_time_counter
 9307                        	
 9308                        		.dbg	line,	"include\routines_SHOP.c", 33; if(seconds > 0)
 9309                        		__ld.umq	_seconds
         02:D762  AD 25 23   			lda	_seconds
 9310                        		__ugt_b.uiq	0
         02:D765  18         			clc			; Subtract integer+1 from A.
         02:D766  E9 00      			sbc	#0		; CS if A > integer.
 9311                        		__bfalse	.LL410
         02:D768  90 05      			bcc	.LL410
 9312                        	
 9313                        		.dbg	line,	"include\routines_SHOP.c", 34; {
 9314                        	
 9315                        		.dbg	line,	"include\routines_SHOP.c", 35; seconds -= 1;
 9316                        		__sub_st.umiq	1, _seconds
         02:D76A  CE 25 23   			dec	_seconds
 9317                        	
 9318                        		.dbg	line,	"include\routines_SHOP.c", 36; }
 9319                        	
 9320                        		.dbg	line,	"include\routines_SHOP.c", 38; else
 9321                        		__bra		.LL411
         02:D76D  80 20      			bra	.LL411
 9322    02:D76F             	.LL410:
 9323                        	
 9324                        		.dbg	line,	"include\routines_SHOP.c", 39; {
 9325                        	
 9326                        		.dbg	line,	"include\routines_SHOP.c", 40; if(minutes > 0)
 9327                        		__ld.umq	_minutes
         02:D76F  AD 24 23   			lda	_minutes
 9328                        		__ugt_b.uiq	0
         02:D772  18         			clc			; Subtract integer+1 from A.
         02:D773  E9 00      			sbc	#0		; CS if A > integer.
 9329                        		__bfalse	.LL412
         02:D775  90 0A      			bcc	.LL412
 9330                        	
 9331                        		.dbg	line,	"include\routines_SHOP.c", 41; {
 9332                        	
 9333                        		.dbg	line,	"include\routines_SHOP.c", 42; seconds = 59;
 9334                        		__st.umiq	59, _seconds
         02:D777  A9 3B      			lda.l	#59
         02:D779  8D 25 23   			sta	_seconds
 9335                        	
 9336                        		.dbg	line,	"include\routines_SHOP.c", 43; minutes -= 1;
 9337                        		__sub_st.umiq	1, _minutes
         02:D77C  CE 24 23   			dec	_minutes
 9338                        	
 9339                        		.dbg	line,	"include\routines_SHOP.c", 44; }
 9340                        	
 9341                        		.dbg	line,	"include\routines_SHOP.c", 46; else
 9342                        		__bra		.LL413
         02:D77F  80 0E      			bra	.LL413
 9343    02:D781             	.LL412:
 9344                        	
 9345                        		.dbg	line,	"include\routines_SHOP.c", 47; {
 9346                        	
 9347                        		.dbg	line,	"include\routines_SHOP.c", 48; seconds = 0;
 9348                        		__st.umiq	0, _seconds
         02:D781  9C 25 23   			stz	_seconds
 9349                        	
 9350                        		.dbg	line,	"include\routines_SHOP.c", 49; minutes = 0;
 9351                        		__st.umiq	0, _minutes
         02:D784  9C 24 23   			stz	_minutes
 9352                        	
 9353                        		.dbg	line,	"include\routines_SHOP.c", 50; shop_counter = 0;    
 9354                        		__st.umiq	0, _shop_counter
         02:D787  9C CD 23   			stz	_shop_counter
 9355                        	
 9356                        		.dbg	line,	"include\routines_SHOP.c", 51; shop_phase = SHOP_PHASE_EXIT;
 9357                        		__st.umiq	2, _shop_phase
         02:D78A  A9 02      			lda.l	#2
         02:D78C  8D CC 23   			sta	_shop_phase
 9358                        	
 9359                        		.dbg	line,	"include\routines_SHOP.c", 52; }
 9360    02:D78F             	.LL413:
 9361                        	
 9362                        		.dbg	line,	"include\routines_SHOP.c", 53; }
 9363    02:D78F             	.LL411:
 9364                        	
 9365                        		.dbg	line,	"include\routines_SHOP.c", 54; } 
 9366                        	
 9367                        		.dbg	line,	"include\routines_SHOP.c", 55; }
 9368    02:D78F             	.LL409:
 9369    02:D78F             	.LL406:
 9370                        		__return	0
         02:D78F  4C EF FF   			jmp	leave_proc
 9371                        		.dbg	clear
 9372                        		.endp
 9373                        		.pceas
 9374                        	
 9375                        		.dbg	line,	"include\routines_SHOP.c", 59; void joypad_BUTTONS_SHOP()
 9376                        		.dbg	line,	"include\routines_SHOP.c", 60; {
 9377                        	;***********************
 9378                        	;***********************
 9379                        	
 9380                        		.hucc
 9381    01:CA03             		.proc		_joypad_BUTTONS_SHOP
 9382                        		__enter		_joypad_BUTTONS_SHOP
 9383                        	
 9384                        		.dbg	line,	"include\routines_SHOP.c", 61; if(joytrg(JOYPAD_1) & JOY_RIGHT)
 9385                        		__ld.uiq	0
         01:CA03  62         			cla
 9386                        		 _joytrg.1
         01:CA04  AA         			tax
         01:CA05  BD 2D 22   			lda	joytrg, x
         01:CA08  BC DD 22   			ldy	joy6trg, x
 9387                        		__tand.wi	32
         01:CA0B  29 20      			and	#32
         01:CA0D  C9 01      	!:		cmp	#1
 9388                        		__bfalse	.LL415
         01:CA0F  90 59      			bcc	.LL415
 9389                        	
 9390                        		.dbg	line,	"include\routines_SHOP.c", 62; {   
 9391                        	
 9392                        		.dbg	line,	"include\routines_SHOP.c", 63; char max_index;
 9393                        	
 9394                        		.dbg	line,	"include\routines_SHOP.c", 64; 
 9395                        	
 9396                        		.dbg	line,	"include\routines_SHOP.c", 65; if(index_y == 0)
 9397                        		__not.um	_index_y
         01:CA11  AD CA 23   			lda	_index_y
         01:CA14  18         			clc
         01:CA15  D0 01      			bne	!+
         01:CA17  38         			sec
         01:CA18             	!:
 9398                        		__bfalse	.LL416
         01:CA18  90 07      			bcc	.LL416
 9399                        	
 9400                        		.dbg	line,	"include\routines_SHOP.c", 66; {
 9401                        	
 9402                        		.dbg	line,	"include\routines_SHOP.c", 67; max_index = 4;
 9403                        		__st.umiq	4, __joypad_BUTTONS_SHOP_end - 1  /* max_index */
         01:CA1A  A9 04      			lda.l	#4
         01:CA1C  8D 0D 23   			sta	__joypad_BUTTONS_SHOP_end - 1
 9404                        	
 9405                        		.dbg	line,	"include\routines_SHOP.c", 68; }
 9406                        	
 9407                        		.dbg	line,	"include\routines_SHOP.c", 70; else
 9408                        		__bra		.LL417
         01:CA1F  80 05      			bra	.LL417
 9409    01:CA21             	.LL416:
 9410                        	
 9411                        		.dbg	line,	"include\routines_SHOP.c", 71; {
 9412                        	
 9413                        		.dbg	line,	"include\routines_SHOP.c", 72; max_index = 5;
 9414                        		__st.umiq	5, __joypad_BUTTONS_SHOP_end - 1  /* max_index */
         01:CA21  A9 05      			lda.l	#5
         01:CA23  8D 0D 23   			sta	__joypad_BUTTONS_SHOP_end - 1
 9415                        	
 9416                        		.dbg	line,	"include\routines_SHOP.c", 73; }
 9417    01:CA26             	.LL417:
 9418                        	
 9419                        		.dbg	line,	"include\routines_SHOP.c", 75; if(index_x < max_index)
 9420                        		__ld.umq	_index_x
         01:CA26  AD C9 23   			lda	_index_x
 9421                        		__ult_b.umq	__joypad_BUTTONS_SHOP_end - 1  /* max_index */
         01:CA29  CD 0D 23   			cmp	__joypad_BUTTONS_SHOP_end - 1		; Subtract memory from A.
         01:CA2C  6A         			ror	a		; CC if A < memory.
         01:CA2D  49 80      			eor	#$80
         01:CA2F  2A         			rol	a
 9422                        		__bfalse	.LL418
         01:CA30  B0 03 4C 80			bcc	.LL418
         01:CA34  CF          
 9423                        	
 9424                        		.dbg	line,	"include\routines_SHOP.c", 76; {
 9425                        	
 9426                        		.dbg	line,	"include\routines_SHOP.c", 77; index_x += 1;
 9427                        		__add_st.umiq	1, _index_x
         01:CA35  EE C9 23   			inc	_index_x
 9428                        	
 9429                        		.dbg	line,	"include\routines_SHOP.c", 78; item_index = (index_x + (index_y * 5));
 9430                        		__ld.um		_index_y
         01:CA38  AD CA 23   			lda	_index_y
         01:CA3B  C2         			cly
 9431                        		__mul.wi	5
         01:CA3C  85 00      			sta.l	__temp
         01:CA3E  84 01      			sty.h	__temp
                             		__asl.wr
         01:CA40  0A         			asl	a
         01:CA41  42         			say
         01:CA42  2A         			rol	a
         01:CA43  42         			say
                             		__asl.wr
         01:CA44  0A         			asl	a
         01:CA45  42         			say
         01:CA46  2A         			rol	a
         01:CA47  42         			say
                             		__add.wm	__temp
         01:CA48  18         			clc
         01:CA49  65 00      			adc.l	__temp
         01:CA4B  42         			say
         01:CA4C  65 01      			adc.h	__temp
         01:CA4E  42         			say
 9432                        		__add.um	_index_x
         01:CA4F  18         			clc
         01:CA50  6D C9 23   			adc	_index_x
         01:CA53  90 01      			bcc	!+
         01:CA55  C8         			iny
         01:CA56             	!:
 9433                        		__st.umq	_item_index
         01:CA56  8D CB 23   			sta	_item_index
 9434                        	
 9435                        		.dbg	line,	"include\routines_SHOP.c", 80; spr_set(0);
 9436                        		__ld.uiq	0
         01:CA59  62         			cla
 9437                        		__call		_spr_set.1
         01:CA5A  20 DD E7   			call	_spr_set.1
 9438                        	
 9439                        		.dbg	line,	"include\routines_SHOP.c", 81; spr_x(TABLE_CURSOR_POS_X[item_index]);
 9440                        		__ldx.umq	_item_index
         01:CA5D  AE CB 23   			ldx	_item_index
 9441                        		__ld.uax	_TABLE_CURSOR_POS_X
         01:CA60  BD 8B 61   			lda	_TABLE_CURSOR_POS_X, x
         01:CA63  C2         			cly
 9442                        		__call		_spr_x.1
         01:CA64  20 0A E8   			call	_spr_x.1
 9443                        	
 9444                        		.dbg	line,	"include\routines_SHOP.c", 82; }
 9445                        	
 9446                        		.dbg	line,	"include\routines_SHOP.c", 83; }
 9447    01:CA67             	.LL418	.alias		.LL419
 9448                        	
 9449                        		.dbg	line,	"include\routines_SHOP.c", 85; 
 9450                        	
 9451                        		.dbg	line,	"include\routines_SHOP.c", 86; else if(joytrg(JOYPAD_1) & JOY_LEFT)
 9452                        		__bra		.LL419
         01:CA67  4C 80 CF   			bra	.LL419
 9453    01:CA6A             	.LL415:
 9454                        		__ld.uiq	0
         01:CA6A  62         			cla
 9455                        		 _joytrg.1
         01:CA6B  AA         			tax
         01:CA6C  BD 2D 22   			lda	joytrg, x
         01:CA6F  BC DD 22   			ldy	joy6trg, x
 9456                        		__tand.wi	128
         01:CA72  29 80      			and	#128
         01:CA74  C9 01      	!:		cmp	#1
 9457                        		__bfalse	.LL420
         01:CA76  90 40      			bcc	.LL420
 9458                        	
 9459                        		.dbg	line,	"include\routines_SHOP.c", 87; {
 9460                        	
 9461                        		.dbg	line,	"include\routines_SHOP.c", 88; if(index_x > 0)
 9462                        		__ld.umq	_index_x
         01:CA78  AD C9 23   			lda	_index_x
 9463                        		__ugt_b.uiq	0
         01:CA7B  18         			clc			; Subtract integer+1 from A.
         01:CA7C  E9 00      			sbc	#0		; CS if A > integer.
 9464                        		__bfalse	.LL421
         01:CA7E  B0 03 4C 80			bcc	.LL421
         01:CA82  CF          
 9465                        	
 9466                        		.dbg	line,	"include\routines_SHOP.c", 89; {
 9467                        	
 9468                        		.dbg	line,	"include\routines_SHOP.c", 90; index_x -= 1;
 9469                        		__sub_st.umiq	1, _index_x
         01:CA83  CE C9 23   			dec	_index_x
 9470                        	
 9471                        		.dbg	line,	"include\routines_SHOP.c", 91; item_index = (index_x + (index_y * 5));
 9472                        		__ld.um		_index_y
         01:CA86  AD CA 23   			lda	_index_y
         01:CA89  C2         			cly
 9473                        		__mul.wi	5
         01:CA8A  85 00      			sta.l	__temp
         01:CA8C  84 01      			sty.h	__temp
                             		__asl.wr
         01:CA8E  0A         			asl	a
         01:CA8F  42         			say
         01:CA90  2A         			rol	a
         01:CA91  42         			say
                             		__asl.wr
         01:CA92  0A         			asl	a
         01:CA93  42         			say
         01:CA94  2A         			rol	a
         01:CA95  42         			say
                             		__add.wm	__temp
         01:CA96  18         			clc
         01:CA97  65 00      			adc.l	__temp
         01:CA99  42         			say
         01:CA9A  65 01      			adc.h	__temp
         01:CA9C  42         			say
 9474                        		__add.um	_index_x
         01:CA9D  18         			clc
         01:CA9E  6D C9 23   			adc	_index_x
         01:CAA1  90 01      			bcc	!+
         01:CAA3  C8         			iny
         01:CAA4             	!:
 9475                        		__st.umq	_item_index
         01:CAA4  8D CB 23   			sta	_item_index
 9476                        	
 9477                        		.dbg	line,	"include\routines_SHOP.c", 93; spr_set(0);
 9478                        		__ld.uiq	0
         01:CAA7  62         			cla
 9479                        		__call		_spr_set.1
         01:CAA8  20 DD E7   			call	_spr_set.1
 9480                        	
 9481                        		.dbg	line,	"include\routines_SHOP.c", 94; spr_x(TABLE_CURSOR_POS_X[item_index]);
 9482                        		__ldx.umq	_item_index
         01:CAAB  AE CB 23   			ldx	_item_index
 9483                        		__ld.uax	_TABLE_CURSOR_POS_X
         01:CAAE  BD 8B 61   			lda	_TABLE_CURSOR_POS_X, x
         01:CAB1  C2         			cly
 9484                        		__call		_spr_x.1
         01:CAB2  20 0A E8   			call	_spr_x.1
 9485                        	
 9486                        		.dbg	line,	"include\routines_SHOP.c", 95; }
 9487                        	
 9488                        		.dbg	line,	"include\routines_SHOP.c", 96; }
 9489    01:CAB5             	.LL421	.alias		.LL422
 9490                        	
 9491                        		.dbg	line,	"include\routines_SHOP.c", 99; else if(joytrg(JOYPAD_1) & JOY_UP)
 9492                        		__bra		.LL422
         01:CAB5  4C 80 CF   			bra	.LL422
 9493    01:CAB8             	.LL420:
 9494                        		__ld.uiq	0
         01:CAB8  62         			cla
 9495                        		 _joytrg.1
         01:CAB9  AA         			tax
         01:CABA  BD 2D 22   			lda	joytrg, x
         01:CABD  BC DD 22   			ldy	joy6trg, x
 9496                        		__tand.wi	16
         01:CAC0  29 10      			and	#16
         01:CAC2  C9 01      	!:		cmp	#1
 9497                        		__bfalse	.LL423
         01:CAC4  90 4A      			bcc	.LL423
 9498                        	
 9499                        		.dbg	line,	"include\routines_SHOP.c", 100; {
 9500                        	
 9501                        		.dbg	line,	"include\routines_SHOP.c", 101; if(index_y > 0)
 9502                        		__ld.umq	_index_y
         01:CAC6  AD CA 23   			lda	_index_y
 9503                        		__ugt_b.uiq	0
         01:CAC9  18         			clc			; Subtract integer+1 from A.
         01:CACA  E9 00      			sbc	#0		; CS if A > integer.
 9504                        		__bfalse	.LL424
         01:CACC  B0 03 4C 80			bcc	.LL424
         01:CAD0  CF          
 9505                        	
 9506                        		.dbg	line,	"include\routines_SHOP.c", 102; {
 9507                        	
 9508                        		.dbg	line,	"include\routines_SHOP.c", 103; if(item_index != 10)
 9509                        		__ld.umq	_item_index
         01:CAD1  AD CB 23   			lda	_item_index
 9510                        		__neq_b.uiq	10
         01:CAD4  38         			sec
         01:CAD5  49 0A      			eor	#10
         01:CAD7  D0 01      			bne	!+
         01:CAD9  18         			clc
         01:CADA             	!:
 9511                        		__bfalse	.LL425
         01:CADA  B0 03 4C 80			bcc	.LL425
         01:CADE  CF          
 9512                        	
 9513                        		.dbg	line,	"include\routines_SHOP.c", 104; {
 9514                        	
 9515                        		.dbg	line,	"include\routines_SHOP.c", 105; index_y -= 1;
 9516                        		__sub_st.umiq	1, _index_y
         01:CADF  CE CA 23   			dec	_index_y
 9517                        	
 9518                        		.dbg	line,	"include\routines_SHOP.c", 106; item_index = (index_x + (index_y * 5));
 9519                        		__ld.um		_index_y
         01:CAE2  AD CA 23   			lda	_index_y
         01:CAE5  C2         			cly
 9520                        		__mul.wi	5
         01:CAE6  85 00      			sta.l	__temp
         01:CAE8  84 01      			sty.h	__temp
                             		__asl.wr
         01:CAEA  0A         			asl	a
         01:CAEB  42         			say
         01:CAEC  2A         			rol	a
         01:CAED  42         			say
                             		__asl.wr
         01:CAEE  0A         			asl	a
         01:CAEF  42         			say
         01:CAF0  2A         			rol	a
         01:CAF1  42         			say
                             		__add.wm	__temp
         01:CAF2  18         			clc
         01:CAF3  65 00      			adc.l	__temp
         01:CAF5  42         			say
         01:CAF6  65 01      			adc.h	__temp
         01:CAF8  42         			say
 9521                        		__add.um	_index_x
         01:CAF9  18         			clc
         01:CAFA  6D C9 23   			adc	_index_x
         01:CAFD  90 01      			bcc	!+
         01:CAFF  C8         			iny
         01:CB00             	!:
 9522                        		__st.umq	_item_index
         01:CB00  8D CB 23   			sta	_item_index
 9523                        	
 9524                        		.dbg	line,	"include\routines_SHOP.c", 108; spr_set(0);
 9525                        		__ld.uiq	0
         01:CB03  62         			cla
 9526                        		__call		_spr_set.1
         01:CB04  20 DD E7   			call	_spr_set.1
 9527                        	
 9528                        		.dbg	line,	"include\routines_SHOP.c", 109; spr_y(144);
 9529                        		__ld.wi		144
         01:CB07  A9 90      			lda.l	#144
         01:CB09  C2         			cly
 9530                        		__call		_spr_y.1
         01:CB0A  20 19 E8   			call	_spr_y.1
 9531                        	
 9532                        		.dbg	line,	"include\routines_SHOP.c", 110; }
 9533                        	
 9534                        		.dbg	line,	"include\routines_SHOP.c", 111; }
 9535    01:CB0D             	.LL425	.alias		.LL426
 9536                        	
 9537                        		.dbg	line,	"include\routines_SHOP.c", 112; }
 9538    01:CB0D             	.LL424	.alias		.LL426
 9539                        	
 9540                        		.dbg	line,	"include\routines_SHOP.c", 115; else if(joytrg(JOYPAD_1) & JOY_DOWN)
 9541                        		__bra		.LL426
         01:CB0D  4C 80 CF   			bra	.LL426
 9542    01:CB10             	.LL423:
 9543                        		__ld.uiq	0
         01:CB10  62         			cla
 9544                        		 _joytrg.1
         01:CB11  AA         			tax
         01:CB12  BD 2D 22   			lda	joytrg, x
         01:CB15  BC DD 22   			ldy	joy6trg, x
 9545                        		__tand.wi	64
         01:CB18  29 40      			and	#64
         01:CB1A  C9 01      	!:		cmp	#1
 9546                        		__bfalse	.LL427
         01:CB1C  90 3F      			bcc	.LL427
 9547                        	
 9548                        		.dbg	line,	"include\routines_SHOP.c", 116; {
 9549                        	
 9550                        		.dbg	line,	"include\routines_SHOP.c", 117; if(index_y < 1)
 9551                        		__ld.umq	_index_y
         01:CB1E  AD CA 23   			lda	_index_y
 9552                        		__ult_b.uiq	1
         01:CB21  C9 01      			cmp	#1		; Subtract integer from A.
         01:CB23  6A         			ror	a		; CC if A < integer.
         01:CB24  49 80      			eor	#$80
         01:CB26  2A         			rol	a
 9553                        		__bfalse	.LL428
         01:CB27  B0 03 4C 80			bcc	.LL428
         01:CB2B  CF          
 9554                        	
 9555                        		.dbg	line,	"include\routines_SHOP.c", 118; {
 9556                        	
 9557                        		.dbg	line,	"include\routines_SHOP.c", 119; index_y += 1;
 9558                        		__add_st.umiq	1, _index_y
         01:CB2C  EE CA 23   			inc	_index_y
 9559                        	
 9560                        		.dbg	line,	"include\routines_SHOP.c", 120; item_index = (index_x + (index_y * 5));
 9561                        		__ld.um		_index_y
         01:CB2F  AD CA 23   			lda	_index_y
         01:CB32  C2         			cly
 9562                        		__mul.wi	5
         01:CB33  85 00      			sta.l	__temp
         01:CB35  84 01      			sty.h	__temp
                             		__asl.wr
         01:CB37  0A         			asl	a
         01:CB38  42         			say
         01:CB39  2A         			rol	a
         01:CB3A  42         			say
                             		__asl.wr
         01:CB3B  0A         			asl	a
         01:CB3C  42         			say
         01:CB3D  2A         			rol	a
         01:CB3E  42         			say
                             		__add.wm	__temp
         01:CB3F  18         			clc
         01:CB40  65 00      			adc.l	__temp
         01:CB42  42         			say
         01:CB43  65 01      			adc.h	__temp
         01:CB45  42         			say
 9563                        		__add.um	_index_x
         01:CB46  18         			clc
         01:CB47  6D C9 23   			adc	_index_x
         01:CB4A  90 01      			bcc	!+
         01:CB4C  C8         			iny
         01:CB4D             	!:
 9564                        		__st.umq	_item_index
         01:CB4D  8D CB 23   			sta	_item_index
 9565                        	
 9566                        		.dbg	line,	"include\routines_SHOP.c", 122; spr_set(0);
 9567                        		__ld.uiq	0
         01:CB50  62         			cla
 9568                        		__call		_spr_set.1
         01:CB51  20 DD E7   			call	_spr_set.1
 9569                        	
 9570                        		.dbg	line,	"include\routines_SHOP.c", 123; spr_y(168);
 9571                        		__ld.wi		168
         01:CB54  A9 A8      			lda.l	#168
         01:CB56  C2         			cly
 9572                        		__call		_spr_y.1
         01:CB57  20 19 E8   			call	_spr_y.1
 9573                        	
 9574                        		.dbg	line,	"include\routines_SHOP.c", 124; }
 9575                        	
 9576                        		.dbg	line,	"include\routines_SHOP.c", 125; }
 9577    01:CB5A             	.LL428	.alias		.LL429
 9578                        	
 9579                        		.dbg	line,	"include\routines_SHOP.c", 128; else if(joytrg(JOYPAD_1) & JOY_I)
 9580                        		__bra		.LL429
         01:CB5A  4C 80 CF   			bra	.LL429
 9581    01:CB5D             	.LL427:
 9582                        		__ld.uiq	0
         01:CB5D  62         			cla
 9583                        		 _joytrg.1
         01:CB5E  AA         			tax
         01:CB5F  BD 2D 22   			lda	joytrg, x
         01:CB62  BC DD 22   			ldy	joy6trg, x
 9584                        		__tand.wi	1
         01:CB65  29 01      			and	#1
         01:CB67  C9 01      	!:		cmp	#1
 9585                        		__bfalse	.LL430
         01:CB69  B0 03 4C 80			bcc	.LL430
         01:CB6D  CF          
 9586                        	
 9587                        		.dbg	line,	"include\routines_SHOP.c", 129; {
 9588                        	
 9589                        		.dbg	line,	"include\routines_SHOP.c", 130; switch(item_index)
 9590                        		__ld.umq	_item_index
         01:CB6E  AD CB 23   			lda	_item_index
 9591                        		__bra		.LL431
         01:CB71  4C 5D CF   			bra	.LL431
 9592                        	
 9593                        		.dbg	line,	"include\routines_SHOP.c", 131; {
 9594                        	
 9595                        		.dbg	line,	"include\routines_SHOP.c", 132; // WEAPON 2 //
 9596                        	
 9597                        		.dbg	line,	"include\routines_SHOP.c", 133; case 0:
 9598    01:CB74             	.LL433:
 9599                        		__case		0
 9600                        	
 9601                        		.dbg	line,	"include\routines_SHOP.c", 134; if(zenny_amount >= shop_prices[0])
 9602                        		__ld.wm		_zenny_amount
         01:CB74  AD 28 26   			lda.l	_zenny_amount
         01:CB77  AC 29 26   			ldy.h	_zenny_amount
 9603                        		__sge_w.wm	_shop_prices
         01:CB7A  CD 2C 26   			cmp.l	_shop_prices		; Subtract memory from Y:A.
         01:CB7D  98         			tya
         01:CB7E  ED 2D 26   			sbc.h	_shop_prices
         01:CB81  50 02      			bvc	!+
         01:CB83  49 80      			eor	#$80		; +ve if Y:A >= memory (signed).
         01:CB85  49 80      	!:		eor	#$80
         01:CB87  0A         			asl	a
 9604                        		__bfalse	.LL434
         01:CB88  B0 03 4C 80			bcc	.LL434
         01:CB8C  CF          
 9605                        	
 9606                        		.dbg	line,	"include\routines_SHOP.c", 135; {
 9607                        	
 9608                        		.dbg	line,	"include\routines_SHOP.c", 136; if(weapon_level < 2)
 9609                        		__ld.umq	_weapon_level
         01:CB8D  AD 20 23   			lda	_weapon_level
 9610                        		__ult_b.uiq	2
         01:CB90  C9 02      			cmp	#2		; Subtract integer from A.
         01:CB92  6A         			ror	a		; CC if A < integer.
         01:CB93  49 80      			eor	#$80
         01:CB95  2A         			rol	a
 9611                        		__bfalse	.LL435
         01:CB96  B0 03 4C 80			bcc	.LL435
         01:CB9A  CF          
 9612                        	
 9613                        		.dbg	line,	"include\routines_SHOP.c", 137; {
 9614                        	
 9615                        		.dbg	line,	"include\routines_SHOP.c", 138; weapon_level = 2;
 9616                        		__st.umiq	2, _weapon_level
         01:CB9B  A9 02      			lda.l	#2
         01:CB9D  8D 20 23   			sta	_weapon_level
 9617                        	
 9618                        		.dbg	line,	"include\routines_SHOP.c", 139; load_vram( WEAPON_VRAM_ADR, tileset_WEAPON_2, SIZEOF(tileset_WEAPON_2) >> 1 );
 9619                        		__st.wmiq	4256, _di
         01:CBA0  A9 A0      			lda.l	#4256
         01:CBA2  85 F0      			sta.l	_di
         01:CBA4  A9 10      			lda.h	#4256
         01:CBA6  85 F1      			sta.h	_di
 9620                        		__farptr	_tileset_WEAPON_2, _bp_bank, _bp
         01:CBA8  A9 80      			lda.l	#$6000 + ($1FFF & (_tileset_WEAPON_2))
         01:CBAA  85 EC      			sta.l	_bp
         01:CBAC  A9 77      			lda.h	#$6000 + ($1FFF & (_tileset_WEAPON_2))
         01:CBAE  85 ED      			sta.h	_bp
         01:CBB0  A9 03      			lda	#bank(_tileset_WEAPON_2)
         01:CBB2  85 02      			sta	_bp_bank
 9621                        		__ld.wi		___sizeof__tileset_WEAPON_2
         01:CBB4  A9 80      			lda.l	#___sizeof__tileset_WEAPON_2
         01:CBB6  A0 00      			ldy.h	#___sizeof__tileset_WEAPON_2
 9622                        		__lsr.wi	1
         01:CBB8  42         			say
         01:CBB9  4A         			lsr	a
         01:CBBA  42         			say
         01:CBBB  6A         			ror	a
 9623                        		__st.wmq	_ax
         01:CBBC  85 F8      			sta.l	_ax
         01:CBBE  84 F9      			sty.h	_ax
 9624                        		 _load_vram.3
         01:CBC0  82         			clx				; Offset to PCE VDC.
         01:CBC1  20 63 FF   			call	load_vram_x
 9625                        	
 9626                        		.dbg	line,	"include\routines_SHOP.c", 141; zenny_amount -= shop_prices[0];
 9627                        		__ld.wm		_shop_prices
         01:CBC4  AD 2C 26   			lda.l	_shop_prices
         01:CBC7  AC 2D 26   			ldy.h	_shop_prices
 9628                        		__isub_st.wmq	_zenny_amount
         01:CBCA  38         			sec
         01:CBCB  49 FF      			eor	#$FF
         01:CBCD  6D 28 26   			adc.l	_zenny_amount
         01:CBD0  8D 28 26   			sta.l	_zenny_amount
         01:CBD3  98         			tya
         01:CBD4  49 FF      			eor	#$FF
         01:CBD6  6D 29 26   			adc.h	_zenny_amount
         01:CBD9  8D 29 26   			sta.h	_zenny_amount
 9629                        	
 9630                        		.dbg	line,	"include\routines_SHOP.c", 142; display_ZENNY();
 9631                        		__call		_display_ZENNY
         01:CBDC  20 45 FF   			call	_display_ZENNY
 9632                        	
 9633                        		.dbg	line,	"include\routines_SHOP.c", 143; }
 9634                        	
 9635                        		.dbg	line,	"include\routines_SHOP.c", 144; }
 9636    01:CBDF             	.LL435	.alias		.LL432
 9637                        	
 9638                        		.dbg	line,	"include\routines_SHOP.c", 146; break;   
 9639    01:CBDF             	.LL434	.alias		.LL432
 9640                        		__bra		.LL432
         01:CBDF  4C 80 CF   			bra	.LL432
 9641                        	
 9642                        		.dbg	line,	"include\routines_SHOP.c", 149; // WEAPON 4 //
 9643                        	
 9644                        		.dbg	line,	"include\routines_SHOP.c", 150; case 1:
 9645    01:CBE2             	.LL436:
 9646                        		__case		1
 9647                        	
 9648                        		.dbg	line,	"include\routines_SHOP.c", 151; if(zenny_amount >= shop_prices[1])
 9649                        		__ld.wm		_zenny_amount
         01:CBE2  AD 28 26   			lda.l	_zenny_amount
         01:CBE5  AC 29 26   			ldy.h	_zenny_amount
 9650                        		__sge_w.wm	_shop_prices + 2
         01:CBE8  CD 2E 26   			cmp.l	_shop_prices + 2		; Subtract memory from Y:A.
         01:CBEB  98         			tya
         01:CBEC  ED 2F 26   			sbc.h	_shop_prices + 2
         01:CBEF  50 02      			bvc	!+
         01:CBF1  49 80      			eor	#$80		; +ve if Y:A >= memory (signed).
         01:CBF3  49 80      	!:		eor	#$80
         01:CBF5  0A         			asl	a
 9651                        		__bfalse	.LL437
         01:CBF6  B0 03 4C 80			bcc	.LL437
         01:CBFA  CF          
 9652                        	
 9653                        		.dbg	line,	"include\routines_SHOP.c", 152; {
 9654                        	
 9655                        		.dbg	line,	"include\routines_SHOP.c", 153; if(weapon_level < 4)
 9656                        		__ld.umq	_weapon_level
         01:CBFB  AD 20 23   			lda	_weapon_level
 9657                        		__ult_b.uiq	4
         01:CBFE  C9 04      			cmp	#4		; Subtract integer from A.
         01:CC00  6A         			ror	a		; CC if A < integer.
         01:CC01  49 80      			eor	#$80
         01:CC03  2A         			rol	a
 9658                        		__bfalse	.LL438
         01:CC04  B0 03 4C 80			bcc	.LL438
         01:CC08  CF          
 9659                        	
 9660                        		.dbg	line,	"include\routines_SHOP.c", 154; {
 9661                        	
 9662                        		.dbg	line,	"include\routines_SHOP.c", 155; weapon_level = 4;
 9663                        		__st.umiq	4, _weapon_level
         01:CC09  A9 04      			lda.l	#4
         01:CC0B  8D 20 23   			sta	_weapon_level
 9664                        	
 9665                        		.dbg	line,	"include\routines_SHOP.c", 156; load_vram( WEAPON_VRAM_ADR, tileset_WEAPON_4, SIZEOF(tileset_WEAPON_4) >> 1 );
 9666                        		__st.wmiq	4256, _di
         01:CC0E  A9 A0      			lda.l	#4256
         01:CC10  85 F0      			sta.l	_di
         01:CC12  A9 10      			lda.h	#4256
         01:CC14  85 F1      			sta.h	_di
 9667                        		__farptr	_tileset_WEAPON_4, _bp_bank, _bp
         01:CC16  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_WEAPON_4))
         01:CC18  85 EC      			sta.l	_bp
         01:CC1A  A9 78      			lda.h	#$6000 + ($1FFF & (_tileset_WEAPON_4))
         01:CC1C  85 ED      			sta.h	_bp
         01:CC1E  A9 03      			lda	#bank(_tileset_WEAPON_4)
         01:CC20  85 02      			sta	_bp_bank
 9668                        		__ld.wi		___sizeof__tileset_WEAPON_4
         01:CC22  A9 80      			lda.l	#___sizeof__tileset_WEAPON_4
         01:CC24  A0 00      			ldy.h	#___sizeof__tileset_WEAPON_4
 9669                        		__lsr.wi	1
         01:CC26  42         			say
         01:CC27  4A         			lsr	a
         01:CC28  42         			say
         01:CC29  6A         			ror	a
 9670                        		__st.wmq	_ax
         01:CC2A  85 F8      			sta.l	_ax
         01:CC2C  84 F9      			sty.h	_ax
 9671                        		 _load_vram.3
         01:CC2E  82         			clx				; Offset to PCE VDC.
         01:CC2F  20 63 FF   			call	load_vram_x
 9672                        	
 9673                        		.dbg	line,	"include\routines_SHOP.c", 158; zenny_amount -= shop_prices[1];
 9674                        		__ld.wm		_shop_prices + 2
         01:CC32  AD 2E 26   			lda.l	_shop_prices + 2
         01:CC35  AC 2F 26   			ldy.h	_shop_prices + 2
 9675                        		__isub_st.wmq	_zenny_amount
         01:CC38  38         			sec
         01:CC39  49 FF      			eor	#$FF
         01:CC3B  6D 28 26   			adc.l	_zenny_amount
         01:CC3E  8D 28 26   			sta.l	_zenny_amount
         01:CC41  98         			tya
         01:CC42  49 FF      			eor	#$FF
         01:CC44  6D 29 26   			adc.h	_zenny_amount
         01:CC47  8D 29 26   			sta.h	_zenny_amount
 9676                        	
 9677                        		.dbg	line,	"include\routines_SHOP.c", 159; display_ZENNY();
 9678                        		__call		_display_ZENNY
         01:CC4A  20 45 FF   			call	_display_ZENNY
 9679                        	
 9680                        		.dbg	line,	"include\routines_SHOP.c", 160; }
 9681                        	
 9682                        		.dbg	line,	"include\routines_SHOP.c", 161; }
 9683    01:CC4D             	.LL438	.alias		.LL432
 9684                        	
 9685                        		.dbg	line,	"include\routines_SHOP.c", 163; break; 
 9686    01:CC4D             	.LL437	.alias		.LL432
 9687                        		__bra		.LL432
         01:CC4D  4C 80 CF   			bra	.LL432
 9688                        	
 9689                        		.dbg	line,	"include\routines_SHOP.c", 166; // WEAPON 5 //
 9690                        	
 9691                        		.dbg	line,	"include\routines_SHOP.c", 167; case 2:
 9692    01:CC50             	.LL439:
 9693                        		__case		2
 9694                        	
 9695                        		.dbg	line,	"include\routines_SHOP.c", 168; if(zenny_amount >= shop_prices[2])
 9696                        		__ld.wm		_zenny_amount
         01:CC50  AD 28 26   			lda.l	_zenny_amount
         01:CC53  AC 29 26   			ldy.h	_zenny_amount
 9697                        		__sge_w.wm	_shop_prices + 4
         01:CC56  CD 30 26   			cmp.l	_shop_prices + 4		; Subtract memory from Y:A.
         01:CC59  98         			tya
         01:CC5A  ED 31 26   			sbc.h	_shop_prices + 4
         01:CC5D  50 02      			bvc	!+
         01:CC5F  49 80      			eor	#$80		; +ve if Y:A >= memory (signed).
         01:CC61  49 80      	!:		eor	#$80
         01:CC63  0A         			asl	a
 9698                        		__bfalse	.LL440
         01:CC64  B0 03 4C 80			bcc	.LL440
         01:CC68  CF          
 9699                        	
 9700                        		.dbg	line,	"include\routines_SHOP.c", 169; {
 9701                        	
 9702                        		.dbg	line,	"include\routines_SHOP.c", 170; if(weapon_level < 5)
 9703                        		__ld.umq	_weapon_level
         01:CC69  AD 20 23   			lda	_weapon_level
 9704                        		__ult_b.uiq	5
         01:CC6C  C9 05      			cmp	#5		; Subtract integer from A.
         01:CC6E  6A         			ror	a		; CC if A < integer.
         01:CC6F  49 80      			eor	#$80
         01:CC71  2A         			rol	a
 9705                        		__bfalse	.LL441
         01:CC72  B0 03 4C 80			bcc	.LL441
         01:CC76  CF          
 9706                        	
 9707                        		.dbg	line,	"include\routines_SHOP.c", 171; {
 9708                        	
 9709                        		.dbg	line,	"include\routines_SHOP.c", 172; weapon_level = 5;
 9710                        		__st.umiq	5, _weapon_level
         01:CC77  A9 05      			lda.l	#5
         01:CC79  8D 20 23   			sta	_weapon_level
 9711                        	
 9712                        		.dbg	line,	"include\routines_SHOP.c", 173; load_vram( WEAPON_VRAM_ADR, tileset_WEAPON_5, SIZEOF(tileset_WEAPON_5) >> 1 );
 9713                        		__st.wmiq	4256, _di
         01:CC7C  A9 A0      			lda.l	#4256
         01:CC7E  85 F0      			sta.l	_di
         01:CC80  A9 10      			lda.h	#4256
         01:CC82  85 F1      			sta.h	_di
 9714                        		__farptr	_tileset_WEAPON_5, _bp_bank, _bp
         01:CC84  A9 80      			lda.l	#$6000 + ($1FFF & (_tileset_WEAPON_5))
         01:CC86  85 EC      			sta.l	_bp
         01:CC88  A9 78      			lda.h	#$6000 + ($1FFF & (_tileset_WEAPON_5))
         01:CC8A  85 ED      			sta.h	_bp
         01:CC8C  A9 03      			lda	#bank(_tileset_WEAPON_5)
         01:CC8E  85 02      			sta	_bp_bank
 9715                        		__ld.wi		___sizeof__tileset_WEAPON_5
         01:CC90  A9 80      			lda.l	#___sizeof__tileset_WEAPON_5
         01:CC92  A0 00      			ldy.h	#___sizeof__tileset_WEAPON_5
 9716                        		__lsr.wi	1
         01:CC94  42         			say
         01:CC95  4A         			lsr	a
         01:CC96  42         			say
         01:CC97  6A         			ror	a
 9717                        		__st.wmq	_ax
         01:CC98  85 F8      			sta.l	_ax
         01:CC9A  84 F9      			sty.h	_ax
 9718                        		 _load_vram.3
         01:CC9C  82         			clx				; Offset to PCE VDC.
         01:CC9D  20 63 FF   			call	load_vram_x
 9719                        	
 9720                        		.dbg	line,	"include\routines_SHOP.c", 175; zenny_amount -= shop_prices[2];
 9721                        		__ld.wm		_shop_prices + 4
         01:CCA0  AD 30 26   			lda.l	_shop_prices + 4
         01:CCA3  AC 31 26   			ldy.h	_shop_prices + 4
 9722                        		__isub_st.wmq	_zenny_amount
         01:CCA6  38         			sec
         01:CCA7  49 FF      			eor	#$FF
         01:CCA9  6D 28 26   			adc.l	_zenny_amount
         01:CCAC  8D 28 26   			sta.l	_zenny_amount
         01:CCAF  98         			tya
         01:CCB0  49 FF      			eor	#$FF
         01:CCB2  6D 29 26   			adc.h	_zenny_amount
         01:CCB5  8D 29 26   			sta.h	_zenny_amount
 9723                        	
 9724                        		.dbg	line,	"include\routines_SHOP.c", 176; display_ZENNY();
 9725                        		__call		_display_ZENNY
         01:CCB8  20 45 FF   			call	_display_ZENNY
 9726                        	
 9727                        		.dbg	line,	"include\routines_SHOP.c", 177; }
 9728                        	
 9729                        		.dbg	line,	"include\routines_SHOP.c", 178; }
 9730    01:CCBB             	.LL441	.alias		.LL432
 9731                        	
 9732                        		.dbg	line,	"include\routines_SHOP.c", 180; break;   
 9733    01:CCBB             	.LL440	.alias		.LL432
 9734                        		__bra		.LL432
         01:CCBB  4C 80 CF   			bra	.LL432
 9735                        	
 9736                        		.dbg	line,	"include\routines_SHOP.c", 183; // WEAPON 8 //
 9737                        	
 9738                        		.dbg	line,	"include\routines_SHOP.c", 184; case 3:
 9739    01:CCBE             	.LL442:
 9740                        		__case		3
 9741                        	
 9742                        		.dbg	line,	"include\routines_SHOP.c", 185; if(zenny_amount >= shop_prices[3])
 9743                        		__ld.wm		_zenny_amount
         01:CCBE  AD 28 26   			lda.l	_zenny_amount
         01:CCC1  AC 29 26   			ldy.h	_zenny_amount
 9744                        		__sge_w.wm	_shop_prices + 6
         01:CCC4  CD 32 26   			cmp.l	_shop_prices + 6		; Subtract memory from Y:A.
         01:CCC7  98         			tya
         01:CCC8  ED 33 26   			sbc.h	_shop_prices + 6
         01:CCCB  50 02      			bvc	!+
         01:CCCD  49 80      			eor	#$80		; +ve if Y:A >= memory (signed).
         01:CCCF  49 80      	!:		eor	#$80
         01:CCD1  0A         			asl	a
 9745                        		__bfalse	.LL443
         01:CCD2  B0 03 4C 80			bcc	.LL443
         01:CCD6  CF          
 9746                        	
 9747                        		.dbg	line,	"include\routines_SHOP.c", 186; {
 9748                        	
 9749                        		.dbg	line,	"include\routines_SHOP.c", 187; if(weapon_level < 8)
 9750                        		__ld.umq	_weapon_level
         01:CCD7  AD 20 23   			lda	_weapon_level
 9751                        		__ult_b.uiq	8
         01:CCDA  C9 08      			cmp	#8		; Subtract integer from A.
         01:CCDC  6A         			ror	a		; CC if A < integer.
         01:CCDD  49 80      			eor	#$80
         01:CCDF  2A         			rol	a
 9752                        		__bfalse	.LL444
         01:CCE0  B0 03 4C 80			bcc	.LL444
         01:CCE4  CF          
 9753                        	
 9754                        		.dbg	line,	"include\routines_SHOP.c", 188; {
 9755                        	
 9756                        		.dbg	line,	"include\routines_SHOP.c", 189; weapon_level = 8;
 9757                        		__st.umiq	8, _weapon_level
         01:CCE5  A9 08      			lda.l	#8
         01:CCE7  8D 20 23   			sta	_weapon_level
 9758                        	
 9759                        		.dbg	line,	"include\routines_SHOP.c", 190; load_vram( WEAPON_VRAM_ADR, tileset_WEAPON_8, SIZEOF(tileset_WEAPON_8) >> 1 );
 9760                        		__st.wmiq	4256, _di
         01:CCEA  A9 A0      			lda.l	#4256
         01:CCEC  85 F0      			sta.l	_di
         01:CCEE  A9 10      			lda.h	#4256
         01:CCF0  85 F1      			sta.h	_di
 9761                        		__farptr	_tileset_WEAPON_8, _bp_bank, _bp
         01:CCF2  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_WEAPON_8))
         01:CCF4  85 EC      			sta.l	_bp
         01:CCF6  A9 79      			lda.h	#$6000 + ($1FFF & (_tileset_WEAPON_8))
         01:CCF8  85 ED      			sta.h	_bp
         01:CCFA  A9 03      			lda	#bank(_tileset_WEAPON_8)
         01:CCFC  85 02      			sta	_bp_bank
 9762                        		__ld.wi		___sizeof__tileset_WEAPON_8
         01:CCFE  A9 80      			lda.l	#___sizeof__tileset_WEAPON_8
         01:CD00  A0 00      			ldy.h	#___sizeof__tileset_WEAPON_8
 9763                        		__lsr.wi	1
         01:CD02  42         			say
         01:CD03  4A         			lsr	a
         01:CD04  42         			say
         01:CD05  6A         			ror	a
 9764                        		__st.wmq	_ax
         01:CD06  85 F8      			sta.l	_ax
         01:CD08  84 F9      			sty.h	_ax
 9765                        		 _load_vram.3
         01:CD0A  82         			clx				; Offset to PCE VDC.
         01:CD0B  20 63 FF   			call	load_vram_x
 9766                        	
 9767                        		.dbg	line,	"include\routines_SHOP.c", 192; zenny_amount -= shop_prices[3];
 9768                        		__ld.wm		_shop_prices + 6
         01:CD0E  AD 32 26   			lda.l	_shop_prices + 6
         01:CD11  AC 33 26   			ldy.h	_shop_prices + 6
 9769                        		__isub_st.wmq	_zenny_amount
         01:CD14  38         			sec
         01:CD15  49 FF      			eor	#$FF
         01:CD17  6D 28 26   			adc.l	_zenny_amount
         01:CD1A  8D 28 26   			sta.l	_zenny_amount
         01:CD1D  98         			tya
         01:CD1E  49 FF      			eor	#$FF
         01:CD20  6D 29 26   			adc.h	_zenny_amount
         01:CD23  8D 29 26   			sta.h	_zenny_amount
 9770                        	
 9771                        		.dbg	line,	"include\routines_SHOP.c", 193; display_ZENNY();
 9772                        		__call		_display_ZENNY
         01:CD26  20 45 FF   			call	_display_ZENNY
 9773                        	
 9774                        		.dbg	line,	"include\routines_SHOP.c", 194; }
 9775                        	
 9776                        		.dbg	line,	"include\routines_SHOP.c", 195; }
 9777    01:CD29             	.LL444	.alias		.LL432
 9778                        	
 9779                        		.dbg	line,	"include\routines_SHOP.c", 197; break;  
 9780    01:CD29             	.LL443	.alias		.LL432
 9781                        		__bra		.LL432
         01:CD29  4C 80 CF   			bra	.LL432
 9782                        	
 9783                        		.dbg	line,	"include\routines_SHOP.c", 200; // KEY //
 9784                        	
 9785                        		.dbg	line,	"include\routines_SHOP.c", 201; case 4:
 9786    01:CD2C             	.LL445:
 9787                        		__case		4
 9788                        	
 9789                        		.dbg	line,	"include\routines_SHOP.c", 202; if(zenny_amount >= shop_prices[4])
 9790                        		__ld.wm		_zenny_amount
         01:CD2C  AD 28 26   			lda.l	_zenny_amount
         01:CD2F  AC 29 26   			ldy.h	_zenny_amount
 9791                        		__sge_w.wm	_shop_prices + 8
         01:CD32  CD 34 26   			cmp.l	_shop_prices + 8		; Subtract memory from Y:A.
         01:CD35  98         			tya
         01:CD36  ED 35 26   			sbc.h	_shop_prices + 8
         01:CD39  50 02      			bvc	!+
         01:CD3B  49 80      			eor	#$80		; +ve if Y:A >= memory (signed).
         01:CD3D  49 80      	!:		eor	#$80
         01:CD3F  0A         			asl	a
 9792                        		__bfalse	.LL446
         01:CD40  B0 03 4C 80			bcc	.LL446
         01:CD44  CF          
 9793                        	
 9794                        		.dbg	line,	"include\routines_SHOP.c", 203; {
 9795                        	
 9796                        		.dbg	line,	"include\routines_SHOP.c", 204; key_amount += 1;
 9797                        		__add_st.umiq	1, _key_amount
         01:CD45  EE 22 23   			inc	_key_amount
 9798                        	
 9799                        		.dbg	line,	"include\routines_SHOP.c", 206; zenny_amount -= shop_prices[4];
 9800                        		__ld.wm		_shop_prices + 8
         01:CD48  AD 34 26   			lda.l	_shop_prices + 8
         01:CD4B  AC 35 26   			ldy.h	_shop_prices + 8
 9801                        		__isub_st.wmq	_zenny_amount
         01:CD4E  38         			sec
         01:CD4F  49 FF      			eor	#$FF
         01:CD51  6D 28 26   			adc.l	_zenny_amount
         01:CD54  8D 28 26   			sta.l	_zenny_amount
         01:CD57  98         			tya
         01:CD58  49 FF      			eor	#$FF
         01:CD5A  6D 29 26   			adc.h	_zenny_amount
         01:CD5D  8D 29 26   			sta.h	_zenny_amount
 9802                        	
 9803                        		.dbg	line,	"include\routines_SHOP.c", 207; display_KEY();
 9804                        		__call		_display_KEY
         01:CD60  20 8B FF   			call	_display_KEY
 9805                        	
 9806                        		.dbg	line,	"include\routines_SHOP.c", 208; }
 9807                        	
 9808                        		.dbg	line,	"include\routines_SHOP.c", 210; break;   
 9809    01:CD63             	.LL446	.alias		.LL432
 9810                        		__bra		.LL432
         01:CD63  4C 80 CF   			bra	.LL432
 9811                        	
 9812                        		.dbg	line,	"include\routines_SHOP.c", 213; // ARMOR 1 //
 9813                        	
 9814                        		.dbg	line,	"include\routines_SHOP.c", 214; case 5:
 9815    01:CD66             	.LL447:
 9816                        		__case		5
 9817                        	
 9818                        		.dbg	line,	"include\routines_SHOP.c", 215; if(zenny_amount >= shop_prices[5])
 9819                        		__ld.wm		_zenny_amount
         01:CD66  AD 28 26   			lda.l	_zenny_amount
         01:CD69  AC 29 26   			ldy.h	_zenny_amount
 9820                        		__sge_w.wm	_shop_prices + 10
         01:CD6C  CD 36 26   			cmp.l	_shop_prices + 10		; Subtract memory from Y:A.
         01:CD6F  98         			tya
         01:CD70  ED 37 26   			sbc.h	_shop_prices + 10
         01:CD73  50 02      			bvc	!+
         01:CD75  49 80      			eor	#$80		; +ve if Y:A >= memory (signed).
         01:CD77  49 80      	!:		eor	#$80
         01:CD79  0A         			asl	a
 9821                        		__bfalse	.LL448
         01:CD7A  B0 03 4C 80			bcc	.LL448
         01:CD7E  CF          
 9822                        	
 9823                        		.dbg	line,	"include\routines_SHOP.c", 216; {
 9824                        	
 9825                        		.dbg	line,	"include\routines_SHOP.c", 217; if(armor_level < 1)
 9826                        		__ld.umq	_armor_level
         01:CD7F  AD 1F 23   			lda	_armor_level
 9827                        		__ult_b.uiq	1
         01:CD82  C9 01      			cmp	#1		; Subtract integer from A.
         01:CD84  6A         			ror	a		; CC if A < integer.
         01:CD85  49 80      			eor	#$80
         01:CD87  2A         			rol	a
 9828                        		__bfalse	.LL449
         01:CD88  B0 03 4C 80			bcc	.LL449
         01:CD8C  CF          
 9829                        	
 9830                        		.dbg	line,	"include\routines_SHOP.c", 218; {
 9831                        	
 9832                        		.dbg	line,	"include\routines_SHOP.c", 219; armor_level = 1;
 9833                        		__st.umiq	1, _armor_level
         01:CD8D  A9 01      			lda.l	#1
         01:CD8F  8D 1F 23   			sta	_armor_level
 9834                        	
 9835                        		.dbg	line,	"include\routines_SHOP.c", 220; load_vram( ARMOR_VRAM_ADR, tileset_ARMOR_1, SIZEOF(tileset_ARMOR_1) >> 1 );
 9836                        		__st.wmiq	4320, _di
         01:CD92  A9 E0      			lda.l	#4320
         01:CD94  85 F0      			sta.l	_di
         01:CD96  A9 10      			lda.h	#4320
         01:CD98  85 F1      			sta.h	_di
 9837                        		__farptr	_tileset_ARMOR_1, _bp_bank, _bp
         01:CD9A  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_ARMOR_1))
         01:CD9C  85 EC      			sta.l	_bp
         01:CD9E  A9 75      			lda.h	#$6000 + ($1FFF & (_tileset_ARMOR_1))
         01:CDA0  85 ED      			sta.h	_bp
         01:CDA2  A9 03      			lda	#bank(_tileset_ARMOR_1)
         01:CDA4  85 02      			sta	_bp_bank
 9838                        		__ld.wi		___sizeof__tileset_ARMOR_1
         01:CDA6  A9 80      			lda.l	#___sizeof__tileset_ARMOR_1
         01:CDA8  A0 00      			ldy.h	#___sizeof__tileset_ARMOR_1
 9839                        		__lsr.wi	1
         01:CDAA  42         			say
         01:CDAB  4A         			lsr	a
         01:CDAC  42         			say
         01:CDAD  6A         			ror	a
 9840                        		__st.wmq	_ax
         01:CDAE  85 F8      			sta.l	_ax
         01:CDB0  84 F9      			sty.h	_ax
 9841                        		 _load_vram.3
         01:CDB2  82         			clx				; Offset to PCE VDC.
         01:CDB3  20 63 FF   			call	load_vram_x
 9842                        	
 9843                        		.dbg	line,	"include\routines_SHOP.c", 222; zenny_amount -= shop_prices[5];
 9844                        		__ld.wm		_shop_prices + 10
         01:CDB6  AD 36 26   			lda.l	_shop_prices + 10
         01:CDB9  AC 37 26   			ldy.h	_shop_prices + 10
 9845                        		__isub_st.wmq	_zenny_amount
         01:CDBC  38         			sec
         01:CDBD  49 FF      			eor	#$FF
         01:CDBF  6D 28 26   			adc.l	_zenny_amount
         01:CDC2  8D 28 26   			sta.l	_zenny_amount
         01:CDC5  98         			tya
         01:CDC6  49 FF      			eor	#$FF
         01:CDC8  6D 29 26   			adc.h	_zenny_amount
         01:CDCB  8D 29 26   			sta.h	_zenny_amount
 9846                        	
 9847                        		.dbg	line,	"include\routines_SHOP.c", 223; display_ZENNY();
 9848                        		__call		_display_ZENNY
         01:CDCE  20 45 FF   			call	_display_ZENNY
 9849                        	
 9850                        		.dbg	line,	"include\routines_SHOP.c", 224; }
 9851                        	
 9852                        		.dbg	line,	"include\routines_SHOP.c", 225; }
 9853    01:CDD1             	.LL449	.alias		.LL432
 9854                        	
 9855                        		.dbg	line,	"include\routines_SHOP.c", 227; break;   
 9856    01:CDD1             	.LL448	.alias		.LL432
 9857                        		__bra		.LL432
         01:CDD1  4C 80 CF   			bra	.LL432
 9858                        	
 9859                        		.dbg	line,	"include\routines_SHOP.c", 230; // ARMOR 2 //
 9860                        	
 9861                        		.dbg	line,	"include\routines_SHOP.c", 231; case 6:
 9862    01:CDD4             	.LL450:
 9863                        		__case		6
 9864                        	
 9865                        		.dbg	line,	"include\routines_SHOP.c", 232; if(zenny_amount >= shop_prices[6])
 9866                        		__ld.wm		_zenny_amount
         01:CDD4  AD 28 26   			lda.l	_zenny_amount
         01:CDD7  AC 29 26   			ldy.h	_zenny_amount
 9867                        		__sge_w.wm	_shop_prices + 12
         01:CDDA  CD 38 26   			cmp.l	_shop_prices + 12		; Subtract memory from Y:A.
         01:CDDD  98         			tya
         01:CDDE  ED 39 26   			sbc.h	_shop_prices + 12
         01:CDE1  50 02      			bvc	!+
         01:CDE3  49 80      			eor	#$80		; +ve if Y:A >= memory (signed).
         01:CDE5  49 80      	!:		eor	#$80
         01:CDE7  0A         			asl	a
 9868                        		__bfalse	.LL451
         01:CDE8  B0 03 4C 80			bcc	.LL451
         01:CDEC  CF          
 9869                        	
 9870                        		.dbg	line,	"include\routines_SHOP.c", 233; {
 9871                        	
 9872                        		.dbg	line,	"include\routines_SHOP.c", 234; if(armor_level < 4)
 9873                        		__ld.umq	_armor_level
         01:CDED  AD 1F 23   			lda	_armor_level
 9874                        		__ult_b.uiq	4
         01:CDF0  C9 04      			cmp	#4		; Subtract integer from A.
         01:CDF2  6A         			ror	a		; CC if A < integer.
         01:CDF3  49 80      			eor	#$80
         01:CDF5  2A         			rol	a
 9875                        		__bfalse	.LL452
         01:CDF6  B0 03 4C 80			bcc	.LL452
         01:CDFA  CF          
 9876                        	
 9877                        		.dbg	line,	"include\routines_SHOP.c", 235; {
 9878                        	
 9879                        		.dbg	line,	"include\routines_SHOP.c", 236; armor_level = 4;
 9880                        		__st.umiq	4, _armor_level
         01:CDFB  A9 04      			lda.l	#4
         01:CDFD  8D 1F 23   			sta	_armor_level
 9881                        	
 9882                        		.dbg	line,	"include\routines_SHOP.c", 237; load_vram( ARMOR_VRAM_ADR, tileset_ARMOR_2, SIZEOF(tileset_ARMOR_2) >> 1 );
 9883                        		__st.wmiq	4320, _di
         01:CE00  A9 E0      			lda.l	#4320
         01:CE02  85 F0      			sta.l	_di
         01:CE04  A9 10      			lda.h	#4320
         01:CE06  85 F1      			sta.h	_di
 9884                        		__farptr	_tileset_ARMOR_2, _bp_bank, _bp
         01:CE08  A9 80      			lda.l	#$6000 + ($1FFF & (_tileset_ARMOR_2))
         01:CE0A  85 EC      			sta.l	_bp
         01:CE0C  A9 75      			lda.h	#$6000 + ($1FFF & (_tileset_ARMOR_2))
         01:CE0E  85 ED      			sta.h	_bp
         01:CE10  A9 03      			lda	#bank(_tileset_ARMOR_2)
         01:CE12  85 02      			sta	_bp_bank
 9885                        		__ld.wi		___sizeof__tileset_ARMOR_2
         01:CE14  A9 80      			lda.l	#___sizeof__tileset_ARMOR_2
         01:CE16  A0 00      			ldy.h	#___sizeof__tileset_ARMOR_2
 9886                        		__lsr.wi	1
         01:CE18  42         			say
         01:CE19  4A         			lsr	a
         01:CE1A  42         			say
         01:CE1B  6A         			ror	a
 9887                        		__st.wmq	_ax
         01:CE1C  85 F8      			sta.l	_ax
         01:CE1E  84 F9      			sty.h	_ax
 9888                        		 _load_vram.3
         01:CE20  82         			clx				; Offset to PCE VDC.
         01:CE21  20 63 FF   			call	load_vram_x
 9889                        	
 9890                        		.dbg	line,	"include\routines_SHOP.c", 239; zenny_amount -= shop_prices[6];
 9891                        		__ld.wm		_shop_prices + 12
         01:CE24  AD 38 26   			lda.l	_shop_prices + 12
         01:CE27  AC 39 26   			ldy.h	_shop_prices + 12
 9892                        		__isub_st.wmq	_zenny_amount
         01:CE2A  38         			sec
         01:CE2B  49 FF      			eor	#$FF
         01:CE2D  6D 28 26   			adc.l	_zenny_amount
         01:CE30  8D 28 26   			sta.l	_zenny_amount
         01:CE33  98         			tya
         01:CE34  49 FF      			eor	#$FF
         01:CE36  6D 29 26   			adc.h	_zenny_amount
         01:CE39  8D 29 26   			sta.h	_zenny_amount
 9893                        	
 9894                        		.dbg	line,	"include\routines_SHOP.c", 240; display_ZENNY();
 9895                        		__call		_display_ZENNY
         01:CE3C  20 45 FF   			call	_display_ZENNY
 9896                        	
 9897                        		.dbg	line,	"include\routines_SHOP.c", 241; }
 9898                        	
 9899                        		.dbg	line,	"include\routines_SHOP.c", 242; }
 9900    01:CE3F             	.LL452	.alias		.LL432
 9901                        	
 9902                        		.dbg	line,	"include\routines_SHOP.c", 244; break;    
 9903    01:CE3F             	.LL451	.alias		.LL432
 9904                        		__bra		.LL432
         01:CE3F  4C 80 CF   			bra	.LL432
 9905                        	
 9906                        		.dbg	line,	"include\routines_SHOP.c", 247; // ARMOR 4 //
 9907                        	
 9908                        		.dbg	line,	"include\routines_SHOP.c", 248; case 7:
 9909    01:CE42             	.LL453:
 9910                        		__case		7
 9911                        	
 9912                        		.dbg	line,	"include\routines_SHOP.c", 249; if(zenny_amount >= shop_prices[7])
 9913                        		__ld.wm		_zenny_amount
         01:CE42  AD 28 26   			lda.l	_zenny_amount
         01:CE45  AC 29 26   			ldy.h	_zenny_amount
 9914                        		__sge_w.wm	_shop_prices + 14
         01:CE48  CD 3A 26   			cmp.l	_shop_prices + 14		; Subtract memory from Y:A.
         01:CE4B  98         			tya
         01:CE4C  ED 3B 26   			sbc.h	_shop_prices + 14
         01:CE4F  50 02      			bvc	!+
         01:CE51  49 80      			eor	#$80		; +ve if Y:A >= memory (signed).
         01:CE53  49 80      	!:		eor	#$80
         01:CE55  0A         			asl	a
 9915                        		__bfalse	.LL454
         01:CE56  B0 03 4C 80			bcc	.LL454
         01:CE5A  CF          
 9916                        	
 9917                        		.dbg	line,	"include\routines_SHOP.c", 250; {
 9918                        	
 9919                        		.dbg	line,	"include\routines_SHOP.c", 251; if(armor_level < 5)
 9920                        		__ld.umq	_armor_level
         01:CE5B  AD 1F 23   			lda	_armor_level
 9921                        		__ult_b.uiq	5
         01:CE5E  C9 05      			cmp	#5		; Subtract integer from A.
         01:CE60  6A         			ror	a		; CC if A < integer.
         01:CE61  49 80      			eor	#$80
         01:CE63  2A         			rol	a
 9922                        		__bfalse	.LL455
         01:CE64  B0 03 4C 80			bcc	.LL455
         01:CE68  CF          
 9923                        	
 9924                        		.dbg	line,	"include\routines_SHOP.c", 252; {
 9925                        	
 9926                        		.dbg	line,	"include\routines_SHOP.c", 253; armor_level = 5;
 9927                        		__st.umiq	5, _armor_level
         01:CE69  A9 05      			lda.l	#5
         01:CE6B  8D 1F 23   			sta	_armor_level
 9928                        	
 9929                        		.dbg	line,	"include\routines_SHOP.c", 254; load_vram( ARMOR_VRAM_ADR, tileset_ARMOR_4, SIZEOF(tileset_ARMOR_4) >> 1 );
 9930                        		__st.wmiq	4320, _di
         01:CE6E  A9 E0      			lda.l	#4320
         01:CE70  85 F0      			sta.l	_di
         01:CE72  A9 10      			lda.h	#4320
         01:CE74  85 F1      			sta.h	_di
 9931                        		__farptr	_tileset_ARMOR_4, _bp_bank, _bp
         01:CE76  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_ARMOR_4))
         01:CE78  85 EC      			sta.l	_bp
         01:CE7A  A9 76      			lda.h	#$6000 + ($1FFF & (_tileset_ARMOR_4))
         01:CE7C  85 ED      			sta.h	_bp
         01:CE7E  A9 03      			lda	#bank(_tileset_ARMOR_4)
         01:CE80  85 02      			sta	_bp_bank
 9932                        		__ld.wi		___sizeof__tileset_ARMOR_4
         01:CE82  A9 80      			lda.l	#___sizeof__tileset_ARMOR_4
         01:CE84  A0 00      			ldy.h	#___sizeof__tileset_ARMOR_4
 9933                        		__lsr.wi	1
         01:CE86  42         			say
         01:CE87  4A         			lsr	a
         01:CE88  42         			say
         01:CE89  6A         			ror	a
 9934                        		__st.wmq	_ax
         01:CE8A  85 F8      			sta.l	_ax
         01:CE8C  84 F9      			sty.h	_ax
 9935                        		 _load_vram.3
         01:CE8E  82         			clx				; Offset to PCE VDC.
         01:CE8F  20 63 FF   			call	load_vram_x
 9936                        	
 9937                        		.dbg	line,	"include\routines_SHOP.c", 256; zenny_amount -= shop_prices[7];
 9938                        		__ld.wm		_shop_prices + 14
         01:CE92  AD 3A 26   			lda.l	_shop_prices + 14
         01:CE95  AC 3B 26   			ldy.h	_shop_prices + 14
 9939                        		__isub_st.wmq	_zenny_amount
         01:CE98  38         			sec
         01:CE99  49 FF      			eor	#$FF
         01:CE9B  6D 28 26   			adc.l	_zenny_amount
         01:CE9E  8D 28 26   			sta.l	_zenny_amount
         01:CEA1  98         			tya
         01:CEA2  49 FF      			eor	#$FF
         01:CEA4  6D 29 26   			adc.h	_zenny_amount
         01:CEA7  8D 29 26   			sta.h	_zenny_amount
 9940                        	
 9941                        		.dbg	line,	"include\routines_SHOP.c", 257; display_ZENNY();
 9942                        		__call		_display_ZENNY
         01:CEAA  20 45 FF   			call	_display_ZENNY
 9943                        	
 9944                        		.dbg	line,	"include\routines_SHOP.c", 258; }
 9945                        	
 9946                        		.dbg	line,	"include\routines_SHOP.c", 259; }
 9947    01:CEAD             	.LL455	.alias		.LL432
 9948                        	
 9949                        		.dbg	line,	"include\routines_SHOP.c", 261; break;   
 9950    01:CEAD             	.LL454	.alias		.LL432
 9951                        		__bra		.LL432
         01:CEAD  4C 80 CF   			bra	.LL432
 9952                        	
 9953                        		.dbg	line,	"include\routines_SHOP.c", 264; // ARMOR 8 //
 9954                        	
 9955                        		.dbg	line,	"include\routines_SHOP.c", 265; case 8:
 9956    01:CEB0             	.LL456:
 9957                        		__case		8
 9958                        	
 9959                        		.dbg	line,	"include\routines_SHOP.c", 266; if(zenny_amount >= shop_prices[8])
 9960                        		__ld.wm		_zenny_amount
         01:CEB0  AD 28 26   			lda.l	_zenny_amount
         01:CEB3  AC 29 26   			ldy.h	_zenny_amount
 9961                        		__sge_w.wm	_shop_prices + 16
         01:CEB6  CD 3C 26   			cmp.l	_shop_prices + 16		; Subtract memory from Y:A.
         01:CEB9  98         			tya
         01:CEBA  ED 3D 26   			sbc.h	_shop_prices + 16
         01:CEBD  50 02      			bvc	!+
         01:CEBF  49 80      			eor	#$80		; +ve if Y:A >= memory (signed).
         01:CEC1  49 80      	!:		eor	#$80
         01:CEC3  0A         			asl	a
 9962                        		__bfalse	.LL457
         01:CEC4  B0 03 4C 80			bcc	.LL457
         01:CEC8  CF          
 9963                        	
 9964                        		.dbg	line,	"include\routines_SHOP.c", 267; {
 9965                        	
 9966                        		.dbg	line,	"include\routines_SHOP.c", 268; if(armor_level < 8)
 9967                        		__ld.umq	_armor_level
         01:CEC9  AD 1F 23   			lda	_armor_level
 9968                        		__ult_b.uiq	8
         01:CECC  C9 08      			cmp	#8		; Subtract integer from A.
         01:CECE  6A         			ror	a		; CC if A < integer.
         01:CECF  49 80      			eor	#$80
         01:CED1  2A         			rol	a
 9969                        		__bfalse	.LL458
         01:CED2  B0 03 4C 80			bcc	.LL458
         01:CED6  CF          
 9970                        	
 9971                        		.dbg	line,	"include\routines_SHOP.c", 269; {
 9972                        	
 9973                        		.dbg	line,	"include\routines_SHOP.c", 270; armor_level = 8;
 9974                        		__st.umiq	8, _armor_level
         01:CED7  A9 08      			lda.l	#8
         01:CED9  8D 1F 23   			sta	_armor_level
 9975                        	
 9976                        		.dbg	line,	"include\routines_SHOP.c", 271; load_vram( ARMOR_VRAM_ADR, tileset_ARMOR_8, SIZEOF(tileset_ARMOR_8) >> 1 );
 9977                        		__st.wmiq	4320, _di
         01:CEDC  A9 E0      			lda.l	#4320
         01:CEDE  85 F0      			sta.l	_di
         01:CEE0  A9 10      			lda.h	#4320
         01:CEE2  85 F1      			sta.h	_di
 9978                        		__farptr	_tileset_ARMOR_8, _bp_bank, _bp
         01:CEE4  A9 80      			lda.l	#$6000 + ($1FFF & (_tileset_ARMOR_8))
         01:CEE6  85 EC      			sta.l	_bp
         01:CEE8  A9 76      			lda.h	#$6000 + ($1FFF & (_tileset_ARMOR_8))
         01:CEEA  85 ED      			sta.h	_bp
         01:CEEC  A9 03      			lda	#bank(_tileset_ARMOR_8)
         01:CEEE  85 02      			sta	_bp_bank
 9979                        		__ld.wi		___sizeof__tileset_ARMOR_8
         01:CEF0  A9 80      			lda.l	#___sizeof__tileset_ARMOR_8
         01:CEF2  A0 00      			ldy.h	#___sizeof__tileset_ARMOR_8
 9980                        		__lsr.wi	1
         01:CEF4  42         			say
         01:CEF5  4A         			lsr	a
         01:CEF6  42         			say
         01:CEF7  6A         			ror	a
 9981                        		__st.wmq	_ax
         01:CEF8  85 F8      			sta.l	_ax
         01:CEFA  84 F9      			sty.h	_ax
 9982                        		 _load_vram.3
         01:CEFC  82         			clx				; Offset to PCE VDC.
         01:CEFD  20 63 FF   			call	load_vram_x
 9983                        	
 9984                        		.dbg	line,	"include\routines_SHOP.c", 273; zenny_amount -= shop_prices[8];
 9985                        		__ld.wm		_shop_prices + 16
         01:CF00  AD 3C 26   			lda.l	_shop_prices + 16
         01:CF03  AC 3D 26   			ldy.h	_shop_prices + 16
 9986                        		__isub_st.wmq	_zenny_amount
         01:CF06  38         			sec
         01:CF07  49 FF      			eor	#$FF
         01:CF09  6D 28 26   			adc.l	_zenny_amount
         01:CF0C  8D 28 26   			sta.l	_zenny_amount
         01:CF0F  98         			tya
         01:CF10  49 FF      			eor	#$FF
         01:CF12  6D 29 26   			adc.h	_zenny_amount
         01:CF15  8D 29 26   			sta.h	_zenny_amount
 9987                        	
 9988                        		.dbg	line,	"include\routines_SHOP.c", 274; display_ZENNY();
 9989                        		__call		_display_ZENNY
         01:CF18  20 45 FF   			call	_display_ZENNY
 9990                        	
 9991                        		.dbg	line,	"include\routines_SHOP.c", 275; }
 9992                        	
 9993                        		.dbg	line,	"include\routines_SHOP.c", 276; }
 9994    01:CF1B             	.LL458	.alias		.LL432
 9995                        	
 9996                        		.dbg	line,	"include\routines_SHOP.c", 278; break;   
 9997    01:CF1B             	.LL457	.alias		.LL432
 9998                        		__bra		.LL432
         01:CF1B  80 63      			bra	.LL432
 9999                        	
10000                        		.dbg	line,	"include\routines_SHOP.c", 281; // POTION //
10001                        	
10002                        		.dbg	line,	"include\routines_SHOP.c", 282; case 9:
10003    01:CF1D             	.LL459:
10004                        		__case		9
10005                        	
10006                        		.dbg	line,	"include\routines_SHOP.c", 283; if(zenny_amount >= shop_prices[9])
10007                        		__ld.wm		_zenny_amount
         01:CF1D  AD 28 26   			lda.l	_zenny_amount
         01:CF20  AC 29 26   			ldy.h	_zenny_amount
10008                        		__sge_w.wm	_shop_prices + 18
         01:CF23  CD 3E 26   			cmp.l	_shop_prices + 18		; Subtract memory from Y:A.
         01:CF26  98         			tya
         01:CF27  ED 3F 26   			sbc.h	_shop_prices + 18
         01:CF2A  50 02      			bvc	!+
         01:CF2C  49 80      			eor	#$80		; +ve if Y:A >= memory (signed).
         01:CF2E  49 80      	!:		eor	#$80
         01:CF30  0A         			asl	a
10009                        		__bfalse	.LL460
         01:CF31  90 4D      			bcc	.LL460
10010                        	
10011                        		.dbg	line,	"include\routines_SHOP.c", 284; {
10012                        	
10013                        		.dbg	line,	"include\routines_SHOP.c", 285; potion_amount += 1;
10014                        		__add_st.umiq	1, _potion_amount
         01:CF33  EE 23 23   			inc	_potion_amount
10015                        	
10016                        		.dbg	line,	"include\routines_SHOP.c", 287; zenny_amount -= shop_prices[9];
10017                        		__ld.wm		_shop_prices + 18
         01:CF36  AD 3E 26   			lda.l	_shop_prices + 18
         01:CF39  AC 3F 26   			ldy.h	_shop_prices + 18
10018                        		__isub_st.wmq	_zenny_amount
         01:CF3C  38         			sec
         01:CF3D  49 FF      			eor	#$FF
         01:CF3F  6D 28 26   			adc.l	_zenny_amount
         01:CF42  8D 28 26   			sta.l	_zenny_amount
         01:CF45  98         			tya
         01:CF46  49 FF      			eor	#$FF
         01:CF48  6D 29 26   			adc.h	_zenny_amount
         01:CF4B  8D 29 26   			sta.h	_zenny_amount
10019                        	
10020                        		.dbg	line,	"include\routines_SHOP.c", 288; display_POTION();
10021                        		__call		_display_POTION
         01:CF4E  20 3B FF   			call	_display_POTION
10022                        	
10023                        		.dbg	line,	"include\routines_SHOP.c", 289; }
10024                        	
10025                        		.dbg	line,	"include\routines_SHOP.c", 291; break;   
10026    01:CF51             	.LL460	.alias		.LL432
10027                        		__bra		.LL432
         01:CF51  80 2D      			bra	.LL432
10028                        	
10029                        		.dbg	line,	"include\routines_SHOP.c", 294; // EXIT //
10030                        	
10031                        		.dbg	line,	"include\routines_SHOP.c", 295; case 10:
10032    01:CF53             	.LL461:
10033                        		__case		10
10034                        	
10035                        		.dbg	line,	"include\routines_SHOP.c", 296; shop_counter = 0;    
10036                        		__st.umiq	0, _shop_counter
         01:CF53  9C CD 23   			stz	_shop_counter
10037                        	
10038                        		.dbg	line,	"include\routines_SHOP.c", 297; shop_phase = SHOP_PHASE_EXIT;
10039                        		__st.umiq	2, _shop_phase
         01:CF56  A9 02      			lda.l	#2
         01:CF58  8D CC 23   			sta	_shop_phase
10040                        	
10041                        		.dbg	line,	"include\routines_SHOP.c", 299; break;                  
10042                        		__bra		.LL432
         01:CF5B  80 23      			bra	.LL432
10043                        	
10044                        		.dbg	line,	"include\routines_SHOP.c", 300; }
10045    01:CF5D             	.LL431:
10046                        		__switch_r.ur	0, 10
         01:CF5D  C9 0B      			cmp	#(10 - 0) + 1
         01:CF5F  90 02      			bcc	!found+
         01:CF61  A9 0B      	!default:	lda	#(10 - 0) + 1
         01:CF63  0A         	!found:		asl	a
         01:CF64  AA         			tax
         01:CF65  7C 68 CF   			jmp	[!table+, x]
10047                        	
10048    01:CF68  74 CB      	!table:		dw	.LL433, .LL436, .LL439, .LL442, .LL445, .LL447, .LL450, .LL453
         01:CF6A  E2 CB       
         01:CF6C  50 CC       
         01:CF6E  BE CC       
         01:CF70  2C CD       
         01:CF72  66 CD       
         01:CF74  D4 CD       
         01:CF76  42 CE       
10049    01:CF78  B0 CE      			dw	.LL456, .LL459, .LL461
         01:CF7A  1D CF       
         01:CF7C  53 CF       
10050    01:CF7E  80 CF      			dw	.LL432
10051    01:CF80             	.LL432:
10052                        	
10053                        		.dbg	line,	"include\routines_SHOP.c", 301; }
10054                        	
10055                        		.dbg	line,	"include\routines_SHOP.c", 302; }
10056    01:CF80             	.LL430:
10057    01:CF80             	.LL429:
10058    01:CF80             	.LL426:
10059    01:CF80             	.LL422:
10060    01:CF80             	.LL419:
10061    01:CF80             	.LL414:
10062                        		__return	0
         01:CF80  4C EF FF   			jmp	leave_proc
10063                        		.dbg	clear
10064                        		.endp
10065               6760     		.data
10066               230D     		.bss
10067    F8:230D             	__joypad_BUTTONS_SHOP_loc:
10068    F8:230D             			ds	1
10069    F8:230E             	__joypad_BUTTONS_SHOP_end:
10070               E309     		.code
10071                        		.pceas
10072                        	
10073                        		.dbg	line,	"main.c", 24; #include "include/init.c"
10074                        		.dbg	line,	"include\init.c", 1; #include "huc.h"
10075                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 1; #ifndef _hucc_legacy_h
10076                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 2; #define _hucc_legacy_h
10077                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 4; /****************************************************************************
10078                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 5; ; ***************************************************************************
10079                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 6; ;
10080                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 7; ; huc.h
10081                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 8; ;
10082                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 9; ; HuCC wrapper file to include a default set of HuC-compatible functions.
10083                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 10; ;
10084                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 11; ; Copyright John Brandwood 2024.
10085                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 12; ;
10086                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 13; ; Distributed under the Boost Software License, Version 1.0.
10087                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
10088                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
10089                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 16; ;
10090                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 17; ; ***************************************************************************
10091                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 18; ; ***************************************************************************
10092                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 19; ;
10093                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 20; ; When the HuCC compiler is invoked with the "--legacy" option to compile old
10094                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 21; ; projects, then this "huc.h" file is automatically included.
10095                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 22; ;
10096                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 23; ; This file includes a set of the individual HuCC headers which correspond to
10097                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 24; ; HuC's built-in functions and MagicKit library.
10098                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 25; ;
10099                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 26; ; New HuCC projects should, preferably, include the specific headers that are
10100                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 27; ; needed, which will then allow them to replace parts of the standard library
10101                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 28; ; with newer functions, or they can just manually include this "huc.h" file.
10102                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 29; ;
10103                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 30; ; ***************************************************************************
10104                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 31; ; **************************************************************************/
10105                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 33; #include "hucc-systemcard.h"
10106                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 34; #include "hucc-baselib.h"
10107                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 35; #include "hucc-gfx.h"
10108                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 36; #include "hucc-string.h"
10109                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 37; #include "hucc-old-scroll.h"
10110                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 38; #include "hucc-old-spr.h"
10111                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 39; #include "hucc-old-map.h"
10112                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 40; #include "hucc-old-line.h"
10113                        		.dbg	line,	"..\..\..\include\hucc\huc.h", 42; #endif // _hucc_legacy_h
10114                        		.dbg	line,	"include\init.c", 2; #include "hucc-scroll.h"
10115                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 1; #ifndef _hucc_scroll_h
10116                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 2; #define _hucc_scroll_h
10117                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 4; /****************************************************************************
10118                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 5; ; ***************************************************************************
10119                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 6; ;
10120                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 7; ; hucc-scroll.h
10121                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 8; ;
10122                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 9; ; Routines for a fast split-screen scrolling system.
10123                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 10; ;
10124                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 11; ; Copyright John Brandwood 2024.
10125                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 12; ;
10126                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 13; ; Distributed under the Boost Software License, Version 1.0.
10127                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
10128                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
10129                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 16; ;
10130                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 17; ; ***************************************************************************
10131                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 18; ; ***************************************************************************
10132                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 19; ;
10133                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 20; ; The maximum number of splits for each screen layer is set in your project's
10134                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 21; ; "hucc-config.inc" file, with the library having a limit of 128-per-layer.
10135                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 22; ;
10136                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 23; ; Your first active split must be defined to start at screen line 0, and then
10137                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 24; ; the rest of the active splits must be in increasing line order to match the
10138                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 25; ; way that the PC Engine displays the output image.
10139                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 26; ;
10140                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 27; ; You can have disabled splits interleaved with your active splits.
10141                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 28; ;
10142                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 29; ; Splits that are normally disabled can be used to create full screen effects
10143                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 30; ; such as bouncing the screen up and down by adding blank areas at the top or
10144                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 31; ; bottom of the screen, and then rapidly changing the height of those areas.
10145                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 32; ;
10146                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 33; ; ***************************************************************************
10147                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 34; ; **************************************************************************/
10148                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 36; // *************
10149                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 37; // VDC bits for display_flags ...
10150                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 38; // *************
10151                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 40; #ifndef BKG_OFF
10152                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 41; #define BKG_OFF 0x00
10153                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 42; #endif
10154                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 44; #ifndef SPR_OFF
10155                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 45; #define SPR_OFF 0x00
10156                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 46; #endif
10157                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 48; #ifndef BKG_ON
10158                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 49; #define BKG_ON 0x80
10159                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 50; #endif
10160                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 52; #ifndef SPR_ON
10161                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 53; #define SPR_ON 0x40
10162                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 54; #endif
10163                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 56; // *************
10164                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 57; // Functions in hucc-scroll.asm ...
10165                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 58; // *************
10166                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 60; #ifdef __HUCC__
10167                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 62; #asmdef	HUCC_USES_NEW_SCROLL 1
10168                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 64; extern void __fastcall scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
10169                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 65; extern void __fastcall sgx_scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
10170                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 67; extern void __fastcall disable_split( unsigned char index<acc> );
10171                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 68; extern void __fastcall sgx_disable_split( unsigned char index<acc> );
10172                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 70; extern void __fastcall __macro disable_all_splits( void );
10173                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 71; extern void __fastcall __macro sgx_disable_all_splits( void );
10174                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 73; #asm
10175                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 74; .macro	_disable_all_splits
10176                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 75; ldy	#HUCC_PCE_SPLITS - 1
10177                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 76; !loop:		tya
10178                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 77; call	_disable_split.1
10179                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 78; dey
10180                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 79; bpl	!loop-
10181                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 80; .endm
10182                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 82; .macro	_sgx_disable_all_splits
10183                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 83; ldy	#HUCC_SGX_SPLITS - 1
10184                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 84; !loop:		tya
10185                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 85; call	_sgx_disable_split.1
10186                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 86; dey
10187                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 87; bpl	!loop-
10188                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 88; .endm
10189                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 89; #endasm
10190                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 91; #endif // __HUCC__
10191                        		.dbg	line,	"..\..\..\include\hucc\hucc-scroll.h", 93; #endif // _hucc_scroll_h
10192                        		.dbg	line,	"include\init.c", 3; #include "hucc-chrmap.h"
10193                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 1; #ifndef _hucc_chrmap_h
10194                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 2; #define _hucc_chrmap_h
10195                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 4; /****************************************************************************
10196                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 5; ; ***************************************************************************
10197                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 6; ;
10198                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 7; ; hucc-chrmap.h
10199                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 8; ;
10200                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 9; ; A simple map system based on 8x8 characters (aka "tiles") in BAT format.
10201                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 10; ;
10202                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 11; ; Copyright John Brandwood 2025.
10203                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 12; ;
10204                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
10205                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
10206                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
10207                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 16; ;
10208                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 17; ; ***************************************************************************
10209                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 18; ; ***************************************************************************
10210                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 19; ;
10211                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 20; ; The maximum X and Y size for chrmaps is 256 characters (2048 pixels).
10212                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 21; ;
10213                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 22; ; The maximum total size for a chrmap is 16KBytes, which allows for maps up
10214                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 23; ; to 256x32 tiles (2048x256 pixels).
10215                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 24; ;
10216                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 25; ; ***************************************************************************
10217                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 26; ; **************************************************************************/
10218                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 28; // *************
10219                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 29; // This code extends the blkmap library ...
10220                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 30; // *************
10221                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 32; #include "hucc-blkmap.h"
10222                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 34; // *************
10223                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 35; // Functions in chrmap.asm ...
10224                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 36; // *************
10225                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 38; #ifdef __HUCC__
10226                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 40; #asmdef	HUCC_USES_CHRMAP 1
10227                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 42; extern void __fastcall __nop set_chrmap( unsigned char __far *chrmap<vdc_map_bank:vdc_map_addr>, unsigned char tiles_w<vdc_map_line_w> );
10228                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 44; extern void __fastcall draw_bat( void );
10229                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 45; extern void __fastcall scroll_bat( void );
10230                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 47; extern void __fastcall blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
10231                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 49; #ifdef _SGX
10232                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 51; extern void __fastcall __nop sgx_set_chrmap( unsigned char __far *chrmap<sgx_map_bank:sgx_map_addr>, unsigned char tiles_w<sgx_map_line_w> );
10233                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 53; extern void __fastcall sgx_draw_bat( void );
10234                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 54; extern void __fastcall sgx_scroll_bat( void );
10235                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 56; extern void __fastcall sgx_blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
10236                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 58; #endif
10237                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 60; #endif // __HUCC__
10238                        		.dbg	line,	"..\..\..\include\hucc\hucc-chrmap.h", 62; #endif // _hucc_chrmap_h
10239                        		.dbg	line,	"include\init.c", 4; #include "hucc-blkmap.h"
10240                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 1; #ifndef _hucc_blkmap_h
10241                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 2; #define _hucc_blkmap_h
10242                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 4; /****************************************************************************
10243                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 5; ; ***************************************************************************
10244                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 6; ;
10245                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 7; ; hucc-blkmap.h
10246                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 8; ;
10247                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 9; ; A map system based on 16x16 meta-tiles (aka "blocks", aka CHR/BLK/MAP).
10248                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 10; ;
10249                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 11; ; Copyright John Brandwood 2025.
10250                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 12; ;
10251                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 13; ; Distributed under the Boost Software License, Version 1.0.
10252                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 14; ; (See accompanying file LICENSE_1_0.txt or copy at
10253                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 15; ;  http://www.boost.org/LICENSE_1_0.txt)
10254                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 16; ;
10255                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 17; ; ***************************************************************************
10256                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 18; ; ***************************************************************************
10257                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 19; ;
10258                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 20; ; The maximum X and Y size for blkmaps is 128 blocks (2048 pixels).
10259                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 21; ;
10260                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 22; ; The maximum total size for a blkmap is 16KBytes, which allows for maps up
10261                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 23; ; to 128x128 blocks (2048x2048 pixels).
10262                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 24; ;
10263                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 25; ; Huge multi-screen blkmaps are also supported (optionally).
10264                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 26; ;
10265                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 27; ; The maximum X and Y for multi-screen maps is 128 screens (32768 pixels).
10266                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 28; ;
10267                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 29; ; The maximum total size for a multi-screen map is 8KBytes, which allows for
10268                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 30; ; a total of 1024 screens.
10269                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 31; ;
10270                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 32; ; ***************************************************************************
10271                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 33; ; **************************************************************************/
10272                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 35; // *************
10273                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 36; // Functions in blkmap.asm ...
10274                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 37; // *************
10275                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 39; #ifdef __HUCC__
10276                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 41; #asmdef	HUCC_USES_BLKMAP 1
10277                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 43; // Current top-left of drawn map in pixels.
10278                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 44; extern unsigned int   vdc_map_pxl_x;
10279                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 45; extern unsigned int   vdc_map_pxl_y;
10280                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 47; // Width and height to draw/scroll in characters (not tiles).
10281                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 48; extern unsigned char  vdc_map_draw_w;
10282                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 49; extern unsigned char  vdc_map_draw_h;
10283                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 51; // Width of map (or multi-screen BAT) in tiles.
10284                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 52; extern unsigned char  vdc_map_line_w;
10285                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 54; // Width of map in screens (if multi-screen map).
10286                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 55; extern unsigned char  vdc_map_scrn_w;
10287                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 57; // Extra information returned by get_map_block() and sgx_get_map_block(),
10288                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 58; // which are the collision flags and the mask/overlay sprite for the BLK.
10289                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 59; extern unsigned char  map_blk_flag;
10290                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 60; extern unsigned char  map_blk_mask;
10291                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 62; extern unsigned char  vdc_scr_bank;
10292                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 63; extern unsigned char *vdc_scr_addr;
10293                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 65; extern unsigned char  vdc_map_bank;
10294                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 66; extern unsigned char *vdc_map_addr;
10295                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 68; extern unsigned char  vdc_blk_bank;
10296                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 69; extern unsigned char *vdc_blk_addr;
10297                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 71; extern unsigned char  vdc_tbl_bank;
10298                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 72; extern unsigned char *vdc_tbl_addr;
10299                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 74; extern void __fastcall set_blocks( unsigned char __far *blk_def<vdc_blk_bank:vdc_blk_addr>, unsigned char __far *flg_def<vdc_tbl_bank:vdc_tbl_addr>, unsigned char number_of_blocks<_al> );
10300                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 75; extern void __fastcall __macro set_blkmap( unsigned char __far *blk_map<vdc_map_bank:vdc_map_addr>, unsigned char blocks_w<vdc_map_line_w> );
10301                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 76; extern void __fastcall __macro set_multimap( unsigned char __far *multi_map<vdc_scr_bank:vdc_scr_addr>, unsigned char screens_w<vdc_map_scrn_w> );
10302                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 78; extern void __fastcall draw_map( void );
10303                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 79; extern void __fastcall scroll_map( void );
10304                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 81; extern void __fastcall blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
10305                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 83; extern unsigned char __fastcall get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
10306                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 85; #asm
10307                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 86; .macro	_set_blkmap.2
10308                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 87; stz	vdc_scr_bank
10309                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 88; .endm
10310                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 90; .macro	_set_multimap.2
10311                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 91; lda	vdc_bat_width
10312                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 92; lsr	a
10313                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 93; sta	vdc_map_line_w
10314                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 94; .endm
10315                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 96; .macro	SCREEN
10316                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 97; db	(((\1) & $1FFF) | $6000) >> 8, bank(\1)
10317                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 98; db	(((\2) & $1FFF) | $4000) >> 8, bank(\2)
10318                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 99; db	(((\3) & $1FFF) | $6000) >> 8, bank(\3)
10319                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 100; dw	(\4)
10320                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 101; .endm
10321                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 102; #endasm
10322                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 104; #ifdef _SGX
10323                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 106; // Current top-left of drawn map in pixels.
10324                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 107; extern unsigned int   sgx_map_pxl_x;
10325                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 108; extern unsigned int   sgx_map_pxl_y;
10326                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 110; // Width and height to draw/scroll in characters (not tiles).
10327                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 111; extern unsigned char  sgx_map_draw_w;
10328                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 112; extern unsigned char  sgx_map_draw_h;
10329                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 114; // Width of map (or multi-screen BAT) in tiles.
10330                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 115; extern unsigned char  sgx_map_line_w;
10331                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 117; // Width of map in screens (if multi-screen map).
10332                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 118; extern unsigned char  sgx_map_scrn_w;
10333                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 120; extern unsigned char  sgx_scr_bank;
10334                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 121; extern unsigned char *sgx_scr_addr;
10335                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 123; extern unsigned char  sgx_map_bank;
10336                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 124; extern unsigned char *sgx_map_addr;
10337                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 126; extern unsigned char  sgx_blk_bank;
10338                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 127; extern unsigned char *sgx_blk_addr;
10339                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 129; extern unsigned char  sgx_tbl_bank;
10340                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 130; extern unsigned char *sgx_tbl_addr;
10341                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 132; extern void __fastcall sgx_set_blocks( unsigned char __far *blk_def<sgx_blk_bank:sgx_blk_addr>, unsigned char __far *flg_def<sgx_tbl_bank:sgx_tbl_addr>, unsigned char number_of_blocks<_al> );
10342                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 133; extern void __fastcall __macro sgx_set_blkmap( unsigned char __far *blk_map<sgx_map_bank:sgx_map_addr>, unsigned char blocks_w<sgx_map_line_w> );
10343                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 134; extern void __fastcall __macro sgx_set_multimap( unsigned char __far *multi_map<sgx_scr_bank:sgx_scr_addr>, unsigned char screens_w<sgx_map_scrn_w> );
10344                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 136; extern void __fastcall sgx_draw_map( void );
10345                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 137; extern void __fastcall sgx_scroll_map( void );
10346                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 139; extern void __fastcall sgx_blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
10347                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 141; extern unsigned char __fastcall sgx_get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
10348                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 143; #asm
10349                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 144; .macro	_sgx_set_blkmap.2
10350                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 145; stz	sgx_scr_bank
10351                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 146; .endm
10352                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 148; .macro	_sgx_set_multimap.2
10353                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 149; lda	sgx_bat_width
10354                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 150; lsr	a
10355                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 151; sta	sgx_map_line_w
10356                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 152; .endm
10357                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 153; #endasm
10358                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 155; #endif
10359                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 157; #endif // __HUCC__
10360                        		.dbg	line,	"..\..\..\include\hucc\hucc-blkmap.h", 159; #endif // _hucc_blkmap_h
10361                        		.dbg	line,	"include\init.c", 13; void init_SYSTEM()
10362                        		.dbg	line,	"include\init.c", 14; {
10363                        	;***********************
10364                        	;***********************
10365                        	
10366                        		.hucc
10367    02:DE93             		.proc		_init_SYSTEM
10368                        		__enter		_init_SYSTEM
10369                        	
10370                        		.dbg	line,	"include\init.c", 15; // DISABLE DISPLAY //
10371                        	
10372                        		.dbg	line,	"include\init.c", 16; disp_off();
10373                        		__call		_disp_off
         02:DE93  20 29 E4   			call	_disp_off
10374                        	
10375                        		.dbg	line,	"include\init.c", 18; // VSYNC //
10376                        	
10377                        		.dbg	line,	"include\init.c", 19; vsync();
10378                        		__call		_vsync
         02:DE96  20 09 E3   			call	_vsync
10379                        	
10380                        		.dbg	line,	"include\init.c", 21; // LOAD DEFAULT FONT //
10381                        	
10382                        		.dbg	line,	"include\init.c", 22; load_default_font();
10383                        		 _load_default_font
         02:DE99  82         			clx				; Offset to PCE VDC.
         02:DE9A  20 C7 FF   			call	huc_monofont_x
10384                        	
10385                        		.dbg	line,	"include\init.c", 25; // SET VDC 1 SCREEN SIZE (IN TILES) - 32x32 = 256 PIXELS
10386                        	
10387                        		.dbg	line,	"include\init.c", 26; set_screen_size(SCR_SIZE_32x32);
10388                        		__st.umiq	0, _al
         02:DE9D  64 F8      			stz	_al
10389                        		__call		_set_screen_size.1
         02:DE9F  20 31 FF   			call	_set_screen_size.1
10390                        	
10391                        		.dbg	line,	"include\init.c", 29; // SET VDC 2 SCREEN SIZE (IN TILES) - 32x32 = 256 PIXELS
10392                        	
10393                        		.dbg	line,	"include\init.c", 30; sgx_set_screen_size(SCR_SIZE_32x32);
10394                        		__st.umiq	0, _al
         02:DEA2  64 F8      			stz	_al
10395                        		__call		_sgx_set_screen_size.1
         02:DEA4  20 27 FF   			call	_sgx_set_screen_size.1
10396                        	
10397                        		.dbg	line,	"include\init.c", 33; // INIT SPRITE ATTRIBUTE TABLE //
10398                        	
10399                        		.dbg	line,	"include\init.c", 34; init_satb();
10400                        		__call		_init_satb
         02:DEA7  20 B7 E7   			call	_init_satb
10401                        	
10402                        		.dbg	line,	"include\init.c", 37; // ENABLE DISPLAY //
10403                        	
10404                        		.dbg	line,	"include\init.c", 38; //disp_on();
10405                        	
10406                        		.dbg	line,	"include\init.c", 39; }
10407    02:DEAA             	.LL462:
10408                        		__return	0
         02:DEAA  4C EF FF   			jmp	leave_proc
10409                        		.dbg	clear
10410                        		.endp
10411                        		.pceas
10412                        	
10413                        		.dbg	line,	"include\init.c", 42; void init_VARIABLES()
10414                        		.dbg	line,	"include\init.c", 43; {
10415                        	;***********************
10416                        	;***********************
10417                        	
10418                        		.hucc
10419    02:DCE0             		.proc		_init_VARIABLES
10420                        		__enter		_init_VARIABLES
10421                        	
10422                        		.dbg	line,	"include\init.c", 44; sequence_id = SEQUENCE_GAME; //SEQUENCE_GAME | SEQUENCE_SHOP
10423                        		__st.umiq	2, _sequence_id
         02:DCE0  A9 02      			lda.l	#2
         02:DCE2  8D 10 23   			sta	_sequence_id
10424                        	
10425                        		.dbg	line,	"include\init.c", 46; level_id = 1;
10426                        		__st.umiq	1, _level_id
         02:DCE5  A9 01      			lda.l	#1
         02:DCE7  8D 12 23   			sta	_level_id
10427                        	
10428                        		.dbg	line,	"include\init.c", 48; key_amount = 0;
10429                        		__st.umiq	0, _key_amount
         02:DCEA  9C 22 23   			stz	_key_amount
10430                        	
10431                        		.dbg	line,	"include\init.c", 49; potion_amount = 0;
10432                        		__st.umiq	0, _potion_amount
         02:DCED  9C 23 23   			stz	_potion_amount
10433                        	
10434                        		.dbg	line,	"include\init.c", 50; zenny_amount = 25000;
10435                        		__st.wmiq	25000, _zenny_amount
         02:DCF0  A9 A8      			lda.l	#25000
         02:DCF2  8D 28 26   			sta.l	_zenny_amount
         02:DCF5  A9 61      			lda.h	#25000
         02:DCF7  8D 29 26   			sta.h	_zenny_amount
10436                        	
10437                        		.dbg	line,	"include\init.c", 52; weapon_level = 1;
10438                        		__st.umiq	1, _weapon_level
         02:DCFA  A9 01      			lda.l	#1
         02:DCFC  8D 20 23   			sta	_weapon_level
10439                        	
10440                        		.dbg	line,	"include\init.c", 53; armor_level = 2;
10441                        		__st.umiq	2, _armor_level
         02:DCFF  A9 02      			lda.l	#2
         02:DD01  8D 1F 23   			sta	_armor_level
10442                        	
10443                        		.dbg	line,	"include\init.c", 54; player_naked = FALSE;
10444                        		__st.umiq	0, _player_naked
         02:DD04  9C 1B 23   			stz	_player_naked
10445                        	
10446                        		.dbg	line,	"include\init.c", 56; shop_counter = 0;
10447                        		__st.umiq	0, _shop_counter
         02:DD07  9C CD 23   			stz	_shop_counter
10448                        	
10449                        		.dbg	line,	"include\init.c", 57; shop_phase = SHOP_PHASE_ENTER;
10450                        		__st.umiq	0, _shop_phase
         02:DD0A  9C CC 23   			stz	_shop_phase
10451                        	
10452                        		.dbg	line,	"include\init.c", 59; respawn = FALSE;
10453                        		__st.umiq	0, _respawn
         02:DD0D  9C 13 23   			stz	_respawn
10454                        	
10455                        		.dbg	line,	"include\init.c", 61; sequence_loaded = FALSE;
10456                        		__st.umiq	0, _sequence_loaded
         02:DD10  9C 11 23   			stz	_sequence_loaded
10457                        	
10458                        		.dbg	line,	"include\init.c", 62; }
10459    02:DD13             	.LL463:
10460                        		__return	0
         02:DD13  4C EF FF   			jmp	leave_proc
10461                        		.dbg	clear
10462                        		.endp
10463                        		.pceas
10464                        	
10465                        		.dbg	line,	"include\init.c", 65; void init_PLAYER()
10466                        		.dbg	line,	"include\init.c", 66; {
10467                        	;***********************
10468                        	;***********************
10469                        	
10470                        		.hucc
10471    02:DD16             		.proc		_init_PLAYER
10472                        		__enter		_init_PLAYER
10473                        	
10474                        		.dbg	line,	"include\init.c", 67; if(player_naked != RESPAWN_SHOP)
10475                        		__ld.umq	_player_naked
         02:DD16  AD 1B 23   			lda	_player_naked
10476                        		__neq_b.uiq	2
         02:DD19  38         			sec
         02:DD1A  49 02      			eor	#2
         02:DD1C  D0 01      			bne	!+
         02:DD1E  18         			clc
         02:DD1F             	!:
10477                        		__bfalse	.LL465
         02:DD1F  90 03      			bcc	.LL465
10478                        	
10479                        		.dbg	line,	"include\init.c", 68; {
10480                        	
10481                        		.dbg	line,	"include\init.c", 69; player_naked = FALSE;
10482                        		__st.umiq	0, _player_naked
         02:DD21  9C 1B 23   			stz	_player_naked
10483                        	
10484                        		.dbg	line,	"include\init.c", 70; }
10485                        	
10486                        		.dbg	line,	"include\init.c", 71; 
10487                        	
10488                        		.dbg	line,	"include\init.c", 72; player_id = 2;
10489    02:DD24             	.LL465:
10490                        		__st.umiq	2, _player_id
         02:DD24  A9 02      			lda.l	#2
         02:DD26  8D 14 23   			sta	_player_id
10491                        	
10492                        		.dbg	line,	"include\init.c", 73; player_axis = AXIS_RIGHT;
10493                        		__st.umiq	0, _player_axis
         02:DD29  9C 16 23   			stz	_player_axis
10494                        	
10495                        		.dbg	line,	"include\init.c", 74; player_previous_axis = player_axis;
10496                        		__ld.um		_player_axis
         02:DD2C  AD 16 23   			lda	_player_axis
         02:DD2F  C2         			cly
10497                        		__st.umq	_player_previous_axis
         02:DD30  8D 17 23   			sta	_player_previous_axis
10498                        	
10499                        		.dbg	line,	"include\init.c", 75; player_counter_anim = 0;
10500                        		__st.umiq	0, _player_counter_anim
         02:DD33  9C 18 23   			stz	_player_counter_anim
10501                        	
10502                        		.dbg	line,	"include\init.c", 76; player_index_jump = 0;
10503                        		__st.umiq	0, _player_index_jump
         02:DD36  9C 19 23   			stz	_player_index_jump
10504                        	
10505                        		.dbg	line,	"include\init.c", 77; player_index_fall = 0;
10506                        		__st.umiq	0, _player_index_fall
         02:DD39  9C 1A 23   			stz	_player_index_fall
10507                        	
10508                        		.dbg	line,	"include\init.c", 78; player_attack = FALSE;
10509                        		__st.umiq	0, _player_attack
         02:DD3C  9C 1C 23   			stz	_player_attack
10510                        	
10511                        		.dbg	line,	"include\init.c", 79; player_state = STATE_IDLE;
10512                        		__st.umiq	0, _player_state
         02:DD3F  9C 15 23   			stz	_player_state
10513                        	
10514                        		.dbg	line,	"include\init.c", 80; }
10515    02:DD42             	.LL464:
10516                        		__return	0
         02:DD42  4C EF FF   			jmp	leave_proc
10517                        		.dbg	clear
10518                        		.endp
10519                        		.pceas
10520                        	
10521                        		.dbg	line,	"include\init.c", 87; void load_OBJECT_TILES()
10522                        		.dbg	line,	"include\init.c", 88; {
10523                        	;***********************
10524                        	;***********************
10525                        	
10526                        		.hucc
10527    02:C2C7             		.proc		_load_OBJECT_TILES
10528                        		__enter		_load_OBJECT_TILES
10529                        	
10530                        		.dbg	line,	"include\init.c", 89; load_vram(POT1_VRAM_ADR, tiles_SPR_POT , SIZEOF(tiles_SPR_POT) >> 1);
10531                        		__st.wmiq	7168, _di
         02:C2C7  64 F0      			stz.l	_di
         02:C2C9  A9 1C      			lda.h	#7168
         02:C2CB  85 F1      			sta.h	_di
10532                        		__farptr	_tiles_SPR_POT, _bp_bank, _bp
         02:C2CD  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_POT))
         02:C2CF  85 EC      			sta.l	_bp
         02:C2D1  A9 6D      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_POT))
         02:C2D3  85 ED      			sta.h	_bp
         02:C2D5  A9 11      			lda	#bank(_tiles_SPR_POT)
         02:C2D7  85 02      			sta	_bp_bank
10533                        		__ld.wi		___sizeof__tiles_SPR_POT
         02:C2D9  A9 00      			lda.l	#___sizeof__tiles_SPR_POT
         02:C2DB  A0 04      			ldy.h	#___sizeof__tiles_SPR_POT
10534                        		__lsr.wi	1
         02:C2DD  42         			say
         02:C2DE  4A         			lsr	a
         02:C2DF  42         			say
         02:C2E0  6A         			ror	a
10535                        		__st.wmq	_ax
         02:C2E1  85 F8      			sta.l	_ax
         02:C2E3  84 F9      			sty.h	_ax
10536                        		 _load_vram.3
         02:C2E5  82         			clx				; Offset to PCE VDC.
         02:C2E6  20 63 FF   			call	load_vram_x
10537                        	
10538                        		.dbg	line,	"include\init.c", 90; load_vram(POW_VRAM_ADR, tiles_SPR_POW , TILES_4);
10539                        		__st.wmiq	7680, _di
         02:C2E9  64 F0      			stz.l	_di
         02:C2EB  A9 1E      			lda.h	#7680
         02:C2ED  85 F1      			sta.h	_di
10540                        		__farptr	_tiles_SPR_POW, _bp_bank, _bp
         02:C2EF  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_POW))
         02:C2F1  85 EC      			sta.l	_bp
         02:C2F3  A9 71      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_POW))
         02:C2F5  85 ED      			sta.h	_bp
         02:C2F7  A9 11      			lda	#bank(_tiles_SPR_POW)
         02:C2F9  85 02      			sta	_bp_bank
10541                        		__st.wmiq	64, _ax
         02:C2FB  A9 40      			lda.l	#64
         02:C2FD  85 F8      			sta.l	_ax
         02:C2FF  64 F9      			stz.h	_ax
10542                        		 _load_vram.3
         02:C301  82         			clx				; Offset to PCE VDC.
         02:C302  20 63 FF   			call	load_vram_x
10543                        	
10544                        		.dbg	line,	"include\init.c", 91; load_vram(GRAY_KEY_VRAM_ADR, tiles_SPR_GRAY_KEY , TILES_4);
10545                        		__st.wmiq	7744, _di
         02:C305  A9 40      			lda.l	#7744
         02:C307  85 F0      			sta.l	_di
         02:C309  A9 1E      			lda.h	#7744
         02:C30B  85 F1      			sta.h	_di
10546                        		__farptr	_tiles_SPR_GRAY_KEY, _bp_bank, _bp
         02:C30D  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_GRAY_KEY))
         02:C30F  85 EC      			sta.l	_bp
         02:C311  A9 6A      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_GRAY_KEY))
         02:C313  85 ED      			sta.h	_bp
         02:C315  A9 11      			lda	#bank(_tiles_SPR_GRAY_KEY)
         02:C317  85 02      			sta	_bp_bank
10547                        		__st.wmiq	64, _ax
         02:C319  A9 40      			lda.l	#64
         02:C31B  85 F8      			sta.l	_ax
         02:C31D  64 F9      			stz.h	_ax
10548                        		 _load_vram.3
         02:C31F  82         			clx				; Offset to PCE VDC.
         02:C320  20 63 FF   			call	load_vram_x
10549                        	
10550                        		.dbg	line,	"include\init.c", 92; load_vram(GOLD_KEY_VRAM_ADR, tiles_SPR_GOLD_KEY , TILES_4);
10551                        		__st.wmiq	7808, _di
         02:C323  A9 80      			lda.l	#7808
         02:C325  85 F0      			sta.l	_di
         02:C327  A9 1E      			lda.h	#7808
         02:C329  85 F1      			sta.h	_di
10552                        		__farptr	_tiles_SPR_GOLD_KEY, _bp_bank, _bp
         02:C32B  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_GOLD_KEY))
         02:C32D  85 EC      			sta.l	_bp
         02:C32F  A9 6B      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_GOLD_KEY))
         02:C331  85 ED      			sta.h	_bp
         02:C333  A9 11      			lda	#bank(_tiles_SPR_GOLD_KEY)
         02:C335  85 02      			sta	_bp_bank
10553                        		__st.wmiq	64, _ax
         02:C337  A9 40      			lda.l	#64
         02:C339  85 F8      			sta.l	_ax
         02:C33B  64 F9      			stz.h	_ax
10554                        		 _load_vram.3
         02:C33D  82         			clx				; Offset to PCE VDC.
         02:C33E  20 63 FF   			call	load_vram_x
10555                        	
10556                        		.dbg	line,	"include\init.c", 93; load_vram(LIFE_VRAM_ADR, tiles_SPR_LIFE , TILES_4);
10557                        		__st.wmiq	7872, _di
         02:C341  A9 C0      			lda.l	#7872
         02:C343  85 F0      			sta.l	_di
         02:C345  A9 1E      			lda.h	#7872
         02:C347  85 F1      			sta.h	_di
10558                        		__farptr	_tiles_SPR_LIFE, _bp_bank, _bp
         02:C349  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_LIFE))
         02:C34B  85 EC      			sta.l	_bp
         02:C34D  A9 6C      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_LIFE))
         02:C34F  85 ED      			sta.h	_bp
         02:C351  A9 11      			lda	#bank(_tiles_SPR_LIFE)
         02:C353  85 02      			sta	_bp_bank
10559                        		__st.wmiq	64, _ax
         02:C355  A9 40      			lda.l	#64
         02:C357  85 F8      			sta.l	_ax
         02:C359  64 F9      			stz.h	_ax
10560                        		 _load_vram.3
         02:C35B  82         			clx				; Offset to PCE VDC.
         02:C35C  20 63 FF   			call	load_vram_x
10561                        	
10562                        		.dbg	line,	"include\init.c", 94; load_vram(COIN_1_VRAM_ADR, tiles_SPR_COIN_1 , TILES_4);
10563                        		__st.wmiq	7936, _di
         02:C35F  64 F0      			stz.l	_di
         02:C361  A9 1F      			lda.h	#7936
         02:C363  85 F1      			sta.h	_di
10564                        		__farptr	_tiles_SPR_COIN_1, _bp_bank, _bp
         02:C365  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_COIN_1))
         02:C367  85 EC      			sta.l	_bp
         02:C369  A9 66      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_COIN_1))
         02:C36B  85 ED      			sta.h	_bp
         02:C36D  A9 11      			lda	#bank(_tiles_SPR_COIN_1)
         02:C36F  85 02      			sta	_bp_bank
10565                        		__st.wmiq	64, _ax
         02:C371  A9 40      			lda.l	#64
         02:C373  85 F8      			sta.l	_ax
         02:C375  64 F9      			stz.h	_ax
10566                        		 _load_vram.3
         02:C377  82         			clx				; Offset to PCE VDC.
         02:C378  20 63 FF   			call	load_vram_x
10567                        	
10568                        		.dbg	line,	"include\init.c", 95; load_vram(COIN_5_VRAM_ADR, tiles_SPR_COIN_5 , TILES_4);
10569                        		__st.wmiq	8000, _di
         02:C37B  A9 40      			lda.l	#8000
         02:C37D  85 F0      			sta.l	_di
         02:C37F  A9 1F      			lda.h	#8000
         02:C381  85 F1      			sta.h	_di
10570                        		__farptr	_tiles_SPR_COIN_5, _bp_bank, _bp
         02:C383  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_COIN_5))
         02:C385  85 EC      			sta.l	_bp
         02:C387  A9 67      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_COIN_5))
         02:C389  85 ED      			sta.h	_bp
         02:C38B  A9 11      			lda	#bank(_tiles_SPR_COIN_5)
         02:C38D  85 02      			sta	_bp_bank
10571                        		__st.wmiq	64, _ax
         02:C38F  A9 40      			lda.l	#64
         02:C391  85 F8      			sta.l	_ax
         02:C393  64 F9      			stz.h	_ax
10572                        		 _load_vram.3
         02:C395  82         			clx				; Offset to PCE VDC.
         02:C396  20 63 FF   			call	load_vram_x
10573                        	
10574                        		.dbg	line,	"include\init.c", 96; load_vram(COIN_10_VRAM_ADR, tiles_SPR_COIN_10 , TILES_4);
10575                        		__st.wmiq	8064, _di
         02:C399  A9 80      			lda.l	#8064
         02:C39B  85 F0      			sta.l	_di
         02:C39D  A9 1F      			lda.h	#8064
         02:C39F  85 F1      			sta.h	_di
10576                        		__farptr	_tiles_SPR_COIN_10, _bp_bank, _bp
         02:C3A1  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_COIN_10))
         02:C3A3  85 EC      			sta.l	_bp
         02:C3A5  A9 67      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_COIN_10))
         02:C3A7  85 ED      			sta.h	_bp
         02:C3A9  A9 11      			lda	#bank(_tiles_SPR_COIN_10)
         02:C3AB  85 02      			sta	_bp_bank
10577                        		__st.wmiq	64, _ax
         02:C3AD  A9 40      			lda.l	#64
         02:C3AF  85 F8      			sta.l	_ax
         02:C3B1  64 F9      			stz.h	_ax
10578                        		 _load_vram.3
         02:C3B3  82         			clx				; Offset to PCE VDC.
         02:C3B4  20 63 FF   			call	load_vram_x
10579                        	
10580                        		.dbg	line,	"include\init.c", 97; load_vram(COIN_50_VRAM_ADR, tiles_SPR_COIN_50 , TILES_4);
10581                        		__st.wmiq	8128, _di
         02:C3B7  A9 C0      			lda.l	#8128
         02:C3B9  85 F0      			sta.l	_di
         02:C3BB  A9 1F      			lda.h	#8128
         02:C3BD  85 F1      			sta.h	_di
10582                        		__farptr	_tiles_SPR_COIN_50, _bp_bank, _bp
         02:C3BF  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_COIN_50))
         02:C3C1  85 EC      			sta.l	_bp
         02:C3C3  A9 68      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_COIN_50))
         02:C3C5  85 ED      			sta.h	_bp
         02:C3C7  A9 11      			lda	#bank(_tiles_SPR_COIN_50)
         02:C3C9  85 02      			sta	_bp_bank
10583                        		__st.wmiq	64, _ax
         02:C3CB  A9 40      			lda.l	#64
         02:C3CD  85 F8      			sta.l	_ax
         02:C3CF  64 F9      			stz.h	_ax
10584                        		 _load_vram.3
         02:C3D1  82         			clx				; Offset to PCE VDC.
         02:C3D2  20 63 FF   			call	load_vram_x
10585                        	
10586                        		.dbg	line,	"include\init.c", 98; load_vram(COIN_100_VRAM_ADR, tiles_SPR_COIN_100 , TILES_4);
10587                        		__st.wmiq	8192, _di
         02:C3D5  64 F0      			stz.l	_di
         02:C3D7  A9 20      			lda.h	#8192
         02:C3D9  85 F1      			sta.h	_di
10588                        		__farptr	_tiles_SPR_COIN_100, _bp_bank, _bp
         02:C3DB  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_COIN_100))
         02:C3DD  85 EC      			sta.l	_bp
         02:C3DF  A9 68      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_COIN_100))
         02:C3E1  85 ED      			sta.h	_bp
         02:C3E3  A9 11      			lda	#bank(_tiles_SPR_COIN_100)
         02:C3E5  85 02      			sta	_bp_bank
10589                        		__st.wmiq	64, _ax
         02:C3E7  A9 40      			lda.l	#64
         02:C3E9  85 F8      			sta.l	_ax
         02:C3EB  64 F9      			stz.h	_ax
10590                        		 _load_vram.3
         02:C3ED  82         			clx				; Offset to PCE VDC.
         02:C3EE  20 63 FF   			call	load_vram_x
10591                        	
10592                        		.dbg	line,	"include\init.c", 99; load_vram(COIN_500_VRAM_ADR, tiles_SPR_COIN_500 , TILES_4);
10593                        		__st.wmiq	8256, _di
         02:C3F1  A9 40      			lda.l	#8256
         02:C3F3  85 F0      			sta.l	_di
         02:C3F5  A9 20      			lda.h	#8256
         02:C3F7  85 F1      			sta.h	_di
10594                        		__farptr	_tiles_SPR_COIN_500, _bp_bank, _bp
         02:C3F9  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_COIN_500))
         02:C3FB  85 EC      			sta.l	_bp
         02:C3FD  A9 69      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_COIN_500))
         02:C3FF  85 ED      			sta.h	_bp
         02:C401  A9 11      			lda	#bank(_tiles_SPR_COIN_500)
         02:C403  85 02      			sta	_bp_bank
10595                        		__st.wmiq	64, _ax
         02:C405  A9 40      			lda.l	#64
         02:C407  85 F8      			sta.l	_ax
         02:C409  64 F9      			stz.h	_ax
10596                        		 _load_vram.3
         02:C40B  82         			clx				; Offset to PCE VDC.
         02:C40C  20 63 FF   			call	load_vram_x
10597                        	
10598                        		.dbg	line,	"include\init.c", 100; load_vram(COIN_1000_VRAM_ADR, tiles_SPR_COIN_1000 , TILES_4);
10599                        		__st.wmiq	8320, _di
         02:C40F  A9 80      			lda.l	#8320
         02:C411  85 F0      			sta.l	_di
         02:C413  A9 20      			lda.h	#8320
         02:C415  85 F1      			sta.h	_di
10600                        		__farptr	_tiles_SPR_COIN_1000, _bp_bank, _bp
         02:C417  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_COIN_1000))
         02:C419  85 EC      			sta.l	_bp
         02:C41B  A9 69      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_COIN_1000))
         02:C41D  85 ED      			sta.h	_bp
         02:C41F  A9 11      			lda	#bank(_tiles_SPR_COIN_1000)
         02:C421  85 02      			sta	_bp_bank
10601                        		__st.wmiq	64, _ax
         02:C423  A9 40      			lda.l	#64
         02:C425  85 F8      			sta.l	_ax
         02:C427  64 F9      			stz.h	_ax
10602                        		 _load_vram.3
         02:C429  82         			clx				; Offset to PCE VDC.
         02:C42A  20 63 FF   			call	load_vram_x
10603                        	
10604                        		.dbg	line,	"include\init.c", 101; load_vram(STAR_VRAM_ADR, tiles_SPR_STAR , TILES_4);
10605                        		__st.wmiq	8384, _di
         02:C42D  A9 C0      			lda.l	#8384
         02:C42F  85 F0      			sta.l	_di
         02:C431  A9 20      			lda.h	#8384
         02:C433  85 F1      			sta.h	_di
10606                        		__farptr	_tiles_SPR_STAR, _bp_bank, _bp
         02:C435  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_STAR))
         02:C437  85 EC      			sta.l	_bp
         02:C439  A9 71      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_STAR))
         02:C43B  85 ED      			sta.h	_bp
         02:C43D  A9 11      			lda	#bank(_tiles_SPR_STAR)
         02:C43F  85 02      			sta	_bp_bank
10607                        		__st.wmiq	64, _ax
         02:C441  A9 40      			lda.l	#64
         02:C443  85 F8      			sta.l	_ax
         02:C445  64 F9      			stz.h	_ax
10608                        		 _load_vram.3
         02:C447  82         			clx				; Offset to PCE VDC.
         02:C448  20 63 FF   			call	load_vram_x
10609                        	
10610                        		.dbg	line,	"include\init.c", 102; load_vram(OCTOPUS_VRAM_ADR, tiles_SPR_OCTOPUS , TILES_4);
10611                        		__st.wmiq	8448, _di
         02:C44B  64 F0      			stz.l	_di
         02:C44D  A9 21      			lda.h	#8448
         02:C44F  85 F1      			sta.h	_di
10612                        		__farptr	_tiles_SPR_OCTOPUS, _bp_bank, _bp
         02:C451  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_OCTOPUS))
         02:C453  85 EC      			sta.l	_bp
         02:C455  A9 6C      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_OCTOPUS))
         02:C457  85 ED      			sta.h	_bp
         02:C459  A9 11      			lda	#bank(_tiles_SPR_OCTOPUS)
         02:C45B  85 02      			sta	_bp_bank
10613                        		__st.wmiq	64, _ax
         02:C45D  A9 40      			lda.l	#64
         02:C45F  85 F8      			sta.l	_ax
         02:C461  64 F9      			stz.h	_ax
10614                        		 _load_vram.3
         02:C463  82         			clx				; Offset to PCE VDC.
         02:C464  20 63 FF   			call	load_vram_x
10615                        	
10616                        		.dbg	line,	"include\init.c", 103; load_vram(FRUIT_VRAM_ADR, tiles_SPR_FRUIT , TILES_4);
10617                        		__st.wmiq	8512, _di
         02:C467  A9 40      			lda.l	#8512
         02:C469  85 F0      			sta.l	_di
         02:C46B  A9 21      			lda.h	#8512
         02:C46D  85 F1      			sta.h	_di
10618                        		__farptr	_tiles_SPR_FRUIT, _bp_bank, _bp
         02:C46F  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_FRUIT))
         02:C471  85 EC      			sta.l	_bp
         02:C473  A9 6A      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_FRUIT))
         02:C475  85 ED      			sta.h	_bp
         02:C477  A9 11      			lda	#bank(_tiles_SPR_FRUIT)
         02:C479  85 02      			sta	_bp_bank
10619                        		__st.wmiq	64, _ax
         02:C47B  A9 40      			lda.l	#64
         02:C47D  85 F8      			sta.l	_ax
         02:C47F  64 F9      			stz.h	_ax
10620                        		 _load_vram.3
         02:C481  82         			clx				; Offset to PCE VDC.
         02:C482  20 63 FF   			call	load_vram_x
10621                        	
10622                        		.dbg	line,	"include\init.c", 104; load_vram(BARREL_VRAM_ADR, tiles_SPR_BARREL , TILES_4);
10623                        		__st.wmiq	8576, _di
         02:C485  A9 80      			lda.l	#8576
         02:C487  85 F0      			sta.l	_di
         02:C489  A9 21      			lda.h	#8576
         02:C48B  85 F1      			sta.h	_di
10624                        		__farptr	_tiles_SPR_BARREL, _bp_bank, _bp
         02:C48D  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_BARREL))
         02:C48F  85 EC      			sta.l	_bp
         02:C491  A9 7A      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_BARREL))
         02:C493  85 ED      			sta.h	_bp
         02:C495  A9 10      			lda	#bank(_tiles_SPR_BARREL)
         02:C497  85 02      			sta	_bp_bank
10625                        		__st.wmiq	64, _ax
         02:C499  A9 40      			lda.l	#64
         02:C49B  85 F8      			sta.l	_ax
         02:C49D  64 F9      			stz.h	_ax
10626                        		 _load_vram.3
         02:C49F  82         			clx				; Offset to PCE VDC.
         02:C4A0  20 63 FF   			call	load_vram_x
10627                        	
10628                        		.dbg	line,	"include\init.c", 105; load_vram(HOURGLASS_VRAM_ADR, tiles_SPR_HOURGLASS , TILES_4);
10629                        		__st.wmiq	8640, _di
         02:C4A3  A9 C0      			lda.l	#8640
         02:C4A5  85 F0      			sta.l	_di
         02:C4A7  A9 21      			lda.h	#8640
         02:C4A9  85 F1      			sta.h	_di
10630                        		__farptr	_tiles_SPR_HOURGLASS, _bp_bank, _bp
         02:C4AB  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_HOURGLASS))
         02:C4AD  85 EC      			sta.l	_bp
         02:C4AF  A9 6B      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_HOURGLASS))
         02:C4B1  85 ED      			sta.h	_bp
         02:C4B3  A9 11      			lda	#bank(_tiles_SPR_HOURGLASS)
         02:C4B5  85 02      			sta	_bp_bank
10631                        		__st.wmiq	64, _ax
         02:C4B7  A9 40      			lda.l	#64
         02:C4B9  85 F8      			sta.l	_ax
         02:C4BB  64 F9      			stz.h	_ax
10632                        		 _load_vram.3
         02:C4BD  82         			clx				; Offset to PCE VDC.
         02:C4BE  20 63 FF   			call	load_vram_x
10633                        	
10634                        		.dbg	line,	"include\init.c", 106; load_vram(BAMBOO_VRAM_ADR, tiles_SPR_BAMBOO , TILES_4);
10635                        		__st.wmiq	8704, _di
         02:C4C1  64 F0      			stz.l	_di
         02:C4C3  A9 22      			lda.h	#8704
         02:C4C5  85 F1      			sta.h	_di
10636                        		__farptr	_tiles_SPR_BAMBOO, _bp_bank, _bp
         02:C4C7  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_BAMBOO))
         02:C4C9  85 EC      			sta.l	_bp
         02:C4CB  A9 72      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_BAMBOO))
         02:C4CD  85 ED      			sta.h	_bp
         02:C4CF  A9 11      			lda	#bank(_tiles_SPR_BAMBOO)
         02:C4D1  85 02      			sta	_bp_bank
10637                        		__st.wmiq	64, _ax
         02:C4D3  A9 40      			lda.l	#64
         02:C4D5  85 F8      			sta.l	_ax
         02:C4D7  64 F9      			stz.h	_ax
10638                        		 _load_vram.3
         02:C4D9  82         			clx				; Offset to PCE VDC.
         02:C4DA  20 63 FF   			call	load_vram_x
10639                        	
10640                        		.dbg	line,	"include\init.c", 107; load_vram(YASHICHI_VRAM_ADR, tiles_SPR_YASHICHI , TILES_4);
10641                        		__st.wmiq	8768, _di
         02:C4DD  A9 40      			lda.l	#8768
         02:C4DF  85 F0      			sta.l	_di
         02:C4E1  A9 22      			lda.h	#8768
         02:C4E3  85 F1      			sta.h	_di
10642                        		__farptr	_tiles_SPR_YASHICHI, _bp_bank, _bp
         02:C4E5  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_YASHICHI))
         02:C4E7  85 EC      			sta.l	_bp
         02:C4E9  A9 72      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_YASHICHI))
         02:C4EB  85 ED      			sta.h	_bp
         02:C4ED  A9 11      			lda	#bank(_tiles_SPR_YASHICHI)
         02:C4EF  85 02      			sta	_bp_bank
10643                        		__st.wmiq	64, _ax
         02:C4F1  A9 40      			lda.l	#64
         02:C4F3  85 F8      			sta.l	_ax
         02:C4F5  64 F9      			stz.h	_ax
10644                        		 _load_vram.3
         02:C4F7  82         			clx				; Offset to PCE VDC.
         02:C4F8  20 63 FF   			call	load_vram_x
10645                        	
10646                        		.dbg	line,	"include\init.c", 108; load_vram(ELEPHANT_VRAM_ADR, tiles_SPR_ELEPHANT , TILES_4);
10647                        		__st.wmiq	8832, _di
         02:C4FB  A9 80      			lda.l	#8832
         02:C4FD  85 F0      			sta.l	_di
         02:C4FF  A9 22      			lda.h	#8832
         02:C501  85 F1      			sta.h	_di
10648                        		__farptr	_tiles_SPR_ELEPHANT, _bp_bank, _bp
         02:C503  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_ELEPHANT))
         02:C505  85 EC      			sta.l	_bp
         02:C507  A9 73      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_ELEPHANT))
         02:C509  85 ED      			sta.h	_bp
         02:C50B  A9 11      			lda	#bank(_tiles_SPR_ELEPHANT)
         02:C50D  85 02      			sta	_bp_bank
10649                        		__st.wmiq	64, _ax
         02:C50F  A9 40      			lda.l	#64
         02:C511  85 F8      			sta.l	_ax
         02:C513  64 F9      			stz.h	_ax
10650                        		 _load_vram.3
         02:C515  82         			clx				; Offset to PCE VDC.
         02:C516  20 63 FF   			call	load_vram_x
10651                        	
10652                        		.dbg	line,	"include\init.c", 109; load_vram(DRAGONFLY_VRAM_ADR, tiles_SPR_DRAGONFLY , TILES_4);
10653                        		__st.wmiq	8896, _di
         02:C519  A9 C0      			lda.l	#8896
         02:C51B  85 F0      			sta.l	_di
         02:C51D  A9 22      			lda.h	#8896
         02:C51F  85 F1      			sta.h	_di
10654                        		__farptr	_tiles_SPR_DRAGONFLY, _bp_bank, _bp
         02:C521  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_DRAGONFLY))
         02:C523  85 EC      			sta.l	_bp
         02:C525  A9 73      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_DRAGONFLY))
         02:C527  85 ED      			sta.h	_bp
         02:C529  A9 11      			lda	#bank(_tiles_SPR_DRAGONFLY)
         02:C52B  85 02      			sta	_bp_bank
10655                        		__st.wmiq	64, _ax
         02:C52D  A9 40      			lda.l	#64
         02:C52F  85 F8      			sta.l	_ax
         02:C531  64 F9      			stz.h	_ax
10656                        		 _load_vram.3
         02:C533  82         			clx				; Offset to PCE VDC.
         02:C534  20 63 FF   			call	load_vram_x
10657                        	
10658                        		.dbg	line,	"include\init.c", 110; load_vram(COW_VRAM_ADR, tiles_SPR_COW , TILES_4);
10659                        		__st.wmiq	8960, _di
         02:C537  64 F0      			stz.l	_di
         02:C539  A9 23      			lda.h	#8960
         02:C53B  85 F1      			sta.h	_di
10660                        		__farptr	_tiles_SPR_COW, _bp_bank, _bp
         02:C53D  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_COW))
         02:C53F  85 EC      			sta.l	_bp
         02:C541  A9 74      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_COW))
         02:C543  85 ED      			sta.h	_bp
         02:C545  A9 11      			lda	#bank(_tiles_SPR_COW)
         02:C547  85 02      			sta	_bp_bank
10661                        		__st.wmiq	64, _ax
         02:C549  A9 40      			lda.l	#64
         02:C54B  85 F8      			sta.l	_ax
         02:C54D  64 F9      			stz.h	_ax
10662                        		 _load_vram.3
         02:C54F  82         			clx				; Offset to PCE VDC.
         02:C550  20 63 FF   			call	load_vram_x
10663                        	
10664                        		.dbg	line,	"include\init.c", 111; load_vram(MOBICHAN_VRAM_ADR, tiles_SPR_MOBICHAN , TILES_4);
10665                        		__st.wmiq	9024, _di
         02:C553  A9 40      			lda.l	#9024
         02:C555  85 F0      			sta.l	_di
         02:C557  A9 23      			lda.h	#9024
         02:C559  85 F1      			sta.h	_di
10666                        		__farptr	_tiles_SPR_MOBICHAN, _bp_bank, _bp
         02:C55B  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_MOBICHAN))
         02:C55D  85 EC      			sta.l	_bp
         02:C55F  A9 74      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_MOBICHAN))
         02:C561  85 ED      			sta.h	_bp
         02:C563  A9 11      			lda	#bank(_tiles_SPR_MOBICHAN)
         02:C565  85 02      			sta	_bp_bank
10667                        		__st.wmiq	64, _ax
         02:C567  A9 40      			lda.l	#64
         02:C569  85 F8      			sta.l	_ax
         02:C56B  64 F9      			stz.h	_ax
10668                        		 _load_vram.3
         02:C56D  82         			clx				; Offset to PCE VDC.
         02:C56E  20 63 FF   			call	load_vram_x
10669                        	
10670                        		.dbg	line,	"include\init.c", 112; }
10671    02:C571             	.LL466:
10672                        		__return	0
         02:C571  4C EF FF   			jmp	leave_proc
10673                        		.dbg	clear
10674                        		.endp
10675                        		.pceas
10676                        	
10677                        		.dbg	line,	"include\init.c", 115; void load_CHEST_TILES()
10678                        		.dbg	line,	"include\init.c", 116; {
10679                        	;***********************
10680                        	;***********************
10681                        	
10682                        		.hucc
10683    02:DD9E             		.proc		_load_CHEST_TILES
10684                        		__enter		_load_CHEST_TILES
10685                        	
10686                        		.dbg	line,	"include\init.c", 117; load_vram(CHEST_VRAM_ADR, tiles_SPR_CHEST , SIZEOF(tiles_SPR_CHEST) >> 1);
10687                        		__st.wmiq	9216, _di
         02:DD9E  64 F0      			stz.l	_di
         02:DDA0  A9 24      			lda.h	#9216
         02:DDA2  85 F1      			sta.h	_di
10688                        		__farptr	_tiles_SPR_CHEST, _bp_bank, _bp
         02:DDA4  A9 E0      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_CHEST))
         02:DDA6  85 EC      			sta.l	_bp
         02:DDA8  A9 7A      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_CHEST))
         02:DDAA  85 ED      			sta.h	_bp
         02:DDAC  A9 10      			lda	#bank(_tiles_SPR_CHEST)
         02:DDAE  85 02      			sta	_bp_bank
10689                        		__ld.wi		___sizeof__tiles_SPR_CHEST
         02:DDB0  A9 00      			lda.l	#___sizeof__tiles_SPR_CHEST
         02:DDB2  A0 0C      			ldy.h	#___sizeof__tiles_SPR_CHEST
10690                        		__lsr.wi	1
         02:DDB4  42         			say
         02:DDB5  4A         			lsr	a
         02:DDB6  42         			say
         02:DDB7  6A         			ror	a
10691                        		__st.wmq	_ax
         02:DDB8  85 F8      			sta.l	_ax
         02:DDBA  84 F9      			sty.h	_ax
10692                        		 _load_vram.3
         02:DDBC  82         			clx				; Offset to PCE VDC.
         02:DDBD  20 63 FF   			call	load_vram_x
10693                        	
10694                        		.dbg	line,	"include\init.c", 118; }
10695    02:DDC0             	.LL467:
10696                        		__return	0
         02:DDC0  4C EF FF   			jmp	leave_proc
10697                        		.dbg	clear
10698                        		.endp
10699                        		.pceas
10700                        	
10701                        		.dbg	line,	"include\init.c", 121; void load_NPC_TILES()
10702                        		.dbg	line,	"include\init.c", 122; {
10703                        	;***********************
10704                        	;***********************
10705                        	
10706                        		.hucc
10707    02:DDC3             		.proc		_load_NPC_TILES
10708                        		__enter		_load_NPC_TILES
10709                        	
10710                        		.dbg	line,	"include\init.c", 123; load_vram(NPC_VRAM_ADR, tiles_SPR_NPC , SIZEOF(tiles_SPR_NPC) >> 1);
10711                        		__st.wmiq	10752, _di
         02:DDC3  64 F0      			stz.l	_di
         02:DDC5  A9 2A      			lda.h	#10752
         02:DDC7  85 F1      			sta.h	_di
10712                        		__farptr	_tiles_SPR_NPC, _bp_bank, _bp
         02:DDC9  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_NPC))
         02:DDCB  85 EC      			sta.l	_bp
         02:DDCD  A9 79      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_NPC))
         02:DDCF  85 ED      			sta.h	_bp
         02:DDD1  A9 11      			lda	#bank(_tiles_SPR_NPC)
         02:DDD3  85 02      			sta	_bp_bank
10713                        		__ld.wi		___sizeof__tiles_SPR_NPC
         02:DDD5  A9 00      			lda.l	#___sizeof__tiles_SPR_NPC
         02:DDD7  A0 0C      			ldy.h	#___sizeof__tiles_SPR_NPC
10714                        		__lsr.wi	1
         02:DDD9  42         			say
         02:DDDA  4A         			lsr	a
         02:DDDB  42         			say
         02:DDDC  6A         			ror	a
10715                        		__st.wmq	_ax
         02:DDDD  85 F8      			sta.l	_ax
         02:DDDF  84 F9      			sty.h	_ax
10716                        		 _load_vram.3
         02:DDE1  82         			clx				; Offset to PCE VDC.
         02:DDE2  20 63 FF   			call	load_vram_x
10717                        	
10718                        		.dbg	line,	"include\init.c", 124; }
10719    02:DDE5             	.LL468:
10720                        		__return	0
         02:DDE5  4C EF FF   			jmp	leave_proc
10721                        		.dbg	clear
10722                        		.endp
10723                        		.pceas
10724                        	
10725                        		.dbg	line,	"include\init.c", 127; void init_OBJECT_LV1()
10726                        		.dbg	line,	"include\init.c", 128; {
10727                        	;***********************
10728                        	;***********************
10729                        	
10730                        		.hucc
10731    02:CF4B             		.proc		_init_OBJECT_LV1
10732                        		__enter		_init_OBJECT_LV1
10733                        	
10734                        		.dbg	line,	"include\init.c", 129; signed char i;
10735                        	
10736                        		.dbg	line,	"include\init.c", 131; for(i=0 ; i<level_object_number ; i++)
10737                        		__st.umiq	0, __init_OBJECT_LV1_end - 1  /* i */
         02:CF4B  9C 45 26   			stz	__init_OBJECT_LV1_end - 1
10738    02:CF4E             	.LL470:
10739                        		__ld.bm		__init_OBJECT_LV1_end - 1  /* i */
         02:CF4E  AD 45 26   			lda	__init_OBJECT_LV1_end - 1
         02:CF51  C2         			cly
         02:CF52  10 01      			bpl	!+
         02:CF54  88         			dey
         02:CF55             	!:
10740                        		__slt_w.um	_level_object_number
         02:CF55  CD 2A 23   			cmp	_level_object_number		; Subtract memory from Y:A.
         02:CF58  98         			tya
         02:CF59  E9 00      			sbc	#0
         02:CF5B  50 02      			bvc	!+
         02:CF5D  49 80      			eor	#$80		; -ve if Y:A < memory (signed).
         02:CF5F  0A         	!:		asl	a
10741                        		__btrue		.LL472
         02:CF60  B0 08      			bcs	.LL472
10742                        		__bra		.LL473
         02:CF62  4C 85 D0   			bra	.LL473
10743    02:CF65             	.LL471:
10744                        		__inc.umq	__init_OBJECT_LV1_end - 1  /* i */
         02:CF65  EE 45 26   			inc	__init_OBJECT_LV1_end - 1
10745                        		__bra		.LL470
         02:CF68  80 E4      			bra	.LL470
10746    02:CF6A             	.LL472:
10747                        	
10748                        		.dbg	line,	"include\init.c", 132; {
10749                        	
10750                        		.dbg	line,	"include\init.c", 133; // SET OBJECT PROPERTIES //
10751                        	
10752                        		.dbg	line,	"include\init.c", 134; list_object_type[i] = TABLE_OBJECT_TYPE_LV1[i];
10753                        		__ldx.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:CF6A  AE 45 26   			ldx	__init_OBJECT_LV1_end - 1
10754                        		__ld.uax	_TABLE_OBJECT_TYPE_LV1
         02:CF6D  BD 78 60   			lda	_TABLE_OBJECT_TYPE_LV1, x
         02:CF70  C2         			cly
10755                        		__ldx.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:CF71  AE 45 26   			ldx	__init_OBJECT_LV1_end - 1
10756                        		__st.uaxq	_list_object_type
         02:CF74  9D 2C 23   			sta	_list_object_type, x
10757                        	
10758                        		.dbg	line,	"include\init.c", 135; list_object_x_pos_ref[i] = TABLE_OBJECT_X_POS_REF_LV1[i];
10759                        		__ld2x.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:CF77  AD 45 26   			lda	__init_OBJECT_LV1_end - 1
         02:CF7A  0A         			asl	a
         02:CF7B  AA         			tax
10760                        		__ld.wax	_TABLE_OBJECT_X_POS_REF_LV1
         02:CF7C  BD 8F 60   			lda.l	_TABLE_OBJECT_X_POS_REF_LV1, x
         02:CF7F  BC 90 60   			ldy.h	_TABLE_OBJECT_X_POS_REF_LV1, x
10761                        		__ld2x.bm	__init_OBJECT_LV1_end - 1  /* i */
         02:CF82  AA         			tax
         02:CF83  AD 45 26   			lda	__init_OBJECT_LV1_end - 1
         02:CF86  0A         			asl	a
         02:CF87  22         			sax
10762                        		__st.waxq	_list_object_x_pos_ref
         02:CF88  9D 3C 25   			sta.l	_list_object_x_pos_ref, x
         02:CF8B  98         			tya
         02:CF8C  9D 3D 25   			sta.h	_list_object_x_pos_ref, x
10763                        	
10764                        		.dbg	line,	"include\init.c", 136; list_object_y_pos_ref[i] = TABLE_OBJECT_Y_POS_REF_LV1[i];
10765                        		__ld2x.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:CF8F  AD 45 26   			lda	__init_OBJECT_LV1_end - 1
         02:CF92  0A         			asl	a
         02:CF93  AA         			tax
10766                        		__ld.wax	_TABLE_OBJECT_Y_POS_REF_LV1
         02:CF94  BD BD 60   			lda.l	_TABLE_OBJECT_Y_POS_REF_LV1, x
         02:CF97  BC BE 60   			ldy.h	_TABLE_OBJECT_Y_POS_REF_LV1, x
10767                        		__ld2x.bm	__init_OBJECT_LV1_end - 1  /* i */
         02:CF9A  AA         			tax
         02:CF9B  AD 45 26   			lda	__init_OBJECT_LV1_end - 1
         02:CF9E  0A         			asl	a
         02:CF9F  22         			sax
10768                        		__st.waxq	_list_object_y_pos_ref
         02:CFA0  9D 6E 25   			sta.l	_list_object_y_pos_ref, x
         02:CFA3  98         			tya
         02:CFA4  9D 6F 25   			sta.h	_list_object_y_pos_ref, x
10769                        	
10770                        		.dbg	line,	"include\init.c", 137; list_object_x_pos[i] = -16;
10771                        		__ld2x.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:CFA7  AD 45 26   			lda	__init_OBJECT_LV1_end - 1
         02:CFAA  0A         			asl	a
         02:CFAB  AA         			tax
10772                        		__st.waxiq	-16, _list_object_x_pos
         02:CFAC  A9 F0      			lda.l	#-16
         02:CFAE  9D D8 24   			sta.l	_list_object_x_pos, x
         02:CFB1  A9 FF      			lda.h	#-16
         02:CFB3  9D D9 24   			sta.h	_list_object_x_pos, x
10773                        	
10774                        		.dbg	line,	"include\init.c", 138; list_object_y_pos[i] = -16;
10775                        		__ld2x.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:CFB6  AD 45 26   			lda	__init_OBJECT_LV1_end - 1
         02:CFB9  0A         			asl	a
         02:CFBA  AA         			tax
10776                        		__st.waxiq	-16, _list_object_y_pos
         02:CFBB  A9 F0      			lda.l	#-16
         02:CFBD  9D 0A 25   			sta.l	_list_object_y_pos, x
         02:CFC0  A9 FF      			lda.h	#-16
         02:CFC2  9D 0B 25   			sta.h	_list_object_y_pos, x
10777                        	
10778                        		.dbg	line,	"include\init.c", 139; 
10779                        	
10780                        		.dbg	line,	"include\init.c", 140; // IF THE PLAYERS ENTERS THE LEVEL FOR THE 1RST TIME //
10781                        	
10782                        		.dbg	line,	"include\init.c", 141; // ALL OBJECTS ARE ACTIVE //
10783                        	
10784                        		.dbg	line,	"include\init.c", 142; if(respawn == FALSE)
10785                        		__not.um	_respawn
         02:CFC5  AD 13 23   			lda	_respawn
         02:CFC8  18         			clc
         02:CFC9  D0 01      			bne	!+
         02:CFCB  38         			sec
         02:CFCC             	!:
10786                        		__bfalse	.LL474
         02:CFCC  90 06      			bcc	.LL474
10787                        	
10788                        		.dbg	line,	"include\init.c", 143; {
10789                        	
10790                        		.dbg	line,	"include\init.c", 144; list_object_state[i] = STATE_ACTIVE;
10791                        		__ldx.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:CFCE  AE 45 26   			ldx	__init_OBJECT_LV1_end - 1
10792                        		__st.uaxiq	0, _list_object_state
         02:CFD1  9E 45 23   			stz	_list_object_state, x
10793                        	
10794                        		.dbg	line,	"include\init.c", 145; }
10795                        	
10796                        		.dbg	line,	"include\init.c", 148; // SET OBJECT SPRITE //
10797                        	
10798                        		.dbg	line,	"include\init.c", 149; spr_set(i + object_start_index);
10799    02:CFD4             	.LL474:
10800                        		__ld.bm		__init_OBJECT_LV1_end - 1  /* i */
         02:CFD4  AD 45 26   			lda	__init_OBJECT_LV1_end - 1
         02:CFD7  C2         			cly
         02:CFD8  10 01      			bpl	!+
         02:CFDA  88         			dey
         02:CFDB             	!:
10801                        		__add.um	_object_start_index
         02:CFDB  18         			clc
         02:CFDC  6D 29 23   			adc	_object_start_index
         02:CFDF  90 01      			bcc	!+
         02:CFE1  C8         			iny
         02:CFE2             	!:
10802                        		__call		_spr_set.1
         02:CFE2  20 DD E7   			call	_spr_set.1
10803                        	
10804                        		.dbg	line,	"include\init.c", 150; spr_x(list_object_x_pos[i]);
10805                        		__ld2x.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:CFE5  AD 45 26   			lda	__init_OBJECT_LV1_end - 1
         02:CFE8  0A         			asl	a
         02:CFE9  AA         			tax
10806                        		__ld.wax	_list_object_x_pos
         02:CFEA  BD D8 24   			lda.l	_list_object_x_pos, x
         02:CFED  BC D9 24   			ldy.h	_list_object_x_pos, x
10807                        		__call		_spr_x.1
         02:CFF0  20 0A E8   			call	_spr_x.1
10808                        	
10809                        		.dbg	line,	"include\init.c", 151; spr_y(list_object_y_pos[i]);
10810                        		__ld2x.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:CFF3  AD 45 26   			lda	__init_OBJECT_LV1_end - 1
         02:CFF6  0A         			asl	a
         02:CFF7  AA         			tax
10811                        		__ld.wax	_list_object_y_pos
         02:CFF8  BD 0A 25   			lda.l	_list_object_y_pos, x
         02:CFFB  BC 0B 25   			ldy.h	_list_object_y_pos, x
10812                        		__call		_spr_y.1
         02:CFFE  20 19 E8   			call	_spr_y.1
10813                        	
10814                        		.dbg	line,	"include\init.c", 152; spr_pri(FALSE);
10815                        		__ld.uiq	0
         02:D001  62         			cla
10816                        		__call		_spr_pri.1
         02:D002  20 5C E8   			call	_spr_pri.1
10817                        	
10818                        		.dbg	line,	"include\init.c", 155; if(list_object_type[i] == TYPE_HOURGLASS)
10819                        		__ldx.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:D005  AE 45 26   			ldx	__init_OBJECT_LV1_end - 1
10820                        		__not.uax	_list_object_type
         02:D008  BD 2C 23   			lda	_list_object_type, x
         02:D00B  18         			clc
         02:D00C  D0 01      			bne	!+
         02:D00E  38         			sec
         02:D00F             	!:
10821                        		__bfalse	.LL475
         02:D00F  90 1D      			bcc	.LL475
10822                        	
10823                        		.dbg	line,	"include\init.c", 156; {
10824                        	
10825                        		.dbg	line,	"include\init.c", 157; list_object_energy[i] = 0;
10826                        		__ldx.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:D011  AE 45 26   			ldx	__init_OBJECT_LV1_end - 1
10827                        		__st.uaxiq	0, _list_object_energy
         02:D014  9E 5E 23   			stz	_list_object_energy, x
10828                        	
10829                        		.dbg	line,	"include\init.c", 158; spr_pal(18);
10830                        		__ld.uiq	18
         02:D017  A9 12      			lda	#18
10831                        		__call		_spr_pal.1
         02:D019  20 4D E8   			call	_spr_pal.1
10832                        	
10833                        		.dbg	line,	"include\init.c", 159; spr_pattern(HOURGLASS_VRAM_ADR);
10834                        		__ld.wi		8640
         02:D01C  A9 C0      			lda.l	#8640
         02:D01E  A0 21      			ldy.h	#8640
10835                        		__call		_spr_pattern.1
         02:D020  20 26 E8   			call	_spr_pattern.1
10836                        	
10837                        		.dbg	line,	"include\init.c", 160; spr_ctrl(FLIP_MAS|SIZE_MAS, NO_FLIP|SZ_16x16);
10838                        		__st.umiq	185, _al
         02:D023  A9 B9      			lda.l	#185
         02:D025  85 F8      			sta	_al
10839                        		__ld.uiq	0
         02:D027  62         			cla
10840                        		__call		_spr_ctrl.2
         02:D028  20 3C E8   			call	_spr_ctrl.2
10841                        	
10842                        		.dbg	line,	"include\init.c", 161; }
10843                        	
10844                        		.dbg	line,	"include\init.c", 163; else if(list_object_type[i] == TYPE_POT)
10845                        		__bra		.LL476
         02:D02B  4C 65 CF   			bra	.LL476
10846    02:D02E             	.LL475:
10847                        		__ldx.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:D02E  AE 45 26   			ldx	__init_OBJECT_LV1_end - 1
10848                        		__ld.uaxq	_list_object_type
         02:D031  BD 2C 23   			lda	_list_object_type, x
10849                        		__equ_b.uiq	1
         02:D034  C9 01      			cmp	#1
         02:D036  F0 01      			beq	!+
         02:D038  18         			clc
         02:D039             	!:
10850                        		__bfalse	.LL477
         02:D039  90 1E      			bcc	.LL477
10851                        	
10852                        		.dbg	line,	"include\init.c", 164; {
10853                        	
10854                        		.dbg	line,	"include\init.c", 165; list_object_energy[i] = 2;
10855                        		__ldx.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:D03B  AE 45 26   			ldx	__init_OBJECT_LV1_end - 1
10856                        		__st.uaxiq	2, _list_object_energy
         02:D03E  A9 02      			lda.l	#2
         02:D040  9D 5E 23   			sta	_list_object_energy, x
10857                        	
10858                        		.dbg	line,	"include\init.c", 166; spr_pal(17);
10859                        		__ld.uiq	17
         02:D043  A9 11      			lda	#17
10860                        		__call		_spr_pal.1
         02:D045  20 4D E8   			call	_spr_pal.1
10861                        	
10862                        		.dbg	line,	"include\init.c", 167; spr_pattern(POT1_VRAM_ADR);
10863                        		__ld.wi		7168
         02:D048  62         			cla
         02:D049  A0 1C      			ldy.h	#7168
10864                        		__call		_spr_pattern.1
         02:D04B  20 26 E8   			call	_spr_pattern.1
10865                        	
10866                        		.dbg	line,	"include\init.c", 168; spr_ctrl(FLIP_MAS|SIZE_MAS, NO_FLIP|SZ_16x16);
10867                        		__st.umiq	185, _al
         02:D04E  A9 B9      			lda.l	#185
         02:D050  85 F8      			sta	_al
10868                        		__ld.uiq	0
         02:D052  62         			cla
10869                        		__call		_spr_ctrl.2
         02:D053  20 3C E8   			call	_spr_ctrl.2
10870                        	
10871                        		.dbg	line,	"include\init.c", 169; }
10872                        	
10873                        		.dbg	line,	"include\init.c", 171; else if(list_object_type[i] == TYPE_POW)
10874                        		__bra		.LL478
         02:D056  4C 65 CF   			bra	.LL478
10875    02:D059             	.LL477:
10876                        		__ldx.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:D059  AE 45 26   			ldx	__init_OBJECT_LV1_end - 1
10877                        		__ld.uaxq	_list_object_type
         02:D05C  BD 2C 23   			lda	_list_object_type, x
10878                        		__equ_b.uiq	2
         02:D05F  C9 02      			cmp	#2
         02:D061  F0 01      			beq	!+
         02:D063  18         			clc
         02:D064             	!:
10879                        		__bfalse	.LL479
         02:D064  B0 03 4C 65			bcc	.LL479
         02:D068  CF          
10880                        	
10881                        		.dbg	line,	"include\init.c", 172; {
10882                        	
10883                        		.dbg	line,	"include\init.c", 173; list_object_energy[i] = 0;
10884                        		__ldx.bmq	__init_OBJECT_LV1_end - 1  /* i */
         02:D069  AE 45 26   			ldx	__init_OBJECT_LV1_end - 1
10885                        		__st.uaxiq	0, _list_object_energy
         02:D06C  9E 5E 23   			stz	_list_object_energy, x
10886                        	
10887                        		.dbg	line,	"include\init.c", 174; spr_pal(18);
10888                        		__ld.uiq	18
         02:D06F  A9 12      			lda	#18
10889                        		__call		_spr_pal.1
         02:D071  20 4D E8   			call	_spr_pal.1
10890                        	
10891                        		.dbg	line,	"include\init.c", 175; spr_pattern(POW_VRAM_ADR);
10892                        		__ld.wi		7680
         02:D074  62         			cla
         02:D075  A0 1E      			ldy.h	#7680
10893                        		__call		_spr_pattern.1
         02:D077  20 26 E8   			call	_spr_pattern.1
10894                        	
10895                        		.dbg	line,	"include\init.c", 176; spr_ctrl(FLIP_MAS|SIZE_MAS, NO_FLIP|SZ_16x16);
10896                        		__st.umiq	185, _al
         02:D07A  A9 B9      			lda.l	#185
         02:D07C  85 F8      			sta	_al
10897                        		__ld.uiq	0
         02:D07E  62         			cla
10898                        		__call		_spr_ctrl.2
         02:D07F  20 3C E8   			call	_spr_ctrl.2
10899                        	
10900                        		.dbg	line,	"include\init.c", 177; }
10901                        	
10902                        		.dbg	line,	"include\init.c", 178; }
10903    02:D082             	.LL479	.alias		.LL471
10904    02:D082             	.LL478	.alias		.LL471
10905    02:D082             	.LL476	.alias		.LL471
10906                        		__bra		.LL471
         02:D082  4C 65 CF   			bra	.LL471
10907    02:D085             	.LL473:
10908                        	
10909                        		.dbg	line,	"include\init.c", 179; }
10910    02:D085             	.LL469:
10911                        		__return	0
         02:D085  4C EF FF   			jmp	leave_proc
10912                        		.dbg	clear
10913                        		.endp
10914                        		.pceas
10915                        	
10916                        		.dbg	line,	"include\init.c", 182; void init_CHEST_LV1()
10917                        		.dbg	line,	"include\init.c", 183; {
10918                        	;***********************
10919                        	;***********************
10920                        	
10921                        		.hucc
10922    02:D567             		.proc		_init_CHEST_LV1
10923                        		__enter		_init_CHEST_LV1
10924                        	
10925                        		.dbg	line,	"include\init.c", 184; signed char i;
10926                        	
10927                        		.dbg	line,	"include\init.c", 186; for(i=0 ; i<level_chest_number ; i++)
10928                        		__st.umiq	0, __init_CHEST_LV1_end - 1  /* i */
         02:D567  9C 45 26   			stz	__init_CHEST_LV1_end - 1
10929    02:D56A             	.LL481:
10930                        		__ld.bm		__init_CHEST_LV1_end - 1  /* i */
         02:D56A  AD 45 26   			lda	__init_CHEST_LV1_end - 1
         02:D56D  C2         			cly
         02:D56E  10 01      			bpl	!+
         02:D570  88         			dey
         02:D571             	!:
10931                        		__slt_w.um	_level_chest_number
         02:D571  CD 99 23   			cmp	_level_chest_number		; Subtract memory from Y:A.
         02:D574  98         			tya
         02:D575  E9 00      			sbc	#0
         02:D577  50 02      			bvc	!+
         02:D579  49 80      			eor	#$80		; -ve if Y:A < memory (signed).
         02:D57B  0A         	!:		asl	a
10932                        		__btrue		.LL483
         02:D57C  B0 08      			bcs	.LL483
10933                        		__bra		.LL484
         02:D57E  4C 2B D6   			bra	.LL484
10934    02:D581             	.LL482:
10935                        		__inc.umq	__init_CHEST_LV1_end - 1  /* i */
         02:D581  EE 45 26   			inc	__init_CHEST_LV1_end - 1
10936                        		__bra		.LL481
         02:D584  80 E4      			bra	.LL481
10937    02:D586             	.LL483:
10938                        	
10939                        		.dbg	line,	"include\init.c", 187; {
10940                        	
10941                        		.dbg	line,	"include\init.c", 188; // SET CHEST PROPERTIES //
10942                        	
10943                        		.dbg	line,	"include\init.c", 189; list_chest_x_pos_ref[i] = TABLE_CHEST_X_POS_REF_LV1[i];
10944                        		__ld2x.bmq	__init_CHEST_LV1_end - 1  /* i */
         02:D586  AD 45 26   			lda	__init_CHEST_LV1_end - 1
         02:D589  0A         			asl	a
         02:D58A  AA         			tax
10945                        		__ld.wax	_TABLE_CHEST_X_POS_REF_LV1
         02:D58B  BD EB 60   			lda.l	_TABLE_CHEST_X_POS_REF_LV1, x
         02:D58E  BC EC 60   			ldy.h	_TABLE_CHEST_X_POS_REF_LV1, x
10946                        		__ld2x.bm	__init_CHEST_LV1_end - 1  /* i */
         02:D591  AA         			tax
         02:D592  AD 45 26   			lda	__init_CHEST_LV1_end - 1
         02:D595  0A         			asl	a
         02:D596  22         			sax
10947                        		__st.waxq	_list_chest_x_pos_ref
         02:D597  9D C0 25   			sta.l	_list_chest_x_pos_ref, x
         02:D59A  98         			tya
         02:D59B  9D C1 25   			sta.h	_list_chest_x_pos_ref, x
10948                        	
10949                        		.dbg	line,	"include\init.c", 190; list_chest_y_pos_ref[i] = TABLE_CHEST_Y_POS_REF_LV1[i];
10950                        		__ld2x.bmq	__init_CHEST_LV1_end - 1  /* i */
         02:D59E  AD 45 26   			lda	__init_CHEST_LV1_end - 1
         02:D5A1  0A         			asl	a
         02:D5A2  AA         			tax
10951                        		__ld.wax	_TABLE_CHEST_Y_POS_REF_LV1
         02:D5A3  BD EF 60   			lda.l	_TABLE_CHEST_Y_POS_REF_LV1, x
         02:D5A6  BC F0 60   			ldy.h	_TABLE_CHEST_Y_POS_REF_LV1, x
10952                        		__ld2x.bm	__init_CHEST_LV1_end - 1  /* i */
         02:D5A9  AA         			tax
         02:D5AA  AD 45 26   			lda	__init_CHEST_LV1_end - 1
         02:D5AD  0A         			asl	a
         02:D5AE  22         			sax
10953                        		__st.waxq	_list_chest_y_pos_ref
         02:D5AF  9D D0 25   			sta.l	_list_chest_y_pos_ref, x
         02:D5B2  98         			tya
         02:D5B3  9D D1 25   			sta.h	_list_chest_y_pos_ref, x
10954                        	
10955                        		.dbg	line,	"include\init.c", 191; list_chest_x_pos[i] = -32;
10956                        		__ld2x.bmq	__init_CHEST_LV1_end - 1  /* i */
         02:D5B6  AD 45 26   			lda	__init_CHEST_LV1_end - 1
         02:D5B9  0A         			asl	a
         02:D5BA  AA         			tax
10957                        		__st.waxiq	-32, _list_chest_x_pos
         02:D5BB  A9 E0      			lda.l	#-32
         02:D5BD  9D A0 25   			sta.l	_list_chest_x_pos, x
         02:D5C0  A9 FF      			lda.h	#-32
         02:D5C2  9D A1 25   			sta.h	_list_chest_x_pos, x
10958                        	
10959                        		.dbg	line,	"include\init.c", 192; list_chest_y_pos[i] = -32;
10960                        		__ld2x.bmq	__init_CHEST_LV1_end - 1  /* i */
         02:D5C5  AD 45 26   			lda	__init_CHEST_LV1_end - 1
         02:D5C8  0A         			asl	a
         02:D5C9  AA         			tax
10961                        		__st.waxiq	-32, _list_chest_y_pos
         02:D5CA  A9 E0      			lda.l	#-32
         02:D5CC  9D B0 25   			sta.l	_list_chest_y_pos, x
         02:D5CF  A9 FF      			lda.h	#-32
         02:D5D1  9D B1 25   			sta.h	_list_chest_y_pos, x
10962                        	
10963                        		.dbg	line,	"include\init.c", 194; if(respawn == FALSE)
10964                        		__not.um	_respawn
         02:D5D4  AD 13 23   			lda	_respawn
         02:D5D7  18         			clc
         02:D5D8  D0 01      			bne	!+
         02:D5DA  38         			sec
         02:D5DB             	!:
10965                        		__bfalse	.LL485
         02:D5DB  90 06      			bcc	.LL485
10966                        	
10967                        		.dbg	line,	"include\init.c", 195; {
10968                        	
10969                        		.dbg	line,	"include\init.c", 196; list_chest_state[i] = STATE_ACTIVE;
10970                        		__ldx.bmq	__init_CHEST_LV1_end - 1  /* i */
         02:D5DD  AE 45 26   			ldx	__init_CHEST_LV1_end - 1
10971                        		__st.uaxiq	0, _list_chest_state
         02:D5E0  9E 9B 23   			stz	_list_chest_state, x
10972                        	
10973                        		.dbg	line,	"include\init.c", 197; }
10974                        	
10975                        		.dbg	line,	"include\init.c", 200; // SET CHEST SPRITE //
10976                        	
10977                        		.dbg	line,	"include\init.c", 201; spr_set(i + chest_start_index);
10978    02:D5E3             	.LL485:
10979                        		__ld.bm		__init_CHEST_LV1_end - 1  /* i */
         02:D5E3  AD 45 26   			lda	__init_CHEST_LV1_end - 1
         02:D5E6  C2         			cly
         02:D5E7  10 01      			bpl	!+
         02:D5E9  88         			dey
         02:D5EA             	!:
10980                        		__add.um	_chest_start_index
         02:D5EA  18         			clc
         02:D5EB  6D 98 23   			adc	_chest_start_index
         02:D5EE  90 01      			bcc	!+
         02:D5F0  C8         			iny
         02:D5F1             	!:
10981                        		__call		_spr_set.1
         02:D5F1  20 DD E7   			call	_spr_set.1
10982                        	
10983                        		.dbg	line,	"include\init.c", 202; spr_x(list_chest_x_pos[i]);
10984                        		__ld2x.bmq	__init_CHEST_LV1_end - 1  /* i */
         02:D5F4  AD 45 26   			lda	__init_CHEST_LV1_end - 1
         02:D5F7  0A         			asl	a
         02:D5F8  AA         			tax
10985                        		__ld.wax	_list_chest_x_pos
         02:D5F9  BD A0 25   			lda.l	_list_chest_x_pos, x
         02:D5FC  BC A1 25   			ldy.h	_list_chest_x_pos, x
10986                        		__call		_spr_x.1
         02:D5FF  20 0A E8   			call	_spr_x.1
10987                        	
10988                        		.dbg	line,	"include\init.c", 203; spr_y(list_chest_y_pos[i]);
10989                        		__ld2x.bmq	__init_CHEST_LV1_end - 1  /* i */
         02:D602  AD 45 26   			lda	__init_CHEST_LV1_end - 1
         02:D605  0A         			asl	a
         02:D606  AA         			tax
10990                        		__ld.wax	_list_chest_y_pos
         02:D607  BD B0 25   			lda.l	_list_chest_y_pos, x
         02:D60A  BC B1 25   			ldy.h	_list_chest_y_pos, x
10991                        		__call		_spr_y.1
         02:D60D  20 19 E8   			call	_spr_y.1
10992                        	
10993                        		.dbg	line,	"include\init.c", 204; spr_pri(FALSE);
10994                        		__ld.uiq	0
         02:D610  62         			cla
10995                        		__call		_spr_pri.1
         02:D611  20 5C E8   			call	_spr_pri.1
10996                        	
10997                        		.dbg	line,	"include\init.c", 207; spr_pal(18);
10998                        		__ld.uiq	18
         02:D614  A9 12      			lda	#18
10999                        		__call		_spr_pal.1
         02:D616  20 4D E8   			call	_spr_pal.1
11000                        	
11001                        		.dbg	line,	"include\init.c", 208; spr_pattern(CHEST_VRAM_ADR);
11002                        		__ld.wi		9216
         02:D619  62         			cla
         02:D61A  A0 24      			ldy.h	#9216
11003                        		__call		_spr_pattern.1
         02:D61C  20 26 E8   			call	_spr_pattern.1
11004                        	
11005                        		.dbg	line,	"include\init.c", 209; spr_ctrl(FLIP_MAS|SIZE_MAS, NO_FLIP|SZ_32x32);
11006                        		__st.umiq	185, _al
         02:D61F  A9 B9      			lda.l	#185
         02:D621  85 F8      			sta	_al
11007                        		__ld.uiq	17
         02:D623  A9 11      			lda	#17
11008                        		__call		_spr_ctrl.2
         02:D625  20 3C E8   			call	_spr_ctrl.2
11009                        	
11010                        		.dbg	line,	"include\init.c", 210; }
11011                        		__bra		.LL482
         02:D628  4C 81 D5   			bra	.LL482
11012    02:D62B             	.LL484:
11013                        	
11014                        		.dbg	line,	"include\init.c", 211; }
11015    02:D62B             	.LL480:
11016                        		__return	0
         02:D62B  4C EF FF   			jmp	leave_proc
11017                        		.dbg	clear
11018                        		.endp
11019                        		.pceas
11020                        	
11021                        		.dbg	line,	"include\init.c", 214; void init_NPC_LV1()
11022                        		.dbg	line,	"include\init.c", 215; {
11023                        	;***********************
11024                        	;***********************
11025                        	
11026                        		.hucc
11027    02:D493             		.proc		_init_NPC_LV1
11028                        		__enter		_init_NPC_LV1
11029                        	
11030                        		.dbg	line,	"include\init.c", 216; signed char i;
11031                        	
11032                        		.dbg	line,	"include\init.c", 218; for(i=0 ; i<level_npc_number ; i++)
11033                        		__st.umiq	0, __init_NPC_LV1_end - 1  /* i */
         02:D493  9C 45 26   			stz	__init_NPC_LV1_end - 1
11034    02:D496             	.LL487:
11035                        		__ld.bm		__init_NPC_LV1_end - 1  /* i */
         02:D496  AD 45 26   			lda	__init_NPC_LV1_end - 1
         02:D499  C2         			cly
         02:D49A  10 01      			bpl	!+
         02:D49C  88         			dey
         02:D49D             	!:
11036                        		__slt_w.um	_level_npc_number
         02:D49D  CD AC 23   			cmp	_level_npc_number		; Subtract memory from Y:A.
         02:D4A0  98         			tya
         02:D4A1  E9 00      			sbc	#0
         02:D4A3  50 02      			bvc	!+
         02:D4A5  49 80      			eor	#$80		; -ve if Y:A < memory (signed).
         02:D4A7  0A         	!:		asl	a
11037                        		__btrue		.LL489
         02:D4A8  B0 08      			bcs	.LL489
11038                        		__bra		.LL490
         02:D4AA  4C 64 D5   			bra	.LL490
11039    02:D4AD             	.LL488:
11040                        		__inc.umq	__init_NPC_LV1_end - 1  /* i */
         02:D4AD  EE 45 26   			inc	__init_NPC_LV1_end - 1
11041                        		__bra		.LL487
         02:D4B0  80 E4      			bra	.LL487
11042    02:D4B2             	.LL489:
11043                        	
11044                        		.dbg	line,	"include\init.c", 219; {
11045                        	
11046                        		.dbg	line,	"include\init.c", 220; // SET NPC PROPERTIES //
11047                        	
11048                        		.dbg	line,	"include\init.c", 221; list_npc_type[i] = TABLE_NPC_TYPE_LV1[i];
11049                        		__ldx.bmq	__init_NPC_LV1_end - 1  /* i */
         02:D4B2  AE 45 26   			ldx	__init_NPC_LV1_end - 1
11050                        		__ld.uax	_TABLE_NPC_TYPE_LV1
         02:D4B5  BD 6E 60   			lda	_TABLE_NPC_TYPE_LV1, x
         02:D4B8  C2         			cly
11051                        		__ldx.bmq	__init_NPC_LV1_end - 1  /* i */
         02:D4B9  AE 45 26   			ldx	__init_NPC_LV1_end - 1
11052                        		__st.uaxq	_list_npc_type
         02:D4BC  9D AE 23   			sta	_list_npc_type, x
11053                        	
11054                        		.dbg	line,	"include\init.c", 222; list_npc_x_pos_ref[i] = TABLE_NPC_X_POS_REF_LV1[i];
11055                        		__ld2x.bmq	__init_NPC_LV1_end - 1  /* i */
         02:D4BF  AD 45 26   			lda	__init_NPC_LV1_end - 1
         02:D4C2  0A         			asl	a
         02:D4C3  AA         			tax
11056                        		__ld.wax	_TABLE_NPC_X_POS_REF_LV1
         02:D4C4  BD 70 60   			lda.l	_TABLE_NPC_X_POS_REF_LV1, x
         02:D4C7  BC 71 60   			ldy.h	_TABLE_NPC_X_POS_REF_LV1, x
11057                        		__ld2x.bm	__init_NPC_LV1_end - 1  /* i */
         02:D4CA  AA         			tax
         02:D4CB  AD 45 26   			lda	__init_NPC_LV1_end - 1
         02:D4CE  0A         			asl	a
         02:D4CF  22         			sax
11058                        		__st.waxq	_list_npc_x_pos_ref
         02:D4D0  9D 04 26   			sta.l	_list_npc_x_pos_ref, x
         02:D4D3  98         			tya
         02:D4D4  9D 05 26   			sta.h	_list_npc_x_pos_ref, x
11059                        	
11060                        		.dbg	line,	"include\init.c", 223; list_npc_y_pos_ref[i] = TABLE_NPC_Y_POS_REF_LV1[i];
11061                        		__ld2x.bmq	__init_NPC_LV1_end - 1  /* i */
         02:D4D7  AD 45 26   			lda	__init_NPC_LV1_end - 1
         02:D4DA  0A         			asl	a
         02:D4DB  AA         			tax
11062                        		__ld.wax	_TABLE_NPC_Y_POS_REF_LV1
         02:D4DC  BD 74 60   			lda.l	_TABLE_NPC_Y_POS_REF_LV1, x
         02:D4DF  BC 75 60   			ldy.h	_TABLE_NPC_Y_POS_REF_LV1, x
11063                        		__ld2x.bm	__init_NPC_LV1_end - 1  /* i */
         02:D4E2  AA         			tax
         02:D4E3  AD 45 26   			lda	__init_NPC_LV1_end - 1
         02:D4E6  0A         			asl	a
         02:D4E7  22         			sax
11064                        		__st.waxq	_list_npc_y_pos_ref
         02:D4E8  9D 16 26   			sta.l	_list_npc_y_pos_ref, x
         02:D4EB  98         			tya
         02:D4EC  9D 17 26   			sta.h	_list_npc_y_pos_ref, x
11065                        	
11066                        		.dbg	line,	"include\init.c", 224; list_npc_x_pos[i] = -32;
11067                        		__ld2x.bmq	__init_NPC_LV1_end - 1  /* i */
         02:D4EF  AD 45 26   			lda	__init_NPC_LV1_end - 1
         02:D4F2  0A         			asl	a
         02:D4F3  AA         			tax
11068                        		__st.waxiq	-32, _list_npc_x_pos
         02:D4F4  A9 E0      			lda.l	#-32
         02:D4F6  9D E0 25   			sta.l	_list_npc_x_pos, x
         02:D4F9  A9 FF      			lda.h	#-32
         02:D4FB  9D E1 25   			sta.h	_list_npc_x_pos, x
11069                        	
11070                        		.dbg	line,	"include\init.c", 225; list_npc_y_pos[i] = -32;
11071                        		__ld2x.bmq	__init_NPC_LV1_end - 1  /* i */
         02:D4FE  AD 45 26   			lda	__init_NPC_LV1_end - 1
         02:D501  0A         			asl	a
         02:D502  AA         			tax
11072                        		__st.waxiq	-32, _list_npc_y_pos
         02:D503  A9 E0      			lda.l	#-32
         02:D505  9D F2 25   			sta.l	_list_npc_y_pos, x
         02:D508  A9 FF      			lda.h	#-32
         02:D50A  9D F3 25   			sta.h	_list_npc_y_pos, x
11073                        	
11074                        		.dbg	line,	"include\init.c", 227; if(respawn == FALSE)
11075                        		__not.um	_respawn
         02:D50D  AD 13 23   			lda	_respawn
         02:D510  18         			clc
         02:D511  D0 01      			bne	!+
         02:D513  38         			sec
         02:D514             	!:
11076                        		__bfalse	.LL491
         02:D514  90 06      			bcc	.LL491
11077                        	
11078                        		.dbg	line,	"include\init.c", 228; {
11079                        	
11080                        		.dbg	line,	"include\init.c", 229; list_npc_state[i] = STATE_ACTIVE;
11081                        		__ldx.bmq	__init_NPC_LV1_end - 1  /* i */
         02:D516  AE 45 26   			ldx	__init_NPC_LV1_end - 1
11082                        		__st.uaxiq	0, _list_npc_state
         02:D519  9E B7 23   			stz	_list_npc_state, x
11083                        	
11084                        		.dbg	line,	"include\init.c", 230; }
11085                        	
11086                        		.dbg	line,	"include\init.c", 233; // SET NPC SPRITE //
11087                        	
11088                        		.dbg	line,	"include\init.c", 234; spr_set(i + npc_start_index);
11089    02:D51C             	.LL491:
11090                        		__ld.bm		__init_NPC_LV1_end - 1  /* i */
         02:D51C  AD 45 26   			lda	__init_NPC_LV1_end - 1
         02:D51F  C2         			cly
         02:D520  10 01      			bpl	!+
         02:D522  88         			dey
         02:D523             	!:
11091                        		__add.um	_npc_start_index
         02:D523  18         			clc
         02:D524  6D AB 23   			adc	_npc_start_index
         02:D527  90 01      			bcc	!+
         02:D529  C8         			iny
         02:D52A             	!:
11092                        		__call		_spr_set.1
         02:D52A  20 DD E7   			call	_spr_set.1
11093                        	
11094                        		.dbg	line,	"include\init.c", 235; spr_x(list_npc_x_pos[i]);
11095                        		__ld2x.bmq	__init_NPC_LV1_end - 1  /* i */
         02:D52D  AD 45 26   			lda	__init_NPC_LV1_end - 1
         02:D530  0A         			asl	a
         02:D531  AA         			tax
11096                        		__ld.wax	_list_npc_x_pos
         02:D532  BD E0 25   			lda.l	_list_npc_x_pos, x
         02:D535  BC E1 25   			ldy.h	_list_npc_x_pos, x
11097                        		__call		_spr_x.1
         02:D538  20 0A E8   			call	_spr_x.1
11098                        	
11099                        		.dbg	line,	"include\init.c", 236; spr_y(list_npc_y_pos[i]);
11100                        		__ld2x.bmq	__init_NPC_LV1_end - 1  /* i */
         02:D53B  AD 45 26   			lda	__init_NPC_LV1_end - 1
         02:D53E  0A         			asl	a
         02:D53F  AA         			tax
11101                        		__ld.wax	_list_npc_y_pos
         02:D540  BD F2 25   			lda.l	_list_npc_y_pos, x
         02:D543  BC F3 25   			ldy.h	_list_npc_y_pos, x
11102                        		__call		_spr_y.1
         02:D546  20 19 E8   			call	_spr_y.1
11103                        	
11104                        		.dbg	line,	"include\init.c", 237; spr_pri(FALSE);
11105                        		__ld.uiq	0
         02:D549  62         			cla
11106                        		__call		_spr_pri.1
         02:D54A  20 5C E8   			call	_spr_pri.1
11107                        	
11108                        		.dbg	line,	"include\init.c", 240; spr_pal(17);
11109                        		__ld.uiq	17
         02:D54D  A9 11      			lda	#17
11110                        		__call		_spr_pal.1
         02:D54F  20 4D E8   			call	_spr_pal.1
11111                        	
11112                        		.dbg	line,	"include\init.c", 241; spr_pattern(NPC_VRAM_ADR);
11113                        		__ld.wi		10752
         02:D552  62         			cla
         02:D553  A0 2A      			ldy.h	#10752
11114                        		__call		_spr_pattern.1
         02:D555  20 26 E8   			call	_spr_pattern.1
11115                        	
11116                        		.dbg	line,	"include\init.c", 242; spr_ctrl(FLIP_MAS|SIZE_MAS, NO_FLIP|SZ_32x32);
11117                        		__st.umiq	185, _al
         02:D558  A9 B9      			lda.l	#185
         02:D55A  85 F8      			sta	_al
11118                        		__ld.uiq	17
         02:D55C  A9 11      			lda	#17
11119                        		__call		_spr_ctrl.2
         02:D55E  20 3C E8   			call	_spr_ctrl.2
11120                        	
11121                        		.dbg	line,	"include\init.c", 243; }
11122                        		__bra		.LL488
         02:D561  4C AD D4   			bra	.LL488
11123    02:D564             	.LL490:
11124                        	
11125                        		.dbg	line,	"include\init.c", 244; }
11126    02:D564             	.LL486:
11127                        		__return	0
         02:D564  4C EF FF   			jmp	leave_proc
11128                        		.dbg	clear
11129                        		.endp
11130                        		.pceas
11131                        	
11132                        		.dbg	line,	"include\init.c", 251; void init_HUD()
11133                        		.dbg	line,	"include\init.c", 252; {
11134                        	;***********************
11135                        	;***********************
11136                        	
11137                        		.hucc
11138    01:DB80             		.proc		_init_HUD
11139                        		__enter		_init_HUD
11140                        	
11141                        		.dbg	line,	"include\init.c", 253; //**************************************************************************************//
11142                        	
11143                        		.dbg	line,	"include\init.c", 254; //                                                                                      //
11144                        	
11145                        		.dbg	line,	"include\init.c", 255; //                                        VDC 1                                         //
11146                        	
11147                        		.dbg	line,	"include\init.c", 256; //                                                                                      //
11148                        	
11149                        		.dbg	line,	"include\init.c", 257; //**************************************************************************************//
11150                        	
11151                        		.dbg	line,	"include\init.c", 259; //--------------------------------------------------------------------------------------//
11152                        	
11153                        		.dbg	line,	"include\init.c", 260; //                                      LOAD FONT                                       //
11154                        	
11155                        		.dbg	line,	"include\init.c", 261; //--------------------------------------------------------------------------------------//
11156                        	
11157                        		.dbg	line,	"include\init.c", 263; load_vram( 0x0800, tileset_FONT, SIZEOF(tileset_FONT) >> 1 );
11158                        		__st.wmiq	2048, _di
         01:DB80  64 F0      			stz.l	_di
         01:DB82  A9 08      			lda.h	#2048
         01:DB84  85 F1      			sta.h	_di
11159                        		__farptr	_tileset_FONT, _bp_bank, _bp
         01:DB86  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_FONT))
         01:DB88  85 EC      			sta.l	_bp
         01:DB8A  A9 60      			lda.h	#$6000 + ($1FFF & (_tileset_FONT))
         01:DB8C  85 ED      			sta.h	_bp
         01:DB8E  A9 03      			lda	#bank(_tileset_FONT)
         01:DB90  85 02      			sta	_bp_bank
11160                        		__ld.wi		___sizeof__tileset_FONT
         01:DB92  A9 00      			lda.l	#___sizeof__tileset_FONT
         01:DB94  A0 0C      			ldy.h	#___sizeof__tileset_FONT
11161                        		__lsr.wi	1
         01:DB96  42         			say
         01:DB97  4A         			lsr	a
         01:DB98  42         			say
         01:DB99  6A         			ror	a
11162                        		__st.wmq	_ax
         01:DB9A  85 F8      			sta.l	_ax
         01:DB9C  84 F9      			sty.h	_ax
11163                        		 _load_vram.3
         01:DB9E  82         			clx				; Offset to PCE VDC.
         01:DB9F  20 63 FF   			call	load_vram_x
11164                        	
11165                        		.dbg	line,	"include\init.c", 265; set_font_pal(15);
11166                        		__ld.uiq	15
         01:DBA2  A9 0F      			lda	#15
11167                        		__call		_set_font_pal.1
         01:DBA4  20 09 E6   			call	_set_font_pal.1
11168                        	
11169                        		.dbg	line,	"include\init.c", 268; //--------------------------------------------------------------------------------------//
11170                        	
11171                        		.dbg	line,	"include\init.c", 269; //                                    LOAD TILESET                                      //
11172                        	
11173                        		.dbg	line,	"include\init.c", 270; //--------------------------------------------------------------------------------------//
11174                        	
11175                        		.dbg	line,	"include\init.c", 272; load_vram( 0x1000, tileset_HUD, SIZEOF(tileset_HUD) >> 1 );
11176                        		__st.wmiq	4096, _di
         01:DBA7  64 F0      			stz.l	_di
         01:DBA9  A9 10      			lda.h	#4096
         01:DBAB  85 F1      			sta.h	_di
11177                        		__farptr	_tileset_HUD, _bp_bank, _bp
         01:DBAD  A9 A0      			lda.l	#$6000 + ($1FFF & (_tileset_HUD))
         01:DBAF  85 EC      			sta.l	_bp
         01:DBB1  A9 79      			lda.h	#$6000 + ($1FFF & (_tileset_HUD))
         01:DBB3  85 ED      			sta.h	_bp
         01:DBB5  A9 09      			lda	#bank(_tileset_HUD)
         01:DBB7  85 02      			sta	_bp_bank
11178                        		__ld.wi		___sizeof__tileset_HUD
         01:DBB9  A9 60      			lda.l	#___sizeof__tileset_HUD
         01:DBBB  A0 06      			ldy.h	#___sizeof__tileset_HUD
11179                        		__lsr.wi	1
         01:DBBD  42         			say
         01:DBBE  4A         			lsr	a
         01:DBBF  42         			say
         01:DBC0  6A         			ror	a
11180                        		__st.wmq	_ax
         01:DBC1  85 F8      			sta.l	_ax
         01:DBC3  84 F9      			sty.h	_ax
11181                        		 _load_vram.3
         01:DBC5  82         			clx				; Offset to PCE VDC.
         01:DBC6  20 63 FF   			call	load_vram_x
11182                        	
11183                        		.dbg	line,	"include\init.c", 275; //--------------------------------------------------------------------------------------//
11184                        	
11185                        		.dbg	line,	"include\init.c", 276; //                                 LOAD LIFEBAR TILES                                   //
11186                        	
11187                        		.dbg	line,	"include\init.c", 277; //--------------------------------------------------------------------------------------//
11188                        	
11189                        		.dbg	line,	"include\init.c", 279; load_vram( LIFEBAR_1_VRAM_ADR, tileset_LIFE_RED, SIZEOF(tileset_LIFE_RED) >> 1 );
11190                        		__st.wmiq	4096, _di
         01:DBC9  64 F0      			stz.l	_di
         01:DBCB  A9 10      			lda.h	#4096
         01:DBCD  85 F1      			sta.h	_di
11191                        		__farptr	_tileset_LIFE_RED, _bp_bank, _bp
         01:DBCF  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_LIFE_RED))
         01:DBD1  85 EC      			sta.l	_bp
         01:DBD3  A9 74      			lda.h	#$6000 + ($1FFF & (_tileset_LIFE_RED))
         01:DBD5  85 ED      			sta.h	_bp
         01:DBD7  A9 03      			lda	#bank(_tileset_LIFE_RED)
         01:DBD9  85 02      			sta	_bp_bank
11192                        		__ld.wi		___sizeof__tileset_LIFE_RED
         01:DBDB  A9 40      			lda.l	#___sizeof__tileset_LIFE_RED
         01:DBDD  A0 00      			ldy.h	#___sizeof__tileset_LIFE_RED
11193                        		__lsr.wi	1
         01:DBDF  42         			say
         01:DBE0  4A         			lsr	a
         01:DBE1  42         			say
         01:DBE2  6A         			ror	a
11194                        		__st.wmq	_ax
         01:DBE3  85 F8      			sta.l	_ax
         01:DBE5  84 F9      			sty.h	_ax
11195                        		 _load_vram.3
         01:DBE7  82         			clx				; Offset to PCE VDC.
         01:DBE8  20 63 FF   			call	load_vram_x
11196                        	
11197                        		.dbg	line,	"include\init.c", 280; load_vram( LIFEBAR_2_VRAM_ADR, tileset_LIFE_ORANGE, SIZEOF(tileset_LIFE_ORANGE) >> 1 );
11198                        		__st.wmiq	4128, _di
         01:DBEB  A9 20      			lda.l	#4128
         01:DBED  85 F0      			sta.l	_di
         01:DBEF  A9 10      			lda.h	#4128
         01:DBF1  85 F1      			sta.h	_di
11199                        		__farptr	_tileset_LIFE_ORANGE, _bp_bank, _bp
         01:DBF3  A9 40      			lda.l	#$6000 + ($1FFF & (_tileset_LIFE_ORANGE))
         01:DBF5  85 EC      			sta.l	_bp
         01:DBF7  A9 74      			lda.h	#$6000 + ($1FFF & (_tileset_LIFE_ORANGE))
         01:DBF9  85 ED      			sta.h	_bp
         01:DBFB  A9 03      			lda	#bank(_tileset_LIFE_ORANGE)
         01:DBFD  85 02      			sta	_bp_bank
11200                        		__ld.wi		___sizeof__tileset_LIFE_ORANGE
         01:DBFF  A9 40      			lda.l	#___sizeof__tileset_LIFE_ORANGE
         01:DC01  A0 00      			ldy.h	#___sizeof__tileset_LIFE_ORANGE
11201                        		__lsr.wi	1
         01:DC03  42         			say
         01:DC04  4A         			lsr	a
         01:DC05  42         			say
         01:DC06  6A         			ror	a
11202                        		__st.wmq	_ax
         01:DC07  85 F8      			sta.l	_ax
         01:DC09  84 F9      			sty.h	_ax
11203                        		 _load_vram.3
         01:DC0B  82         			clx				; Offset to PCE VDC.
         01:DC0C  20 63 FF   			call	load_vram_x
11204                        	
11205                        		.dbg	line,	"include\init.c", 281; load_vram( LIFEBAR_3_VRAM_ADR, tileset_LIFE_YELLOW, SIZEOF(tileset_LIFE_YELLOW) >> 1 );
11206                        		__st.wmiq	4160, _di
         01:DC0F  A9 40      			lda.l	#4160
         01:DC11  85 F0      			sta.l	_di
         01:DC13  A9 10      			lda.h	#4160
         01:DC15  85 F1      			sta.h	_di
11207                        		__farptr	_tileset_LIFE_YELLOW, _bp_bank, _bp
         01:DC17  A9 80      			lda.l	#$6000 + ($1FFF & (_tileset_LIFE_YELLOW))
         01:DC19  85 EC      			sta.l	_bp
         01:DC1B  A9 74      			lda.h	#$6000 + ($1FFF & (_tileset_LIFE_YELLOW))
         01:DC1D  85 ED      			sta.h	_bp
         01:DC1F  A9 03      			lda	#bank(_tileset_LIFE_YELLOW)
         01:DC21  85 02      			sta	_bp_bank
11208                        		__ld.wi		___sizeof__tileset_LIFE_YELLOW
         01:DC23  A9 40      			lda.l	#___sizeof__tileset_LIFE_YELLOW
         01:DC25  A0 00      			ldy.h	#___sizeof__tileset_LIFE_YELLOW
11209                        		__lsr.wi	1
         01:DC27  42         			say
         01:DC28  4A         			lsr	a
         01:DC29  42         			say
         01:DC2A  6A         			ror	a
11210                        		__st.wmq	_ax
         01:DC2B  85 F8      			sta.l	_ax
         01:DC2D  84 F9      			sty.h	_ax
11211                        		 _load_vram.3
         01:DC2F  82         			clx				; Offset to PCE VDC.
         01:DC30  20 63 FF   			call	load_vram_x
11212                        	
11213                        		.dbg	line,	"include\init.c", 282; load_vram( LIFEBAR_4_VRAM_ADR, tileset_LIFE_YELLOW, SIZEOF(tileset_LIFE_YELLOW) >> 1 );
11214                        		__st.wmiq	4192, _di
         01:DC33  A9 60      			lda.l	#4192
         01:DC35  85 F0      			sta.l	_di
         01:DC37  A9 10      			lda.h	#4192
         01:DC39  85 F1      			sta.h	_di
11215                        		__farptr	_tileset_LIFE_YELLOW, _bp_bank, _bp
         01:DC3B  A9 80      			lda.l	#$6000 + ($1FFF & (_tileset_LIFE_YELLOW))
         01:DC3D  85 EC      			sta.l	_bp
         01:DC3F  A9 74      			lda.h	#$6000 + ($1FFF & (_tileset_LIFE_YELLOW))
         01:DC41  85 ED      			sta.h	_bp
         01:DC43  A9 03      			lda	#bank(_tileset_LIFE_YELLOW)
         01:DC45  85 02      			sta	_bp_bank
11216                        		__ld.wi		___sizeof__tileset_LIFE_YELLOW
         01:DC47  A9 40      			lda.l	#___sizeof__tileset_LIFE_YELLOW
         01:DC49  A0 00      			ldy.h	#___sizeof__tileset_LIFE_YELLOW
11217                        		__lsr.wi	1
         01:DC4B  42         			say
         01:DC4C  4A         			lsr	a
         01:DC4D  42         			say
         01:DC4E  6A         			ror	a
11218                        		__st.wmq	_ax
         01:DC4F  85 F8      			sta.l	_ax
         01:DC51  84 F9      			sty.h	_ax
11219                        		 _load_vram.3
         01:DC53  82         			clx				; Offset to PCE VDC.
         01:DC54  20 63 FF   			call	load_vram_x
11220                        	
11221                        		.dbg	line,	"include\init.c", 283; load_vram( LIFEBAR_5_VRAM_ADR, tileset_LIFE_EMPTY, SIZEOF(tileset_LIFE_EMPTY) >> 1 );
11222                        		__st.wmiq	4224, _di
         01:DC57  A9 80      			lda.l	#4224
         01:DC59  85 F0      			sta.l	_di
         01:DC5B  A9 10      			lda.h	#4224
         01:DC5D  85 F1      			sta.h	_di
11223                        		__farptr	_tileset_LIFE_EMPTY, _bp_bank, _bp
         01:DC5F  A9 C0      			lda.l	#$6000 + ($1FFF & (_tileset_LIFE_EMPTY))
         01:DC61  85 EC      			sta.l	_bp
         01:DC63  A9 74      			lda.h	#$6000 + ($1FFF & (_tileset_LIFE_EMPTY))
         01:DC65  85 ED      			sta.h	_bp
         01:DC67  A9 03      			lda	#bank(_tileset_LIFE_EMPTY)
         01:DC69  85 02      			sta	_bp_bank
11224                        		__ld.wi		___sizeof__tileset_LIFE_EMPTY
         01:DC6B  A9 40      			lda.l	#___sizeof__tileset_LIFE_EMPTY
         01:DC6D  A0 00      			ldy.h	#___sizeof__tileset_LIFE_EMPTY
11225                        		__lsr.wi	1
         01:DC6F  42         			say
         01:DC70  4A         			lsr	a
         01:DC71  42         			say
         01:DC72  6A         			ror	a
11226                        		__st.wmq	_ax
         01:DC73  85 F8      			sta.l	_ax
         01:DC75  84 F9      			sty.h	_ax
11227                        		 _load_vram.3
         01:DC77  82         			clx				; Offset to PCE VDC.
         01:DC78  20 63 FF   			call	load_vram_x
11228                        	
11229                        		.dbg	line,	"include\init.c", 286; //--------------------------------------------------------------------------------------//
11230                        	
11231                        		.dbg	line,	"include\init.c", 287; //                               LOAD WEAPON + ARMOR TILES                              //
11232                        	
11233                        		.dbg	line,	"include\init.c", 288; //--------------------------------------------------------------------------------------//
11234                        	
11235                        		.dbg	line,	"include\init.c", 290; if(weapon_level == 1)
11236                        		__ld.umq	_weapon_level
         01:DC7B  AD 20 23   			lda	_weapon_level
11237                        		__equ_b.uiq	1
         01:DC7E  C9 01      			cmp	#1
         01:DC80  F0 01      			beq	!+
         01:DC82  18         			clc
         01:DC83             	!:
11238                        		__bfalse	.LL493
         01:DC83  90 27      			bcc	.LL493
11239                        	
11240                        		.dbg	line,	"include\init.c", 291; {
11241                        	
11242                        		.dbg	line,	"include\init.c", 292; load_vram( WEAPON_VRAM_ADR, tileset_WEAPON_1, SIZEOF(tileset_WEAPON_1) >> 1 );
11243                        		__st.wmiq	4256, _di
         01:DC85  A9 A0      			lda.l	#4256
         01:DC87  85 F0      			sta.l	_di
         01:DC89  A9 10      			lda.h	#4256
         01:DC8B  85 F1      			sta.h	_di
11244                        		__farptr	_tileset_WEAPON_1, _bp_bank, _bp
         01:DC8D  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_WEAPON_1))
         01:DC8F  85 EC      			sta.l	_bp
         01:DC91  A9 77      			lda.h	#$6000 + ($1FFF & (_tileset_WEAPON_1))
         01:DC93  85 ED      			sta.h	_bp
         01:DC95  A9 03      			lda	#bank(_tileset_WEAPON_1)
         01:DC97  85 02      			sta	_bp_bank
11245                        		__ld.wi		___sizeof__tileset_WEAPON_1
         01:DC99  A9 80      			lda.l	#___sizeof__tileset_WEAPON_1
         01:DC9B  A0 00      			ldy.h	#___sizeof__tileset_WEAPON_1
11246                        		__lsr.wi	1
         01:DC9D  42         			say
         01:DC9E  4A         			lsr	a
         01:DC9F  42         			say
         01:DCA0  6A         			ror	a
11247                        		__st.wmq	_ax
         01:DCA1  85 F8      			sta.l	_ax
         01:DCA3  84 F9      			sty.h	_ax
11248                        		 _load_vram.3
         01:DCA5  82         			clx				; Offset to PCE VDC.
         01:DCA6  20 63 FF   			call	load_vram_x
11249                        	
11250                        		.dbg	line,	"include\init.c", 293; }
11251                        	
11252                        		.dbg	line,	"include\init.c", 295; else if(weapon_level == 2)
11253                        		__bra		.LL494
         01:DCA9  4C 6B DD   			bra	.LL494
11254    01:DCAC             	.LL493:
11255                        		__ld.umq	_weapon_level
         01:DCAC  AD 20 23   			lda	_weapon_level
11256                        		__equ_b.uiq	2
         01:DCAF  C9 02      			cmp	#2
         01:DCB1  F0 01      			beq	!+
         01:DCB3  18         			clc
         01:DCB4             	!:
11257                        		__bfalse	.LL495
         01:DCB4  90 27      			bcc	.LL495
11258                        	
11259                        		.dbg	line,	"include\init.c", 296; {
11260                        	
11261                        		.dbg	line,	"include\init.c", 297; load_vram( WEAPON_VRAM_ADR, tileset_WEAPON_2, SIZEOF(tileset_WEAPON_2) >> 1 );
11262                        		__st.wmiq	4256, _di
         01:DCB6  A9 A0      			lda.l	#4256
         01:DCB8  85 F0      			sta.l	_di
         01:DCBA  A9 10      			lda.h	#4256
         01:DCBC  85 F1      			sta.h	_di
11263                        		__farptr	_tileset_WEAPON_2, _bp_bank, _bp
         01:DCBE  A9 80      			lda.l	#$6000 + ($1FFF & (_tileset_WEAPON_2))
         01:DCC0  85 EC      			sta.l	_bp
         01:DCC2  A9 77      			lda.h	#$6000 + ($1FFF & (_tileset_WEAPON_2))
         01:DCC4  85 ED      			sta.h	_bp
         01:DCC6  A9 03      			lda	#bank(_tileset_WEAPON_2)
         01:DCC8  85 02      			sta	_bp_bank
11264                        		__ld.wi		___sizeof__tileset_WEAPON_2
         01:DCCA  A9 80      			lda.l	#___sizeof__tileset_WEAPON_2
         01:DCCC  A0 00      			ldy.h	#___sizeof__tileset_WEAPON_2
11265                        		__lsr.wi	1
         01:DCCE  42         			say
         01:DCCF  4A         			lsr	a
         01:DCD0  42         			say
         01:DCD1  6A         			ror	a
11266                        		__st.wmq	_ax
         01:DCD2  85 F8      			sta.l	_ax
         01:DCD4  84 F9      			sty.h	_ax
11267                        		 _load_vram.3
         01:DCD6  82         			clx				; Offset to PCE VDC.
         01:DCD7  20 63 FF   			call	load_vram_x
11268                        	
11269                        		.dbg	line,	"include\init.c", 298; }
11270                        	
11271                        		.dbg	line,	"include\init.c", 300; else if(weapon_level == 3)
11272                        		__bra		.LL496
         01:DCDA  4C 6B DD   			bra	.LL496
11273    01:DCDD             	.LL495:
11274                        		__ld.umq	_weapon_level
         01:DCDD  AD 20 23   			lda	_weapon_level
11275                        		__equ_b.uiq	3
         01:DCE0  C9 03      			cmp	#3
         01:DCE2  F0 01      			beq	!+
         01:DCE4  18         			clc
         01:DCE5             	!:
11276                        		__bfalse	.LL497
         01:DCE5  90 26      			bcc	.LL497
11277                        	
11278                        		.dbg	line,	"include\init.c", 301; {
11279                        	
11280                        		.dbg	line,	"include\init.c", 302; load_vram( WEAPON_VRAM_ADR, tileset_WEAPON_4, SIZEOF(tileset_WEAPON_4) >> 1 );
11281                        		__st.wmiq	4256, _di
         01:DCE7  A9 A0      			lda.l	#4256
         01:DCE9  85 F0      			sta.l	_di
         01:DCEB  A9 10      			lda.h	#4256
         01:DCED  85 F1      			sta.h	_di
11282                        		__farptr	_tileset_WEAPON_4, _bp_bank, _bp
         01:DCEF  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_WEAPON_4))
         01:DCF1  85 EC      			sta.l	_bp
         01:DCF3  A9 78      			lda.h	#$6000 + ($1FFF & (_tileset_WEAPON_4))
         01:DCF5  85 ED      			sta.h	_bp
         01:DCF7  A9 03      			lda	#bank(_tileset_WEAPON_4)
         01:DCF9  85 02      			sta	_bp_bank
11283                        		__ld.wi		___sizeof__tileset_WEAPON_4
         01:DCFB  A9 80      			lda.l	#___sizeof__tileset_WEAPON_4
         01:DCFD  A0 00      			ldy.h	#___sizeof__tileset_WEAPON_4
11284                        		__lsr.wi	1
         01:DCFF  42         			say
         01:DD00  4A         			lsr	a
         01:DD01  42         			say
         01:DD02  6A         			ror	a
11285                        		__st.wmq	_ax
         01:DD03  85 F8      			sta.l	_ax
         01:DD05  84 F9      			sty.h	_ax
11286                        		 _load_vram.3
         01:DD07  82         			clx				; Offset to PCE VDC.
         01:DD08  20 63 FF   			call	load_vram_x
11287                        	
11288                        		.dbg	line,	"include\init.c", 303; }
11289                        	
11290                        		.dbg	line,	"include\init.c", 305; else if(weapon_level == 4)
11291                        		__bra		.LL498
         01:DD0B  80 5E      			bra	.LL498
11292    01:DD0D             	.LL497:
11293                        		__ld.umq	_weapon_level
         01:DD0D  AD 20 23   			lda	_weapon_level
11294                        		__equ_b.uiq	4
         01:DD10  C9 04      			cmp	#4
         01:DD12  F0 01      			beq	!+
         01:DD14  18         			clc
         01:DD15             	!:
11295                        		__bfalse	.LL499
         01:DD15  90 26      			bcc	.LL499
11296                        	
11297                        		.dbg	line,	"include\init.c", 306; {
11298                        	
11299                        		.dbg	line,	"include\init.c", 307; load_vram( WEAPON_VRAM_ADR, tileset_WEAPON_5, SIZEOF(tileset_WEAPON_5) >> 1 );
11300                        		__st.wmiq	4256, _di
         01:DD17  A9 A0      			lda.l	#4256
         01:DD19  85 F0      			sta.l	_di
         01:DD1B  A9 10      			lda.h	#4256
         01:DD1D  85 F1      			sta.h	_di
11301                        		__farptr	_tileset_WEAPON_5, _bp_bank, _bp
         01:DD1F  A9 80      			lda.l	#$6000 + ($1FFF & (_tileset_WEAPON_5))
         01:DD21  85 EC      			sta.l	_bp
         01:DD23  A9 78      			lda.h	#$6000 + ($1FFF & (_tileset_WEAPON_5))
         01:DD25  85 ED      			sta.h	_bp
         01:DD27  A9 03      			lda	#bank(_tileset_WEAPON_5)
         01:DD29  85 02      			sta	_bp_bank
11302                        		__ld.wi		___sizeof__tileset_WEAPON_5
         01:DD2B  A9 80      			lda.l	#___sizeof__tileset_WEAPON_5
         01:DD2D  A0 00      			ldy.h	#___sizeof__tileset_WEAPON_5
11303                        		__lsr.wi	1
         01:DD2F  42         			say
         01:DD30  4A         			lsr	a
         01:DD31  42         			say
         01:DD32  6A         			ror	a
11304                        		__st.wmq	_ax
         01:DD33  85 F8      			sta.l	_ax
         01:DD35  84 F9      			sty.h	_ax
11305                        		 _load_vram.3
         01:DD37  82         			clx				; Offset to PCE VDC.
         01:DD38  20 63 FF   			call	load_vram_x
11306                        	
11307                        		.dbg	line,	"include\init.c", 308; }
11308                        	
11309                        		.dbg	line,	"include\init.c", 310; else if(weapon_level == 5)
11310                        		__bra		.LL500
         01:DD3B  80 2E      			bra	.LL500
11311    01:DD3D             	.LL499:
11312                        		__ld.umq	_weapon_level
         01:DD3D  AD 20 23   			lda	_weapon_level
11313                        		__equ_b.uiq	5
         01:DD40  C9 05      			cmp	#5
         01:DD42  F0 01      			beq	!+
         01:DD44  18         			clc
         01:DD45             	!:
11314                        		__bfalse	.LL501
         01:DD45  90 24      			bcc	.LL501
11315                        	
11316                        		.dbg	line,	"include\init.c", 311; {
11317                        	
11318                        		.dbg	line,	"include\init.c", 312; load_vram( WEAPON_VRAM_ADR, tileset_WEAPON_8, SIZEOF(tileset_WEAPON_8) >> 1 );
11319                        		__st.wmiq	4256, _di
         01:DD47  A9 A0      			lda.l	#4256
         01:DD49  85 F0      			sta.l	_di
         01:DD4B  A9 10      			lda.h	#4256
         01:DD4D  85 F1      			sta.h	_di
11320                        		__farptr	_tileset_WEAPON_8, _bp_bank, _bp
         01:DD4F  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_WEAPON_8))
         01:DD51  85 EC      			sta.l	_bp
         01:DD53  A9 79      			lda.h	#$6000 + ($1FFF & (_tileset_WEAPON_8))
         01:DD55  85 ED      			sta.h	_bp
         01:DD57  A9 03      			lda	#bank(_tileset_WEAPON_8)
         01:DD59  85 02      			sta	_bp_bank
11321                        		__ld.wi		___sizeof__tileset_WEAPON_8
         01:DD5B  A9 80      			lda.l	#___sizeof__tileset_WEAPON_8
         01:DD5D  A0 00      			ldy.h	#___sizeof__tileset_WEAPON_8
11322                        		__lsr.wi	1
         01:DD5F  42         			say
         01:DD60  4A         			lsr	a
         01:DD61  42         			say
         01:DD62  6A         			ror	a
11323                        		__st.wmq	_ax
         01:DD63  85 F8      			sta.l	_ax
         01:DD65  84 F9      			sty.h	_ax
11324                        		 _load_vram.3
         01:DD67  82         			clx				; Offset to PCE VDC.
         01:DD68  20 63 FF   			call	load_vram_x
11325                        	
11326                        		.dbg	line,	"include\init.c", 313; }
11327                        	
11328                        		.dbg	line,	"include\init.c", 318; if(armor_level == 1)
11329    01:DD6B             	.LL501:
11330    01:DD6B             	.LL500:
11331    01:DD6B             	.LL498:
11332    01:DD6B             	.LL496:
11333    01:DD6B             	.LL494:
11334                        		__ld.umq	_armor_level
         01:DD6B  AD 1F 23   			lda	_armor_level
11335                        		__equ_b.uiq	1
         01:DD6E  C9 01      			cmp	#1
         01:DD70  F0 01      			beq	!+
         01:DD72  18         			clc
         01:DD73             	!:
11336                        		__bfalse	.LL502
         01:DD73  90 27      			bcc	.LL502
11337                        	
11338                        		.dbg	line,	"include\init.c", 319; {
11339                        	
11340                        		.dbg	line,	"include\init.c", 320; load_vram( ARMOR_VRAM_ADR, tileset_ARMOR_1, SIZEOF(tileset_ARMOR_1) >> 1 );
11341                        		__st.wmiq	4320, _di
         01:DD75  A9 E0      			lda.l	#4320
         01:DD77  85 F0      			sta.l	_di
         01:DD79  A9 10      			lda.h	#4320
         01:DD7B  85 F1      			sta.h	_di
11342                        		__farptr	_tileset_ARMOR_1, _bp_bank, _bp
         01:DD7D  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_ARMOR_1))
         01:DD7F  85 EC      			sta.l	_bp
         01:DD81  A9 75      			lda.h	#$6000 + ($1FFF & (_tileset_ARMOR_1))
         01:DD83  85 ED      			sta.h	_bp
         01:DD85  A9 03      			lda	#bank(_tileset_ARMOR_1)
         01:DD87  85 02      			sta	_bp_bank
11343                        		__ld.wi		___sizeof__tileset_ARMOR_1
         01:DD89  A9 80      			lda.l	#___sizeof__tileset_ARMOR_1
         01:DD8B  A0 00      			ldy.h	#___sizeof__tileset_ARMOR_1
11344                        		__lsr.wi	1
         01:DD8D  42         			say
         01:DD8E  4A         			lsr	a
         01:DD8F  42         			say
         01:DD90  6A         			ror	a
11345                        		__st.wmq	_ax
         01:DD91  85 F8      			sta.l	_ax
         01:DD93  84 F9      			sty.h	_ax
11346                        		 _load_vram.3
         01:DD95  82         			clx				; Offset to PCE VDC.
         01:DD96  20 63 FF   			call	load_vram_x
11347                        	
11348                        		.dbg	line,	"include\init.c", 321; }
11349                        	
11350                        		.dbg	line,	"include\init.c", 323; else if(armor_level == 2)
11351                        		__bra		.LL503
         01:DD99  4C 2A DE   			bra	.LL503
11352    01:DD9C             	.LL502:
11353                        		__ld.umq	_armor_level
         01:DD9C  AD 1F 23   			lda	_armor_level
11354                        		__equ_b.uiq	2
         01:DD9F  C9 02      			cmp	#2
         01:DDA1  F0 01      			beq	!+
         01:DDA3  18         			clc
         01:DDA4             	!:
11355                        		__bfalse	.LL504
         01:DDA4  90 26      			bcc	.LL504
11356                        	
11357                        		.dbg	line,	"include\init.c", 324; {
11358                        	
11359                        		.dbg	line,	"include\init.c", 325; load_vram( ARMOR_VRAM_ADR, tileset_ARMOR_2, SIZEOF(tileset_ARMOR_2) >> 1 );
11360                        		__st.wmiq	4320, _di
         01:DDA6  A9 E0      			lda.l	#4320
         01:DDA8  85 F0      			sta.l	_di
         01:DDAA  A9 10      			lda.h	#4320
         01:DDAC  85 F1      			sta.h	_di
11361                        		__farptr	_tileset_ARMOR_2, _bp_bank, _bp
         01:DDAE  A9 80      			lda.l	#$6000 + ($1FFF & (_tileset_ARMOR_2))
         01:DDB0  85 EC      			sta.l	_bp
         01:DDB2  A9 75      			lda.h	#$6000 + ($1FFF & (_tileset_ARMOR_2))
         01:DDB4  85 ED      			sta.h	_bp
         01:DDB6  A9 03      			lda	#bank(_tileset_ARMOR_2)
         01:DDB8  85 02      			sta	_bp_bank
11362                        		__ld.wi		___sizeof__tileset_ARMOR_2
         01:DDBA  A9 80      			lda.l	#___sizeof__tileset_ARMOR_2
         01:DDBC  A0 00      			ldy.h	#___sizeof__tileset_ARMOR_2
11363                        		__lsr.wi	1
         01:DDBE  42         			say
         01:DDBF  4A         			lsr	a
         01:DDC0  42         			say
         01:DDC1  6A         			ror	a
11364                        		__st.wmq	_ax
         01:DDC2  85 F8      			sta.l	_ax
         01:DDC4  84 F9      			sty.h	_ax
11365                        		 _load_vram.3
         01:DDC6  82         			clx				; Offset to PCE VDC.
         01:DDC7  20 63 FF   			call	load_vram_x
11366                        	
11367                        		.dbg	line,	"include\init.c", 326; }
11368                        	
11369                        		.dbg	line,	"include\init.c", 328; else if(armor_level == 3)
11370                        		__bra		.LL505
         01:DDCA  80 5E      			bra	.LL505
11371    01:DDCC             	.LL504:
11372                        		__ld.umq	_armor_level
         01:DDCC  AD 1F 23   			lda	_armor_level
11373                        		__equ_b.uiq	3
         01:DDCF  C9 03      			cmp	#3
         01:DDD1  F0 01      			beq	!+
         01:DDD3  18         			clc
         01:DDD4             	!:
11374                        		__bfalse	.LL506
         01:DDD4  90 26      			bcc	.LL506
11375                        	
11376                        		.dbg	line,	"include\init.c", 329; {
11377                        	
11378                        		.dbg	line,	"include\init.c", 330; load_vram( ARMOR_VRAM_ADR, tileset_ARMOR_4, SIZEOF(tileset_ARMOR_4) >> 1 );
11379                        		__st.wmiq	4320, _di
         01:DDD6  A9 E0      			lda.l	#4320
         01:DDD8  85 F0      			sta.l	_di
         01:DDDA  A9 10      			lda.h	#4320
         01:DDDC  85 F1      			sta.h	_di
11380                        		__farptr	_tileset_ARMOR_4, _bp_bank, _bp
         01:DDDE  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_ARMOR_4))
         01:DDE0  85 EC      			sta.l	_bp
         01:DDE2  A9 76      			lda.h	#$6000 + ($1FFF & (_tileset_ARMOR_4))
         01:DDE4  85 ED      			sta.h	_bp
         01:DDE6  A9 03      			lda	#bank(_tileset_ARMOR_4)
         01:DDE8  85 02      			sta	_bp_bank
11381                        		__ld.wi		___sizeof__tileset_ARMOR_4
         01:DDEA  A9 80      			lda.l	#___sizeof__tileset_ARMOR_4
         01:DDEC  A0 00      			ldy.h	#___sizeof__tileset_ARMOR_4
11382                        		__lsr.wi	1
         01:DDEE  42         			say
         01:DDEF  4A         			lsr	a
         01:DDF0  42         			say
         01:DDF1  6A         			ror	a
11383                        		__st.wmq	_ax
         01:DDF2  85 F8      			sta.l	_ax
         01:DDF4  84 F9      			sty.h	_ax
11384                        		 _load_vram.3
         01:DDF6  82         			clx				; Offset to PCE VDC.
         01:DDF7  20 63 FF   			call	load_vram_x
11385                        	
11386                        		.dbg	line,	"include\init.c", 331; }
11387                        	
11388                        		.dbg	line,	"include\init.c", 333; else if(armor_level == 4)
11389                        		__bra		.LL507
         01:DDFA  80 2E      			bra	.LL507
11390    01:DDFC             	.LL506:
11391                        		__ld.umq	_armor_level
         01:DDFC  AD 1F 23   			lda	_armor_level
11392                        		__equ_b.uiq	4
         01:DDFF  C9 04      			cmp	#4
         01:DE01  F0 01      			beq	!+
         01:DE03  18         			clc
         01:DE04             	!:
11393                        		__bfalse	.LL508
         01:DE04  90 24      			bcc	.LL508
11394                        	
11395                        		.dbg	line,	"include\init.c", 334; {
11396                        	
11397                        		.dbg	line,	"include\init.c", 335; load_vram( ARMOR_VRAM_ADR, tileset_ARMOR_8, SIZEOF(tileset_ARMOR_8) >> 1 );
11398                        		__st.wmiq	4320, _di
         01:DE06  A9 E0      			lda.l	#4320
         01:DE08  85 F0      			sta.l	_di
         01:DE0A  A9 10      			lda.h	#4320
         01:DE0C  85 F1      			sta.h	_di
11399                        		__farptr	_tileset_ARMOR_8, _bp_bank, _bp
         01:DE0E  A9 80      			lda.l	#$6000 + ($1FFF & (_tileset_ARMOR_8))
         01:DE10  85 EC      			sta.l	_bp
         01:DE12  A9 76      			lda.h	#$6000 + ($1FFF & (_tileset_ARMOR_8))
         01:DE14  85 ED      			sta.h	_bp
         01:DE16  A9 03      			lda	#bank(_tileset_ARMOR_8)
         01:DE18  85 02      			sta	_bp_bank
11400                        		__ld.wi		___sizeof__tileset_ARMOR_8
         01:DE1A  A9 80      			lda.l	#___sizeof__tileset_ARMOR_8
         01:DE1C  A0 00      			ldy.h	#___sizeof__tileset_ARMOR_8
11401                        		__lsr.wi	1
         01:DE1E  42         			say
         01:DE1F  4A         			lsr	a
         01:DE20  42         			say
         01:DE21  6A         			ror	a
11402                        		__st.wmq	_ax
         01:DE22  85 F8      			sta.l	_ax
         01:DE24  84 F9      			sty.h	_ax
11403                        		 _load_vram.3
         01:DE26  82         			clx				; Offset to PCE VDC.
         01:DE27  20 63 FF   			call	load_vram_x
11404                        	
11405                        		.dbg	line,	"include\init.c", 336; }
11406                        	
11407                        		.dbg	line,	"include\init.c", 341; //--------------------------------------------------------------------------------------//
11408                        	
11409                        		.dbg	line,	"include\init.c", 342; //                                     SET MULTIMAP                                     //
11410                        	
11411                        		.dbg	line,	"include\init.c", 343; //--------------------------------------------------------------------------------------//
11412                        	
11413                        		.dbg	line,	"include\init.c", 345; // multimap is 2 screens wide //
11414                        	
11415                        		.dbg	line,	"include\init.c", 346; set_multimap( multimap_LV1_BG_A , 5 );
11416    01:DE2A             	.LL508:
11417    01:DE2A             	.LL507:
11418    01:DE2A             	.LL505:
11419    01:DE2A             	.LL503:
11420                        		__farptr	_multimap_LV1_BG_A, vdc_scr_bank, vdc_scr_addr
         01:DE2A  A9 00      			lda.l	#$6000 + ($1FFF & (_multimap_LV1_BG_A))
         01:DE2C  8D B8 2B   			sta.l	vdc_scr_addr
         01:DE2F  A9 78      			lda.h	#$6000 + ($1FFF & (_multimap_LV1_BG_A))
         01:DE31  8D B9 2B   			sta.h	vdc_scr_addr
         01:DE34  A9 0B      			lda	#bank(_multimap_LV1_BG_A)
         01:DE36  8D BA 2B   			sta	vdc_scr_bank
11421                        		__st.umiq	5, vdc_map_scrn_w
         01:DE39  A9 05      			lda.l	#5
         01:DE3B  8D 79 26   			sta	vdc_map_scrn_w
11422                        		 _set_multimap.2
         01:DE3E  AD 71 26   			lda	vdc_bat_width
         01:DE41  4A         			lsr	a
         01:DE42  8D 78 26   			sta	vdc_map_line_w
11423                        	
11424                        		.dbg	line,	"include\init.c", 349; //--------------------------------------------------------------------------------------//
11425                        	
11426                        		.dbg	line,	"include\init.c", 350; //                                    DRAW TILEMAP                                      //
11427                        	
11428                        		.dbg	line,	"include\init.c", 351; //--------------------------------------------------------------------------------------//
11429                        	
11430                        		.dbg	line,	"include\init.c", 353; // The blkmap is drawn using global variables for the top-left coordinate
11431                        	
11432                        		.dbg	line,	"include\init.c", 354; // in pixels, and the draw width and height in terms of 8x8 characters.
11433                        	
11434                        		.dbg	line,	"include\init.c", 356; vdc_map_pxl_x = 0;
11435                        		__st.wmiq	0, _vdc_map_pxl_x
         01:DE45  9C 7A 26   			stz.l	_vdc_map_pxl_x
         01:DE48  9C 7B 26   			stz.h	_vdc_map_pxl_x
11436                        	
11437                        		.dbg	line,	"include\init.c", 357; vdc_map_pxl_y = 0;
11438                        		__st.wmiq	0, _vdc_map_pxl_y
         01:DE4B  9C 7C 26   			stz.l	_vdc_map_pxl_y
         01:DE4E  9C 7D 26   			stz.h	_vdc_map_pxl_y
11439                        	
11440                        		.dbg	line,	"include\init.c", 359; vdc_map_draw_w = 32;
11441                        		__st.umiq	32, _vdc_map_draw_w
         01:DE51  A9 20      			lda.l	#32
         01:DE53  8D 76 26   			sta	_vdc_map_draw_w
11442                        	
11443                        		.dbg	line,	"include\init.c", 360; vdc_map_draw_h = 28;
11444                        		__st.umiq	28, _vdc_map_draw_h
         01:DE56  A9 1C      			lda.l	#28
         01:DE58  8D 77 26   			sta	_vdc_map_draw_h
11445                        	
11446                        		.dbg	line,	"include\init.c", 362; draw_map();
11447                        		__call		_draw_map
         01:DE5B  20 1D FF   			call	_draw_map
11448                        	
11449                        		.dbg	line,	"include\init.c", 364; display_SCORE();
11450                        		__call		_display_SCORE
         01:DE5E  20 13 FF   			call	_display_SCORE
11451                        	
11452                        		.dbg	line,	"include\init.c", 365; display_TIME_LEVEL();
11453                        		__call		_display_TIME_LEVEL
         01:DE61  20 09 FF   			call	_display_TIME_LEVEL
11454                        	
11455                        		.dbg	line,	"include\init.c", 366; display_KEY();
11456                        		__call		_display_KEY
         01:DE64  20 8B FF   			call	_display_KEY
11457                        	
11458                        		.dbg	line,	"include\init.c", 367; display_POTION();
11459                        		__call		_display_POTION
         01:DE67  20 3B FF   			call	_display_POTION
11460                        	
11461                        		.dbg	line,	"include\init.c", 368; display_ZENNY();
11462                        		__call		_display_ZENNY
         01:DE6A  20 45 FF   			call	_display_ZENNY
11463                        	
11464                        		.dbg	line,	"include\init.c", 369; }
11465    01:DE6D             	.LL492:
11466                        		__return	0
         01:DE6D  4C EF FF   			jmp	leave_proc
11467                        		.dbg	clear
11468                        		.endp
11469                        		.pceas
11470                        	
11471                        		.dbg	line,	"include\init.c", 372; void init_LEVEL()
11472                        		.dbg	line,	"include\init.c", 373; {
11473                        	;***********************
11474                        	;***********************
11475                        	
11476                        		.hucc
11477    02:C000             		.proc		_init_LEVEL
11478                        		__enter		_init_LEVEL
11479                        	
11480                        		.dbg	line,	"include\init.c", 374; if(level_id == 1)
11481                        		__ld.umq	_level_id
         02:C000  AD 12 23   			lda	_level_id
11482                        		__equ_b.uiq	1
         02:C003  C9 01      			cmp	#1
         02:C005  F0 01      			beq	!+
         02:C007  18         			clc
         02:C008             	!:
11483                        		__bfalse	.LL510
         02:C008  B0 03 4C C4			bcc	.LL510
         02:C00C  C2          
11484                        	
11485                        		.dbg	line,	"include\init.c", 375; {
11486                        	
11487                        		.dbg	line,	"include\init.c", 376; // VSYNC //
11488                        	
11489                        		.dbg	line,	"include\init.c", 377; vsync();
11490                        		__call		_vsync
         02:C00D  20 09 E3   			call	_vsync
11491                        	
11492                        		.dbg	line,	"include\init.c", 380; // DISABLE DISPLAY //
11493                        	
11494                        		.dbg	line,	"include\init.c", 381; disp_off();
11495                        		__call		_disp_off
         02:C010  20 29 E4   			call	_disp_off
11496                        	
11497                        		.dbg	line,	"include\init.c", 384; // SET VDC 1 SCREEN SIZE (IN TILES) - 64x32 = 512x256 PIXELS
11498                        	
11499                        		.dbg	line,	"include\init.c", 385; set_screen_size(SCR_SIZE_64x32);
11500                        		__st.umiq	1, _al
         02:C013  A9 01      			lda.l	#1
         02:C015  85 F8      			sta	_al
11501                        		__call		_set_screen_size.1
         02:C017  20 31 FF   			call	_set_screen_size.1
11502                        	
11503                        		.dbg	line,	"include\init.c", 388; // SET VDC 2 SCREEN SIZE (IN TILES) - 64x32 = 512x256 PIXELS
11504                        	
11505                        		.dbg	line,	"include\init.c", 389; sgx_set_screen_size(SCR_SIZE_64x32);
11506                        		__st.umiq	1, _al
         02:C01A  A9 01      			lda.l	#1
         02:C01C  85 F8      			sta	_al
11507                        		__call		_sgx_set_screen_size.1
         02:C01E  20 27 FF   			call	_sgx_set_screen_size.1
11508                        	
11509                        		.dbg	line,	"include\init.c", 392; // INIT SPRITE ATTRIBUTE TABLE //
11510                        	
11511                        		.dbg	line,	"include\init.c", 393; //init_satb();
11512                        	
11513                        		.dbg	line,	"include\init.c", 398; //**************************************************************************************//
11514                        	
11515                        		.dbg	line,	"include\init.c", 399; //                                                                                      //
11516                        	
11517                        		.dbg	line,	"include\init.c", 400; //                                      VARIABLES                                       //
11518                        	
11519                        		.dbg	line,	"include\init.c", 401; //                                                                                      //
11520                        	
11521                        		.dbg	line,	"include\init.c", 402; //**************************************************************************************//
11522                        	
11523                        		.dbg	line,	"include\init.c", 404; time_counter = 0;
11524                        		__st.umiq	0, _time_counter
         02:C021  9C 26 23   			stz	_time_counter
11525                        	
11526                        		.dbg	line,	"include\init.c", 405; 
11527                        	
11528                        		.dbg	line,	"include\init.c", 406; if(respawn == RESPAWN_SHOP)
11529                        		__ld.umq	_respawn
         02:C024  AD 13 23   			lda	_respawn
11530                        		__equ_b.uiq	2
         02:C027  C9 02      			cmp	#2
         02:C029  F0 01      			beq	!+
         02:C02B  18         			clc
         02:C02C             	!:
11531                        		__bfalse	.LL511
         02:C02C  90 10      			bcc	.LL511
11532                        	
11533                        		.dbg	line,	"include\init.c", 407; {
11534                        	
11535                        		.dbg	line,	"include\init.c", 408; minutes = minutes_backup;
11536                        		__ld.um		_minutes_backup
         02:C02E  AD 27 23   			lda	_minutes_backup
         02:C031  C2         			cly
11537                        		__st.umq	_minutes
         02:C032  8D 24 23   			sta	_minutes
11538                        	
11539                        		.dbg	line,	"include\init.c", 409; seconds = seconds_backup;
11540                        		__ld.um		_seconds_backup
         02:C035  AD 28 23   			lda	_seconds_backup
         02:C038  C2         			cly
11541                        		__st.umq	_seconds
         02:C039  8D 25 23   			sta	_seconds
11542                        	
11543                        		.dbg	line,	"include\init.c", 410; }
11544                        	
11545                        		.dbg	line,	"include\init.c", 412; else
11546                        		__bra		.LL512
         02:C03C  80 0A      			bra	.LL512
11547    02:C03E             	.LL511:
11548                        	
11549                        		.dbg	line,	"include\init.c", 413; {
11550                        	
11551                        		.dbg	line,	"include\init.c", 414; minutes = 1;
11552                        		__st.umiq	1, _minutes
         02:C03E  A9 01      			lda.l	#1
         02:C040  8D 24 23   			sta	_minutes
11553                        	
11554                        		.dbg	line,	"include\init.c", 415; seconds = 59;
11555                        		__st.umiq	59, _seconds
         02:C043  A9 3B      			lda.l	#59
         02:C045  8D 25 23   			sta	_seconds
11556                        	
11557                        		.dbg	line,	"include\init.c", 416; }
11558    02:C048             	.LL512:
11559                        	
11560                        		.dbg	line,	"include\init.c", 418; camera_max_y_position = 768;
11561                        		__st.wmiq	768, _camera_max_y_position
         02:C048  9C D2 24   			stz.l	_camera_max_y_position
         02:C04B  A9 03      			lda.h	#768
         02:C04D  8D D3 24   			sta.h	_camera_max_y_position
11562                        	
11563                        		.dbg	line,	"include\init.c", 419; jump_max_index = 34;
11564                        		__st.umiq	34, _jump_max_index
         02:C050  A9 22      			lda.l	#34
         02:C052  8D 1E 23   			sta	_jump_max_index
11565                        	
11566                        		.dbg	line,	"include\init.c", 420; score = 0;
11567                        		__st.wmiq	0, _score
         02:C055  9C 2A 26   			stz.l	_score
         02:C058  9C 2B 26   			stz.h	_score
11568                        	
11569                        		.dbg	line,	"include\init.c", 421; level_object_number = OBJECT_NUMBER_LV1;
11570                        		__st.umiq	23, _level_object_number
         02:C05B  A9 17      			lda.l	#23
         02:C05D  8D 2A 23   			sta	_level_object_number
11571                        	
11572                        		.dbg	line,	"include\init.c", 422; level_chest_number = CHEST_NUMBER_LV1;
11573                        		__st.umiq	2, _level_chest_number
         02:C060  A9 02      			lda.l	#2
         02:C062  8D 99 23   			sta	_level_chest_number
11574                        	
11575                        		.dbg	line,	"include\init.c", 423; level_npc_number = NPC_NUMBER_LV1;
11576                        		__st.umiq	2, _level_npc_number
         02:C065  A9 02      			lda.l	#2
         02:C067  8D AC 23   			sta	_level_npc_number
11577                        	
11578                        		.dbg	line,	"include\init.c", 424; object_start_index = OBJECT_START_INDEX_LV1;
11579                        		__st.umiq	3, _object_start_index
         02:C06A  A9 03      			lda.l	#3
         02:C06C  8D 29 23   			sta	_object_start_index
11580                        	
11581                        		.dbg	line,	"include\init.c", 425; chest_start_index = CHEST_START_INDEX_LV1;
11582                        		__st.umiq	26, _chest_start_index
         02:C06F  A9 1A      			lda.l	#26
         02:C071  8D 98 23   			sta	_chest_start_index
11583                        	
11584                        		.dbg	line,	"include\init.c", 426; npc_start_index = NPC_START_INDEX_LV1;
11585                        		__st.umiq	28, _npc_start_index
         02:C074  A9 1C      			lda.l	#28
         02:C076  8D AB 23   			sta	_npc_start_index
11586                        	
11587                        		.dbg	line,	"include\init.c", 427; jump_ladder = FALSE;
11588                        		__st.umiq	0, _jump_ladder
         02:C079  9C 1D 23   			stz	_jump_ladder
11589                        	
11590                        		.dbg	line,	"include\init.c", 428; //player_naked = TRUE;
11591                        	
11592                        		.dbg	line,	"include\init.c", 432; //**************************************************************************************//
11593                        	
11594                        		.dbg	line,	"include\init.c", 433; //                                                                                      //
11595                        	
11596                        		.dbg	line,	"include\init.c", 434; //                                        VDC 2                                         //
11597                        	
11598                        		.dbg	line,	"include\init.c", 435; //                                                                                      //
11599                        	
11600                        		.dbg	line,	"include\init.c", 436; //**************************************************************************************//
11601                        	
11602                        		.dbg	line,	"include\init.c", 438; //--------------------------------------------------------------------------------------//
11603                        	
11604                        		.dbg	line,	"include\init.c", 439; //                                    LOAD TILESET                                      //
11605                        	
11606                        		.dbg	line,	"include\init.c", 440; //--------------------------------------------------------------------------------------//
11607                        	
11608                        		.dbg	line,	"include\init.c", 442; sgx_load_vram( 0x1000, tileset_LV1_BG_B, SIZEOF(tileset_LV1_BG_B) >> 1 );
11609                        		__st.wmiq	4096, _di
         02:C07C  64 F0      			stz.l	_di
         02:C07E  A9 10      			lda.h	#4096
         02:C080  85 F1      			sta.h	_di
11610                        		__farptr	_tileset_LV1_BG_B, _bp_bank, _bp
         02:C082  A9 80      			lda.l	#$6000 + ($1FFF & (_tileset_LV1_BG_B))
         02:C084  85 EC      			sta.l	_bp
         02:C086  A9 79      			lda.h	#$6000 + ($1FFF & (_tileset_LV1_BG_B))
         02:C088  85 ED      			sta.h	_bp
         02:C08A  A9 03      			lda	#bank(_tileset_LV1_BG_B)
         02:C08C  85 02      			sta	_bp_bank
11611                        		__ld.wi		___sizeof__tileset_LV1_BG_B
         02:C08E  A9 E0      			lda.l	#___sizeof__tileset_LV1_BG_B
         02:C090  A0 72      			ldy.h	#___sizeof__tileset_LV1_BG_B
11612                        		__lsr.wi	1
         02:C092  42         			say
         02:C093  4A         			lsr	a
         02:C094  42         			say
         02:C095  6A         			ror	a
11613                        		__st.wmq	_ax
         02:C096  85 F8      			sta.l	_ax
         02:C098  84 F9      			sty.h	_ax
11614                        		 _sgx_load_vram.3
         02:C09A  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
         02:C09C  20 63 FF   			call	load_vram_x
11615                        	
11616                        		.dbg	line,	"include\init.c", 445; //--------------------------------------------------------------------------------------//
11617                        	
11618                        		.dbg	line,	"include\init.c", 446; //                               LOAD WALL & DOOR TILES                                 //
11619                        	
11620                        		.dbg	line,	"include\init.c", 447; //--------------------------------------------------------------------------------------//
11621                        	
11622                        		.dbg	line,	"include\init.c", 449; sgx_load_vram( LV1_WALL_VRAM_ADR, tileset_LV1_WALL, SIZEOF(tileset_LV1_WALL) >> 1 );
11623                        		__st.wmiq	4096, _di
         02:C09F  64 F0      			stz.l	_di
         02:C0A1  A9 10      			lda.h	#4096
         02:C0A3  85 F1      			sta.h	_di
11624                        		__farptr	_tileset_LV1_WALL, _bp_bank, _bp
         02:C0A5  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_LV1_WALL))
         02:C0A7  85 EC      			sta.l	_bp
         02:C0A9  A9 6C      			lda.h	#$6000 + ($1FFF & (_tileset_LV1_WALL))
         02:C0AB  85 ED      			sta.h	_bp
         02:C0AD  A9 03      			lda	#bank(_tileset_LV1_WALL)
         02:C0AF  85 02      			sta	_bp_bank
11625                        		__ld.wi		___sizeof__tileset_LV1_WALL
         02:C0B1  A9 00      			lda.l	#___sizeof__tileset_LV1_WALL
         02:C0B3  A0 02      			ldy.h	#___sizeof__tileset_LV1_WALL
11626                        		__lsr.wi	1
         02:C0B5  42         			say
         02:C0B6  4A         			lsr	a
         02:C0B7  42         			say
         02:C0B8  6A         			ror	a
11627                        		__st.wmq	_ax
         02:C0B9  85 F8      			sta.l	_ax
         02:C0BB  84 F9      			sty.h	_ax
11628                        		 _sgx_load_vram.3
         02:C0BD  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
         02:C0BF  20 63 FF   			call	load_vram_x
11629                        	
11630                        		.dbg	line,	"include\init.c", 450; sgx_load_vram( LV1_DOOR_VRAM_ADR, tileset_LV1_DOOR_OPEN, SIZEOF(tileset_LV1_DOOR_OPEN) >> 1 );
11631                        		__st.wmiq	4352, _di
         02:C0C2  64 F0      			stz.l	_di
         02:C0C4  A9 11      			lda.h	#4352
         02:C0C6  85 F1      			sta.h	_di
11632                        		__farptr	_tileset_LV1_DOOR_OPEN, _bp_bank, _bp
         02:C0C8  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_LV1_DOOR_OPEN))
         02:C0CA  85 EC      			sta.l	_bp
         02:C0CC  A9 6E      			lda.h	#$6000 + ($1FFF & (_tileset_LV1_DOOR_OPEN))
         02:C0CE  85 ED      			sta.h	_bp
         02:C0D0  A9 03      			lda	#bank(_tileset_LV1_DOOR_OPEN)
         02:C0D2  85 02      			sta	_bp_bank
11633                        		__ld.wi		___sizeof__tileset_LV1_DOOR_OPEN
         02:C0D4  A9 00      			lda.l	#___sizeof__tileset_LV1_DOOR_OPEN
         02:C0D6  A0 03      			ldy.h	#___sizeof__tileset_LV1_DOOR_OPEN
11634                        		__lsr.wi	1
         02:C0D8  42         			say
         02:C0D9  4A         			lsr	a
         02:C0DA  42         			say
         02:C0DB  6A         			ror	a
11635                        		__st.wmq	_ax
         02:C0DC  85 F8      			sta.l	_ax
         02:C0DE  84 F9      			sty.h	_ax
11636                        		 _sgx_load_vram.3
         02:C0E0  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
         02:C0E2  20 63 FF   			call	load_vram_x
11637                        	
11638                        		.dbg	line,	"include\init.c", 453; //--------------------------------------------------------------------------------------//
11639                        	
11640                        		.dbg	line,	"include\init.c", 454; //                                     SET MULTIMAP                                     //
11641                        	
11642                        		.dbg	line,	"include\init.c", 455; //--------------------------------------------------------------------------------------//
11643                        	
11644                        		.dbg	line,	"include\init.c", 457; // multimap is 5 screens wide //
11645                        	
11646                        		.dbg	line,	"include\init.c", 458; sgx_set_multimap( multimap_LV1_BG_B , 5 );
11647                        		__farptr	_multimap_LV1_BG_B, sgx_scr_bank, sgx_scr_addr
         02:C0E5  A9 00      			lda.l	#$6000 + ($1FFF & (_multimap_LV1_BG_B))
         02:C0E7  8D C8 2B   			sta.l	sgx_scr_addr
         02:C0EA  A9 79      			lda.h	#$6000 + ($1FFF & (_multimap_LV1_BG_B))
         02:C0EC  8D C9 2B   			sta.h	sgx_scr_addr
         02:C0EF  A9 09      			lda	#bank(_multimap_LV1_BG_B)
         02:C0F1  8D CA 2B   			sta	sgx_scr_bank
11648                        		__st.umiq	5, sgx_map_scrn_w
         02:C0F4  A9 05      			lda.l	#5
         02:C0F6  8D 89 26   			sta	sgx_map_scrn_w
11649                        		 _sgx_set_multimap.2
         02:C0F9  AD 81 26   			lda	sgx_bat_width
         02:C0FC  4A         			lsr	a
         02:C0FD  8D 88 26   			sta	sgx_map_line_w
11650                        	
11651                        		.dbg	line,	"include\init.c", 461; //--------------------------------------------------------------------------------------//
11652                        	
11653                        		.dbg	line,	"include\init.c", 462; //                                    DRAW TILEMAP                                      //
11654                        	
11655                        		.dbg	line,	"include\init.c", 463; //--------------------------------------------------------------------------------------//
11656                        	
11657                        		.dbg	line,	"include\init.c", 465; // The blkmap is drawn using global variables for the top-left coordinate
11658                        	
11659                        		.dbg	line,	"include\init.c", 466; // in pixels, and the draw width and height in terms of 8x8 characters.
11660                        	
11661                        		.dbg	line,	"include\init.c", 468; if(respawn == FALSE)
11662                        		__not.um	_respawn
         02:C100  AD 13 23   			lda	_respawn
         02:C103  18         			clc
         02:C104  D0 01      			bne	!+
         02:C106  38         			sec
         02:C107             	!:
11663                        		__bfalse	.LL513
         02:C107  90 12      			bcc	.LL513
11664                        	
11665                        		.dbg	line,	"include\init.c", 469; {
11666                        	
11667                        		.dbg	line,	"include\init.c", 470; sgx_map_pxl_x = 96;
11668                        		__st.wmiq	96, _sgx_map_pxl_x
         02:C109  A9 60      			lda.l	#96
         02:C10B  8D 8A 26   			sta.l	_sgx_map_pxl_x
         02:C10E  9C 8B 26   			stz.h	_sgx_map_pxl_x
11669                        	
11670                        		.dbg	line,	"include\init.c", 471; sgx_map_pxl_y = 768;
11671                        		__st.wmiq	768, _sgx_map_pxl_y
         02:C111  9C 8C 26   			stz.l	_sgx_map_pxl_y
         02:C114  A9 03      			lda.h	#768
         02:C116  8D 8D 26   			sta.h	_sgx_map_pxl_y
11672                        	
11673                        		.dbg	line,	"include\init.c", 472; }
11674                        	
11675                        		.dbg	line,	"include\init.c", 474; else if(respawn == RESPAWN_SHOP)
11676                        		__bra		.LL514
         02:C119  80 22      			bra	.LL514
11677    02:C11B             	.LL513:
11678                        		__ld.umq	_respawn
         02:C11B  AD 13 23   			lda	_respawn
11679                        		__equ_b.uiq	2
         02:C11E  C9 02      			cmp	#2
         02:C120  F0 01      			beq	!+
         02:C122  18         			clc
         02:C123             	!:
11680                        		__bfalse	.LL515
         02:C123  90 18      			bcc	.LL515
11681                        	
11682                        		.dbg	line,	"include\init.c", 475; {
11683                        	
11684                        		.dbg	line,	"include\init.c", 476; sgx_map_pxl_x = camera_pos_x_backup;
11685                        		__ld.wm		_camera_pos_x_backup
         02:C125  AD D4 24   			lda.l	_camera_pos_x_backup
         02:C128  AC D5 24   			ldy.h	_camera_pos_x_backup
11686                        		__st.wmq	_sgx_map_pxl_x
         02:C12B  8D 8A 26   			sta.l	_sgx_map_pxl_x
         02:C12E  8C 8B 26   			sty.h	_sgx_map_pxl_x
11687                        	
11688                        		.dbg	line,	"include\init.c", 477; sgx_map_pxl_y = camera_pos_y_backup;
11689                        		__ld.wm		_camera_pos_y_backup
         02:C131  AD D6 24   			lda.l	_camera_pos_y_backup
         02:C134  AC D7 24   			ldy.h	_camera_pos_y_backup
11690                        		__st.wmq	_sgx_map_pxl_y
         02:C137  8D 8C 26   			sta.l	_sgx_map_pxl_y
         02:C13A  8C 8D 26   			sty.h	_sgx_map_pxl_y
11691                        	
11692                        		.dbg	line,	"include\init.c", 478; }
11693                        	
11694                        		.dbg	line,	"include\init.c", 481; sgx_map_draw_w = 63;
11695    02:C13D             	.LL515:
11696    02:C13D             	.LL514:
11697                        		__st.umiq	63, _sgx_map_draw_w
         02:C13D  A9 3F      			lda.l	#63
         02:C13F  8D 86 26   			sta	_sgx_map_draw_w
11698                        	
11699                        		.dbg	line,	"include\init.c", 482; sgx_map_draw_h = 29;
11700                        		__st.umiq	29, _sgx_map_draw_h
         02:C142  A9 1D      			lda.l	#29
         02:C144  8D 87 26   			sta	_sgx_map_draw_h
11701                        	
11702                        		.dbg	line,	"include\init.c", 484; sgx_draw_map();
11703                        		__call		_sgx_draw_map
         02:C147  20 FF FE   			call	_sgx_draw_map
11704                        	
11705                        		.dbg	line,	"include\init.c", 489; //**************************************************************************************//
11706                        	
11707                        		.dbg	line,	"include\init.c", 490; //                                                                                      //
11708                        	
11709                        		.dbg	line,	"include\init.c", 491; //                                         HUD                                          //
11710                        	
11711                        		.dbg	line,	"include\init.c", 492; //                                                                                      //
11712                        	
11713                        		.dbg	line,	"include\init.c", 493; //**************************************************************************************//
11714                        	
11715                        		.dbg	line,	"include\init.c", 495; init_HUD();
11716                        		__call		_init_HUD
         02:C14A  20 F5 FE   			call	_init_HUD
11717                        	
11718                        		.dbg	line,	"include\init.c", 500; //**************************************************************************************//
11719                        	
11720                        		.dbg	line,	"include\init.c", 501; //                                                                                      //
11721                        	
11722                        		.dbg	line,	"include\init.c", 502; //                                  SETUP SCROLL_SPLIT                                  //
11723                        	
11724                        		.dbg	line,	"include\init.c", 503; //                                                                                      //
11725                        	
11726                        		.dbg	line,	"include\init.c", 504; //**************************************************************************************//
11727                        	
11728                        		.dbg	line,	"include\init.c", 506; //--------------------------------------------------------------------------------------//
11729                        	
11730                        		.dbg	line,	"include\init.c", 507; //                                        VDC 2                                         //
11731                        	
11732                        		.dbg	line,	"include\init.c", 508; //--------------------------------------------------------------------------------------//
11733                        	
11734                        		.dbg	line,	"include\init.c", 510; sgx_scroll_map();
11735                        		__call		_sgx_scroll_map
         02:C14D  20 81 FF   			call	_sgx_scroll_map
11736                        	
11737                        		.dbg	line,	"include\init.c", 512; sgx_scroll_split(0,   0, sgx_map_pxl_x & (BAT_SIZE_W - 1), sgx_map_pxl_y & (BAT_SIZE_H - 1), BKG_ON | SPR_ON);
11738                        		__st.umiq	0, _al
         02:C150  64 F8      			stz	_al
11739                        		__st.umiq	0, _ah
         02:C152  64 F9      			stz	_ah
11740                        		__ld.wm		_sgx_map_pxl_x
         02:C154  AD 8A 26   			lda.l	_sgx_map_pxl_x
         02:C157  AC 8B 26   			ldy.h	_sgx_map_pxl_x
11741                        		__and.wi	2047
         02:C15A  29 FF      			and.l	#2047
         02:C15C  42         			say
         02:C15D  29 07      			and.h	#2047
         02:C15F  42         			say
11742                        		__st.wmq	_bx
         02:C160  85 FA      			sta.l	_bx
         02:C162  84 FB      			sty.h	_bx
11743                        		__ld.wm		_sgx_map_pxl_y
         02:C164  AD 8C 26   			lda.l	_sgx_map_pxl_y
         02:C167  AC 8D 26   			ldy.h	_sgx_map_pxl_y
11744                        		__and.wi	255
         02:C16A  29 FF      			and	#255
         02:C16C  C2         			cly
11745                        		__st.wmq	_cx
         02:C16D  85 FC      			sta.l	_cx
         02:C16F  84 FD      			sty.h	_cx
11746                        		__st.umiq	192, _dl
         02:C171  A9 C0      			lda.l	#192
         02:C173  85 FE      			sta	_dl
11747                        		__call		_sgx_scroll_split.5
         02:C175  20 77 FF   			call	_sgx_scroll_split.5
11748                        	
11749                        		.dbg	line,	"include\init.c", 517; //--------------------------------------------------------------------------------------//
11750                        	
11751                        		.dbg	line,	"include\init.c", 518; //                                   LOAD BG PALETTES                                   //
11752                        	
11753                        		.dbg	line,	"include\init.c", 519; //--------------------------------------------------------------------------------------//
11754                        	
11755                        		.dbg	line,	"include\init.c", 521; // LOAD ALL PALETTES AT BG PALETTE 0 //
11756                        	
11757                        		.dbg	line,	"include\init.c", 522; load_palette( 0, palette_LV1, 16 );
11758                        		__st.umiq	0, _al
         02:C178  64 F8      			stz	_al
11759                        		__farptr	_palette_LV1, _bp_bank, _bp
         02:C17A  A9 A0      			lda.l	#$6000 + ($1FFF & (_palette_LV1))
         02:C17C  85 EC      			sta.l	_bp
         02:C17E  A9 78      			lda.h	#$6000 + ($1FFF & (_palette_LV1))
         02:C180  85 ED      			sta.h	_bp
         02:C182  A9 0B      			lda	#bank(_palette_LV1)
         02:C184  85 02      			sta	_bp_bank
11760                        		__st.umiq	16, _ah
         02:C186  A9 10      			lda.l	#16
         02:C188  85 F9      			sta	_ah
11761                        		__call		_load_palette.3
         02:C18A  20 EB FE   			call	_load_palette.3
11762                        	
11763                        		.dbg	line,	"include\init.c", 527; //**************************************************************************************//
11764                        	
11765                        		.dbg	line,	"include\init.c", 528; //                                                                                      //
11766                        	
11767                        		.dbg	line,	"include\init.c", 529; //                                       SPRITES                                        //
11768                        	
11769                        		.dbg	line,	"include\init.c", 530; //                                                                                      //
11770                        	
11771                        		.dbg	line,	"include\init.c", 531; //**************************************************************************************//
11772                        	
11773                        		.dbg	line,	"include\init.c", 533; //--------------------------------------------------------------------------------------//
11774                        	
11775                        		.dbg	line,	"include\init.c", 534; //                                        PLAYER                                        //
11776                        	
11777                        		.dbg	line,	"include\init.c", 535; //--------------------------------------------------------------------------------------//
11778                        	
11779                        		.dbg	line,	"include\init.c", 537; // LOAD PLAYER TILES //
11780                        	
11781                        		.dbg	line,	"include\init.c", 538; // 0x2000
11782                        	
11783                        		.dbg	line,	"include\init.c", 539; // 32 TILES = 512 //
11784                        	
11785                        		.dbg	line,	"include\init.c", 540; // LOAD PLAYER FIRST FRAME OF ANIMATION (IDLE)
11786                        	
11787                        		.dbg	line,	"include\init.c", 541; set_far_base(TABLE_PLAYER_TILES_BANK[player_naked],TABLE_PLAYER_TILES_ADR[player_naked]);
11788                        		__ldx.umq	_player_naked
         02:C18D  AE 1B 23   			ldx	_player_naked
11789                        		__ld.uax	_TABLE_PLAYER_TILES_BANK
         02:C190  BD F7 60   			lda	_TABLE_PLAYER_TILES_BANK, x
         02:C193  C2         			cly
11790                        		__st.umq	_bp_bank
         02:C194  85 02      			sta	_bp_bank
11791                        		__ld2x.umq	_player_naked
         02:C196  AD 1B 23   			lda	_player_naked
         02:C199  0A         			asl	a
         02:C19A  AA         			tax
11792                        		__ld.wax	_TABLE_PLAYER_TILES_ADR
         02:C19B  BD F3 60   			lda.l	_TABLE_PLAYER_TILES_ADR, x
         02:C19E  BC F4 60   			ldy.h	_TABLE_PLAYER_TILES_ADR, x
11793                        		__st.wmq	_bp
         02:C1A1  85 EC      			sta.l	_bp
         02:C1A3  84 ED      			sty.h	_bp
11794                        	
11795                        		.dbg	line,	"include\init.c", 542; far_load_vram(PLAYER_VRAM_ADR,TILES_16);
11796                        		__st.wmiq	6144, _di
         02:C1A5  64 F0      			stz.l	_di
         02:C1A7  A9 18      			lda.h	#6144
         02:C1A9  85 F1      			sta.h	_di
11797                        		__st.wmiq	256, _ax
         02:C1AB  64 F8      			stz.l	_ax
         02:C1AD  A9 01      			lda.h	#256
         02:C1AF  85 F9      			sta.h	_ax
11798                        		 _far_load_vram.2
         02:C1B1  82         			clx				; Offset to PCE VDC.
         02:C1B2  20 63 FF   			call	load_vram_x
11799                        	
11800                        		.dbg	line,	"include\init.c", 543; //load_vram(PLAYER_VRAM_ADR, tiles_SPR_PLAYER_ARMOR , TILES_16);
11801                        	
11802                        		.dbg	line,	"include\init.c", 546; // SELECT PLAYER CORE SPRITE //
11803                        	
11804                        		.dbg	line,	"include\init.c", 547; spr_set(player_id); // ID : 2
11805                        		__ld.umq	_player_id
         02:C1B5  AD 14 23   			lda	_player_id
11806                        		__call		_spr_set.1
         02:C1B8  20 DD E7   			call	_spr_set.1
11807                        	
11808                        		.dbg	line,	"include\init.c", 550; player_pos_x = 112;
11809                        		__st.wmiq	112, _player_pos_x
         02:C1BB  A9 70      			lda.l	#112
         02:C1BD  8D CE 24   			sta.l	_player_pos_x
         02:C1C0  9C CF 24   			stz.h	_player_pos_x
11810                        	
11811                        		.dbg	line,	"include\init.c", 551; player_pos_y = PLAYER_BASE_Y_POS;
11812                        		__st.wmiq	128, _player_pos_y
         02:C1C3  A9 80      			lda.l	#128
         02:C1C5  8D D0 24   			sta.l	_player_pos_y
         02:C1C8  9C D1 24   			stz.h	_player_pos_y
11813                        	
11814                        		.dbg	line,	"include\init.c", 554; spr_x(player_pos_x);
11815                        		__ld.wm		_player_pos_x
         02:C1CB  AD CE 24   			lda.l	_player_pos_x
         02:C1CE  AC CF 24   			ldy.h	_player_pos_x
11816                        		__call		_spr_x.1
         02:C1D1  20 0A E8   			call	_spr_x.1
11817                        	
11818                        		.dbg	line,	"include\init.c", 555; spr_y(player_pos_y);
11819                        		__ld.wm		_player_pos_y
         02:C1D4  AD D0 24   			lda.l	_player_pos_y
         02:C1D7  AC D1 24   			ldy.h	_player_pos_y
11820                        		__call		_spr_y.1
         02:C1DA  20 19 E8   			call	_spr_y.1
11821                        	
11822                        		.dbg	line,	"include\init.c", 557; // SET TILES DATA FOR THE PLAYER //
11823                        	
11824                        		.dbg	line,	"include\init.c", 558; spr_pattern(PLAYER_VRAM_ADR);
11825                        		__ld.wi		6144
         02:C1DD  62         			cla
         02:C1DE  A0 18      			ldy.h	#6144
11826                        		__call		_spr_pattern.1
         02:C1E0  20 26 E8   			call	_spr_pattern.1
11827                        	
11828                        		.dbg	line,	"include\init.c", 560; // SET SPRITE FLIP //
11829                        	
11830                        		.dbg	line,	"include\init.c", 561; spr_ctrl(FLIP_MAS|SIZE_MAS, NO_FLIP|SZ_32x32);
11831                        		__st.umiq	185, _al
         02:C1E3  A9 B9      			lda.l	#185
         02:C1E5  85 F8      			sta	_al
11832                        		__ld.uiq	17
         02:C1E7  A9 11      			lda	#17
11833                        		__call		_spr_ctrl.2
         02:C1E9  20 3C E8   			call	_spr_ctrl.2
11834                        	
11835                        		.dbg	line,	"include\init.c", 563; 
11836                        	
11837                        		.dbg	line,	"include\init.c", 566; spr_pal(0);
11838                        		__ld.uiq	0
         02:C1EC  62         			cla
11839                        		__call		_spr_pal.1
         02:C1ED  20 4D E8   			call	_spr_pal.1
11840                        	
11841                        		.dbg	line,	"include\init.c", 567; spr_pri(TRUE);
11842                        		__ld.uiq	1
         02:C1F0  A9 01      			lda	#1
11843                        		__call		_spr_pri.1
         02:C1F2  20 5C E8   			call	_spr_pri.1
11844                        	
11845                        		.dbg	line,	"include\init.c", 570; //--------------------------------------------------------------------------------------//
11846                        	
11847                        		.dbg	line,	"include\init.c", 571; //                                       OBJECTS                                        //
11848                        	
11849                        		.dbg	line,	"include\init.c", 572; //--------------------------------------------------------------------------------------//
11850                        	
11851                        		.dbg	line,	"include\init.c", 574; load_OBJECT_TILES();
11852                        		__call		_load_OBJECT_TILES
         02:C1F5  20 E1 FE   			call	_load_OBJECT_TILES
11853                        	
11854                        		.dbg	line,	"include\init.c", 575; init_OBJECT_LV1();
11855                        		__call		_init_OBJECT_LV1
         02:C1F8  20 D7 FE   			call	_init_OBJECT_LV1
11856                        	
11857                        		.dbg	line,	"include\init.c", 576; scroll_object();
11858                        		__call		_scroll_object
         02:C1FB  20 CD FE   			call	_scroll_object
11859                        	
11860                        		.dbg	line,	"include\init.c", 579; //--------------------------------------------------------------------------------------//
11861                        	
11862                        		.dbg	line,	"include\init.c", 580; //                                        CHESTS                                        //
11863                        	
11864                        		.dbg	line,	"include\init.c", 581; //--------------------------------------------------------------------------------------//
11865                        	
11866                        		.dbg	line,	"include\init.c", 583; load_CHEST_TILES();
11867                        		__call		_load_CHEST_TILES
         02:C1FE  20 C3 FE   			call	_load_CHEST_TILES
11868                        	
11869                        		.dbg	line,	"include\init.c", 584; init_CHEST_LV1();
11870                        		__call		_init_CHEST_LV1
         02:C201  20 B9 FE   			call	_init_CHEST_LV1
11871                        	
11872                        		.dbg	line,	"include\init.c", 585; scroll_chest();
11873                        		__call		_scroll_chest
         02:C204  20 AF FE   			call	_scroll_chest
11874                        	
11875                        		.dbg	line,	"include\init.c", 588; //--------------------------------------------------------------------------------------//
11876                        	
11877                        		.dbg	line,	"include\init.c", 589; //                                         NPCS                                         //
11878                        	
11879                        		.dbg	line,	"include\init.c", 590; //--------------------------------------------------------------------------------------//
11880                        	
11881                        		.dbg	line,	"include\init.c", 592; load_NPC_TILES();
11882                        		__call		_load_NPC_TILES
         02:C207  20 A5 FE   			call	_load_NPC_TILES
11883                        	
11884                        		.dbg	line,	"include\init.c", 593; init_NPC_LV1();
11885                        		__call		_init_NPC_LV1
         02:C20A  20 9B FE   			call	_init_NPC_LV1
11886                        	
11887                        		.dbg	line,	"include\init.c", 599; // UPDATE PCE SAT //
11888                        	
11889                        		.dbg	line,	"include\init.c", 600; satb_update();
11890                        		__call		_satb_update
         02:C20D  20 91 FE   			call	_satb_update
11891                        	
11892                        		.dbg	line,	"include\init.c", 605; //--------------------------------------------------------------------------------------//
11893                        	
11894                        		.dbg	line,	"include\init.c", 606; //                                LOAD SPRITES PALETTES                                 //
11895                        	
11896                        		.dbg	line,	"include\init.c", 607; //--------------------------------------------------------------------------------------//
11897                        	
11898                        		.dbg	line,	"include\init.c", 609; if(armor_level == 8)
11899                        		__ld.umq	_armor_level
         02:C210  AD 1F 23   			lda	_armor_level
11900                        		__equ_b.uiq	8
         02:C213  C9 08      			cmp	#8
         02:C215  F0 01      			beq	!+
         02:C217  18         			clc
         02:C218             	!:
11901                        		__bfalse	.LL516
         02:C218  90 19      			bcc	.LL516
11902                        	
11903                        		.dbg	line,	"include\init.c", 610; {
11904                        	
11905                        		.dbg	line,	"include\init.c", 611; load_palette( 16, palette_PLAYER_8, 1 );
11906                        		__st.umiq	16, _al
         02:C21A  A9 10      			lda.l	#16
         02:C21C  85 F8      			sta	_al
11907                        		__farptr	_palette_PLAYER_8, _bp_bank, _bp
         02:C21E  A9 E0      			lda.l	#$6000 + ($1FFF & (_palette_PLAYER_8))
         02:C220  85 EC      			sta.l	_bp
         02:C222  A9 77      			lda.h	#$6000 + ($1FFF & (_palette_PLAYER_8))
         02:C224  85 ED      			sta.h	_bp
         02:C226  A9 10      			lda	#bank(_palette_PLAYER_8)
         02:C228  85 02      			sta	_bp_bank
11908                        		__st.umiq	1, _ah
         02:C22A  A9 01      			lda.l	#1
         02:C22C  85 F9      			sta	_ah
11909                        		__call		_load_palette.3
         02:C22E  20 EB FE   			call	_load_palette.3
11910                        	
11911                        		.dbg	line,	"include\init.c", 612; }
11912                        	
11913                        		.dbg	line,	"include\init.c", 614; else if(armor_level == 5)
11914                        		__bra		.LL517
         02:C231  80 5D      			bra	.LL517
11915    02:C233             	.LL516:
11916                        		__ld.umq	_armor_level
         02:C233  AD 1F 23   			lda	_armor_level
11917                        		__equ_b.uiq	5
         02:C236  C9 05      			cmp	#5
         02:C238  F0 01      			beq	!+
         02:C23A  18         			clc
         02:C23B             	!:
11918                        		__bfalse	.LL518
         02:C23B  90 19      			bcc	.LL518
11919                        	
11920                        		.dbg	line,	"include\init.c", 615; {
11921                        	
11922                        		.dbg	line,	"include\init.c", 616; load_palette( 16, palette_PLAYER_5, 1 );
11923                        		__st.umiq	16, _al
         02:C23D  A9 10      			lda.l	#16
         02:C23F  85 F8      			sta	_al
11924                        		__farptr	_palette_PLAYER_5, _bp_bank, _bp
         02:C241  A9 E0      			lda.l	#$6000 + ($1FFF & (_palette_PLAYER_5))
         02:C243  85 EC      			sta.l	_bp
         02:C245  A9 75      			lda.h	#$6000 + ($1FFF & (_palette_PLAYER_5))
         02:C247  85 ED      			sta.h	_bp
         02:C249  A9 10      			lda	#bank(_palette_PLAYER_5)
         02:C24B  85 02      			sta	_bp_bank
11925                        		__st.umiq	1, _ah
         02:C24D  A9 01      			lda.l	#1
         02:C24F  85 F9      			sta	_ah
11926                        		__call		_load_palette.3
         02:C251  20 EB FE   			call	_load_palette.3
11927                        	
11928                        		.dbg	line,	"include\init.c", 617; }
11929                        	
11930                        		.dbg	line,	"include\init.c", 619; else if(armor_level == 4)
11931                        		__bra		.LL519
         02:C254  80 3A      			bra	.LL519
11932    02:C256             	.LL518:
11933                        		__ld.umq	_armor_level
         02:C256  AD 1F 23   			lda	_armor_level
11934                        		__equ_b.uiq	4
         02:C259  C9 04      			cmp	#4
         02:C25B  F0 01      			beq	!+
         02:C25D  18         			clc
         02:C25E             	!:
11935                        		__bfalse	.LL520
         02:C25E  90 19      			bcc	.LL520
11936                        	
11937                        		.dbg	line,	"include\init.c", 620; {
11938                        	
11939                        		.dbg	line,	"include\init.c", 621; load_palette( 16, palette_PLAYER_4, 1 );
11940                        		__st.umiq	16, _al
         02:C260  A9 10      			lda.l	#16
         02:C262  85 F8      			sta	_al
11941                        		__farptr	_palette_PLAYER_4, _bp_bank, _bp
         02:C264  A9 E0      			lda.l	#$6000 + ($1FFF & (_palette_PLAYER_4))
         02:C266  85 EC      			sta.l	_bp
         02:C268  A9 73      			lda.h	#$6000 + ($1FFF & (_palette_PLAYER_4))
         02:C26A  85 ED      			sta.h	_bp
         02:C26C  A9 10      			lda	#bank(_palette_PLAYER_4)
         02:C26E  85 02      			sta	_bp_bank
11942                        		__st.umiq	1, _ah
         02:C270  A9 01      			lda.l	#1
         02:C272  85 F9      			sta	_ah
11943                        		__call		_load_palette.3
         02:C274  20 EB FE   			call	_load_palette.3
11944                        	
11945                        		.dbg	line,	"include\init.c", 622; }
11946                        	
11947                        		.dbg	line,	"include\init.c", 624; else
11948                        		__bra		.LL521
         02:C277  80 17      			bra	.LL521
11949    02:C279             	.LL520:
11950                        	
11951                        		.dbg	line,	"include\init.c", 625; {
11952                        	
11953                        		.dbg	line,	"include\init.c", 626; load_palette( 16, palette_PLAYER_1, 1 );
11954                        		__st.umiq	16, _al
         02:C279  A9 10      			lda.l	#16
         02:C27B  85 F8      			sta	_al
11955                        		__farptr	_palette_PLAYER_1, _bp_bank, _bp
         02:C27D  A9 E0      			lda.l	#$6000 + ($1FFF & (_palette_PLAYER_1))
         02:C27F  85 EC      			sta.l	_bp
         02:C281  A9 71      			lda.h	#$6000 + ($1FFF & (_palette_PLAYER_1))
         02:C283  85 ED      			sta.h	_bp
         02:C285  A9 10      			lda	#bank(_palette_PLAYER_1)
         02:C287  85 02      			sta	_bp_bank
11956                        		__st.umiq	1, _ah
         02:C289  A9 01      			lda.l	#1
         02:C28B  85 F9      			sta	_ah
11957                        		__call		_load_palette.3
         02:C28D  20 EB FE   			call	_load_palette.3
11958                        	
11959                        		.dbg	line,	"include\init.c", 627; }
11960    02:C290             	.LL521:
11961    02:C290             	.LL519:
11962    02:C290             	.LL517:
11963                        	
11964                        		.dbg	line,	"include\init.c", 630; load_palette( 17, palette_objects_1, 1 );
11965                        		__st.umiq	17, _al
         02:C290  A9 11      			lda.l	#17
         02:C292  85 F8      			sta	_al
11966                        		__farptr	_palette_objects_1, _bp_bank, _bp
         02:C294  A9 60      			lda.l	#$6000 + ($1FFF & (_palette_objects_1))
         02:C296  85 EC      			sta.l	_bp
         02:C298  A9 75      			lda.h	#$6000 + ($1FFF & (_palette_objects_1))
         02:C29A  85 ED      			sta.h	_bp
         02:C29C  A9 11      			lda	#bank(_palette_objects_1)
         02:C29E  85 02      			sta	_bp_bank
11967                        		__st.umiq	1, _ah
         02:C2A0  A9 01      			lda.l	#1
         02:C2A2  85 F9      			sta	_ah
11968                        		__call		_load_palette.3
         02:C2A4  20 EB FE   			call	_load_palette.3
11969                        	
11970                        		.dbg	line,	"include\init.c", 631; load_palette( 18, palette_objects_2, 1 );
11971                        		__st.umiq	18, _al
         02:C2A7  A9 12      			lda.l	#18
         02:C2A9  85 F8      			sta	_al
11972                        		__farptr	_palette_objects_2, _bp_bank, _bp
         02:C2AB  A9 60      			lda.l	#$6000 + ($1FFF & (_palette_objects_2))
         02:C2AD  85 EC      			sta.l	_bp
         02:C2AF  A9 77      			lda.h	#$6000 + ($1FFF & (_palette_objects_2))
         02:C2B1  85 ED      			sta.h	_bp
         02:C2B3  A9 11      			lda	#bank(_palette_objects_2)
         02:C2B5  85 02      			sta	_bp_bank
11973                        		__st.umiq	1, _ah
         02:C2B7  A9 01      			lda.l	#1
         02:C2B9  85 F9      			sta	_ah
11974                        		__call		_load_palette.3
         02:C2BB  20 EB FE   			call	_load_palette.3
11975                        	
11976                        		.dbg	line,	"include\init.c", 639; // VSYNC //
11977                        	
11978                        		.dbg	line,	"include\init.c", 640; vsync();
11979                        		__call		_vsync
         02:C2BE  20 09 E3   			call	_vsync
11980                        	
11981                        		.dbg	line,	"include\init.c", 642; // ENABLE DISPLAY //
11982                        	
11983                        		.dbg	line,	"include\init.c", 643; disp_on();
11984                        		__call		_disp_on
         02:C2C1  20 16 E4   			call	_disp_on
11985                        	
11986                        		.dbg	line,	"include\init.c", 644; }
11987                        	
11988                        		.dbg	line,	"include\init.c", 645; }
11989    02:C2C4             	.LL510:
11990    02:C2C4             	.LL509:
11991                        		__return	0
         02:C2C4  4C EF FF   			jmp	leave_proc
11992                        		.dbg	clear
11993                        		.endp
11994                        		.pceas
11995                        	
11996                        		.dbg	line,	"include\init.c", 648; void init_SHOP()
11997                        		.dbg	line,	"include\init.c", 649; {
11998                        	;***********************
11999                        	;***********************
12000                        	
12001                        		.hucc
12002    01:D408             		.proc		_init_SHOP
12003                        		__enter		_init_SHOP
12004                        	
12005                        		.dbg	line,	"include\init.c", 650; char i;
12006                        	
12007                        		.dbg	line,	"include\init.c", 651; char item_id;
12008                        	
12009                        		.dbg	line,	"include\init.c", 654; // DISABLE DISPLAY //
12010                        	
12011                        		.dbg	line,	"include\init.c", 655; disp_off();
12012                        		__call		_disp_off
         01:D408  20 29 E4   			call	_disp_off
12013                        	
12014                        		.dbg	line,	"include\init.c", 656; 
12015                        	
12016                        		.dbg	line,	"include\init.c", 658; // VSYNC //
12017                        	
12018                        		.dbg	line,	"include\init.c", 659; vsync();
12019                        		__call		_vsync
         01:D40B  20 09 E3   			call	_vsync
12020                        	
12021                        		.dbg	line,	"include\init.c", 662; // HIDE ALL LEVEL SPRITES //
12022                        	
12023                        		.dbg	line,	"include\init.c", 663; hide_LEVEL_SPRITES();
12024                        		__call		_hide_LEVEL_SPRITES
         01:D40E  20 87 FE   			call	_hide_LEVEL_SPRITES
12025                        	
12026                        		.dbg	line,	"include\init.c", 666; // SET VDC 1 SCREEN SIZE (IN TILES) - 32x32 = 256 PIXELS
12027                        	
12028                        		.dbg	line,	"include\init.c", 667; set_screen_size(SCR_SIZE_64x32);
12029                        		__st.umiq	1, _al
         01:D411  A9 01      			lda.l	#1
         01:D413  85 F8      			sta	_al
12030                        		__call		_set_screen_size.1
         01:D415  20 31 FF   			call	_set_screen_size.1
12031                        	
12032                        		.dbg	line,	"include\init.c", 670; // SET VDC 2 SCREEN SIZE (IN TILES) - 32x32 = 256 PIXELS
12033                        	
12034                        		.dbg	line,	"include\init.c", 671; sgx_set_screen_size(SCR_SIZE_32x32);
12035                        		__st.umiq	0, _al
         01:D418  64 F8      			stz	_al
12036                        		__call		_sgx_set_screen_size.1
         01:D41A  20 27 FF   			call	_sgx_set_screen_size.1
12037                        	
12038                        		.dbg	line,	"include\init.c", 676; //**************************************************************************************//
12039                        	
12040                        		.dbg	line,	"include\init.c", 677; //                                                                                      //
12041                        	
12042                        		.dbg	line,	"include\init.c", 678; //                                      VARIABLES                                       //
12043                        	
12044                        		.dbg	line,	"include\init.c", 679; //                                                                                      //
12045                        	
12046                        		.dbg	line,	"include\init.c", 680; //**************************************************************************************//
12047                        	
12048                        		.dbg	line,	"include\init.c", 682; index_x = 0;
12049                        		__st.umiq	0, _index_x
         01:D41D  9C C9 23   			stz	_index_x
12050                        	
12051                        		.dbg	line,	"include\init.c", 683; index_y = 0;
12052                        		__st.umiq	0, _index_y
         01:D420  9C CA 23   			stz	_index_y
12053                        	
12054                        		.dbg	line,	"include\init.c", 684; item_index = 0;
12055                        		__st.umiq	0, _item_index
         01:D423  9C CB 23   			stz	_item_index
12056                        	
12057                        		.dbg	line,	"include\init.c", 686; minutes = 0;
12058                        		__st.umiq	0, _minutes
         01:D426  9C 24 23   			stz	_minutes
12059                        	
12060                        		.dbg	line,	"include\init.c", 687; seconds = 30;
12061                        		__st.umiq	30, _seconds
         01:D429  A9 1E      			lda.l	#30
         01:D42B  8D 25 23   			sta	_seconds
12062                        	
12063                        		.dbg	line,	"include\init.c", 689; shop_counter = 0;
12064                        		__st.umiq	0, _shop_counter
         01:D42E  9C CD 23   			stz	_shop_counter
12065                        	
12066                        		.dbg	line,	"include\init.c", 690; shop_phase = SHOP_PHASE_ENTER;
12067                        		__st.umiq	0, _shop_phase
         01:D431  9C CC 23   			stz	_shop_phase
12068                        	
12069                        		.dbg	line,	"include\init.c", 692; if(level_id == 1)
12070                        		__ld.umq	_level_id
         01:D434  AD 12 23   			lda	_level_id
12071                        		__equ_b.uiq	1
         01:D437  C9 01      			cmp	#1
         01:D439  F0 01      			beq	!+
         01:D43B  18         			clc
         01:D43C             	!:
12072                        		__bfalse	.LL523
         01:D43C  90 0A      			bcc	.LL523
12073                        	
12074                        		.dbg	line,	"include\init.c", 693; {
12075                        	
12076                        		.dbg	line,	"include\init.c", 694; ptr_SHOP_ITEM_PRICES = &TABLE_SHOP_PRICES_LV1[0];
12077                        		__ld.wi		_TABLE_SHOP_PRICES_LV1
         01:D43E  A9 59      			lda.l	#_TABLE_SHOP_PRICES_LV1
         01:D440  A0 61      			ldy.h	#_TABLE_SHOP_PRICES_LV1
12078                        		__st.wmq	_ptr_SHOP_ITEM_PRICES
         01:D442  8D 40 26   			sta.l	_ptr_SHOP_ITEM_PRICES
         01:D445  8C 41 26   			sty.h	_ptr_SHOP_ITEM_PRICES
12079                        	
12080                        		.dbg	line,	"include\init.c", 695; }
12081                        	
12082                        		.dbg	line,	"include\init.c", 696; 
12083                        	
12084                        		.dbg	line,	"include\init.c", 701; //**************************************************************************************//
12085                        	
12086                        		.dbg	line,	"include\init.c", 702; //                                                                                      //
12087                        	
12088                        		.dbg	line,	"include\init.c", 703; //                                        VDC 2                                         //
12089                        	
12090                        		.dbg	line,	"include\init.c", 704; //                                                                                      //
12091                        	
12092                        		.dbg	line,	"include\init.c", 705; //**************************************************************************************//
12093                        	
12094                        		.dbg	line,	"include\init.c", 707; //--------------------------------------------------------------------------------------//
12095                        	
12096                        		.dbg	line,	"include\init.c", 708; //                                      LOAD FONT                                       //
12097                        	
12098                        		.dbg	line,	"include\init.c", 709; //--------------------------------------------------------------------------------------//
12099                        	
12100                        		.dbg	line,	"include\init.c", 711; load_vram( 0x0800, tileset_FONT, SIZEOF(tileset_FONT) >> 1 );
12101    01:D448             	.LL523:
12102                        		__st.wmiq	2048, _di
         01:D448  64 F0      			stz.l	_di
         01:D44A  A9 08      			lda.h	#2048
         01:D44C  85 F1      			sta.h	_di
12103                        		__farptr	_tileset_FONT, _bp_bank, _bp
         01:D44E  A9 00      			lda.l	#$6000 + ($1FFF & (_tileset_FONT))
         01:D450  85 EC      			sta.l	_bp
         01:D452  A9 60      			lda.h	#$6000 + ($1FFF & (_tileset_FONT))
         01:D454  85 ED      			sta.h	_bp
         01:D456  A9 03      			lda	#bank(_tileset_FONT)
         01:D458  85 02      			sta	_bp_bank
12104                        		__ld.wi		___sizeof__tileset_FONT
         01:D45A  A9 00      			lda.l	#___sizeof__tileset_FONT
         01:D45C  A0 0C      			ldy.h	#___sizeof__tileset_FONT
12105                        		__lsr.wi	1
         01:D45E  42         			say
         01:D45F  4A         			lsr	a
         01:D460  42         			say
         01:D461  6A         			ror	a
12106                        		__st.wmq	_ax
         01:D462  85 F8      			sta.l	_ax
         01:D464  84 F9      			sty.h	_ax
12107                        		 _load_vram.3
         01:D466  82         			clx				; Offset to PCE VDC.
         01:D467  20 63 FF   			call	load_vram_x
12108                        	
12109                        		.dbg	line,	"include\init.c", 713; set_font_pal(15);
12110                        		__ld.uiq	15
         01:D46A  A9 0F      			lda	#15
12111                        		__call		_set_font_pal.1
         01:D46C  20 09 E6   			call	_set_font_pal.1
12112                        	
12113                        		.dbg	line,	"include\init.c", 716; //--------------------------------------------------------------------------------------//
12114                        	
12115                        		.dbg	line,	"include\init.c", 717; //                                    LOAD TILESET                                      //
12116                        	
12117                        		.dbg	line,	"include\init.c", 718; //--------------------------------------------------------------------------------------//
12118                        	
12119                        		.dbg	line,	"include\init.c", 720; sgx_load_vram( 0x1000, tileset_SHOP_BG_B, SIZEOF(tileset_SHOP_BG_B) >> 1 );
12120                        		__st.wmiq	4096, _di
         01:D46F  64 F0      			stz.l	_di
         01:D471  A9 10      			lda.h	#4096
         01:D473  85 F1      			sta.h	_di
12121                        		__farptr	_tileset_SHOP_BG_B, _bp_bank, _bp
         01:D475  A9 A0      			lda.l	#$6000 + ($1FFF & (_tileset_SHOP_BG_B))
         01:D477  85 EC      			sta.l	_bp
         01:D479  A9 7A      			lda.h	#$6000 + ($1FFF & (_tileset_SHOP_BG_B))
         01:D47B  85 ED      			sta.h	_bp
         01:D47D  A9 0B      			lda	#bank(_tileset_SHOP_BG_B)
         01:D47F  85 02      			sta	_bp_bank
12122                        		__ld.wi		___sizeof__tileset_SHOP_BG_B
         01:D481  A9 60      			lda.l	#___sizeof__tileset_SHOP_BG_B
         01:D483  A0 39      			ldy.h	#___sizeof__tileset_SHOP_BG_B
12123                        		__lsr.wi	1
         01:D485  42         			say
         01:D486  4A         			lsr	a
         01:D487  42         			say
         01:D488  6A         			ror	a
12124                        		__st.wmq	_ax
         01:D489  85 F8      			sta.l	_ax
         01:D48B  84 F9      			sty.h	_ax
12125                        		 _sgx_load_vram.3
         01:D48D  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
         01:D48F  20 63 FF   			call	load_vram_x
12126                        	
12127                        		.dbg	line,	"include\init.c", 723; //--------------------------------------------------------------------------------------//
12128                        	
12129                        		.dbg	line,	"include\init.c", 724; //                                      LOAD ITEMS                                      //
12130                        	
12131                        		.dbg	line,	"include\init.c", 725; //--------------------------------------------------------------------------------------//
12132                        	
12133                        		.dbg	line,	"include\init.c", 727; for(i=0 ; i<10 ; i++)
12134                        		__st.umiq	0, __init_SHOP_end - 1  /* i */
         01:D492  9C 0F 23   			stz	__init_SHOP_end - 1
12135    01:D495             	.LL524:
12136                        		__ld.umq	__init_SHOP_end - 1  /* i */
         01:D495  AD 0F 23   			lda	__init_SHOP_end - 1
12137                        		__ult_b.uiq	10
         01:D498  C9 0A      			cmp	#10		; Subtract integer from A.
         01:D49A  6A         			ror	a		; CC if A < integer.
         01:D49B  49 80      			eor	#$80
         01:D49D  2A         			rol	a
12138                        		__btrue		.LL526
         01:D49E  B0 07      			bcs	.LL526
12139                        		__bra		.LL527
         01:D4A0  80 42      			bra	.LL527
12140    01:D4A2             	.LL525:
12141                        		__inc.umq	__init_SHOP_end - 1  /* i */
         01:D4A2  EE 0F 23   			inc	__init_SHOP_end - 1
12142                        		__bra		.LL524
         01:D4A5  80 EE      			bra	.LL524
12143    01:D4A7             	.LL526:
12144                        	
12145                        		.dbg	line,	"include\init.c", 728; {
12146                        	
12147                        		.dbg	line,	"include\init.c", 729; set_far_base(TABLE_SHOP_ITEMS_TILES_BANK[i],TABLE_SHOP_ITEMS_TILES_ADR[i]);
12148                        		__ldx.umq	__init_SHOP_end - 1  /* i */
         01:D4A7  AE 0F 23   			ldx	__init_SHOP_end - 1
12149                        		__ld.uax	_TABLE_SHOP_ITEMS_TILES_BANK
         01:D4AA  BD 81 61   			lda	_TABLE_SHOP_ITEMS_TILES_BANK, x
         01:D4AD  C2         			cly
12150                        		__st.umq	_bp_bank
         01:D4AE  85 02      			sta	_bp_bank
12151                        		__ld2x.umq	__init_SHOP_end - 1  /* i */
         01:D4B0  AD 0F 23   			lda	__init_SHOP_end - 1
         01:D4B3  0A         			asl	a
         01:D4B4  AA         			tax
12152                        		__ld.wax	_TABLE_SHOP_ITEMS_TILES_ADR
         01:D4B5  BD 6D 61   			lda.l	_TABLE_SHOP_ITEMS_TILES_ADR, x
         01:D4B8  BC 6E 61   			ldy.h	_TABLE_SHOP_ITEMS_TILES_ADR, x
12153                        		__st.wmq	_bp
         01:D4BB  85 EC      			sta.l	_bp
         01:D4BD  84 ED      			sty.h	_bp
12154                        	
12155                        		.dbg	line,	"include\init.c", 730; sgx_far_load_vram( 0x1000 + (i * TILES_4), TILES_4 );
12156                        		__ld.um		__init_SHOP_end - 1  /* i */
         01:D4BF  AD 0F 23   			lda	__init_SHOP_end - 1
         01:D4C2  C2         			cly
12157                        		__asl.wi	6
         01:D4C3  85 00      			sta	__temp
         01:D4C5  98         			tya
         01:D4C6  4A         			lsr	a
         01:D4C7  20 CB E1   			jsr	aslw6
         01:D4CA  29 C0      			and.l	#$FF << 6
12158                        		__add.wi	4096
         01:D4CC  18         			clc
         01:D4CD  69 00      			adc.l	#4096
         01:D4CF  42         			say
         01:D4D0  69 10      			adc.h	#4096
         01:D4D2  42         			say
12159                        		__st.wmq	_di
         01:D4D3  85 F0      			sta.l	_di
         01:D4D5  84 F1      			sty.h	_di
12160                        		__st.wmiq	64, _ax
         01:D4D7  A9 40      			lda.l	#64
         01:D4D9  85 F8      			sta.l	_ax
         01:D4DB  64 F9      			stz.h	_ax
12161                        		 _sgx_far_load_vram.2
         01:D4DD  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
         01:D4DF  20 63 FF   			call	load_vram_x
12162                        	
12163                        		.dbg	line,	"include\init.c", 731; }
12164                        		__bra		.LL525
         01:D4E2  80 BE      			bra	.LL525
12165    01:D4E4             	.LL527:
12166                        	
12167                        		.dbg	line,	"include\init.c", 734; //--------------------------------------------------------------------------------------//
12168                        	
12169                        		.dbg	line,	"include\init.c", 735; //                                      SET BLOCKS                                      //
12170                        	
12171                        		.dbg	line,	"include\init.c", 736; //--------------------------------------------------------------------------------------//
12172                        	
12173                        		.dbg	line,	"include\init.c", 738; sgx_set_blocks( blocks_SHOP_BG_B , tilemap_mask , 256 );
12174                        		__farptr	_blocks_SHOP_BG_B, sgx_blk_bank, sgx_blk_addr
         01:D4E4  A9 00      			lda.l	#$6000 + ($1FFF & (_blocks_SHOP_BG_B))
         01:D4E6  8D C2 2B   			sta.l	sgx_blk_addr
         01:D4E9  A9 78      			lda.h	#$6000 + ($1FFF & (_blocks_SHOP_BG_B))
         01:D4EB  8D C3 2B   			sta.h	sgx_blk_addr
         01:D4EE  A9 0D      			lda	#bank(_blocks_SHOP_BG_B)
         01:D4F0  8D C4 2B   			sta	sgx_blk_bank
12175                        		__farptr	_tilemap_mask, sgx_tbl_bank, sgx_tbl_addr
         01:D4F3  A9 CE      			lda.l	#$6000 + ($1FFF & (_tilemap_mask))
         01:D4F5  8D BF 2B   			sta.l	sgx_tbl_addr
         01:D4F8  A9 63      			lda.h	#$6000 + ($1FFF & (_tilemap_mask))
         01:D4FA  8D C0 2B   			sta.h	sgx_tbl_addr
         01:D4FD  A9 F8      			lda	#bank(_tilemap_mask)
         01:D4FF  8D C1 2B   			sta	sgx_tbl_bank
12176                        		__st.umiq	256, _al
         01:D502  A9 00      			lda.l	#256
         01:D504  85 F8      			sta	_al
12177                        		__call		_sgx_set_blocks.3
         01:D506  20 7D FE   			call	_sgx_set_blocks.3
12178                        	
12179                        		.dbg	line,	"include\init.c", 742; //--------------------------------------------------------------------------------------//
12180                        	
12181                        		.dbg	line,	"include\init.c", 743; //                                       SET MAP                                        //
12182                        	
12183                        		.dbg	line,	"include\init.c", 744; //--------------------------------------------------------------------------------------//
12184                        	
12185                        		.dbg	line,	"include\init.c", 746; sgx_set_blkmap( map_SHOP_BG_B, COUNTOF(map_SHOP_BG_B) );
12186                        		__farptr	_map_SHOP_BG_B, sgx_map_bank, sgx_map_addr
         01:D509  A9 00      			lda.l	#$6000 + ($1FFF & (_map_SHOP_BG_B))
         01:D50B  8D C5 2B   			sta.l	sgx_map_addr
         01:D50E  A9 60      			lda.h	#$6000 + ($1FFF & (_map_SHOP_BG_B))
         01:D510  8D C6 2B   			sta.h	sgx_map_addr
         01:D513  A9 0E      			lda	#bank(_map_SHOP_BG_B)
         01:D515  8D C7 2B   			sta	sgx_map_bank
12187                        		__ld.wi		___countof__map_SHOP_BG_B
         01:D518  A9 10      			lda.l	#___countof__map_SHOP_BG_B
         01:D51A  A0 00      			ldy.h	#___countof__map_SHOP_BG_B
12188                        		__st.umq	sgx_map_line_w
         01:D51C  8D 88 26   			sta	sgx_map_line_w
12189                        		 _sgx_set_blkmap.2
         01:D51F  9C CA 2B   			stz	sgx_scr_bank
12190                        	
12191                        		.dbg	line,	"include\init.c", 749; //--------------------------------------------------------------------------------------//
12192                        	
12193                        		.dbg	line,	"include\init.c", 750; //                                    DRAW TILEMAP                                      //
12194                        	
12195                        		.dbg	line,	"include\init.c", 751; //--------------------------------------------------------------------------------------//
12196                        	
12197                        		.dbg	line,	"include\init.c", 753; // The blkmap is drawn using global variables for the top-left coordinate
12198                        	
12199                        		.dbg	line,	"include\init.c", 754; // in pixels, and the draw width and height in terms of 8x8 characters.
12200                        	
12201                        		.dbg	line,	"include\init.c", 756; sgx_map_pxl_x = 0;
12202                        		__st.wmiq	0, _sgx_map_pxl_x
         01:D522  9C 8A 26   			stz.l	_sgx_map_pxl_x
         01:D525  9C 8B 26   			stz.h	_sgx_map_pxl_x
12203                        	
12204                        		.dbg	line,	"include\init.c", 757; sgx_map_pxl_y = 0;
12205                        		__st.wmiq	0, _sgx_map_pxl_y
         01:D528  9C 8C 26   			stz.l	_sgx_map_pxl_y
         01:D52B  9C 8D 26   			stz.h	_sgx_map_pxl_y
12206                        	
12207                        		.dbg	line,	"include\init.c", 759; sgx_map_draw_w = 32;
12208                        		__st.umiq	32, _sgx_map_draw_w
         01:D52E  A9 20      			lda.l	#32
         01:D530  8D 86 26   			sta	_sgx_map_draw_w
12209                        	
12210                        		.dbg	line,	"include\init.c", 760; sgx_map_draw_h = 28;
12211                        		__st.umiq	28, _sgx_map_draw_h
         01:D533  A9 1C      			lda.l	#28
         01:D535  8D 87 26   			sta	_sgx_map_draw_h
12212                        	
12213                        		.dbg	line,	"include\init.c", 763; //**************************************************************************************//
12214                        	
12215                        		.dbg	line,	"include\init.c", 764; //                                                                                      //
12216                        	
12217                        		.dbg	line,	"include\init.c", 765; //                                  SETUP SCROLL_SPLIT                                  //
12218                        	
12219                        		.dbg	line,	"include\init.c", 766; //                                                                                      //
12220                        	
12221                        		.dbg	line,	"include\init.c", 767; //**************************************************************************************//
12222                        	
12223                        		.dbg	line,	"include\init.c", 769; sgx_draw_map();
12224                        		__call		_sgx_draw_map
         01:D538  20 FF FE   			call	_sgx_draw_map
12225                        	
12226                        		.dbg	line,	"include\init.c", 771; sgx_scroll_split(0,   0, sgx_map_pxl_x & (BAT_SIZE_W - 1), sgx_map_pxl_y & (BAT_SIZE_H - 1), BKG_ON | SPR_ON);
12227                        		__st.umiq	0, _al
         01:D53B  64 F8      			stz	_al
12228                        		__st.umiq	0, _ah
         01:D53D  64 F9      			stz	_ah
12229                        		__ld.wm		_sgx_map_pxl_x
         01:D53F  AD 8A 26   			lda.l	_sgx_map_pxl_x
         01:D542  AC 8B 26   			ldy.h	_sgx_map_pxl_x
12230                        		__and.wi	2047
         01:D545  29 FF      			and.l	#2047
         01:D547  42         			say
         01:D548  29 07      			and.h	#2047
         01:D54A  42         			say
12231                        		__st.wmq	_bx
         01:D54B  85 FA      			sta.l	_bx
         01:D54D  84 FB      			sty.h	_bx
12232                        		__ld.wm		_sgx_map_pxl_y
         01:D54F  AD 8C 26   			lda.l	_sgx_map_pxl_y
         01:D552  AC 8D 26   			ldy.h	_sgx_map_pxl_y
12233                        		__and.wi	255
         01:D555  29 FF      			and	#255
         01:D557  C2         			cly
12234                        		__st.wmq	_cx
         01:D558  85 FC      			sta.l	_cx
         01:D55A  84 FD      			sty.h	_cx
12235                        		__st.umiq	192, _dl
         01:D55C  A9 C0      			lda.l	#192
         01:D55E  85 FE      			sta	_dl
12236                        		__call		_sgx_scroll_split.5
         01:D560  20 77 FF   			call	_sgx_scroll_split.5
12237                        	
12238                        		.dbg	line,	"include\init.c", 776; //**************************************************************************************//
12239                        	
12240                        		.dbg	line,	"include\init.c", 777; //                                                                                      //
12241                        	
12242                        		.dbg	line,	"include\init.c", 778; //                                         HUD                                          //
12243                        	
12244                        		.dbg	line,	"include\init.c", 779; //                                                                                      //
12245                        	
12246                        		.dbg	line,	"include\init.c", 780; //**************************************************************************************//
12247                        	
12248                        		.dbg	line,	"include\init.c", 782; init_HUD();
12249                        		__call		_init_HUD
         01:D563  20 F5 FE   			call	_init_HUD
12250                        	
12251                        		.dbg	line,	"include\init.c", 785; //--------------------------------------------------------------------------------------//
12252                        	
12253                        		.dbg	line,	"include\init.c", 786; //                                     DRAW PRICES                                      //
12254                        	
12255                        		.dbg	line,	"include\init.c", 787; //--------------------------------------------------------------------------------------//
12256                        	
12257                        		.dbg	line,	"include\init.c", 789; shop_prices[0] = *(ptr_SHOP_ITEM_PRICES);
12258                        		__ld.wm		_ptr_SHOP_ITEM_PRICES
         01:D566  AD 40 26   			lda.l	_ptr_SHOP_ITEM_PRICES
         01:D569  AC 41 26   			ldy.h	_ptr_SHOP_ITEM_PRICES
12259                        		__st.wm		__ptr
         01:D56C  85 88      			sta.l	__ptr
         01:D56E  84 89      			sty.h	__ptr
12260                        		__ld.wp		__ptr
         01:D570  A0 01      			ldy	#1
         01:D572  B1 88      			lda	[__ptr], y
         01:D574  A8         			tay
         01:D575  B2 88      			lda	[__ptr]
12261                        		__st.wmq	_shop_prices
         01:D577  8D 2C 26   			sta.l	_shop_prices
         01:D57A  8C 2D 26   			sty.h	_shop_prices
12262                        	
12263                        		.dbg	line,	"include\init.c", 790; shop_prices[1] = *(ptr_SHOP_ITEM_PRICES+1);
12264                        		__ld.wm		_ptr_SHOP_ITEM_PRICES
         01:D57D  AD 40 26   			lda.l	_ptr_SHOP_ITEM_PRICES
         01:D580  AC 41 26   			ldy.h	_ptr_SHOP_ITEM_PRICES
12265                        		__add.wi	2
         01:D583  18         			clc
         01:D584  69 02      			adc.l	#2
         01:D586  90 01      			bcc	!+
         01:D588  C8         			iny
         01:D589             	!:
12266                        		__st.wm		__ptr
         01:D589  85 88      			sta.l	__ptr
         01:D58B  84 89      			sty.h	__ptr
12267                        		__ld.wp		__ptr
         01:D58D  A0 01      			ldy	#1
         01:D58F  B1 88      			lda	[__ptr], y
         01:D591  A8         			tay
         01:D592  B2 88      			lda	[__ptr]
12268                        		__st.wmq	_shop_prices + 2
         01:D594  8D 2E 26   			sta.l	_shop_prices + 2
         01:D597  8C 2F 26   			sty.h	_shop_prices + 2
12269                        	
12270                        		.dbg	line,	"include\init.c", 791; shop_prices[2] = *(ptr_SHOP_ITEM_PRICES+2);
12271                        		__ld.wm		_ptr_SHOP_ITEM_PRICES
         01:D59A  AD 40 26   			lda.l	_ptr_SHOP_ITEM_PRICES
         01:D59D  AC 41 26   			ldy.h	_ptr_SHOP_ITEM_PRICES
12272                        		__add.wi	4
         01:D5A0  18         			clc
         01:D5A1  69 04      			adc.l	#4
         01:D5A3  90 01      			bcc	!+
         01:D5A5  C8         			iny
         01:D5A6             	!:
12273                        		__st.wm		__ptr
         01:D5A6  85 88      			sta.l	__ptr
         01:D5A8  84 89      			sty.h	__ptr
12274                        		__ld.wp		__ptr
         01:D5AA  A0 01      			ldy	#1
         01:D5AC  B1 88      			lda	[__ptr], y
         01:D5AE  A8         			tay
         01:D5AF  B2 88      			lda	[__ptr]
12275                        		__st.wmq	_shop_prices + 4
         01:D5B1  8D 30 26   			sta.l	_shop_prices + 4
         01:D5B4  8C 31 26   			sty.h	_shop_prices + 4
12276                        	
12277                        		.dbg	line,	"include\init.c", 792; shop_prices[3] = *(ptr_SHOP_ITEM_PRICES+3);
12278                        		__ld.wm		_ptr_SHOP_ITEM_PRICES
         01:D5B7  AD 40 26   			lda.l	_ptr_SHOP_ITEM_PRICES
         01:D5BA  AC 41 26   			ldy.h	_ptr_SHOP_ITEM_PRICES
12279                        		__add.wi	6
         01:D5BD  18         			clc
         01:D5BE  69 06      			adc.l	#6
         01:D5C0  90 01      			bcc	!+
         01:D5C2  C8         			iny
         01:D5C3             	!:
12280                        		__st.wm		__ptr
         01:D5C3  85 88      			sta.l	__ptr
         01:D5C5  84 89      			sty.h	__ptr
12281                        		__ld.wp		__ptr
         01:D5C7  A0 01      			ldy	#1
         01:D5C9  B1 88      			lda	[__ptr], y
         01:D5CB  A8         			tay
         01:D5CC  B2 88      			lda	[__ptr]
12282                        		__st.wmq	_shop_prices + 6
         01:D5CE  8D 32 26   			sta.l	_shop_prices + 6
         01:D5D1  8C 33 26   			sty.h	_shop_prices + 6
12283                        	
12284                        		.dbg	line,	"include\init.c", 793; shop_prices[4] = *(ptr_SHOP_ITEM_PRICES+4);
12285                        		__ld.wm		_ptr_SHOP_ITEM_PRICES
         01:D5D4  AD 40 26   			lda.l	_ptr_SHOP_ITEM_PRICES
         01:D5D7  AC 41 26   			ldy.h	_ptr_SHOP_ITEM_PRICES
12286                        		__add.wi	8
         01:D5DA  18         			clc
         01:D5DB  69 08      			adc.l	#8
         01:D5DD  90 01      			bcc	!+
         01:D5DF  C8         			iny
         01:D5E0             	!:
12287                        		__st.wm		__ptr
         01:D5E0  85 88      			sta.l	__ptr
         01:D5E2  84 89      			sty.h	__ptr
12288                        		__ld.wp		__ptr
         01:D5E4  A0 01      			ldy	#1
         01:D5E6  B1 88      			lda	[__ptr], y
         01:D5E8  A8         			tay
         01:D5E9  B2 88      			lda	[__ptr]
12289                        		__st.wmq	_shop_prices + 8
         01:D5EB  8D 34 26   			sta.l	_shop_prices + 8
         01:D5EE  8C 35 26   			sty.h	_shop_prices + 8
12290                        	
12291                        		.dbg	line,	"include\init.c", 794; 
12292                        	
12293                        		.dbg	line,	"include\init.c", 795; shop_prices[5] = *(ptr_SHOP_ITEM_PRICES+5);
12294                        		__ld.wm		_ptr_SHOP_ITEM_PRICES
         01:D5F1  AD 40 26   			lda.l	_ptr_SHOP_ITEM_PRICES
         01:D5F4  AC 41 26   			ldy.h	_ptr_SHOP_ITEM_PRICES
12295                        		__add.wi	10
         01:D5F7  18         			clc
         01:D5F8  69 0A      			adc.l	#10
         01:D5FA  90 01      			bcc	!+
         01:D5FC  C8         			iny
         01:D5FD             	!:
12296                        		__st.wm		__ptr
         01:D5FD  85 88      			sta.l	__ptr
         01:D5FF  84 89      			sty.h	__ptr
12297                        		__ld.wp		__ptr
         01:D601  A0 01      			ldy	#1
         01:D603  B1 88      			lda	[__ptr], y
         01:D605  A8         			tay
         01:D606  B2 88      			lda	[__ptr]
12298                        		__st.wmq	_shop_prices + 10
         01:D608  8D 36 26   			sta.l	_shop_prices + 10
         01:D60B  8C 37 26   			sty.h	_shop_prices + 10
12299                        	
12300                        		.dbg	line,	"include\init.c", 796; shop_prices[6] = *(ptr_SHOP_ITEM_PRICES+6);
12301                        		__ld.wm		_ptr_SHOP_ITEM_PRICES
         01:D60E  AD 40 26   			lda.l	_ptr_SHOP_ITEM_PRICES
         01:D611  AC 41 26   			ldy.h	_ptr_SHOP_ITEM_PRICES
12302                        		__add.wi	12
         01:D614  18         			clc
         01:D615  69 0C      			adc.l	#12
         01:D617  90 01      			bcc	!+
         01:D619  C8         			iny
         01:D61A             	!:
12303                        		__st.wm		__ptr
         01:D61A  85 88      			sta.l	__ptr
         01:D61C  84 89      			sty.h	__ptr
12304                        		__ld.wp		__ptr
         01:D61E  A0 01      			ldy	#1
         01:D620  B1 88      			lda	[__ptr], y
         01:D622  A8         			tay
         01:D623  B2 88      			lda	[__ptr]
12305                        		__st.wmq	_shop_prices + 12
         01:D625  8D 38 26   			sta.l	_shop_prices + 12
         01:D628  8C 39 26   			sty.h	_shop_prices + 12
12306                        	
12307                        		.dbg	line,	"include\init.c", 797; shop_prices[7] = *(ptr_SHOP_ITEM_PRICES+7);
12308                        		__ld.wm		_ptr_SHOP_ITEM_PRICES
         01:D62B  AD 40 26   			lda.l	_ptr_SHOP_ITEM_PRICES
         01:D62E  AC 41 26   			ldy.h	_ptr_SHOP_ITEM_PRICES
12309                        		__add.wi	14
         01:D631  18         			clc
         01:D632  69 0E      			adc.l	#14
         01:D634  90 01      			bcc	!+
         01:D636  C8         			iny
         01:D637             	!:
12310                        		__st.wm		__ptr
         01:D637  85 88      			sta.l	__ptr
         01:D639  84 89      			sty.h	__ptr
12311                        		__ld.wp		__ptr
         01:D63B  A0 01      			ldy	#1
         01:D63D  B1 88      			lda	[__ptr], y
         01:D63F  A8         			tay
         01:D640  B2 88      			lda	[__ptr]
12312                        		__st.wmq	_shop_prices + 14
         01:D642  8D 3A 26   			sta.l	_shop_prices + 14
         01:D645  8C 3B 26   			sty.h	_shop_prices + 14
12313                        	
12314                        		.dbg	line,	"include\init.c", 798; shop_prices[8] = *(ptr_SHOP_ITEM_PRICES+8);
12315                        		__ld.wm		_ptr_SHOP_ITEM_PRICES
         01:D648  AD 40 26   			lda.l	_ptr_SHOP_ITEM_PRICES
         01:D64B  AC 41 26   			ldy.h	_ptr_SHOP_ITEM_PRICES
12316                        		__add.wi	16
         01:D64E  18         			clc
         01:D64F  69 10      			adc.l	#16
         01:D651  90 01      			bcc	!+
         01:D653  C8         			iny
         01:D654             	!:
12317                        		__st.wm		__ptr
         01:D654  85 88      			sta.l	__ptr
         01:D656  84 89      			sty.h	__ptr
12318                        		__ld.wp		__ptr
         01:D658  A0 01      			ldy	#1
         01:D65A  B1 88      			lda	[__ptr], y
         01:D65C  A8         			tay
         01:D65D  B2 88      			lda	[__ptr]
12319                        		__st.wmq	_shop_prices + 16
         01:D65F  8D 3C 26   			sta.l	_shop_prices + 16
         01:D662  8C 3D 26   			sty.h	_shop_prices + 16
12320                        	
12321                        		.dbg	line,	"include\init.c", 799; shop_prices[9] = *(ptr_SHOP_ITEM_PRICES+9);
12322                        		__ld.wm		_ptr_SHOP_ITEM_PRICES
         01:D665  AD 40 26   			lda.l	_ptr_SHOP_ITEM_PRICES
         01:D668  AC 41 26   			ldy.h	_ptr_SHOP_ITEM_PRICES
12323                        		__add.wi	18
         01:D66B  18         			clc
         01:D66C  69 12      			adc.l	#18
         01:D66E  90 01      			bcc	!+
         01:D670  C8         			iny
         01:D671             	!:
12324                        		__st.wm		__ptr
         01:D671  85 88      			sta.l	__ptr
         01:D673  84 89      			sty.h	__ptr
12325                        		__ld.wp		__ptr
         01:D675  A0 01      			ldy	#1
         01:D677  B1 88      			lda	[__ptr], y
         01:D679  A8         			tay
         01:D67A  B2 88      			lda	[__ptr]
12326                        		__st.wmq	_shop_prices + 18
         01:D67C  8D 3E 26   			sta.l	_shop_prices + 18
         01:D67F  8C 3F 26   			sty.h	_shop_prices + 18
12327                        	
12328                        		.dbg	line,	"include\init.c", 802; put_number(shop_prices[0],4,2,20);
12329                        		__ld.wm		_shop_prices
         01:D682  AD 2C 26   			lda.l	_shop_prices
         01:D685  AC 2D 26   			ldy.h	_shop_prices
12330                        		__st.wmq	_bx
         01:D688  85 FA      			sta.l	_bx
         01:D68A  84 FB      			sty.h	_bx
12331                        		__st.umiq	4, _cl
         01:D68C  A9 04      			lda.l	#4
         01:D68E  85 FC      			sta	_cl
12332                        		__st.umiq	2, _dil
         01:D690  A9 02      			lda.l	#2
         01:D692  85 F0      			sta	_dil
12333                        		__st.umiq	20, _dih
         01:D694  A9 14      			lda.l	#20
         01:D696  85 F1      			sta	_dih
12334                        		__call		_put_number.4
         01:D698  20 9F FF   			call	_put_number.4
12335                        	
12336                        		.dbg	line,	"include\init.c", 803; put_number(shop_prices[1],4,7,20);
12337                        		__ld.wm		_shop_prices + 2
         01:D69B  AD 2E 26   			lda.l	_shop_prices + 2
         01:D69E  AC 2F 26   			ldy.h	_shop_prices + 2
12338                        		__st.wmq	_bx
         01:D6A1  85 FA      			sta.l	_bx
         01:D6A3  84 FB      			sty.h	_bx
12339                        		__st.umiq	4, _cl
         01:D6A5  A9 04      			lda.l	#4
         01:D6A7  85 FC      			sta	_cl
12340                        		__st.umiq	7, _dil
         01:D6A9  A9 07      			lda.l	#7
         01:D6AB  85 F0      			sta	_dil
12341                        		__st.umiq	20, _dih
         01:D6AD  A9 14      			lda.l	#20
         01:D6AF  85 F1      			sta	_dih
12342                        		__call		_put_number.4
         01:D6B1  20 9F FF   			call	_put_number.4
12343                        	
12344                        		.dbg	line,	"include\init.c", 804; put_number(shop_prices[2],4,12,20);
12345                        		__ld.wm		_shop_prices + 4
         01:D6B4  AD 30 26   			lda.l	_shop_prices + 4
         01:D6B7  AC 31 26   			ldy.h	_shop_prices + 4
12346                        		__st.wmq	_bx
         01:D6BA  85 FA      			sta.l	_bx
         01:D6BC  84 FB      			sty.h	_bx
12347                        		__st.umiq	4, _cl
         01:D6BE  A9 04      			lda.l	#4
         01:D6C0  85 FC      			sta	_cl
12348                        		__st.umiq	12, _dil
         01:D6C2  A9 0C      			lda.l	#12
         01:D6C4  85 F0      			sta	_dil
12349                        		__st.umiq	20, _dih
         01:D6C6  A9 14      			lda.l	#20
         01:D6C8  85 F1      			sta	_dih
12350                        		__call		_put_number.4
         01:D6CA  20 9F FF   			call	_put_number.4
12351                        	
12352                        		.dbg	line,	"include\init.c", 805; put_number(shop_prices[3],4,17,20);
12353                        		__ld.wm		_shop_prices + 6
         01:D6CD  AD 32 26   			lda.l	_shop_prices + 6
         01:D6D0  AC 33 26   			ldy.h	_shop_prices + 6
12354                        		__st.wmq	_bx
         01:D6D3  85 FA      			sta.l	_bx
         01:D6D5  84 FB      			sty.h	_bx
12355                        		__st.umiq	4, _cl
         01:D6D7  A9 04      			lda.l	#4
         01:D6D9  85 FC      			sta	_cl
12356                        		__st.umiq	17, _dil
         01:D6DB  A9 11      			lda.l	#17
         01:D6DD  85 F0      			sta	_dil
12357                        		__st.umiq	20, _dih
         01:D6DF  A9 14      			lda.l	#20
         01:D6E1  85 F1      			sta	_dih
12358                        		__call		_put_number.4
         01:D6E3  20 9F FF   			call	_put_number.4
12359                        	
12360                        		.dbg	line,	"include\init.c", 806; put_number(shop_prices[4],4,22,20);
12361                        		__ld.wm		_shop_prices + 8
         01:D6E6  AD 34 26   			lda.l	_shop_prices + 8
         01:D6E9  AC 35 26   			ldy.h	_shop_prices + 8
12362                        		__st.wmq	_bx
         01:D6EC  85 FA      			sta.l	_bx
         01:D6EE  84 FB      			sty.h	_bx
12363                        		__st.umiq	4, _cl
         01:D6F0  A9 04      			lda.l	#4
         01:D6F2  85 FC      			sta	_cl
12364                        		__st.umiq	22, _dil
         01:D6F4  A9 16      			lda.l	#22
         01:D6F6  85 F0      			sta	_dil
12365                        		__st.umiq	20, _dih
         01:D6F8  A9 14      			lda.l	#20
         01:D6FA  85 F1      			sta	_dih
12366                        		__call		_put_number.4
         01:D6FC  20 9F FF   			call	_put_number.4
12367                        	
12368                        		.dbg	line,	"include\init.c", 808; put_number(shop_prices[5],4,2,23);
12369                        		__ld.wm		_shop_prices + 10
         01:D6FF  AD 36 26   			lda.l	_shop_prices + 10
         01:D702  AC 37 26   			ldy.h	_shop_prices + 10
12370                        		__st.wmq	_bx
         01:D705  85 FA      			sta.l	_bx
         01:D707  84 FB      			sty.h	_bx
12371                        		__st.umiq	4, _cl
         01:D709  A9 04      			lda.l	#4
         01:D70B  85 FC      			sta	_cl
12372                        		__st.umiq	2, _dil
         01:D70D  A9 02      			lda.l	#2
         01:D70F  85 F0      			sta	_dil
12373                        		__st.umiq	23, _dih
         01:D711  A9 17      			lda.l	#23
         01:D713  85 F1      			sta	_dih
12374                        		__call		_put_number.4
         01:D715  20 9F FF   			call	_put_number.4
12375                        	
12376                        		.dbg	line,	"include\init.c", 809; put_number(shop_prices[6],4,7,23);
12377                        		__ld.wm		_shop_prices + 12
         01:D718  AD 38 26   			lda.l	_shop_prices + 12
         01:D71B  AC 39 26   			ldy.h	_shop_prices + 12
12378                        		__st.wmq	_bx
         01:D71E  85 FA      			sta.l	_bx
         01:D720  84 FB      			sty.h	_bx
12379                        		__st.umiq	4, _cl
         01:D722  A9 04      			lda.l	#4
         01:D724  85 FC      			sta	_cl
12380                        		__st.umiq	7, _dil
         01:D726  A9 07      			lda.l	#7
         01:D728  85 F0      			sta	_dil
12381                        		__st.umiq	23, _dih
         01:D72A  A9 17      			lda.l	#23
         01:D72C  85 F1      			sta	_dih
12382                        		__call		_put_number.4
         01:D72E  20 9F FF   			call	_put_number.4
12383                        	
12384                        		.dbg	line,	"include\init.c", 810; put_number(shop_prices[7],4,12,23);
12385                        		__ld.wm		_shop_prices + 14
         01:D731  AD 3A 26   			lda.l	_shop_prices + 14
         01:D734  AC 3B 26   			ldy.h	_shop_prices + 14
12386                        		__st.wmq	_bx
         01:D737  85 FA      			sta.l	_bx
         01:D739  84 FB      			sty.h	_bx
12387                        		__st.umiq	4, _cl
         01:D73B  A9 04      			lda.l	#4
         01:D73D  85 FC      			sta	_cl
12388                        		__st.umiq	12, _dil
         01:D73F  A9 0C      			lda.l	#12
         01:D741  85 F0      			sta	_dil
12389                        		__st.umiq	23, _dih
         01:D743  A9 17      			lda.l	#23
         01:D745  85 F1      			sta	_dih
12390                        		__call		_put_number.4
         01:D747  20 9F FF   			call	_put_number.4
12391                        	
12392                        		.dbg	line,	"include\init.c", 811; put_number(shop_prices[8],4,17,23);
12393                        		__ld.wm		_shop_prices + 16
         01:D74A  AD 3C 26   			lda.l	_shop_prices + 16
         01:D74D  AC 3D 26   			ldy.h	_shop_prices + 16
12394                        		__st.wmq	_bx
         01:D750  85 FA      			sta.l	_bx
         01:D752  84 FB      			sty.h	_bx
12395                        		__st.umiq	4, _cl
         01:D754  A9 04      			lda.l	#4
         01:D756  85 FC      			sta	_cl
12396                        		__st.umiq	17, _dil
         01:D758  A9 11      			lda.l	#17
         01:D75A  85 F0      			sta	_dil
12397                        		__st.umiq	23, _dih
         01:D75C  A9 17      			lda.l	#23
         01:D75E  85 F1      			sta	_dih
12398                        		__call		_put_number.4
         01:D760  20 9F FF   			call	_put_number.4
12399                        	
12400                        		.dbg	line,	"include\init.c", 812; put_number(shop_prices[9],4,22,23);
12401                        		__ld.wm		_shop_prices + 18
         01:D763  AD 3E 26   			lda.l	_shop_prices + 18
         01:D766  AC 3F 26   			ldy.h	_shop_prices + 18
12402                        		__st.wmq	_bx
         01:D769  85 FA      			sta.l	_bx
         01:D76B  84 FB      			sty.h	_bx
12403                        		__st.umiq	4, _cl
         01:D76D  A9 04      			lda.l	#4
         01:D76F  85 FC      			sta	_cl
12404                        		__st.umiq	22, _dil
         01:D771  A9 16      			lda.l	#22
         01:D773  85 F0      			sta	_dil
12405                        		__st.umiq	23, _dih
         01:D775  A9 17      			lda.l	#23
         01:D777  85 F1      			sta	_dih
12406                        		__call		_put_number.4
         01:D779  20 9F FF   			call	_put_number.4
12407                        	
12408                        		.dbg	line,	"include\init.c", 817; //--------------------------------------------------------------------------------------//
12409                        	
12410                        		.dbg	line,	"include\init.c", 818; //                                   LOAD BG PALETTES                                   //
12411                        	
12412                        		.dbg	line,	"include\init.c", 819; //--------------------------------------------------------------------------------------//
12413                        	
12414                        		.dbg	line,	"include\init.c", 821; load_palette( 0, palette_SHOP, 16 );
12415                        		__st.umiq	0, _al
         01:D77C  64 F8      			stz	_al
12416                        		__farptr	_palette_SHOP, _bp_bank, _bp
         01:D77E  A9 E0      			lda.l	#$6000 + ($1FFF & (_palette_SHOP))
         01:D780  85 EC      			sta.l	_bp
         01:D782  A9 65      			lda.h	#$6000 + ($1FFF & (_palette_SHOP))
         01:D784  85 ED      			sta.h	_bp
         01:D786  A9 0E      			lda	#bank(_palette_SHOP)
         01:D788  85 02      			sta	_bp_bank
12417                        		__st.umiq	16, _ah
         01:D78A  A9 10      			lda.l	#16
         01:D78C  85 F9      			sta	_ah
12418                        		__call		_load_palette.3
         01:D78E  20 EB FE   			call	_load_palette.3
12419                        	
12420                        		.dbg	line,	"include\init.c", 826; //**************************************************************************************//
12421                        	
12422                        		.dbg	line,	"include\init.c", 827; //                                                                                      //
12423                        	
12424                        		.dbg	line,	"include\init.c", 828; //                                       SPRITES                                        //
12425                        	
12426                        		.dbg	line,	"include\init.c", 829; //                                                                                      //
12427                        	
12428                        		.dbg	line,	"include\init.c", 830; //**************************************************************************************//
12429                        	
12430                        		.dbg	line,	"include\init.c", 832; //--------------------------------------------------------------------------------------//
12431                        	
12432                        		.dbg	line,	"include\init.c", 833; //                                        CURSOR                                        //
12433                        	
12434                        		.dbg	line,	"include\init.c", 834; //--------------------------------------------------------------------------------------//
12435                        	
12436                        		.dbg	line,	"include\init.c", 836; // LOAD CURSOR TILES //
12437                        	
12438                        		.dbg	line,	"include\init.c", 837; load_vram(0x2000, tiles_SPR_CURSOR , TILES_16);
12439                        		__st.wmiq	8192, _di
         01:D791  64 F0      			stz.l	_di
         01:D793  A9 20      			lda.h	#8192
         01:D795  85 F1      			sta.h	_di
12440                        		__farptr	_tiles_SPR_CURSOR, _bp_bank, _bp
         01:D797  A9 60      			lda.l	#$6000 + ($1FFF & (_tiles_SPR_CURSOR))
         01:D799  85 EC      			sta.l	_bp
         01:D79B  A9 65      			lda.h	#$6000 + ($1FFF & (_tiles_SPR_CURSOR))
         01:D79D  85 ED      			sta.h	_bp
         01:D79F  A9 12      			lda	#bank(_tiles_SPR_CURSOR)
         01:D7A1  85 02      			sta	_bp_bank
12441                        		__st.wmiq	256, _ax
         01:D7A3  64 F8      			stz.l	_ax
         01:D7A5  A9 01      			lda.h	#256
         01:D7A7  85 F9      			sta.h	_ax
12442                        		 _load_vram.3
         01:D7A9  82         			clx				; Offset to PCE VDC.
         01:D7AA  20 63 FF   			call	load_vram_x
12443                        	
12444                        		.dbg	line,	"include\init.c", 840; // SELECT CURSOR SPRITE //
12445                        	
12446                        		.dbg	line,	"include\init.c", 841; spr_set(0);
12447                        		__ld.uiq	0
         01:D7AD  62         			cla
12448                        		__call		_spr_set.1
         01:D7AE  20 DD E7   			call	_spr_set.1
12449                        	
12450                        		.dbg	line,	"include\init.c", 842; spr_hide();
12451                        		__call		_spr_hide
         01:D7B1  20 F8 E7   			call	_spr_hide
12452                        	
12453                        		.dbg	line,	"include\init.c", 845; //spr_x(24);
12454                        	
12455                        		.dbg	line,	"include\init.c", 846; //spr_y(144);
12456                        	
12457                        		.dbg	line,	"include\init.c", 848; // SET TILES DATA FOR THE CURSOR //
12458                        	
12459                        		.dbg	line,	"include\init.c", 849; spr_pattern(0x2000);
12460                        		__ld.wi		8192
         01:D7B4  62         			cla
         01:D7B5  A0 20      			ldy.h	#8192
12461                        		__call		_spr_pattern.1
         01:D7B7  20 26 E8   			call	_spr_pattern.1
12462                        	
12463                        		.dbg	line,	"include\init.c", 852; spr_ctrl(FLIP_MAS|SIZE_MAS, NO_FLIP|SZ_32x32);
12464                        		__st.umiq	185, _al
         01:D7BA  A9 B9      			lda.l	#185
         01:D7BC  85 F8      			sta	_al
12465                        		__ld.uiq	17
         01:D7BE  A9 11      			lda	#17
12466                        		__call		_spr_ctrl.2
         01:D7C0  20 3C E8   			call	_spr_ctrl.2
12467                        	
12468                        		.dbg	line,	"include\init.c", 855; spr_pal(16);
12469                        		__ld.uiq	16
         01:D7C3  A9 10      			lda	#16
12470                        		__call		_spr_pal.1
         01:D7C5  20 4D E8   			call	_spr_pal.1
12471                        	
12472                        		.dbg	line,	"include\init.c", 856; spr_pri(TRUE);
12473                        		__ld.uiq	1
         01:D7C8  A9 01      			lda	#1
12474                        		__call		_spr_pri.1
         01:D7CA  20 5C E8   			call	_spr_pri.1
12475                        	
12476                        		.dbg	line,	"include\init.c", 859; // UPDATE PCE SAT //
12477                        	
12478                        		.dbg	line,	"include\init.c", 860; satb_update();
12479                        		__call		_satb_update
         01:D7CD  20 91 FE   			call	_satb_update
12480                        	
12481                        		.dbg	line,	"include\init.c", 864; //--------------------------------------------------------------------------------------//
12482                        	
12483                        		.dbg	line,	"include\init.c", 865; //                                LOAD SPRITES PALETTES                                 //
12484                        	
12485                        		.dbg	line,	"include\init.c", 866; //--------------------------------------------------------------------------------------//
12486                        	
12487                        		.dbg	line,	"include\init.c", 868; load_palette( 16, palette_objects_2, 1 );
12488                        		__st.umiq	16, _al
         01:D7D0  A9 10      			lda.l	#16
         01:D7D2  85 F8      			sta	_al
12489                        		__farptr	_palette_objects_2, _bp_bank, _bp
         01:D7D4  A9 60      			lda.l	#$6000 + ($1FFF & (_palette_objects_2))
         01:D7D6  85 EC      			sta.l	_bp
         01:D7D8  A9 77      			lda.h	#$6000 + ($1FFF & (_palette_objects_2))
         01:D7DA  85 ED      			sta.h	_bp
         01:D7DC  A9 11      			lda	#bank(_palette_objects_2)
         01:D7DE  85 02      			sta	_bp_bank
12490                        		__st.umiq	1, _ah
         01:D7E0  A9 01      			lda.l	#1
         01:D7E2  85 F9      			sta	_ah
12491                        		__call		_load_palette.3
         01:D7E4  20 EB FE   			call	_load_palette.3
12492                        	
12493                        		.dbg	line,	"include\init.c", 872; // VSYNC //
12494                        	
12495                        		.dbg	line,	"include\init.c", 873; vsync();
12496                        		__call		_vsync
         01:D7E7  20 09 E3   			call	_vsync
12497                        	
12498                        		.dbg	line,	"include\init.c", 875; // ENABLE DISPLAY //
12499                        	
12500                        		.dbg	line,	"include\init.c", 876; disp_on();
12501                        		__call		_disp_on
         01:D7EA  20 16 E4   			call	_disp_on
12502                        	
12503                        		.dbg	line,	"include\init.c", 877; }
12504    01:D7ED             	.LL522:
12505                        		__return	0
         01:D7ED  4C EF FF   			jmp	leave_proc
12506                        		.dbg	clear
12507                        		.endp
12508               6760     		.data
12509               230E     		.bss
12510    F8:230E             	__init_SHOP_loc:
12511    F8:230E             			ds	2
12512    F8:2310             	__init_SHOP_end:
12513               E309     		.code
12514                        		.pceas
12515                        	
12516                        		.dbg	line,	"main.c", 31; main()
12517                        		.dbg	line,	"main.c", 32; {
12518                        	;***********************
12519                        	;***********************
12520                        	
12521                        		.hucc
12522    02:C806             		.proc		_main
12523                        		__enter		_main
12524                        	
12525                        		.dbg	line,	"main.c", 33; if(!sgx_detect())
12526                        		 _sgx_detect
         02:C806  AD E8 22   			lda	sgx_detected
         02:C809  C2         			cly
12527                        		__not.wr
         02:C80A  84 00      			sty	__temp
         02:C80C  05 00      			ora	__temp
         02:C80E  18         			clc
         02:C80F  D0 01      			bne	!+
         02:C811  38         			sec
         02:C812             	!:
12528                        		__bfalse	.LL529
         02:C812  90 14      			bcc	.LL529
12529                        	
12530                        		.dbg	line,	"main.c", 34; {
12531                        	
12532                        		.dbg	line,	"main.c", 35; put_string("Halt: SGX hardware not found", 2, 13);
12533                        		__ld.wi		__const1+0
         02:C814  62         			cla
         02:C815  A0 60      			ldy.h	#__const1+0
12534                        		__st.wmq	_bp
         02:C817  85 EC      			sta.l	_bp
         02:C819  84 ED      			sty.h	_bp
12535                        		__st.umiq	2, _dil
         02:C81B  A9 02      			lda.l	#2
         02:C81D  85 F0      			sta	_dil
12536                        		__st.umiq	13, _dih
         02:C81F  A9 0D      			lda.l	#13
         02:C821  85 F1      			sta	_dih
12537                        		__call		_put_string.3
         02:C823  20 68 E6   			call	_put_string.3
12538                        	
12539                        		.dbg	line,	"main.c", 37; for(;;)
12540    02:C826             	.LL530	.alias		.LL532
12541    02:C826             	.LL531	.alias		.LL532
12542    02:C826             	.LL532:
12543                        	
12544                        		.dbg	line,	"main.c", 38; {
12545                        	
12546                        		.dbg	line,	"main.c", 39; // INFINITE LOOP //
12547                        	
12548                        		.dbg	line,	"main.c", 40; }
12549                        		__bra		.LL532
         02:C826  80 FE      			bra	.LL532
12550    02:C828             	.LL533:
12551                        	
12552                        		.dbg	line,	"main.c", 41; }
12553                        	
12554                        		.dbg	line,	"main.c", 46; init_SYSTEM();
12555    02:C828             	.LL529:
12556                        		__call		_init_SYSTEM
         02:C828  20 73 FE   			call	_init_SYSTEM
12557                        	
12558                        		.dbg	line,	"main.c", 47; 
12559                        	
12560                        		.dbg	line,	"main.c", 48; 
12561                        	
12562                        		.dbg	line,	"main.c", 49; init_VARIABLES();
12563                        		__call		_init_VARIABLES
         02:C82B  20 69 FE   			call	_init_VARIABLES
12564                        	
12565                        		.dbg	line,	"main.c", 52; init_PLAYER();
12566                        		__call		_init_PLAYER
         02:C82E  20 5F FE   			call	_init_PLAYER
12567                        	
12568                        		.dbg	line,	"main.c", 57; //**************************************************************************************//
12569                        	
12570                        		.dbg	line,	"main.c", 58; //                                                                                      //
12571                        	
12572                        		.dbg	line,	"main.c", 59; //                                         MAIN                                         //
12573                        	
12574                        		.dbg	line,	"main.c", 60; //                                                                                      //
12575                        	
12576                        		.dbg	line,	"main.c", 61; //**************************************************************************************//
12577                        	
12578                        		.dbg	line,	"main.c", 62; for(;;)
12579    02:C831             	.LL534:
12580    02:C831             	.LL535:
12581    02:C831             	.LL536:
12582                        	
12583                        		.dbg	line,	"main.c", 63; {
12584                        	
12585                        		.dbg	line,	"main.c", 64; switch(sequence_id)
12586                        		__ld.umq	_sequence_id
         02:C831  AD 10 23   			lda	_sequence_id
12587                        		__bra		.LL538
         02:C834  4C BA C9   			bra	.LL538
12588                        	
12589                        		.dbg	line,	"main.c", 65; {
12590                        	
12591                        		.dbg	line,	"main.c", 66; //-----------------------------------------------------------------------------//
12592                        	
12593                        		.dbg	line,	"main.c", 67; //                                    TITLE                                    //
12594                        	
12595                        		.dbg	line,	"main.c", 68; //-----------------------------------------------------------------------------//
12596                        	
12597                        		.dbg	line,	"main.c", 69; case SEQUENCE_TITLE:
12598    02:C837             	.LL540:
12599                        		__case		0
12600                        	
12601                        		.dbg	line,	"main.c", 70; break;
12602                        		__bra		.LL539
         02:C837  80 F8      			bra	.LL539
12603                        	
12604                        		.dbg	line,	"main.c", 73; //-----------------------------------------------------------------------------//
12605                        	
12606                        		.dbg	line,	"main.c", 74; //                                    INTRO                                    //
12607                        	
12608                        		.dbg	line,	"main.c", 75; //-----------------------------------------------------------------------------//
12609                        	
12610                        		.dbg	line,	"main.c", 76; case SEQUENCE_INTRO:
12611    02:C839             	.LL541:
12612                        		__case		1
12613                        	
12614                        		.dbg	line,	"main.c", 77; break;
12615                        		__bra		.LL539
         02:C839  80 F6      			bra	.LL539
12616                        	
12617                        		.dbg	line,	"main.c", 80; //-----------------------------------------------------------------------------//
12618                        	
12619                        		.dbg	line,	"main.c", 81; //                                    GAME                                     //
12620                        	
12621                        		.dbg	line,	"main.c", 82; //-----------------------------------------------------------------------------//
12622                        	
12623                        		.dbg	line,	"main.c", 83; case SEQUENCE_GAME:
12624    02:C83B             	.LL542:
12625                        		__case		2
12626                        	
12627                        		.dbg	line,	"main.c", 84; if(sequence_loaded == FALSE)
12628                        		__not.um	_sequence_loaded
         02:C83B  AD 11 23   			lda	_sequence_loaded
         02:C83E  18         			clc
         02:C83F  D0 01      			bne	!+
         02:C841  38         			sec
         02:C842             	!:
12629                        		__bfalse	.LL543
         02:C842  90 0A      			bcc	.LL543
12630                        	
12631                        		.dbg	line,	"main.c", 85; {
12632                        	
12633                        		.dbg	line,	"main.c", 86; init_LEVEL();
12634                        		__call		_init_LEVEL
         02:C844  20 55 FE   			call	_init_LEVEL
12635                        	
12636                        		.dbg	line,	"main.c", 88; sequence_loaded = TRUE;
12637                        		__st.umiq	1, _sequence_loaded
         02:C847  A9 01      			lda.l	#1
         02:C849  8D 11 23   			sta	_sequence_loaded
12638                        	
12639                        		.dbg	line,	"main.c", 89; }
12640                        	
12641                        		.dbg	line,	"main.c", 92; else
12642                        		__bra		.LL544
         02:C84C  80 E3      			bra	.LL544
12643    02:C84E             	.LL543:
12644                        	
12645                        		.dbg	line,	"main.c", 93; {
12646                        	
12647                        		.dbg	line,	"main.c", 94; switch(level_id)
12648                        		__ld.umq	_level_id
         02:C84E  AD 12 23   			lda	_level_id
12649                        		__bra		.LL545
         02:C851  80 3A      			bra	.LL545
12650                        	
12651                        		.dbg	line,	"main.c", 95; {
12652                        	
12653                        		.dbg	line,	"main.c", 96; case 1:
12654    02:C853             	.LL547:
12655                        		__case		1
12656                        	
12657                        		.dbg	line,	"main.c", 97; vsync();
12658                        		__call		_vsync
         02:C853  20 09 E3   			call	_vsync
12659                        	
12660                        		.dbg	line,	"main.c", 99; update_PLAYER();
12661                        		__call		_update_PLAYER
         02:C856  20 4B FE   			call	_update_PLAYER
12662                        	
12663                        		.dbg	line,	"main.c", 100; 
12664                        	
12665                        		.dbg	line,	"main.c", 101; //put_number(player_naked,1,0,0);
12666                        	
12667                        		.dbg	line,	"main.c", 103; joypad_DIR();
12668                        		__call		_joypad_DIR
         02:C859  20 41 FE   			call	_joypad_DIR
12669                        	
12670                        		.dbg	line,	"main.c", 104; joypad_BUTTONS();
12671                        		__call		_joypad_BUTTONS
         02:C85C  20 37 FE   			call	_joypad_BUTTONS
12672                        	
12673                        		.dbg	line,	"main.c", 106; scroll_object();
12674                        		__call		_scroll_object
         02:C85F  20 CD FE   			call	_scroll_object
12675                        	
12676                        		.dbg	line,	"main.c", 107; scroll_chest();
12677                        		__call		_scroll_chest
         02:C862  20 AF FE   			call	_scroll_chest
12678                        	
12679                        		.dbg	line,	"main.c", 108; scroll_npc();
12680                        		__call		_scroll_npc
         02:C865  20 2D FE   			call	_scroll_npc
12681                        	
12682                        		.dbg	line,	"main.c", 110; check_OBJECT();
12683                        		__call		_check_OBJECT
         02:C868  20 23 FE   			call	_check_OBJECT
12684                        	
12685                        		.dbg	line,	"main.c", 111; check_NPC();
12686                        		__call		_check_NPC
         02:C86B  20 19 FE   			call	_check_NPC
12687                        	
12688                        		.dbg	line,	"main.c", 113; display_TIME_LEVEL();
12689                        		__call		_display_TIME_LEVEL
         02:C86E  20 09 FF   			call	_display_TIME_LEVEL
12690                        	
12691                        		.dbg	line,	"main.c", 115; satb_update();
12692                        		__call		_satb_update
         02:C871  20 91 FE   			call	_satb_update
12693                        	
12694                        		.dbg	line,	"main.c", 117; scroll_BG();
12695                        		__call		_scroll_BG
         02:C874  20 0F FE   			call	_scroll_BG
12696                        	
12697                        		.dbg	line,	"main.c", 118; break;
12698                        		__bra		.LL546
         02:C877  80 B8      			bra	.LL546
12699                        	
12700                        		.dbg	line,	"main.c", 121; case 2:
12701    02:C879             	.LL548:
12702                        		__case		2
12703                        	
12704                        		.dbg	line,	"main.c", 122; vsync();
12705                        		__call		_vsync
         02:C879  20 09 E3   			call	_vsync
12706                        	
12707                        		.dbg	line,	"main.c", 123; break;
12708                        		__bra		.LL546
         02:C87C  80 B3      			bra	.LL546
12709                        	
12710                        		.dbg	line,	"main.c", 126; case 3:
12711    02:C87E             	.LL549:
12712                        		__case		3
12713                        	
12714                        		.dbg	line,	"main.c", 127; vsync();
12715                        		__call		_vsync
         02:C87E  20 09 E3   			call	_vsync
12716                        	
12717                        		.dbg	line,	"main.c", 128; break;
12718                        		__bra		.LL546
         02:C881  80 AE      			bra	.LL546
12719                        	
12720                        		.dbg	line,	"main.c", 131; case 4:
12721    02:C883             	.LL550:
12722                        		__case		4
12723                        	
12724                        		.dbg	line,	"main.c", 132; vsync();
12725                        		__call		_vsync
         02:C883  20 09 E3   			call	_vsync
12726                        	
12727                        		.dbg	line,	"main.c", 133; break;
12728                        		__bra		.LL546
         02:C886  80 A9      			bra	.LL546
12729                        	
12730                        		.dbg	line,	"main.c", 136; case 5:
12731    02:C888             	.LL551:
12732                        		__case		5
12733                        	
12734                        		.dbg	line,	"main.c", 137; vsync();
12735                        		__call		_vsync
         02:C888  20 09 E3   			call	_vsync
12736                        	
12737                        		.dbg	line,	"main.c", 138; break;
12738                        		__bra		.LL546
         02:C88B  80 A4      			bra	.LL546
12739                        	
12740                        		.dbg	line,	"main.c", 140; }
12741    02:C88D             	.LL545:
12742                        		__switch_r.ur	0, 5
         02:C88D  C9 06      			cmp	#(5 - 0) + 1
         02:C88F  90 02      			bcc	!found+
         02:C891  A9 06      	!default:	lda	#(5 - 0) + 1
         02:C893  0A         	!found:		asl	a
         02:C894  AA         			tax
         02:C895  7C 98 C8   			jmp	[!table+, x]
12743                        	
12744    02:C898  31 C8      	!table:		dw	.LL546, .LL547, .LL548, .LL549, .LL550, .LL551
         02:C89A  53 C8       
         02:C89C  79 C8       
         02:C89E  7E C8       
         02:C8A0  83 C8       
         02:C8A2  88 C8       
12745    02:C8A4  31 C8      			dw	.LL546
12746    02:C8A6             	.LL546	.alias		.LL539
12747                        	
12748                        		.dbg	line,	"main.c", 141; }
12749    02:C8A6             	.LL544	.alias		.LL539
12750                        	
12751                        		.dbg	line,	"main.c", 143; break;
12752                        		__bra		.LL539
         02:C8A6  80 89      			bra	.LL539
12753                        	
12754                        		.dbg	line,	"main.c", 146; //-----------------------------------------------------------------------------//
12755                        	
12756                        		.dbg	line,	"main.c", 147; //                                     NPC                                     //
12757                        	
12758                        		.dbg	line,	"main.c", 148; //-----------------------------------------------------------------------------//
12759                        	
12760                        		.dbg	line,	"main.c", 149; case SEQUENCE_NPC:
12761    02:C8A8             	.LL552:
12762                        		__case		3
12763                        	
12764                        		.dbg	line,	"main.c", 150; break;
12765                        		__bra		.LL539
         02:C8A8  80 87      			bra	.LL539
12766                        	
12767                        		.dbg	line,	"main.c", 153; //-----------------------------------------------------------------------------//
12768                        	
12769                        		.dbg	line,	"main.c", 154; //                                    SHOP                                     //
12770                        	
12771                        		.dbg	line,	"main.c", 155; //-----------------------------------------------------------------------------//
12772                        	
12773                        		.dbg	line,	"main.c", 156; case SEQUENCE_SHOP:
12774    02:C8AA             	.LL553:
12775                        		__case		4
12776                        	
12777                        		.dbg	line,	"main.c", 157; if(sequence_loaded == FALSE)
12778                        		__not.um	_sequence_loaded
         02:C8AA  AD 11 23   			lda	_sequence_loaded
         02:C8AD  18         			clc
         02:C8AE  D0 01      			bne	!+
         02:C8B0  38         			sec
         02:C8B1             	!:
12779                        		__bfalse	.LL554
         02:C8B1  90 0B      			bcc	.LL554
12780                        	
12781                        		.dbg	line,	"main.c", 158; {
12782                        	
12783                        		.dbg	line,	"main.c", 159; init_SHOP();
12784                        		__call		_init_SHOP
         02:C8B3  20 05 FE   			call	_init_SHOP
12785                        	
12786                        		.dbg	line,	"main.c", 161; sequence_loaded = TRUE;
12787                        		__st.umiq	1, _sequence_loaded
         02:C8B6  A9 01      			lda.l	#1
         02:C8B8  8D 11 23   			sta	_sequence_loaded
12788                        	
12789                        		.dbg	line,	"main.c", 162; }
12790                        	
12791                        		.dbg	line,	"main.c", 163; 
12792                        	
12793                        		.dbg	line,	"main.c", 164; else
12794                        		__bra		.LL555
         02:C8BB  4C 31 C8   			bra	.LL555
12795    02:C8BE             	.LL554:
12796                        	
12797                        		.dbg	line,	"main.c", 165; {
12798                        	
12799                        		.dbg	line,	"main.c", 166; switch(shop_phase)
12800                        		__ld.umq	_shop_phase
         02:C8BE  AD CC 23   			lda	_shop_phase
12801                        		__bra		.LL556
         02:C8C1  4C A4 C9   			bra	.LL556
12802                        	
12803                        		.dbg	line,	"main.c", 167; {
12804                        	
12805                        		.dbg	line,	"main.c", 168; case SHOP_PHASE_ENTER:
12806    02:C8C4             	.LL558:
12807                        		__case		0
12808                        	
12809                        		.dbg	line,	"main.c", 169; vsync();
12810                        		__call		_vsync
         02:C8C4  20 09 E3   			call	_vsync
12811                        	
12812                        		.dbg	line,	"main.c", 171; if(shop_counter == 0)
12813                        		__not.um	_shop_counter
         02:C8C7  AD CD 23   			lda	_shop_counter
         02:C8CA  18         			clc
         02:C8CB  D0 01      			bne	!+
         02:C8CD  38         			sec
         02:C8CE             	!:
12814                        		__bfalse	.LL559
         02:C8CE  90 28      			bcc	.LL559
12815                        	
12816                        		.dbg	line,	"main.c", 172; {
12817                        	
12818                        		.dbg	line,	"main.c", 173; put_string("Maybe, i can sell you" ,  2 , 15);
12819                        		__ld.wi		__const1+29
         02:C8D0  A9 1D      			lda.l	#__const1+29
         02:C8D2  A0 60      			ldy.h	#__const1+29
12820                        		__st.wmq	_bp
         02:C8D4  85 EC      			sta.l	_bp
         02:C8D6  84 ED      			sty.h	_bp
12821                        		__st.umiq	2, _dil
         02:C8D8  A9 02      			lda.l	#2
         02:C8DA  85 F0      			sta	_dil
12822                        		__st.umiq	15, _dih
         02:C8DC  A9 0F      			lda.l	#15
         02:C8DE  85 F1      			sta	_dih
12823                        		__call		_put_string.3
         02:C8E0  20 68 E6   			call	_put_string.3
12824                        	
12825                        		.dbg	line,	"main.c", 174; put_string("something..." , 18 , 16);
12826                        		__ld.wi		__const1+51
         02:C8E3  A9 33      			lda.l	#__const1+51
         02:C8E5  A0 60      			ldy.h	#__const1+51
12827                        		__st.wmq	_bp
         02:C8E7  85 EC      			sta.l	_bp
         02:C8E9  84 ED      			sty.h	_bp
12828                        		__st.umiq	18, _dil
         02:C8EB  A9 12      			lda.l	#18
         02:C8ED  85 F0      			sta	_dil
12829                        		__st.umiq	16, _dih
         02:C8EF  A9 10      			lda.l	#16
         02:C8F1  85 F1      			sta	_dih
12830                        		__call		_put_string.3
         02:C8F3  20 68 E6   			call	_put_string.3
12831                        	
12832                        		.dbg	line,	"main.c", 175; }
12833                        	
12834                        		.dbg	line,	"main.c", 177; else if(shop_counter == 120)
12835                        		__bra		.LL560
         02:C8F6  80 44      			bra	.LL560
12836    02:C8F8             	.LL559:
12837                        		__ld.umq	_shop_counter
         02:C8F8  AD CD 23   			lda	_shop_counter
12838                        		__equ_b.uiq	120
         02:C8FB  C9 78      			cmp	#120
         02:C8FD  F0 01      			beq	!+
         02:C8FF  18         			clc
         02:C900             	!:
12839                        		__bfalse	.LL561
         02:C900  90 3A      			bcc	.LL561
12840                        	
12841                        		.dbg	line,	"main.c", 178; {
12842                        	
12843                        		.dbg	line,	"main.c", 179; put_string("                     " ,  2 , 15);
12844                        		__ld.wi		__const1+64
         02:C902  A9 40      			lda.l	#__const1+64
         02:C904  A0 60      			ldy.h	#__const1+64
12845                        		__st.wmq	_bp
         02:C906  85 EC      			sta.l	_bp
         02:C908  84 ED      			sty.h	_bp
12846                        		__st.umiq	2, _dil
         02:C90A  A9 02      			lda.l	#2
         02:C90C  85 F0      			sta	_dil
12847                        		__st.umiq	15, _dih
         02:C90E  A9 0F      			lda.l	#15
         02:C910  85 F1      			sta	_dih
12848                        		__call		_put_string.3
         02:C912  20 68 E6   			call	_put_string.3
12849                        	
12850                        		.dbg	line,	"main.c", 180; put_string("            " , 18 , 16);
12851                        		__ld.wi		__const1+86
         02:C915  A9 56      			lda.l	#__const1+86
         02:C917  A0 60      			ldy.h	#__const1+86
12852                        		__st.wmq	_bp
         02:C919  85 EC      			sta.l	_bp
         02:C91B  84 ED      			sty.h	_bp
12853                        		__st.umiq	18, _dil
         02:C91D  A9 12      			lda.l	#18
         02:C91F  85 F0      			sta	_dil
12854                        		__st.umiq	16, _dih
         02:C921  A9 10      			lda.l	#16
         02:C923  85 F1      			sta	_dih
12855                        		__call		_put_string.3
         02:C925  20 68 E6   			call	_put_string.3
12856                        	
12857                        		.dbg	line,	"main.c", 182; spr_x(24);
12858                        		__ld.wi		24
         02:C928  A9 18      			lda.l	#24
         02:C92A  C2         			cly
12859                        		__call		_spr_x.1
         02:C92B  20 0A E8   			call	_spr_x.1
12860                        	
12861                        		.dbg	line,	"main.c", 183; spr_y(144);
12862                        		__ld.wi		144
         02:C92E  A9 90      			lda.l	#144
         02:C930  C2         			cly
12863                        		__call		_spr_y.1
         02:C931  20 19 E8   			call	_spr_y.1
12864                        	
12865                        		.dbg	line,	"main.c", 184; satb_update();
12866                        		__call		_satb_update
         02:C934  20 91 FE   			call	_satb_update
12867                        	
12868                        		.dbg	line,	"main.c", 186; shop_phase = SHOP_PHASE_BUY;
12869                        		__st.umiq	1, _shop_phase
         02:C937  A9 01      			lda.l	#1
         02:C939  8D CC 23   			sta	_shop_phase
12870                        	
12871                        		.dbg	line,	"main.c", 187; }
12872                        	
12873                        		.dbg	line,	"main.c", 189; shop_counter++;
12874    02:C93C             	.LL561:
12875    02:C93C             	.LL560:
12876                        		__inc.umq	_shop_counter
         02:C93C  EE CD 23   			inc	_shop_counter
12877                        	
12878                        		.dbg	line,	"main.c", 191; break;
12879                        		__bra		.LL557
         02:C93F  4C 31 C8   			bra	.LL557
12880                        	
12881                        		.dbg	line,	"main.c", 192; 
12882                        	
12883                        		.dbg	line,	"main.c", 194; case SHOP_PHASE_BUY:
12884    02:C942             	.LL562:
12885                        		__case		1
12886                        	
12887                        		.dbg	line,	"main.c", 195; vsync();
12888                        		__call		_vsync
         02:C942  20 09 E3   			call	_vsync
12889                        	
12890                        		.dbg	line,	"main.c", 197; joypad_BUTTONS_SHOP();
12891                        		__call		_joypad_BUTTONS_SHOP
         02:C945  20 FB FD   			call	_joypad_BUTTONS_SHOP
12892                        	
12893                        		.dbg	line,	"main.c", 198; display_TIME_SHOP();
12894                        		__call		_display_TIME_SHOP
         02:C948  20 F1 FD   			call	_display_TIME_SHOP
12895                        	
12896                        		.dbg	line,	"main.c", 199; satb_update();
12897                        		__call		_satb_update
         02:C94B  20 91 FE   			call	_satb_update
12898                        	
12899                        		.dbg	line,	"main.c", 201; break;
12900                        		__bra		.LL557
         02:C94E  4C 31 C8   			bra	.LL557
12901                        	
12902                        		.dbg	line,	"main.c", 204; case SHOP_PHASE_EXIT:
12903    02:C951             	.LL563:
12904                        		__case		2
12905                        	
12906                        		.dbg	line,	"main.c", 205; vsync();
12907                        		__call		_vsync
         02:C951  20 09 E3   			call	_vsync
12908                        	
12909                        		.dbg	line,	"main.c", 207; if(shop_counter == 0)
12910                        		__not.um	_shop_counter
         02:C954  AD CD 23   			lda	_shop_counter
         02:C957  18         			clc
         02:C958  D0 01      			bne	!+
         02:C95A  38         			sec
         02:C95B             	!:
12911                        		__bfalse	.LL564
         02:C95B  90 1F      			bcc	.LL564
12912                        	
12913                        		.dbg	line,	"main.c", 208; {
12914                        	
12915                        		.dbg	line,	"main.c", 209; put_string("GOOD LUCK!" , 11 , 16);
12916                        		__ld.wi		__const1+99
         02:C95D  A9 63      			lda.l	#__const1+99
         02:C95F  A0 60      			ldy.h	#__const1+99
12917                        		__st.wmq	_bp
         02:C961  85 EC      			sta.l	_bp
         02:C963  84 ED      			sty.h	_bp
12918                        		__st.umiq	11, _dil
         02:C965  A9 0B      			lda.l	#11
         02:C967  85 F0      			sta	_dil
12919                        		__st.umiq	16, _dih
         02:C969  A9 10      			lda.l	#16
         02:C96B  85 F1      			sta	_dih
12920                        		__call		_put_string.3
         02:C96D  20 68 E6   			call	_put_string.3
12921                        	
12922                        		.dbg	line,	"main.c", 211; // HIDE CURSOR //
12923                        	
12924                        		.dbg	line,	"main.c", 212; spr_set(0);
12925                        		__ld.uiq	0
         02:C970  62         			cla
12926                        		__call		_spr_set.1
         02:C971  20 DD E7   			call	_spr_set.1
12927                        	
12928                        		.dbg	line,	"main.c", 213; spr_hide();
12929                        		__call		_spr_hide
         02:C974  20 F8 E7   			call	_spr_hide
12930                        	
12931                        		.dbg	line,	"main.c", 214; satb_update();
12932                        		__call		_satb_update
         02:C977  20 91 FE   			call	_satb_update
12933                        	
12934                        		.dbg	line,	"main.c", 215; }
12935                        	
12936                        		.dbg	line,	"main.c", 217; else if(shop_counter == 120)
12937                        		__bra		.LL565
         02:C97A  80 22      			bra	.LL565
12938    02:C97C             	.LL564:
12939                        		__ld.umq	_shop_counter
         02:C97C  AD CD 23   			lda	_shop_counter
12940                        		__equ_b.uiq	120
         02:C97F  C9 78      			cmp	#120
         02:C981  F0 01      			beq	!+
         02:C983  18         			clc
         02:C984             	!:
12941                        		__bfalse	.LL566
         02:C984  90 18      			bcc	.LL566
12942                        	
12943                        		.dbg	line,	"main.c", 218; {
12944                        	
12945                        		.dbg	line,	"main.c", 219; disp_off();
12946                        		__call		_disp_off
         02:C986  20 29 E4   			call	_disp_off
12947                        	
12948                        		.dbg	line,	"main.c", 221; // REINIT PLAYER //
12949                        	
12950                        		.dbg	line,	"main.c", 222; init_PLAYER();
12951                        		__call		_init_PLAYER
         02:C989  20 5F FE   			call	_init_PLAYER
12952                        	
12953                        		.dbg	line,	"main.c", 224; shop_phase = SHOP_PHASE_EXIT;
12954                        		__st.umiq	2, _shop_phase
         02:C98C  A9 02      			lda.l	#2
         02:C98E  8D CC 23   			sta	_shop_phase
12955                        	
12956                        		.dbg	line,	"main.c", 225; respawn = RESPAWN_SHOP;
12957                        		__st.umiq	2, _respawn
         02:C991  A9 02      			lda.l	#2
         02:C993  8D 13 23   			sta	_respawn
12958                        	
12959                        		.dbg	line,	"main.c", 226; sequence_loaded = FALSE;
12960                        		__st.umiq	0, _sequence_loaded
         02:C996  9C 11 23   			stz	_sequence_loaded
12961                        	
12962                        		.dbg	line,	"main.c", 227; sequence_id = SEQUENCE_GAME;
12963                        		__st.umiq	2, _sequence_id
         02:C999  A9 02      			lda.l	#2
         02:C99B  8D 10 23   			sta	_sequence_id
12964                        	
12965                        		.dbg	line,	"main.c", 228; }
12966                        	
12967                        		.dbg	line,	"main.c", 230; shop_counter++;
12968    02:C99E             	.LL566:
12969    02:C99E             	.LL565:
12970                        		__inc.umq	_shop_counter
         02:C99E  EE CD 23   			inc	_shop_counter
12971                        	
12972                        		.dbg	line,	"main.c", 232; break;
12973                        		__bra		.LL557
         02:C9A1  4C 31 C8   			bra	.LL557
12974                        	
12975                        		.dbg	line,	"main.c", 233; }
12976    02:C9A4             	.LL556:
12977                        		__switch_r.ur	0, 2
         02:C9A4  C9 03      			cmp	#(2 - 0) + 1
         02:C9A6  90 02      			bcc	!found+
         02:C9A8  A9 03      	!default:	lda	#(2 - 0) + 1
         02:C9AA  0A         	!found:		asl	a
         02:C9AB  AA         			tax
         02:C9AC  7C AF C9   			jmp	[!table+, x]
12978                        	
12979    02:C9AF  C4 C8      	!table:		dw	.LL558, .LL562, .LL563
         02:C9B1  42 C9       
         02:C9B3  51 C9       
12980    02:C9B5  31 C8      			dw	.LL557
12981    02:C9B7             	.LL557	.alias		.LL539
12982                        	
12983                        		.dbg	line,	"main.c", 234; }
12984    02:C9B7             	.LL555	.alias		.LL539
12985                        	
12986                        		.dbg	line,	"main.c", 236; break;
12987                        		__bra		.LL539
         02:C9B7  4C 31 C8   			bra	.LL539
12988                        	
12989                        		.dbg	line,	"main.c", 237; }
12990    02:C9BA             	.LL538:
12991                        		__switch_r.ur	0, 4
         02:C9BA  C9 05      			cmp	#(4 - 0) + 1
         02:C9BC  90 02      			bcc	!found+
         02:C9BE  A9 05      	!default:	lda	#(4 - 0) + 1
         02:C9C0  0A         	!found:		asl	a
         02:C9C1  AA         			tax
         02:C9C2  7C C5 C9   			jmp	[!table+, x]
12992                        	
12993    02:C9C5  37 C8      	!table:		dw	.LL540, .LL541, .LL542, .LL552, .LL553
         02:C9C7  39 C8       
         02:C9C9  3B C8       
         02:C9CB  A8 C8       
         02:C9CD  AA C8       
12994    02:C9CF  31 C8      			dw	.LL539
12995    02:C9D1             	.LL539	.alias		.LL536
12996                        	
12997                        		.dbg	line,	"main.c", 238; }
12998                        		__bra		.LL536
         02:C9D1  4C 31 C8   			bra	.LL536
12999    02:C9D4             	.LL537:
13000                        	
13001                        		.dbg	line,	"main.c", 239; }
13002    02:C9D4             	.LL528:
13003                        		__return	1
         02:C9D4  AA         			tax
         02:C9D5  4C EF FF   			jmp	leave_proc
13004                        		.dbg	clear
13005                        		.endp
13006                        		.pceas
13007                        	
13008                        		.dbg	clear
13009               6000     		.rodata
13010    01:6000             	__const1:
13011    01:6000  48 61 6C 74			db	'H','a','l','t',':',' ','S','G'
         01:6004  3A 20 53 47 
13012    01:6008  58 20 68 61			db	'X',' ','h','a','r','d','w','a'
         01:600C  72 64 77 61 
13013    01:6010  72 65 20 6E			db	'r','e',' ','n','o','t',' ','f'
         01:6014  6F 74 20 66 
13014    01:6018  6F 75 6E 64			db	'o','u','n','d',$00,'M','a','y'
         01:601C  00 4D 61 79 
13015    01:6020  62 65 2C 20			db	'b','e',',',' ','i',' ','c','a'
         01:6024  69 20 63 61 
13016    01:6028  6E 20 73 65			db	'n',' ','s','e','l','l',' ','y'
         01:602C  6C 6C 20 79 
13017    01:6030  6F 75 00 73			db	'o','u',$00,'s','o','m','e','t'
         01:6034  6F 6D 65 74 
13018    01:6038  68 69 6E 67			db	'h','i','n','g','.','.','.',$00
         01:603C  2E 2E 2E 00 
13019    01:6040  20 20 20 20			db	' ',' ',' ',' ',' ',' ',' ',' '
         01:6044  20 20 20 20 
13020    01:6048  20 20 20 20			db	' ',' ',' ',' ',' ',' ',' ',' '
         01:604C  20 20 20 20 
13021    01:6050  20 20 20 20			db	' ',' ',' ',' ',' ',$00,' ',' '
         01:6054  20 00 20 20 
13022    01:6058  20 20 20 20			db	' ',' ',' ',' ',' ',' ',' ',' '
         01:605C  20 20 20 20 
13023    01:6060  20 20 00 47			db	' ',' ',$00,'G','O','O','D',' '
         01:6064  4F 4F 44 20 
13024    01:6068  4C 55 43 4B			db	'L','U','C','K','!',$00
         01:606C  21 00       
13025    01:606E             	_TABLE_NPC_TYPE_LV1:
13026    01:606E  01         			db	1
13027    01:606F  00         			db	0
13028    01:6070             	_TABLE_NPC_X_POS_REF_LV1:
13029    01:6070  90 03      			dw	912
13030    01:6072  D0 04      			dw	1232
13031    01:6074             	_TABLE_NPC_Y_POS_REF_LV1:
13032    01:6074  40 02      			dw	576
13033    01:6076  90 01      			dw	400
13034    01:6078             	_TABLE_OBJECT_TYPE_LV1:
13035    01:6078  00         			db	0
13036    01:6079  01         			db	1
13037    01:607A  01         			db	1
13038    01:607B  01         			db	1
13039    01:607C  01         			db	1
13040    01:607D  01         			db	1
13041    01:607E  01         			db	1
13042    01:607F  02         			db	2
13043    01:6080  01         			db	1
13044    01:6081  01         			db	1
13045    01:6082  01         			db	1
13046    01:6083  01         			db	1
13047    01:6084  01         			db	1
13048    01:6085  01         			db	1
13049    01:6086  01         			db	1
13050    01:6087  01         			db	1
13051    01:6088  01         			db	1
13052    01:6089  01         			db	1
13053    01:608A  01         			db	1
13054    01:608B  01         			db	1
13055    01:608C  01         			db	1
13056    01:608D  01         			db	1
13057    01:608E  01         			db	1
13058    01:608F             	_TABLE_OBJECT_X_POS_REF_LV1:
13059    01:608F  90 06      			dw	1680
13060    01:6091  00 05      			dw	1280
13061    01:6093  C0 05      			dw	1472
13062    01:6095  A0 05      			dw	1440
13063    01:6097  90 04      			dw	1168
13064    01:6099  B0 04      			dw	1200
13065    01:609B  C0 03      			dw	960
13066    01:609D  D8 03      			dw	984
13067    01:609F  50 05      			dw	1360
13068    01:60A1  70 05      			dw	1392
13069    01:60A3  10 06      			dw	1552
13070    01:60A5  90 06      			dw	1680
13071    01:60A7  B0 06      			dw	1712
13072    01:60A9  D0 06      			dw	1744
13073    01:60AB  E0 04      			dw	1248
13074    01:60AD  00 05      			dw	1280
13075    01:60AF  90 04      			dw	1168
13076    01:60B1  10 04      			dw	1040
13077    01:60B3  80 02      			dw	640
13078    01:60B5  A0 02      			dw	672
13079    01:60B7  50 01      			dw	336
13080    01:60B9  70 01      			dw	368
13081    01:60BB  A0 01      			dw	416
13082    01:60BD             	_TABLE_OBJECT_Y_POS_REF_LV1:
13083    01:60BD  80 01      			dw	384
13084    01:60BF  A0 01      			dw	416
13085    01:60C1  E0 01      			dw	480
13086    01:60C3  F0 01      			dw	496
13087    01:60C5  30 02      			dw	560
13088    01:60C7  30 02      			dw	560
13089    01:60C9  50 02      			dw	592
13090    01:60CB  50 02      			dw	592
13091    01:60CD  50 02      			dw	592
13092    01:60CF  50 02      			dw	592
13093    01:60D1  C0 02      			dw	704
13094    01:60D3  D0 02      			dw	720
13095    01:60D5  D0 02      			dw	720
13096    01:60D7  D0 02      			dw	720
13097    01:60D9  E0 02      			dw	736
13098    01:60DB  E0 02      			dw	736
13099    01:60DD  F0 02      			dw	752
13100    01:60DF  50 03      			dw	848
13101    01:60E1  70 03      			dw	880
13102    01:60E3  70 03      			dw	880
13103    01:60E5  80 03      			dw	896
13104    01:60E7  80 03      			dw	896
13105    01:60E9  80 03      			dw	896
13106    01:60EB             	_TABLE_CHEST_X_POS_REF_LV1:
13107    01:60EB  30 04      			dw	1072
13108    01:60ED  30 03      			dw	816
13109    01:60EF             	_TABLE_CHEST_Y_POS_REF_LV1:
13110    01:60EF  40 03      			dw	832
13111    01:60F1  50 03      			dw	848
13112    01:60F3             	_TABLE_PLAYER_TILES_ADR:
13113    01:60F3  E0 69      			dw	_tiles_SPR_PLAYER_ARMOR
13114    01:60F5  E0 71      			dw	_tiles_SPR_PLAYER_NAKED
13115    01:60F7             	_TABLE_PLAYER_TILES_BANK:
13116    01:60F7  0E         			db	^_tiles_SPR_PLAYER_ARMOR
13117    01:60F8  0F         			db	^_tiles_SPR_PLAYER_NAKED
13118    01:60F9             	_TABLE_PLAYER_JUMP_V:
13119    01:60F9  FC         			db	-4
13120    01:60FA  FB         			db	-5
13121    01:60FB  F6         			db	-10
13122    01:60FC  FC         			db	-4
13123    01:60FD  FC         			db	-4
13124    01:60FE  F9         			db	-7
13125    01:60FF  FA         			db	-6
13126    01:6100  FD         			db	-3
13127    01:6101  FB         			db	-5
13128    01:6102  FE         			db	-2
13129    01:6103  FC         			db	-4
13130    01:6104  FF         			db	-1
13131    01:6105  FF         			db	-1
13132    01:6106  FF         			db	-1
13133    01:6107  FF         			db	-1
13134    01:6108  00         			db	0
13135    01:6109  00         			db	0
13136    01:610A  00         			db	0
13137    01:610B  00         			db	0
13138    01:610C  01         			db	1
13139    01:610D  01         			db	1
13140    01:610E  01         			db	1
13141    01:610F  01         			db	1
13142    01:6110  04         			db	4
13143    01:6111  02         			db	2
13144    01:6112  05         			db	5
13145    01:6113  03         			db	3
13146    01:6114  06         			db	6
13147    01:6115  07         			db	7
13148    01:6116  04         			db	4
13149    01:6117  04         			db	4
13150    01:6118  0A         			db	10
13151    01:6119  04         			db	4
13152    01:611A  04         			db	4
13153    01:611B  05         			db	5
13154    01:611C             	_TABLE_PLAYER_FALL:
13155    01:611C  00         			db	0
13156    01:611D  00         			db	0
13157    01:611E  00         			db	0
13158    01:611F  00         			db	0
13159    01:6120  01         			db	1
13160    01:6121  01         			db	1
13161    01:6122  01         			db	1
13162    01:6123  01         			db	1
13163    01:6124  02         			db	2
13164    01:6125  02         			db	2
13165    01:6126  02         			db	2
13166    01:6127  02         			db	2
13167    01:6128  03         			db	3
13168    01:6129  03         			db	3
13169    01:612A  03         			db	3
13170    01:612B  04         			db	4
13171    01:612C  04         			db	4
13172    01:612D  04         			db	4
13173    01:612E  04         			db	4
13174    01:612F  04         			db	4
13175    01:6130  05         			db	5
13176    01:6131             	_TABLE_PLAYER_JUMP_LADDER:
13177    01:6131  FC         			db	-4
13178    01:6132  FC         			db	-4
13179    01:6133  FD         			db	-3
13180    01:6134  FD         			db	-3
13181    01:6135  FD         			db	-3
13182    01:6136  FE         			db	-2
13183    01:6137  FE         			db	-2
13184    01:6138  FE         			db	-2
13185    01:6139  FF         			db	-1
13186    01:613A  FF         			db	-1
13187    01:613B  FF         			db	-1
13188    01:613C  FF         			db	-1
13189    01:613D  FF         			db	-1
13190    01:613E  00         			db	0
13191    01:613F  00         			db	0
13192    01:6140  00         			db	0
13193    01:6141  00         			db	0
13194    01:6142  01         			db	1
13195    01:6143  01         			db	1
13196    01:6144  01         			db	1
13197    01:6145  01         			db	1
13198    01:6146  01         			db	1
13199    01:6147  02         			db	2
13200    01:6148  02         			db	2
13201    01:6149  02         			db	2
13202    01:614A  03         			db	3
13203    01:614B  03         			db	3
13204    01:614C  03         			db	3
13205    01:614D  04         			db	4
13206    01:614E  04         			db	4
13207    01:614F             	_TABLE_SHOP_ITEMS_LV1:
13208    01:614F  00         			db	0
13209    01:6150  01         			db	1
13210    01:6151  02         			db	2
13211    01:6152  03         			db	3
13212    01:6153  04         			db	4
13213    01:6154  05         			db	5
13214    01:6155  06         			db	6
13215    01:6156  07         			db	7
13216    01:6157  08         			db	8
13217    01:6158  09         			db	9
13218    01:6159             	_TABLE_SHOP_PRICES_LV1:
13219    01:6159  64 00      			dw	100
13220    01:615B  E8 03      			dw	1000
13221    01:615D  60 09      			dw	2400
13222    01:615F  80 25      			dw	9600
13223    01:6161  1E 00      			dw	30
13224    01:6163  50 00      			dw	80
13225    01:6165  2C 01      			dw	300
13226    01:6167  20 03      			dw	800
13227    01:6169  40 06      			dw	1600
13228    01:616B  96 00      			dw	150
13229    01:616D             	_TABLE_SHOP_ITEMS_TILES_ADR:
13230    01:616D  E0 60      			dw	_tiles_ITEM_WEAPON_2
13231    01:616F  60 61      			dw	_tiles_ITEM_WEAPON_3
13232    01:6171  E0 61      			dw	_tiles_ITEM_WEAPON_4
13233    01:6173  60 62      			dw	_tiles_ITEM_WEAPON_5
13234    01:6175  E0 62      			dw	_tiles_ITEM_KEY
13235    01:6177  60 63      			dw	_tiles_ITEM_ARMOR_2
13236    01:6179  E0 63      			dw	_tiles_ITEM_ARMOR_3
13237    01:617B  60 64      			dw	_tiles_ITEM_ARMOR_4
13238    01:617D  E0 64      			dw	_tiles_ITEM_ARMOR_5
13239    01:617F  60 65      			dw	_tiles_ITEM_POTION
13240    01:6181             	_TABLE_SHOP_ITEMS_TILES_BANK:
13241    01:6181  0E         			db	^_tiles_ITEM_WEAPON_2
13242    01:6182  0E         			db	^_tiles_ITEM_WEAPON_3
13243    01:6183  0E         			db	^_tiles_ITEM_WEAPON_4
13244    01:6184  0E         			db	^_tiles_ITEM_WEAPON_5
13245    01:6185  0E         			db	^_tiles_ITEM_KEY
13246    01:6186  0E         			db	^_tiles_ITEM_ARMOR_2
13247    01:6187  0E         			db	^_tiles_ITEM_ARMOR_3
13248    01:6188  0E         			db	^_tiles_ITEM_ARMOR_4
13249    01:6189  0E         			db	^_tiles_ITEM_ARMOR_5
13250    01:618A  0E         			db	^_tiles_ITEM_POTION
13251    01:618B             	_TABLE_CURSOR_POS_X:
13252    01:618B  18         			db	24
13253    01:618C  38         			db	56
13254    01:618D  60         			db	96
13255    01:618E  88         			db	136
13256    01:618F  B0         			db	176
13257    01:6190  18         			db	24
13258    01:6191  38         			db	56
13259    01:6192  60         			db	96
13260    01:6193  88         			db	136
13261    01:6194  B0         			db	176
13262    01:6195  D4         			db	212
13263                        	
13264               2310     		.bss
13265    F8:2310             	_sequence_id:
13266    F8:2310             			ds	1
13267    F8:2311             	_sequence_loaded:
13268    F8:2311             			ds	1
13269    F8:2312             	_level_id:
13270    F8:2312             			ds	1
13271    F8:2313             	_respawn:
13272    F8:2313             			ds	1
13273    F8:2314             	_player_id:
13274    F8:2314             			ds	1
13275    F8:2315             	_player_state:
13276    F8:2315             			ds	1
13277    F8:2316             	_player_axis:
13278    F8:2316             			ds	1
13279    F8:2317             	_player_previous_axis:
13280    F8:2317             			ds	1
13281    F8:2318             	_player_counter_anim:
13282    F8:2318             			ds	1
13283    F8:2319             	_player_index_jump:
13284    F8:2319             			ds	1
13285    F8:231A             	_player_index_fall:
13286    F8:231A             			ds	1
13287    F8:231B             	_player_naked:
13288    F8:231B             			ds	1
13289    F8:231C             	_player_attack:
13290    F8:231C             			ds	1
13291    F8:231D             	_jump_ladder:
13292    F8:231D             			ds	1
13293    F8:231E             	_jump_max_index:
13294    F8:231E             			ds	1
13295    F8:231F             	_armor_level:
13296    F8:231F             			ds	1
13297    F8:2320             	_weapon_level:
13298    F8:2320             			ds	1
13299    F8:2321             	_life_amount:
13300    F8:2321             			ds	1
13301    F8:2322             	_key_amount:
13302    F8:2322             			ds	1
13303    F8:2323             	_potion_amount:
13304    F8:2323             			ds	1
13305    F8:2324             	_minutes:
13306    F8:2324             			ds	1
13307    F8:2325             	_seconds:
13308    F8:2325             			ds	1
13309    F8:2326             	_time_counter:
13310    F8:2326             			ds	1
13311    F8:2327             	_minutes_backup:
13312    F8:2327             			ds	1
13313    F8:2328             	_seconds_backup:
13314    F8:2328             			ds	1
13315    F8:2329             	_object_start_index:
13316    F8:2329             			ds	1
13317    F8:232A             	_level_object_number:
13318    F8:232A             			ds	1
13319    F8:232B             	_onscreen_object_number:
13320    F8:232B             			ds	1
13321    F8:232C             	_list_object_type:
13322    F8:232C             			ds	25
13323    F8:2345             	_list_object_state:
13324    F8:2345             			ds	25
13325    F8:235E             	_list_object_energy:
13326    F8:235E             			ds	25
13327    F8:2377             	_list_reward_type:
13328    F8:2377             			ds	25
13329    F8:2390             	_list_onscreen_object:
13330    F8:2390             			ds	8
13331    F8:2398             	_chest_start_index:
13332    F8:2398             			ds	1
13333    F8:2399             	_level_chest_number:
13334    F8:2399             			ds	1
13335    F8:239A             	_onscreen_chest_number:
13336    F8:239A             			ds	1
13337    F8:239B             	_list_chest_state:
13338    F8:239B             			ds	8
13339    F8:23A3             	_list_onscreen_chest:
13340    F8:23A3             			ds	8
13341    F8:23AB             	_npc_start_index:
13342    F8:23AB             			ds	1
13343    F8:23AC             	_level_npc_number:
13344    F8:23AC             			ds	1
13345    F8:23AD             	_onscreen_npc_number:
13346    F8:23AD             			ds	1
13347    F8:23AE             	_list_npc_type:
13348    F8:23AE             			ds	9
13349    F8:23B7             	_list_npc_state:
13350    F8:23B7             			ds	9
13351    F8:23C0             	_list_onscreen_npc:
13352    F8:23C0             			ds	9
13353    F8:23C9             	_index_x:
13354    F8:23C9             			ds	1
13355    F8:23CA             	_index_y:
13356    F8:23CA             			ds	1
13357    F8:23CB             	_item_index:
13358    F8:23CB             			ds	1
13359    F8:23CC             	_shop_phase:
13360    F8:23CC             			ds	1
13361    F8:23CD             	_shop_counter:
13362    F8:23CD             			ds	1
13363    F8:23CE             	_tilemap_mask:
13364    F8:23CE             			ds	256
13365    F8:24CE             	_player_pos_x:
13366    F8:24CE             			ds	2
13367    F8:24D0             	_player_pos_y:
13368    F8:24D0             			ds	2
13369    F8:24D2             	_camera_max_y_position:
13370    F8:24D2             			ds	2
13371    F8:24D4             	_camera_pos_x_backup:
13372    F8:24D4             			ds	2
13373    F8:24D6             	_camera_pos_y_backup:
13374    F8:24D6             			ds	2
13375    F8:24D8             	_list_object_x_pos:
13376    F8:24D8             			ds	50
13377    F8:250A             	_list_object_y_pos:
13378    F8:250A             			ds	50
13379    F8:253C             	_list_object_x_pos_ref:
13380    F8:253C             			ds	50
13381    F8:256E             	_list_object_y_pos_ref:
13382    F8:256E             			ds	50
13383    F8:25A0             	_list_chest_x_pos:
13384    F8:25A0             			ds	16
13385    F8:25B0             	_list_chest_y_pos:
13386    F8:25B0             			ds	16
13387    F8:25C0             	_list_chest_x_pos_ref:
13388    F8:25C0             			ds	16
13389    F8:25D0             	_list_chest_y_pos_ref:
13390    F8:25D0             			ds	16
13391    F8:25E0             	_list_npc_x_pos:
13392    F8:25E0             			ds	18
13393    F8:25F2             	_list_npc_y_pos:
13394    F8:25F2             			ds	18
13395    F8:2604             	_list_npc_x_pos_ref:
13396    F8:2604             			ds	18
13397    F8:2616             	_list_npc_y_pos_ref:
13398    F8:2616             			ds	18
13399    F8:2628             	_zenny_amount:
13400    F8:2628             			ds	2
13401    F8:262A             	_score:
13402    F8:262A             			ds	2
13403    F8:262C             	_shop_prices:
13404    F8:262C             			ds	20
13405    F8:2640             	_ptr_SHOP_ITEM_PRICES:
13406    F8:2640             			ds	2
13407                        	
13408                        	
13409                        	;0 error(s) in compilation
13410                        	;	literal pool:110
13411                        	;	constant pool:296
13412                        	;	global pool:514
13413                        	;	Macro pool:271
13414    F8:2642             	leaf_loc:
13415    F8:2642             			ds	4
13416    F8:2646             	__hide_LEVEL_SPRITES_end:
13417    F8:2646             	__scroll_object_end:
13418    F8:2646             	__scroll_chest_end:
13419    F8:2646             	__scroll_npc_end:
13420    F8:2646             	__check_TILE_DEPTH_end:
13421    F8:2646             	__check_BG_end:
13422    F8:2646             	__check_NPC_end:
13423    F8:2646             	__recenter_CAMERA_end:
13424    F8:2646             	__init_OBJECT_LV1_end:
13425    F8:2646             	__init_CHEST_LV1_end:
13426    F8:2646             	__init_NPC_LV1_end:
13427                        	
13428    F8:2646             	__bss_init:
13429                        	
13430    F8:2646             	__heap_start:
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; hucc-final.asm
    5                        	;
    6                        	; PCEAS auto-includes this file at the end of every pass in HuCC or SDCC.
    7                        	;
    8                        	; Copyright John Brandwood 2024.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	;
   17                        	; This is used to select which assembly-language library files to include in
   18                        	; a HuCC project, using labels defined in the compiler's header files.
   19                        	;
   20                        	; ***************************************************************************
   21                        	; ***************************************************************************
   22                        	
   23                        			; Allow projects to customize what is included at the end
   24                        			; of a pass without replacing the entire "hucc-final.asm".
   25                        	
   26               E309     			.code
   27               0000     			.bank	CORE_BANK
   28               E309     			.page	CORE_PAGE
   29                        	
                             #[3]   "..\..\..\include\hucc\hucc-final-extra.asm"
   30                        			include	"hucc-final-extra.asm"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; hucc-final-extra.asm
    5                        	;
    6                        	; hucc-final.asm includes this file at the end of every pass in HuCC or SDCC.
    7                        	;
    8                        	; Copyright John Brandwood 2024.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	;
   17                        	; This is used to select which assembly-language library files to include in
   18                        	; a HuCC project, using labels defined in the compiler's header files.
   19                        	;
   20                        	; ***************************************************************************
   21                        	; ***************************************************************************
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
   31                        	
   32                        			; Libraries required for basic functionality.
   33                        	
   34               E309     			.code
   35               0000     			.bank	CORE_BANK
   36               E309     			.page	CORE_PAGE
   37                        	
                             #[3]   "..\..\..\include\hucc\common.asm"
   38                        			include	"common.asm"		; Common helpers.
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; common.asm
    5                        	;
    6                        	; Small, generic, PCE subroutines that are commonly useful when developing.
    7                        	;
    8                        	; These should be located in permanently-accessible memory!
    9                        	;
   10                        	; Copyright John Brandwood 2021-2024.
   11                        	;
   12                        	; Distributed under the Boost Software License, Version 1.0.
   13                        	; (See accompanying file LICENSE_1_0.txt or copy at
   14                        	;  http://www.boost.org/LICENSE_1_0.txt)
   15                        	;
   16                        	; ***************************************************************************
   17                        	; ***************************************************************************
   18                        	
   19                        	
   20                        	
   21                        	; ***************************************************************************
   22                        	; ***************************************************************************
   23                        	;
   24                        	; Wait for the next VBLANK IRQ.
   25                        	;
   26                        	
   27    00:E309  AD 41 22   	wait_vsync:	lda	irq_cnt			; System Card variable, changed
   28    00:E30C  CD 41 22   	.loop:		cmp	irq_cnt			; every VBLANK interrupt.
   29    00:E30F  F0 FB      			beq	.loop
   30               0001     		.ifdef	HUCC
   31    00:E311  8D EB 22   			sta	old_cnt			; Remember the frame count.
   32                        		.endif
   33    00:E314  60         			rts
   34                        	
   35                        	
   36                        	
   37                        	; ***************************************************************************
   38                        	; ***************************************************************************
   39                        	;
   40                        	; Delay for the next Y VBLANK IRQs.
   41                        	;
   42                        	
   43               0001     		.ifdef	HUCC
   44    00:E315             	_vsync		.alias	wait_vsync
   45                        	
   46    00:E315  AD 41 22   	_vsync.1:	lda	irq_cnt			; HuCC's vsync(n) was defined
   47    00:E318  38         			sec				; as frames from the previous
   48    00:E319  ED EB 22   			sbc	old_cnt			; vsync() call, 1 to 255.
   49    00:E31C  38         			sec
   50    00:E31D  E5 F8      			sbc	<_al
   51    00:E31F  90 02      			bcc	!+
   52    00:E321  A9 FF      			lda	#$FF
   53    00:E323  49 FF      	!:		eor	#$FF
   54    00:E325  1A         			inc	a
   55    00:E326  A8         			tay
   56                        		.endif
   57                        	
   58    00:E327  44 E0      	wait_nvsync:	bsr	wait_vsync		; # of VBLANK IRQs to wait in
   59    00:E329  88         			dey				; the Y register.
   60    00:E32A  D0 FB      			bne	wait_nvsync
   61    00:E32C  60         			rts
   62                        	
   63                        	
   64                        	
   65               0000     		.ifndef	HUCC
  101                        		.endif
  102                        	
  103                        	
  104                        	
  105                        	; ***************************************************************************
  106                        	; ***************************************************************************
  107                        	;
  108                        	; Map the _bp data far-pointer into MPR3 (& MPR4).
  109                        	;
  110                        	; Because the 16KB RAM region at $2000-$5FFF is composed of two separate
  111                        	; banks, with the 2nd bank having no specific relation to the 1st, there
  112                        	; is no way to deal with a bank-increment, so do not map that region.
  113                        	;
  114                        	; N.B. Library code relies on this preserving X and V!
  115                        	;
  116                        	
  117    00:E32D  98         	map_bp_to_mpr3:	tya				; Put bank into MPR3.
  118    00:E32E  F0 0A      			beq	!+
  119    00:E330  53 08      			tam3
  120    00:E332  A5 ED      			lda.h	<_bp			; Do not remap a ptr to RAM,
  121    00:E334  29 1F      			and	#$1F			; Remap ptr to MPR3.
  122    00:E336  09 60      			ora	#$60
  123    00:E338  85 ED      			sta.h	<_bp
  124    00:E33A  60         	!:		rts
  125                        	
  126    00:E33B  98         	map_bp_to_mpr34:tya				; Put bank into MPR3.
  127    00:E33C  F0 0D      			beq	!+
  128    00:E33E  53 08      			tam3
  129    00:E340  1A         			inc	a			; Put next into MPR4.
  130    00:E341  53 10      			tam4
  131    00:E343  A5 ED      			lda.h	<_bp			; Do not remap a ptr to RAM,
  132    00:E345  29 1F      			and	#$1F			; Remap ptr to MPR3.
  133    00:E347  09 60      			ora	#$60
  134    00:E349  85 ED      			sta.h	<_bp
  135    00:E34B  60         	!:		rts
  136                        	
  137                        	
  138                        	
  139                        	; ***************************************************************************
  140                        	; ***************************************************************************
  141                        	;
  142                        	; Increment the hi-byte of _bp and change TMA3 if necessary.
  143                        	;
  144                        	; N.B. Library code relies on this preserving A,X,Y and V!
  145                        	;
  146                        	
  147    00:E34C  E6 ED      	inc.h_bp_mpr3:	inc.h	<_bp			; Increment hi-byte of _bp.
  148    00:E34E  10 0B      			bpl	!+			; OK if within MPR0-MPR3.
  149    00:E350  48         			pha				; Increment the bank in MPR3,
  150    00:E351  43 08      			tma3				; usually when pointer moves
  151    00:E353  1A         			inc	a			; from $7FFF -> $8000.
  152    00:E354  53 08      			tam3
  153    00:E356  A9 60      			lda	#$60
  154    00:E358  85 ED      			sta.h	<_bp
  155    00:E35A  68         			pla
  156    00:E35B  60         	!:		rts
  157                        	
  158                        	
  159                        	
  160                        	; ***************************************************************************
  161                        	; ***************************************************************************
  162                        	;
  163                        	; Increment the hi-byte of _bp and change TMA3 and TMA4 if necessary.
  164                        	;
  165                        	; N.B. Library code relies on this preserving A,X,Y and V!
  166                        	;
  167                        	
  168    00:E35C  E6 ED      	inc.h_bp_mpr34:	inc.h	<_bp			; Increment hi-byte of _bp.
  169    00:E35E  10 0D      			bpl	!+			; OK if within MPR0-MPR3.
  170    00:E360  48         			pha				; Increment the bank in MPR3,
  171    00:E361  43 10      			tma4				; usually when pointer moves
  172    00:E363  53 08      			tam3				; from $7FFF -> $8000.
  173    00:E365  1A         			inc	a
  174    00:E366  53 10      			tam4
  175    00:E368  A9 60      			lda	#$60
  176    00:E36A  85 ED      			sta.h	<_bp
  177    00:E36C  68         			pla
  178    00:E36D  60         	!:		rts
  179                        	
  180                        	
  181                        	
  182                        	; ***************************************************************************
  183                        	; ***************************************************************************
  184                        	;
  185                        	; Put the _di data pointer into the VDC's MARR or MAWR register.
  186                        	;
  187                        	; N.B. Library code relies on this preserving Y!
  188                        	;
  189                        	
  190               0001     		.if	SUPPORT_SGX
  191    00:E36E  A2 10      	sgx_di_to_marr:	ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  192    00:E370  F0         			db	$F0			; Turn "clx" into a "beq".
  193                        		.endif
  194                        	
  195    00:E371  82         	vdc_di_to_marr:	clx				; Offset to PCE VDC.
  196                        	
  197    00:E372  A9 01      	set_di_to_marr	lda	#VDC_MARR		; Set VDC or SGX destination
  198    00:E374  95 F7      			sta	<vdc_reg, x		; address.
  199    00:E376  9D 00 02   			sta	VDC_AR, x
  200    00:E379  80 09      			bra	!+
  201                        	
  202               0001     		.if	SUPPORT_SGX
  203    00:E37B  A2 10      	sgx_di_to_mawr:	ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  204    00:E37D  F0         			db	$F0			; Turn "clx" into a "beq".
  205                        		.endif
  206                        	
  207    00:E37E  82         	vdc_di_to_mawr:	clx				; Offset to PCE VDC.
  208                        	
  209    00:E37F             	set_di_to_mawr;	lda	#VDC_MAWR		; Set VDC or SGX destination
  210    00:E37F  74 F7      			stz	<vdc_reg, x		; address.
  211    00:E381  9E 00 02   			stz	VDC_AR, x
  212                        	
  213    00:E384  A5 F0      	!:		lda	<_di + 0
  214    00:E386  9D 02 02   			sta	VDC_DL, x
  215    00:E389  A5 F1      			lda	<_di + 1
  216    00:E38B  9D 03 02   			sta	VDC_DH, x
  217                        	
  218    00:E38E  A9 02      			lda	#VDC_VWR		; Select the VRR/VWR data
  219    00:E390  95 F7      			sta	<vdc_reg, x		; register.
  220    00:E392  9D 00 02   			sta	VDC_AR, x
  221    00:E395  60         			rts
  222                        	
  223                        	
  224                        	
  225                        	; ***************************************************************************
  226                        	; ***************************************************************************
  227                        	;
  228                        	; Increment the hi-byte of _di and change TMA4 if necessary.
  229                        	;
  230                        	
  231               0000     		.if	0				; Save memory, for now.
  250                        		.endif
  251                        	
  252                        	
  253                        	
  254                        	; ***************************************************************************
  255                        	; ***************************************************************************
  256                        	;
  257                        	; Far-call a function in another bank.
  258                        	;
  259                        	; This is a potential alternative procedure call trampoline that uses only 10
  260                        	; bytes of common memory per bank of procedures, instead of 10 bytes for each
  261                        	; individual procedure call, BUT it uses the X register as a procedure-index,
  262                        	; and it needs a table of addresses at the end of every procedure bank.
  263                        	;
  264                        	; To use this ...
  265                        	;
  266                        	;  ldx #procedure-index
  267                        	;  jsr far_call_nn
  268                        	;
  269                        	; The called .PROC routine must exit with "jmp leave_proc" and not "rts".
  270                        	;
  271                        	; leave_proc:	pla
  272                        	;		tam6
  273                        	;		tya
  274                        	;		rts
  275                        	;
  276                        	; N.B. This costs 21 cycles vs 18 for the .newproc trampoline code (when you
  277                        	;      exclude preserving YA in zero-page).
  278                        	;
  279                        	; N.B. This was written as an excerise, and definitely not for HuC!
  280                        	;
  281                        	
  282               0000     		.if	0
  295                        		.endif					; 21
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
                             #[3]   "..\..\..\include\hucc\vce.asm"
   39                        			include	"vce.asm"		; Useful VCE routines.
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; vce.asm
    5                        	;
    6                        	; Useful routines for operating the HuC6260 Video Color Encoder
    7                        	;
    8                        	; These should be located in permanently-accessible memory!
    9                        	;
   10                        	; Copyright John Brandwood 2021-2025.
   11                        	;
   12                        	; Distributed under the Boost Software License, Version 1.0.
   13                        	; (See accompanying file LICENSE_1_0.txt or copy at
   14                        	;  http://www.boost.org/LICENSE_1_0.txt)
   15                        	;
   16                        	; ***************************************************************************
   17                        	; ***************************************************************************
   18                        	
   19                        	;
   20                        	; Configure Library ...
   21                        	;
   22                        	
   23               0000     		.ifndef VCE_SPLIT_CROSS
   25                        		.endif
   26                        	
   27                        	
   28                        	
   29                        	; ***************************************************************************
   30                        	; ***************************************************************************
   31                        	;
   32                        	; xfer_palettes - Update the VCE with the queued palettes changes.
   33                        	;
   34                        	; This is normally called in a developer's vsync_hook handler, but it can
   35                        	; be called manually as long as it will not also be called in an interrupt.
   36                        	;
   37                        	; The queued transfers are split into 32-byte chunks so that an HSYNC and/or
   38                        	; TIMER IRQ is not delayed for too long during the VBLANK.
   39                        	;
   40                        	
   41    00:E396  A9 80      	xfer_palettes:	lda	#$80			; Acquire color mutex to avoid
   42    00:E398  0C 46 26   			tsb	color_mutex		; conflict with a delayed VBL.
   43    00:E39B  30 5F      			bmi	.busy
   44                        	
   45    00:E39D  AC 47 26   			ldy	color_queue_r		; Are there any palette xfers
   46    00:E3A0  CC 48 26   			cpy	color_queue_w		; queued up?
   47    00:E3A3  F0 54      			beq	.exit
   48                        	
   49    00:E3A5  08         			php				; Enable interrupts so that an
   50    00:E3A6  58         			cli				; HSYNC or TIMER IRQ can occur.
   51                        	
   52    00:E3A7  43 08      			tma3				; Preserve MPR3 & MPR4 because
   53    00:E3A9  48         			pha				; this normally runs in the
   54    00:E3AA  43 10      			tma4				; VBLANK IRQ.
   55    00:E3AC  48         			pha
   56                        	
   57               0001     		.if	!CDROM
   58    00:E3AD  73 02 E4 86			tii	.tia_func, color_tia, 8 ; Copy TIA to RAM.
         00:E3B1  22 08 00    
   59                        		.endif
   60                        	
   61    00:E3B4  B9 49 26   	.next_item:	lda	color_index, y		; Get the next set of palettes
   62    00:E3B7  0A         			asl	a			; from the queue.
   63    00:E3B8  0A         			asl	a
   64    00:E3B9  0A         			asl	a
   65    00:E3BA  0A         			asl	a
   66    00:E3BB  8D 02 04   			sta	VCE_CTA + 0
   67    00:E3BE  62         			cla
   68    00:E3BF  2A         			rol	a
   69    00:E3C0  8D 03 04   			sta	VCE_CTA + 1
   70                        	
   71    00:E3C3  BE 51 26   			ldx	color_count,y		; How many palettes to xfer?
   72                        	
   73    00:E3C6  B9 69 26   			lda	color_bank, y		; Map data into MPR3 & MPR4.
   74    00:E3C9  53 08      			tam3
   75    00:E3CB  1A         			inc	a
   76    00:E3CC  53 10      			tam4
   77    00:E3CE  B9 61 26   			lda	color_addr_h, y
   78    00:E3D1  8D 88 22   			sta	.ram_tia + 2
   79    00:E3D4  B9 59 26   			lda	color_addr_l, y
   80    00:E3D7  8D 87 22   	.palette_loop:	sta	.ram_tia + 1
   81                        	
   82               0000     		.if	CDROM
   84                        		.else
   85    00:E3DA  20 86 22   			jsr	.ram_tia		; Copy 32-bytes to the VCE.
   86                        		.endif
   87                        	
   88    00:E3DD  18         			clc				; Increment the data ptr to
   89    00:E3DE  69 20      			adc	#32			; the next 32-byte palette.
   90    00:E3E0  B0 1B      			bcs	.next_page
   91                        	
   92    00:E3E2  CA         	.next_palette:	dex				; Any palettes left to xfer?
   93    00:E3E3  D0 F2      			bne	.palette_loop
   94                        	
   95    00:E3E5  C8         			iny				; Increment the queue index.
   96    00:E3E6  98         			tya
   97    00:E3E7  29 07      			and	#7
   98    00:E3E9  A8         			tay
   99                        	
  100    00:E3EA  CC 48 26   			cpy	color_queue_w		; Any more items in the queue?
  101    00:E3ED  D0 C5      			bne	.next_item
  102    00:E3EF  8C 47 26   			sty	color_queue_r		; Signal the queue is empty.
  103                        	
  104    00:E3F2  68         			pla				; Restore MPR3 & MPR4.
  105    00:E3F3  53 10      			tam4
  106    00:E3F5  68         			pla
  107    00:E3F6  53 08      			tam3
  108                        	
  109    00:E3F8  28         			plp				; Restore interrupt state.
  110                        	
  111    00:E3F9  9C 46 26   	.exit:		stz	color_mutex		; Release color mutex.
  112                        	
  113    00:E3FC  60         	.busy:		rts
  114                        	
  115    00:E3FD  EE 88 22   	.next_page:	inc	.ram_tia + 2
  116    00:E400  80 E0      			bra	.next_palette
  117                        	
  118               0001     		.if	!CDROM
  119               2286     	.ram_tia	=	color_tia		; Use a TIA in RAM.
  120                        	
  121    00:E402  E3 00 00 04	.tia_func:	tia	0, VCE_CTW, 32
         00:E406  04 20 00    
  122    00:E409  60         			rts
  123                        		.endif	!CDROM
  124                        	
  125               2646     			.bss
  126                        	
  127    F8:2646             	color_mutex:	ds	1			; Mutex for VCE changes.
  128    F8:2647             	color_queue_r:	ds	1			; Ring buffer read index.
  129    F8:2648             	color_queue_w:	ds	1			; Ring buffer write index.
  130    F8:2649             	color_index:	ds	8			; Ring buffer - Palette index.
  131    F8:2651             	color_count:	ds	8			; Ring buffer - Palette count.
  132    F8:2659             	color_addr_l:	ds	8			; Ring buffer - Data Ptr (lo).
  133    F8:2661             	color_addr_h:	ds	8			; Ring buffer - Data Ptr (hi).
  134    F8:2669             	color_bank:	ds	8			; Ring buffer - Data Ptr (bank).
  135                        	
  136               E40A     			.code
  137                        	
  138                        	
  139                        	
  140                        	; ***************************************************************************
  141                        	; ***************************************************************************
  142                        	;
  143                        	; load_palettes - Queue a set of palettes to upload to the VCE next VBLANK.
  144                        	;
  145                        	; Args: _al = Palette index (0..15 for BG, 16..31 for SPR).
  146                        	; Args: _ah = Palette count (1..32).
  147                        	; Args: _bp = Pointer to palette data.
  148                        	; Args:   Y = Bank to map into MPR3 & MPR4, or zero to leave unchanged.
  149                        	;
  150                        	; N.B. Y==0 is only useful if the palette data is permanently mapped!
  151                        	;
  152                        	
  153                        	load_palettes	.proc
  179                        			.endp
  180                        	
  181                        	
  182                        	
  183                        	; ***************************************************************************
  184                        	; ***************************************************************************
  185                        	;
  186                        	; clear_vce - Clear all 512 of the VCE's palette entries.
  187                        	;
  188                        	
  189    02:DE43             	clear_vce	.proc
  190                        	
  191    02:DE43  08         			php				; Disable interrupts to avoid
  192    02:DE44  78         			sei				; VBLANK palette upload.
  193    02:DE45  C2         			cly
  194    02:DE46  9C 02 04   			stz	VCE_CTA+0		; Set VCE write address.
  195    02:DE49  9C 03 04   			stz	VCE_CTA+1
  196    02:DE4C  9C 04 04   	.loop:		stz	VCE_CTW+0		; Set lo-byte of color.
  197    02:DE4F  9C 05 04   			stz	VCE_CTW+1		; Write 1 color value.
  198    02:DE52  9C 04 04   			stz	VCE_CTW+0		; Set lo-byte of color.
  199    02:DE55  9C 05 04   			stz	VCE_CTW+1		; Write 1 color value.
  200    02:DE58  88         			dey
  201    02:DE59  D0 F1      			bne	.loop
  202    02:DE5B  28         			plp
  203                        	
  204                        			leave				; All done, phew!
         02:DE5C  4C EF FF   			jmp	leave_proc
  205                        	
  206                        			.endp
  207                        	
  208               0001     		.ifdef	HUCC
  209    00:E40A             			.alias	_clear_palette		= clear_vce
  210                        		.endif
  211                        	
  212                        	
  213                        	
  214                        	; ***************************************************************************
  215                        	; ***************************************************************************
  216                        	;
  217                        	; read_palettes - Read palettes from the VCE into a buffer in RAM.
  218                        	;
  219                        	; Args: _al = Palette index (0..15 for BG, 16..31 for SPR).
  220                        	; Args: _ah = Palette count (1..32).
  221                        	; Args: _di = Pointer to palette data destination in RAM.
  222                        	;
  223                        	; The transfer is split into 32-byte chunks so that an HSYNC and/or TIMER
  224                        	; IRQ is not delayed for too long while executing.
  225                        	;
  226                        	
  227                        	read_palettes	.proc
  281                        			.endp
  282                        	
  283               0001     		.ifdef	HUCC
  284    00:E40A             			.alias	_read_palette.3		= read_palettes
  285                        		.endif
  286                        	
  287                        	
  288                        	
  289                        	vce_fade_funcs	.procgroup
  516                        			.endprocgroup
  517                        	
  518                        	
  519                        	
  520                        	; ***************************************************************************
  521                        	; ***************************************************************************
  522                        	;
  523                        	; cross_fade_to - Cross fade a palette in RAM towards a reference palette.
  524                        	;
  525                        	; Args: _al = Number of colors (1..256).
  526                        	; Args: _di = Pointer to faded palette destination in RAM.
  527                        	; Args: _bp = Pointer to reference palette data.
  528                        	; Args:   Y = Bank to map into MPR3 & MPR4, or zero to leave unchanged.
  529                        	;
  530                        	; N.B. Y==0 is only useful if the reference palette data is already mapped!
  531                        	;
  532                        	; N.B. This only updates the palette in RAM by 1 RGB step, so it will need
  533                        	;      to be called 7 times to guarantee that you've reached the target.
  534                        	;
  535                        	
  536                        	cross_fade_to	.proc
  658                        			.endp
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
                             #[3]   "..\..\..\include\hucc\vdc.asm"
   40                        			include	"vdc.asm"		; Useful VDC routines.
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; vdc.asm
    5                        	;
    6                        	; Useful routines for operating the HuC6270 Video Display Controller.
    7                        	;
    8                        	; These should be located in permanently-accessible memory!
    9                        	;
   10                        	; Copyright John Brandwood 2021-2025.
   11                        	;
   12                        	; Distributed under the Boost Software License, Version 1.0.
   13                        	; (See accompanying file LICENSE_1_0.txt or copy at
   14                        	;  http://www.boost.org/LICENSE_1_0.txt)
   15                        	;
   16                        	; ***************************************************************************
   17                        	; ***************************************************************************
   18                        	
   19                        	;
   20                        	; Include dependancies ...
   21                        	;
   22                        	
   23                        			include "common.asm"		; Common helpers.
   24                        			include "vce.asm"		; Useful VCE routines.
   25                        	
   26                        	;
   27                        	; Choose how much to transfer to VRAM in a single chunk, normally 16-bytes.
   28                        	;
   29                        	; The cycle timings for a TIA-to-VRAM depend upon how the VDC's MWR CPU slots
   30                        	; line up to the CPU's writes, and how long the VDC has to halt the CPU while
   31                        	; it fetches the next scanline's sprite data.
   32                        	;
   33                        	; These cycle timings are for 0 sprites (best) and 16 sprites (worst) ...
   34                        	;
   35                        	; 32-byte TIA takes 270..364 cycles in 5MHz, 242..312 cycles in 7MHz. (8.44 cycles-per-byte best-case at 5MHz.)
   36                        	; 24-byte TIA takes 210..298 cycles in 5MHz, 186..256 cycles in 7MHz. (8.75 cycles-per-byte best-case at 5MHz.)
   37                        	; 16-byte TIA takes 142..234 cycles in 5MHz, 128..200 cycles in 7MHz. (8.88 cycles-per-byte best-case at 5MHz.)
   38                        	;
   39                        	; If a user wishes to be able to put RCR interrupts one-line-after-another,
   40                        	; then it is only safe to use 32-byte chunks if there are no TIMER or IRQ2
   41                        	; interrupts ... which is almost-impossible to rely on in library code!
   42                        	;
   43                        	
   44               0000     		.ifndef	VRAM_XFER_SIZE
   46                        		.endif
   47                        	
   48                        	;
   49                        	; Enable BG & SPR layers, and RCR interrupt.
   50                        	;
   51                        	
   52    00:E40A  A9 04      	set_rcron:	lda	#$04			; Enable RCR interrupt.
   53    00:E40C  80 0A      			bra	!+
   54                        	
   55    00:E40E  A9 80      	set_bgon:	lda	#$80			; Enable BG layer.
   56    00:E410  80 06      			bra	!+
   57                        	
   58    00:E412  A9 40      	set_spron:	lda	#$40			; Enable SPR layer.
   59    00:E414  80 02      			bra	!+
   60                        	
   61    00:E416  A9 C0      	set_dspon:	lda	#$C0			; Enable BG & SPR layers.
   62                        	
   63    00:E418  04 F3      	!:		tsb	<vdc_crl		; These take effect when
   64               0001     		.if	SUPPORT_SGX			; the next VBLANK occurs.
   65    00:E41A  04 03      			tsb	<sgx_crl
   66                        		.endif
   67    00:E41C  60         			rts
   68                        	
   69                        	;
   70                        	; Disable BG & SPR layers, and RCR interrupt.
   71                        	;
   72                        	
   73    00:E41D  A9 04      	set_rcroff:	lda	#$04			; Disable RCR interrupt.
   74    00:E41F  80 0A      			bra	!+
   75                        	
   76    00:E421  A9 80      	set_bgoff:	lda	#$80			; Disable BG layer.
   77    00:E423  80 06      			bra	!+
   78                        	
   79    00:E425  A9 40      	set_sproff:	lda	#$40			; Disable SPR layer.
   80    00:E427  80 02      			bra	!+
   81                        	
   82    00:E429  A9 C0      	set_dspoff:	lda	#$C0			; Disable BG & SPR layers.
   83                        	
   84    00:E42B  14 F3      	!:		trb	<vdc_crl		; These take effect when
   85               0001     		.if	SUPPORT_SGX			; the next VBLANK occurs.
   86    00:E42D  14 03      			trb	<sgx_crl
   87                        		.endif
   88    00:E42F  60         			rts
   89                        	
   90                        	
   91                        	
   92                        	; ***************************************************************************
   93                        	; ***************************************************************************
   94                        	;
   95                        	; Put the _di data pointer into the VDC's MARR or MAWR register.
   96                        	;
   97                        	; N.B. Library code relies on this preserving Y!
   98                        	;
   99                        	; Args: _di + 0 = BAT X coordinate.
  100                        	; Args: _di + 1 = BAT Y coordinate.
  101                        	;
  102                        	; Here because it relies on the "vdc_bat_width" that is defined in this file.
  103                        	;
  104                        	
  105               0001     		.if	SUPPORT_SGX
  106    00:E430  A2 10      	sgx_di_xy_marr:	ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  107    00:E432  F0         			db	$F0			; Turn "clx" into a "beq".
  108                        		.endif
  109                        	
  110    00:E433  82         	vdc_di_xy_marr:	clx				; Offset to PCE VDC.
  111                        	
  112    00:E434  62         	set_di_xy_mawr:	cla
  113    00:E435  3C 71 26   			bit	vdc_bat_width, x	; Set by set_bat_size().
  114    00:E438  30 08      			bmi	.w128
  115    00:E43A  70 03      			bvs	.w64
  116    00:E43C  46 F1      	.w32:		lsr.h	<_di
  117    00:E43E  6A         			ror	a
  118    00:E43F  46 F1      	.w64:		lsr.h	<_di
  119    00:E441  6A         			ror	a
  120    00:E442  46 F1      	.w128:		lsr.h	<_di
  121    00:E444  6A         			ror	a
  122    00:E445  05 F0      			ora.l	<_di
  123    00:E447  85 F0      			sta.l	<_di
  124    00:E449  4C 7F E3   			jmp	set_di_to_mawr		; In "common.asm".
  125                        	
  126                        	
  127                        	
  128    02:DBA2             	vdc_clear_vram	.procgroup			; These routines share code!
  129                        	
  130                        	; ***************************************************************************
  131                        	; ***************************************************************************
  132                        	;
  133                        	; clear_vram_sgx - Clear all of VRAM in the SGX VDC.
  134                        	; clear_vram_vdc - Clear all of VRAM in the PCE VDC.
  135                        	;
  136                        	; Args: _ax = word value to write to the BAT.
  137                        	; Args: _bl = hi-byte of size of BAT (# of words).
  138                        	;
  139                        	
  140               0001     		.if	SUPPORT_SGX
  141    02:DBA2             	clear_vram_sgx	.proc
  142                        	
  143    02:DBA2  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  144    02:DBA4  F0         			db	$F0			; Turn "clx" into a "beq".
  145                        	
  146    02:DBA5             			.ref	clear_vram_vdc		; Need clear_vram_vdc
  147                        			.endp
  148                        		.endif
  149                        	
  150    02:DBA5             	clear_vram_vdc	.proc
  151                        	
  152    02:DBA5  82         			clx				; Offset to PCE VDC.
  153                        	
  154    02:DBA6  20 DD FD   	clear_vram_x:	call	clear_bat_x		; Clear the BAT.
  155                        	
  156    02:DBA9  A9 80      			lda	#$80			; Xvert hi-byte of # words
  157    02:DBAB  38         			sec				; in screen to loop count.
  158    02:DBAC  E5 FA      			sbc	<_bl
  159    02:DBAE  4A         			lsr	a
  160                        	
  161                        	;		cly				; Clear the rest of VRAM.
  162    02:DBAF  9E 02 02   			stz	VDC_DL, x
  163    02:DBB2  9E 03 02   	.clr_loop:	stz	VDC_DH, x		; Seperate writes to minimize
  164    02:DBB5  88         			dey				; VDC MWR penalty.
  165    02:DBB6  9E 03 02   			stz	VDC_DH, x
  166    02:DBB9  D0 F7      			bne	.clr_loop
  167    02:DBBB  3A         			dec	a
  168    02:DBBC  D0 F4      			bne	.clr_loop
  169                        	
  170                        			leave				; All done, phew!
         02:DBBE  4C EF FF   			jmp	leave_proc
  171                        	
  172                        			.endp
  173                        	
  174                        	
  175                        	
  176                        	; ***************************************************************************
  177                        	; ***************************************************************************
  178                        	;
  179                        	; clear_bat_sgx - Clear the BAT in the SGX VDC.
  180                        	; clear_bat_vdc - Clear the BAT in the PCE VDC.
  181                        	;
  182                        	; Args: _ax = word value to write to the BAT.
  183                        	; Args: _bl = hi-byte of size of BAT (# of words).
  184                        	;
  185                        	
  186               0001     		.if	SUPPORT_SGX
  187                        	clear_bat_sgx	.proc
  193                        			.endp
  194                        		.endif
  195                        	
  196    02:DBC1             	clear_bat_vdc	.proc
  197                        	
  198    02:DBC1  82         			clx				; Offset to PCE VDC.
  199                        	
  200    02:DBC2             			.ref	clear_bat_x		; Need clear_bat_x
  201                        			.endp
  202                        	
  203    02:DBC2             	clear_bat_x	.proc				; HuCC uses this entry point.
  204                        	
  205    02:DBC2  64 F0      			stz	<_di + 0		; Set VDC or SGX destination
  206    02:DBC4  64 F1      			stz	<_di + 1		; address.
  207    02:DBC6  20 7F E3   			jsr	set_di_to_mawr
  208                        	
  209    02:DBC9  A5 FA      			lda	<_bl			; Xvert hi-byte of # words
  210    02:DBCB  4A         			lsr	a			; in screen to loop count.
  211                        	
  212    02:DBCC  C2         			cly
  213    02:DBCD  48         	.bat_loop:	pha
  214    02:DBCE  A5 F8      			lda	<_ax + 0
  215    02:DBD0  9D 02 02   			sta	VDC_DL, x
  216    02:DBD3  A5 F9      			lda	<_ax + 1
  217    02:DBD5  9D 03 02   	.bat_pair:	sta	VDC_DH, x		; Seperate writes to minimize
  218    02:DBD8  88         			dey				; VDC MWR penalty.
  219    02:DBD9  9D 03 02   			sta	VDC_DH, x
  220    02:DBDC  D0 F7      			bne	.bat_pair
  221                        	
  222    02:DBDE  68         			pla
  223    02:DBDF  3A         			dec	a
  224    02:DBE0  D0 EB      			bne	.bat_loop
  225                        	
  226                        			leave
         02:DBE2  4C EF FF   			jmp	leave_proc
  227                        	
  228                        			.endp
  229                        	
  230                        			.endprocgroup
  231                        	
  232                        	;
  233                        	;
  234                        	;
  235                        	
  236    02:D3B4             	vdc_set_mode	.procgroup			; These routines share code!
  237                        	
  238                        	; ***************************************************************************
  239                        	; ***************************************************************************
  240                        	;
  241                        	; set_mode_sgx - Set video hardware registers from a data table.
  242                        	; set_mode_vdc - Set video hardware registers from a data table.
  243                        	;
  244                        	; Args: _bp, Y = _farptr to data table mapped into MPR3 & MPR4.
  245                        	;
  246                        	
  247               0001     		.if	SUPPORT_SGX
  248    02:D3B4             	set_mode_sgx	.proc
  249                        	
  250    02:D3B4  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  251    02:D3B6  F0         			db	$F0			; Turn "clx" into a "beq".
  252                        	
  253                        			.endp
  254                        		.endif
  255                        	
  256    02:D3B7             	set_mode_vdc	.proc
  257                        	
  258    02:D3B7  82         			clx				; Offset to PCE VDC.
  259                        	
  260    02:D3B8  F7 F8      			smb7	<_al			; Signal no set_bat_size() yet.
  261                        	
  262    02:D3BA  43 08      			tma3				; Preserve MPR3.
  263    02:D3BC  48         			pha
  264    02:D3BD  43 10      			tma4				; Preserve MPR4.
  265    02:D3BF  48         			pha
  266                        	
  267    02:D3C0  20 3B E3   			jsr	map_bp_to_mpr34		; Map data to MPR3 & MPR4.
  268                        	
  269    02:D3C3  08         			php				; Disable interrupts.
  270    02:D3C4  78         			sei
  271                        	
  272    02:D3C5  C2         			cly				; Table size is < 256 bytes.
  273                        	
  274    02:D3C6  B1 EC      	.loop:		lda	[_bp], y		; Get the register #, +ve for
  275    02:D3C8  F0 46      			beq	.done			; VDC, -128 for VCE_CR.
  276    02:D3CA  10 0C      			bpl	.set_vdc_reg
  277                        	
  278                        			; Set the VCE_CR register.
  279                        	
  280    02:D3CC  C8         	.set_vce_cr:	iny
  281                        	
  282    02:D3CD  B1 EC      			lda	[_bp], y		; Get lo-byte of register.
  283    02:D3CF  C8         			iny
  284    02:D3D0  8D 44 22   			sta	vce_cr			; No SGX shadow for this!
  285    02:D3D3  8D 00 04   			sta	VCE_CR			; Set the VCE clock speed.
  286    02:D3D6  80 EE      			bra	.loop			; Do not set VDC_MWR reg bits!
  287                        	
  288                        			; Set a VDC register.
  289                        	
  290    02:D3D8  C8         	.set_vdc_reg:	iny
  291    02:D3D9  9D 00 02   			sta	VDC_AR, x		; Set which VDC register.
  292                        	
  293    02:D3DC  C9 05      			cmp	#VDC_CR			; CS if VDC_CR or higher.
  294    02:D3DE  F0 14      			beq	.skip_cc
  295    02:D3E0  18         			clc				; CC if not VDC_CR.
  296                        	
  297    02:D3E1  49 09      			eor	#VDC_MWR		; Check if this the VDC_MWR
  298    02:D3E3  D0 0F      			bne	.skip_cc		; without changing CC.
  299                        	
  300    02:D3E5  B1 EC      			lda	[_bp], y		; Remember the BAT size so that
  301    02:D3E7  8D 42 22   			sta	vdc_mwr			; set_bat_size() can be called.
  302    02:D3EA  4A         			lsr	a
  303    02:D3EB  4A         			lsr	a
  304    02:D3EC  4A         			lsr	a
  305    02:D3ED  4A         			lsr	a
  306    02:D3EE  85 F8      			sta	<_al
  307    02:D3F0  C8         			iny
  308    02:D3F1  C8         			iny
  309    02:D3F2  80 D2      			bra	.loop
  310                        	
  311    02:D3F4  B1 EC      	.skip_cc:	lda	[_bp], y		; Get lo-byte of register.
  312    02:D3F6  C8         			iny
  313    02:D3F7  90 08      			bcc	.not_vdc_cr
  314                        	
  315               0001     		.if	SUPPORT_SGX
  316    02:D3F9  E0 00      			cpx	#0			; Writing to the VDC or SGX?
  317    02:D3FB  F0 02      			beq	.save_crl
  318    02:D3FD  29 F7      			and	#$F7			; We only need 1 vblank IRQ!
  319                        		.endif
  320                        	
  321    02:D3FF  95 F3      	.save_crl:	sta	<vdc_crl, x		; Save VDC_CR shadow register.
  322                        	
  323    02:D401  9D 02 02   	.not_vdc_cr:	sta	VDC_DL, x		; Write to VDC.
  324                        	
  325    02:D404  B1 EC      			lda	[_bp], y		; Get hi-byte of register.
  326    02:D406  C8         			iny
  327    02:D407  9D 03 02   			sta	VDC_DH, x
  328    02:D40A  90 BA      			bcc	.loop			; Next register, please!
  329                        	
  330    02:D40C  95 F4      			sta	<vdc_crh, x		; Save VDC_CR shadow register.
  331                        	
  332    02:D40E  80 B6      			bra	.loop			; Next register, please!
  333                        	
  334                        			; All registers set!
  335                        	
  336    02:D410  A9 02      	.done:		lda	#VDC_VWR		; Leave with VDC_VWR set.
  337    02:D412  95 F7      			sta	<vdc_reg, x
  338                        	;		lda	<vdc_reg, x		; Restore previous VDC_AR from
  339    02:D414  9D 00 02   			sta	VDC_AR, x		; the shadow variable.
  340                        	
  341    02:D417  28         			plp				; Restore interrupts.
  342                        	
  343    02:D418  68         			pla				; Restore MPR4.
  344    02:D419  53 10      			tam4
  345    02:D41B  68         			pla				; Restore MPR3.
  346    02:D41C  53 08      			tam3
  347                        	
  348    02:D41E  7F F8 07   			bbr7	<_al, set_bat_size	; Update if BAT size changed.
  349                        	
  350                        			leave				; All done, phew!
         02:D421  4C EF FF   			jmp	leave_proc
  351                        	
  352    02:D424             			.ref	set_bat_vdc
  353                        			.endp
  354                        	
  355                        	
  356                        	
  357                        	; ***************************************************************************
  358                        	; ***************************************************************************
  359                        	;
  360                        	; set_bat_sgx - Change the SGX BAT size and initialize variables based on it.
  361                        	; set_bat_vdc - Change the PCE BAT size and initialize variables based on it.
  362                        	;
  363                        	; Args: _al = new size (0-7).
  364                        	;
  365                        	; (VDC_MWR_32x32  >> 4) or in HuCC, SCR_SIZE_32x32.
  366                        	; (VDC_MWR_32x64  >> 4) or in HuCC, SCR_SIZE_32x64.
  367                        	; (VDC_MWR_64x32  >> 4) or in HuCC, SCR_SIZE_64x32.
  368                        	; (VDC_MWR_64x64  >> 4) or in HuCC, SCR_SIZE_64x64.
  369                        	; (VDC_MWR_128x32 >> 4) or in HuCC, SCR_SIZE_128x32.
  370                        	; (VDC_MWR_128x64 >> 4) or in HuCC, SCR_SIZE_128x64.
  371                        	;
  372                        	
  373               0001     		.if	SUPPORT_SGX
  374    02:D424             	set_bat_sgx	.proc
  375                        	
  376    02:D424  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  377    02:D426  F0         			db	$F0			; Turn "clx" into a "beq".
  378                        	
  379    02:D427             			.ref	set_bat_vdc
  380                        			.endp
  381                        		.endif
  382                        	
  383    02:D427             	set_bat_vdc	.proc
  384                        	
  385    02:D427  82         			clx				; Offset to PCE VDC.
  386                        	
  387    02:D428  A5 F8      	set_bat_size:	lda	<_al			; Get BAT size value.
  388    02:D42A  29 07      			and	#7			; Sanitize screen size value.
  389    02:D42C  A8         			tay
  390    02:D42D  0A         			asl	a			; Put it in bits 4..6.
  391    02:D42E  0A         			asl	a
  392    02:D42F  0A         			asl	a
  393    02:D430  0A         			asl	a
  394    02:D431  85 00      			sta	<__temp
  395                        	
  396    02:D433  B9 73 D4   			lda	.width, y
  397    02:D436  9D 71 26   			sta	vdc_bat_width, x
  398    02:D439  3A         			dec	a
  399    02:D43A  9D 73 26   			sta	vdc_bat_x_mask, x
  400                        	
  401    02:D43D  B9 7B D4   			lda	.height, y
  402    02:D440  9D 72 26   			sta	vdc_bat_height, x
  403    02:D443  3A         			dec	a
  404    02:D444  9D 74 26   			sta	vdc_bat_y_mask, x
  405                        	
  406    02:D447  B9 83 D4   			lda	.limit, y
  407    02:D44A  9D 75 26   			sta	vdc_bat_limit, x
  408                        	
  409    02:D44D  B9 8B D4   			lda	.increment, y		; Put the VRAM increment for a
  410    02:D450  95 F4      			sta	<vdc_crh, x		; line into vdc_crh for later.
  411                        	
  412    02:D452  08         			php
  413    02:D453  78         			sei
  414                        	
  415    02:D454  A9 09      			lda	#VDC_MWR
  416    02:D456  9D 00 02   			sta	VDC_AR, x
  417                        	
  418    02:D459  AD 42 22   			lda	vdc_mwr			; Get the MWR access width bits.
  419    02:D45C  29 8F      			and	#%10001111
  420    02:D45E  05 00      			ora	<__temp
  421               0001     		.if	SUPPORT_SGX
  422    02:D460  E0 00      			cpx	#PCE_VDC_OFFSET		; This has no SGX shadow!
  423    02:D462  D0 03      			bne	!+
  424                        		.endif
  425    02:D464  8D 42 22   			sta	vdc_mwr
  426    02:D467  9D 02 02   	!:		sta	VDC_DL, x
  427                        	
  428    02:D46A  B5 F7      			lda	<vdc_reg, x		; Restore previous VDC_AR from
  429    02:D46C  9D 00 02   			sta	VDC_AR, x		; the shadow variable.
  430                        	
  431    02:D46F  28         			plp
  432                        	
  433                        			leave
         02:D470  4C EF FF   			jmp	leave_proc
  434                        	
  435    02:D473  20 40 80 80	.width:		db	$20,$40,$80,$80,$20,$40,$80,$80
         02:D477  20 40 80 80 
  436    02:D47B  20 20 20 20	.height:	db	$20,$20,$20,$20,$40,$40,$40,$40
         02:D47F  40 40 40 40 
  437    02:D483  03 07 0F 0F	.limit:		db	$03,$07,$0F,$0F,$07,$0F,$1F,$1F
         02:D487  07 0F 1F 1F 
  438    02:D48B  08 10 18 18	.increment	db	$08,$10,$18,$18,$08,$10,$18,$18
         02:D48F  08 10 18 18 
  439                        	
  440               2671     			.bss
  441                        	
  442                        	; **************
  443                        	; 16-bytes of VDC BAT information.
  444                        	;
  445                        	; N.B. MUST be 16-bytes before the SGX versions to use PCE_VDC_OFFSET.
  446                        	;
  447                        	; N.B. Declared inside this .proc so that they can be stripped if unused.
  448                        	
  449                        	; Initialized by set_bat_vdc.
  450    F8:2671             	vdc_bat_width:	ds	1	; $20, $40, $80
  451    F8:2672             	vdc_bat_height:	ds	1	; $20, $40
  452    F8:2673             	vdc_bat_x_mask:	ds	1	; $1F, $3F, $7F
  453    F8:2674             	vdc_bat_y_mask:	ds	1	; $1F, $3F
  454    F8:2675             	vdc_bat_limit:	ds	1	; (>$03FF), (>$07FF), (>$0FFF), (>$1FFF)
  455                        	
  456                        	; From blkmap.asm just to avoid wasting .bss space with padding.
  457    F8:2676             	vdc_map_draw_w:	ds	1	; (SCR_WIDTH / 8) + 1
  458    F8:2677             	vdc_map_draw_h:	ds	1	; (SCR_HEIGHT / 8) + 1
  459    F8:2678             	vdc_map_line_w:	ds	1	; Line width of map data in tiles.
  460    F8:2679             	vdc_map_scrn_w:	ds	1	; Line width of map data in screens.
  461    F8:267A             	vdc_map_pxl_x:	ds	2	; Current top-left X in pixels.
  462    F8:267C             	vdc_map_pxl_y:	ds	2	; Current top-left Y in pixels.
  463    F8:267E             	vdc_map_option:	ds	1	; Flags to disable BAT alignment.
  464                        	
  465                        	; From hucc-old-spr.asm just to avoid wasting .bss space with padding.
  466    F8:267F             	spr_max:	ds	1
  467    F8:2680             	spr_clr:	ds	1
  468                        	
  469               0001     		.if	SUPPORT_SGX
  470                        	
  471                        	; **************
  472                        	; 16-bytes of SGX BAT information.
  473                        	;
  474                        	; N.B. MUST be 16-bytes after the VDC versions to use SGX_VDC_OFFSET.
  475                        	;
  476                        	; N.B. Declared inside this .proc so that they can be stripped if unused.
  477                        	
  478                        	; Initialized by set_bat_sgx.
  479    F8:2681             	sgx_bat_width:	ds	1	; $20, $40, $80
  480    F8:2682             	sgx_bat_height:	ds	1	; $20, $40
  481    F8:2683             	sgx_bat_x_mask:	ds	1	; $1F, $3F, $7F
  482    F8:2684             	sgx_bat_y_mask:	ds	1	; $1F, $3F
  483    F8:2685             	sgx_bat_limit:	ds	1	; (>$03FF), (>$07FF), (>$0FFF), (>$1FFF)
  484                        	
  485                        	; From blkmap.asm just to avoid wasting .bss space with padding.
  486    F8:2686             	sgx_map_draw_w:	ds	1	; (SCR_WIDTH / 8) + 1
  487    F8:2687             	sgx_map_draw_h:	ds	1	; (SCR_HEIGHT / 8) + 1
  488    F8:2688             	sgx_map_line_w:	ds	1	; Line width of map data in tiles.
  489    F8:2689             	sgx_map_scrn_w:	ds	1	; Line width of map data in screens.
  490    F8:268A             	sgx_map_pxl_x:	ds	2	; Current top-left X in pixels.
  491    F8:268C             	sgx_map_pxl_y:	ds	2	; Current top-left Y in pixels.
  492    F8:268E             	sgx_map_option:	ds	1	; Flags to disable BAT alignment.
  493                        	
  494                        	; From hucc-old-spr.asm just to avoid wasting .bss space with padding.
  495    F8:268F             	sgx_spr_max:	ds	1
  496    F8:2690             	sgx_spr_clr:	ds	1
  497                        	
  498                        		.endif
  499                        	
  500               D493     			.code
  501                        	
  502                        			.endp
  503                        	
  504                        			.endprocgroup
  505                        	
  506                        	
  507                        	
  508                        	; ***************************************************************************
  509                        	; ***************************************************************************
  510                        	;
  511                        	; sgx_detect - Detect whether we're running on a SuperGrafx (and init VPC).
  512                        	;
  513                        	; Returns: X,C-flag, and "sgx_detected" = NZ, CS if detected.
  514                        	;
  515                        	; ***************************************************************************
  516                        	;
  517                        	; https://web.archive.org/web/20161129055659/http://cgfm2.emuviews.com/txt/sgxtech.txt
  518                        	;
  519                        	; ***************************************************************************
  520                        	;
  521                        	; HuC6202 VIDEO PRIORITY CONTROLLER (huge thanks to Charles MacDonald!)
  522                        	;
  523                        	; The VPC has no access to sprite priority data, it can only sort pixels
  524                        	; based upon which VDC and whether they are "sprite" or "background".
  525                        	;
  526                        	; This can sometimes lead to unexpected results with low-priority sprites.
  527                        	;
  528                        	; VPC registers $0008 and $0009 make up four 4-bit values that define the
  529                        	; enabled layers and priority setting for the four possible window areas.
  530                        	;
  531                        	; Bits 3-0 of $0008 are for the region where Window 1 and 2 overlap
  532                        	; Bits 7-4 of $0008 are for the region occupied by only Window 2
  533                        	; Bits 3-0 of $0009 are for the region occupied by only Window 1
  534                        	; Bits 7-4 of $0009 are for the region where no Window is present
  535                        	;
  536                        	;  Each 4-bit value has the same format:
  537                        	;
  538                        	;  Bit 0: VDC #1 graphics are 0=disabled, 1=enabled
  539                        	;  Bit 1: VDC #2 graphics are 0=disabled, 1=enabled
  540                        	;  Bit 2: Bit 0 of priority setting
  541                        	;  Bit 3: Bit 1 of priority setting
  542                        	;
  543                        	;   Priority Setting 0b00xx: (useful when VDC #1 is a fullscreen HUD)
  544                        	;
  545                        	;    FRONT
  546                        	;     SP1 = VDC #1 (pce) sprite pixels
  547                        	;     BG1 = VDC #1 (pce) background pixels
  548                        	;     SP2 = VDC #2 (sgx) sprite pixels
  549                        	;     BG2 = VDC #2 (sgx) background pixels
  550                        	;    BACK
  551                        	;
  552                        	;   Priority Setting 0b01xx: (useful for parallax backgrounds)
  553                        	;
  554                        	;    FRONT
  555                        	;     SP1 = VDC #1 (pce) sprite pixels
  556                        	;     SP2 = VDC #2 (sgx) sprite pixels
  557                        	;     BG1 = VDC #1 (pce) background pixels
  558                        	;     BG2 = VDC #2 (sgx) background pixels
  559                        	;    BACK
  560                        	;
  561                        	;   Priority Setting 0b10xx: (only useful for special effects)
  562                        	;
  563                        	;    FRONT
  564                        	;     BG1 = VDC #1 (pce) background pixels (transparent where sprites)
  565                        	;     BG2 = VDC #2 (sgx) background pixels
  566                        	;     SP1 = VDC #1 (pce) sprite pixels
  567                        	;     SP2 = VDC #2 (sgx) sprite pixels
  568                        	;    BACK
  569                        	
  570               0001     		.if	SUPPORT_SGX
  571               0001     		.if	1
  572    02:DBE5             	sgx_detect	.proc
  573                        	
  574    02:DBE5  A0 7F      			ldy	#$7F			; Use VRAM address $7F7F
  575    02:DBE7  84 F0      			sty.l	<_di			; because it won't cause
  576    02:DBE9  84 F1      			sty.h	<_di			; a screen glitch.
  577                        	
  578    02:DBEB  20 7B E3   			jsr	sgx_di_to_mawr		; Write $0001 to SGX VRAM.
  579    02:DBEE  A0 01      			ldy	#$01
  580    02:DBF0  8C 12 02   			sty	SGX_DL
  581    02:DBF3  9C 13 02   			stz	SGX_DH
  582                        	
  583    02:DBF6  20 7E E3   			jsr	vdc_di_to_mawr		; Write $0000 to VDC VRAM.
  584    02:DBF9  9C 02 02   			stz	VDC_DL
  585    02:DBFC  9C 03 02   			stz	VDC_DH
  586                        	
  587    02:DBFF  20 6E E3   			jsr	sgx_di_to_marr		; Check value in SGX VRAM.
  588    02:DC02  AC 12 02   			ldy	SGX_DL			; $01 if found, $00 if not.
  589    02:DC05  8C E8 22   			sty	sgx_detected
  590    02:DC08  F0 10      			beq	!+			; Skip the rest if not SGX.
  591                        	
  592    02:DC0A  20 7B E3   			jsr	sgx_di_to_mawr		; Write $0000 to SGX VRAM
  593    02:DC0D  9C 12 02   			stz	SGX_DL			; to clean VRAM contents.
  594    02:DC10  9C 13 02   			stz	SGX_DH
  595                        	
  596    02:DC13  73 20 DC 08			tii	.vpc_mode, VPC_CR, 8	; Initialize the HuC6202 VPC.
         02:DC17  02 08 00    
  597                        	
  598    02:DC1A  98         	!:		tya
  599    02:DC1B  AA         			tax				; "leave" copies X back to A.
  600    02:DC1C  4A         			lsr	a			; Also CC if PCE, CS if SGX.
  601                        	
  602                        			leave				; All done, phew!
         02:DC1D  4C EF FF   			jmp	leave_proc
  603                        		.else
  618                        		.endif
  619                        	
  620               0000     		.ifndef	SGX_PARALLAX
  622                        		.endif
  623                        	
  624               0001     		.if	SGX_PARALLAX
  625    02:DC20  00 70      	.vpc_mode:	dw	$7000			; Use SGX as a parallax layer
  626    02:DC22  00 00      			dw	$0000			; behind a VDC background.
  627    02:DC24  00 00      			dw	$0000
  628    02:DC26  00 00      			dw	$0000
  629                        		.else
  634                        		.endif	SGX_PARALLAX
  635                        	
  636                        			.endp
  637                        	
  638               0000     		.ifndef	CORE_VERSION			; CORE has this in the kernel.
  642                        		.endif	CORE_VERSION
  643                        	
  644                        		.endif	SUPPORT_SGX
  645                        	
  646                        	
  647                        	
  648                        	
  649                        	vdc_copy_to	.procgroup			; These routines share code!
  799                        			.endprocgroup
  800                        	
  801                        	
  802                        	
  803                        	; ***************************************************************************
  804                        	; ***************************************************************************
  805                        	;
  806                        	; init_240x208 - An example of initializing screen and VRAM.
  807                        	;
  808                        	; This can be used as-is, or copied to your own program and modified.
  809                        	;
  810                        	
  811                        	init_240x208	.proc
  892                        			.endp
  893                        	
  894                        	
  895                        	
  896                        	; ***************************************************************************
  897                        	; ***************************************************************************
  898                        	;
  899                        	; init_256x224 - An example of initializing screen and VRAM.
  900                        	;
  901                        	; This can be used as-is, or copied to your own program and modified.
  902                        	;
  903                        	
  904                        	init_256x224	.proc
  985                        			.endp
  986                        	
  987                        	
  988                        	
  989                        	; ***************************************************************************
  990                        	; ***************************************************************************
  991                        	;
  992                        	; init_352x224 - An example of initializing screen and VRAM.
  993                        	;
  994                        	; This can be used as-is, or copied to your own program and modified.
  995                        	;
  996                        	
  997                        	init_352x224	.proc
 1078                        			.endp
 1079                        	
 1080                        	
 1081                        	
 1082                        	; ***************************************************************************
 1083                        	; ***************************************************************************
 1084                        	;
 1085                        	; init_512x224 - An example of initializing screen and VRAM.
 1086                        	;
 1087                        	; This can be used as-is, or copied to your own program and modified.
 1088                        	;
 1089                        	
 1090                        	init_512x224	.proc
 1171                        			.endp
 1172                        	
 1173                        	
 1174                        	
 1175                        	; ***************************************************************************
 1176                        	; ***************************************************************************
 1177                        	;
 1178                        	; init_320x208 - An example of initializing screen and VRAM.
 1179                        	;
 1180                        	; This can be used as-is, or copied to your own program and modified.
 1181                        	;
 1182                        	; This resolution is rarely-seen, but it has no overscan, so it has a use.
 1183                        	;
 1184                        	
 1185                        	init_320x208	.proc
 1266                        			.endp
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
   41                        	
                             #[3]   "..\..\..\include\hucc\hucc-math.asm"
   42                        			include	"hucc-math.asm"		; HuCC multiply and divide.
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; hucc-math.asm
    5                        	;
    6                        	; Basic (i.e. very slow) 8-bit and 16-bit multiply and divide routines.
    7                        	;
    8                        	; Copyright John Brandwood 2021-2024.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	;
   17                        	; This is basically a set of SDCC-compatible routines, but using Y:A for the
   18                        	; primary register instead of X:A.
   19                        	;
   20                        	; Using Y:A makes the routines instantly usable with HuCC, and it also makes
   21                        	; them usable with SDCC with just an "sxy" before and after the call.
   22                        	;
   23                        	; ***************************************************************************
   24                        	; ***************************************************************************
   25                        	
   26               E44C     			.code
   27                        	
   28               2000     	multiplier	=	__temp
   29               2094     	multiplicand	=	___SDCC_m6502_ret0
   30               2094     	product		=	multiplicand
   31                        	
   32               2000     	__mulint_PARM_2	=	multiplier
   33                        	
   34               2000     	divisor		=	__temp
   35               2094     	dividend	=	___SDCC_m6502_ret0
   36               2094     	quotient	=	dividend
   37               2096     	remainder	=	___SDCC_m6502_ret2
   38                        	
   39               2000     	__moduint_PARM_2 =	divisor
   40               2000     	__modsint_PARM_2 =	divisor
   41               2000     	__divuint_PARM_2 =	divisor
   42               2000     	__divsint_PARM_2 =	divisor
   43                        	
   44                        	
   45                        	
   46                        	; ***************************************************************************
   47                        	; int
   48                        	; _mulint (int a, int b)
   49                        	;
   50                        	; 1st parameter in Y:A (multiplicand)
   51                        	; 2nd parameter in __mulint_PARM_2 (multiplier)
   52                        	; result in Y:A
   53                        	;
   54                        	; N.B. signed and unsigned multiply only differ in the top 16 of the 32bits!
   55                        	
   56    00:E44C  85 94      	__mulint:	sta	<multiplicand + 0
   57    00:E44E  84 95      			sty	<multiplicand + 1
   58                        	
   59    00:E450  A2 10      			ldx	#16			; Loop 16 times.
   60                        	
   61    00:E452  46 95      			lsr	<multiplicand + 1	; Divide multiplicand by 2
   62    00:E454  66 94      			ror	<multiplicand + 0	; and clear the 16th bit.
   63                        	
   64    00:E456  62         			cla				; Clear top word of product.
   65    00:E457  85 96      			sta.l	<multiplicand + 2
   66    00:E459  90 0B      			bcc	.rotate
   67                        	
   68    00:E45B  A8         	.add:		tay				; Add the 16-bit multiplier to
   69    00:E45C  18         			clc				; top 16-bits of the product.
   70    00:E45D  A5 96      			lda	<multiplicand + 2
   71    00:E45F  65 00      			adc.l	<multiplier
   72    00:E461  85 96      			sta	<multiplicand + 2
   73    00:E463  98         			tya
   74    00:E464  65 01      			adc.h	<multiplier
   75                        	
   76    00:E466  6A         	.rotate:	ror	a			; Rotate product into the top
   77    00:E467  66 96      			ror	<multiplicand + 2	; bits of the multiplicand ...
   78    00:E469  66 95      			ror	<multiplicand + 1	; and divide multiplicand by 2.
   79    00:E46B  66 94      			ror	<multiplicand + 0
   80                        	
   81    00:E46D  CA         			dex
   82    00:E46E  B0 EB      			bcs	.add			; Add multiplier to top word?
   83    00:E470  D0 F4      			bne	.rotate			; Completed 16 bits?
   84                        	
   85    00:E472  85 97      			sta	<multiplicand + 3	; Save top byte of product.
   86                        	
   87    00:E474  A5 94      			lda.l	<multiplicand		; Return the bottom 16-bits of
   88    00:E476  A4 95      			ldy.h	<multiplicand		; the 32-bit product.
   89                        	
   90    00:E478  60         			rts
   91                        	
   92                        	
   93                        	
   94                        	; ***************************************************************************
   95                        	; unsigned int
   96                        	; _divuint (unsigned int x, unsigned int y)
   97                        	;
   98                        	; 1st parameter in Y:A (unsigned dividend)
   99                        	; 2nd parameter in __divuint_PARM_2 (unsigned divisor)
  100                        	; result in Y:A
  101                        	
  102    00:E479  20 81 E4   	__divuint:	jsr	__moduint		; Call the basic uint division.
  103                        	
  104    00:E47C  A5 94      			lda.l	<quotient		; Then get the result from where
  105    00:E47E  A4 95      			ldy.h	<quotient		; it was calculated.
  106    00:E480  60         			rts
  107                        	
  108                        	
  109                        	
  110                        	; ***************************************************************************
  111                        	; unsigned int
  112                        	; _moduint (unsigned int x, unsigned int y)
  113                        	;
  114                        	; 1st parameter in Y:A (unsigned dividend)
  115                        	; 2nd parameter in __moduint_PARM_2 (unsigned divisor)
  116                        	; result in Y:A
  117                        	;
  118                        	; If the dividend has more bits than the divisor, then we need to check the
  119                        	; 17th bit of the remainder!
  120                        	
  121               0000     		.if	0
  176                        		.else
  177                        	
  178    00:E481  85 94      	__moduint:	sta.l	<dividend		; 1st SDCC parameter in Y:A.
  179    00:E483  84 95      			sty.h	<dividend
  180                        	
  181    00:E485  A5 00      	divmoduint:	lda.l	<divisor		; Check for a divide-by-zero.
  182    00:E487  05 01      			ora.h	<divisor
  183    00:E489  F0 FE      	.zero:		beq	.zero
  184                        	
  185    00:E48B  A2 11      			ldx	#16 + 1
  186                        	
  187    00:E48D  C2         			cly				; Clear remainder.
  188    00:E48E  84 97      			sty.h	<remainder
  189                        	
  190    00:E490  98         	.skip:		tya				; Restore remainder lo-byte.
  191                        	
  192    00:E491  26 94      	.loop:		rol.l	<dividend		; Quotient bit -> dividend LSB.
  193    00:E493  26 95      			rol.h	<dividend		; Rotate dividend, MSB -> C.
  194                        	
  195    00:E495  CA         			dex
  196    00:E496  F0 14      			beq	.finished
  197                        	
  198    00:E498  2A         			rol	a			; Rotate C into remainder.
  199    00:E499  26 97      			rol.h	<remainder
  200                        	;		php				; Preserve remainder 17th bit.
  201                        	
  202    00:E49B  A8         			tay				; Preserve remainder lo-byte.
  203                        	
  204    00:E49C  C5 00      			cmp.l	<divisor		; Test divisor.
  205    00:E49E  A5 97      			lda.h	<remainder
  206    00:E4A0  E5 01      			sbc.h	<divisor
  207    00:E4A2  90 EC      			bcc	.skip			; CC if divisor > remainder.
  208                        	
  209                        	;		cmp.l	<divisor		; If the dividend has more bits
  210                        	;		lda.h	<remainder		; than the divisor then we need
  211                        	;		sbc.h	<divisor		; to check the remainder hi-bit.
  212                        	;		bcs	.subtract		; CS if divisor <= remainder.
  213                        	;		plp				; Restore remainder 17th bit.
  214                        	;		bcc	.skip			; CC if divisor > remainder.
  215                        	;		db	$90			; Turn "plp" into "bcc" to skip.
  216                        	;.subtract:	plp				; Discard remainder 17th bit.
  217                        	;		sec
  218                        	
  219    00:E4A4  85 97      			sta.h	<remainder		; Subtract divisor.
  220    00:E4A6  98         			tya
  221    00:E4A7  E5 00      			sbc.l	<divisor
  222    00:E4A9  38         			sec				
  223    00:E4AA  80 E5      			bra	.loop
  224                        	
  225    00:E4AC  A4 97      	.finished:	ldy.h	<remainder		; Get the remainder hi-byte.
  226                        	
  227    00:E4AE  60         			rts
  228                        	
  229                        		.endif
  230                        	
  231                        	
  232                        	
  233                        	; ***************************************************************************
  234                        	; int
  235                        	; _divsint (int x, int y)
  236                        	;
  237                        	; 1st parameter in Y:A (signed dividend)
  238                        	; 2nd parameter in __divsint_PARM_2 (signed divisor)
  239                        	; result in Y:A
  240                        	
  241    00:E4AF  20 B7 E4   	__divsint:	jsr	__modsint		; Call the basic sint division.
  242                        	
  243    00:E4B2  A5 94      			lda.l	<quotient		; Then get the result from where
  244    00:E4B4  A4 95      			ldy.h	<quotient		; it was calculated.
  245    00:E4B6  60         			rts
  246                        	
  247                        	
  248                        	
  249                        	; ***************************************************************************
  250                        	; int
  251                        	; _modsint (int x, int y)
  252                        	;
  253                        	; 1st parameter in Y:A (signed dividend)
  254                        	; 2nd parameter in __modsint_PARM_2 (signed divisor)
  255                        	; result in Y:A
  256                        	
  257    00:E4B7  84 95      	__modsint:	sty.h	<dividend
  258                        	
  259    00:E4B9  C0 80      			cpy	#$80			; Remainder -ve if dividend
  260    00:E4BB  08         			php				; was -ve.
  261    00:E4BC  90 03      			bcc	!+
  262    00:E4BE  20 0E E5   			jsr	neg_yacs		; Negate the dividend.
  263                        	
  264    00:E4C1  85 94      	!:		sta.l	<dividend		; Store the dividend.
  265    00:E4C3  A5 95      			lda.h	<dividend
  266    00:E4C5  84 95      			sty.h	<dividend
  267                        	
  268    00:E4C7  45 01      			eor.h	<divisor		; Quotient is -ve if divisor
  269    00:E4C9  08         			php				; and dividend signs differ.
  270                        	
  271    00:E4CA  A5 01      			lda.h	<divisor		; Is the divisor -ve?
  272    00:E4CC  10 0B      			bpl	!+
  273                        	
  274    00:E4CE  38         			sec				; Negate the divisor.
  275    00:E4CF  62         			cla
  276    00:E4D0  E5 00      			sbc.l	<divisor
  277    00:E4D2  85 00      			sta.l	<divisor
  278    00:E4D4  62         			cla
  279    00:E4D5  E5 01      			sbc.h	<divisor
  280    00:E4D7  85 01      			sta.h	<divisor
  281                        	
  282    00:E4D9  20 85 E4   	!:		jsr	divmoduint		; Do the unsigned division.
  283                        	
  284    00:E4DC  28         	.result:	plp				; Should the quotient be -ve?
  285    00:E4DD  10 0D      			bpl	.remainder
  286                        	
  287    00:E4DF  AA         			tax				; Preserve remainder lo-byte.
  288                        	
  289    00:E4E0  38         			sec				; Then negate the quotient.
  290    00:E4E1  62         			cla
  291    00:E4E2  E5 94      			sbc.l	<dividend
  292    00:E4E4  85 94      			sta.l	<dividend
  293    00:E4E6  62         			cla
  294    00:E4E7  E5 95      			sbc.h	<dividend
  295    00:E4E9  85 95      			sta.h	<dividend
  296                        	
  297    00:E4EB  8A         			txa				; Restore remainder lo-byte.
  298                        	
  299    00:E4EC  28         	.remainder:	plp				; Was the dividend -ve?
  300    00:E4ED  B0 1F      			bcs	neg_yacs		; Then negate the remainder.
  301    00:E4EF  60         			rts
  302                        	
  303                        	
  304                        	
  305                        	; ***************************************************************************
  306                        	; unsigned int
  307                        	; _muluchar (unsigned char x, unsigned char y)
  308                        	;
  309                        	; 1st parameter in A (unsigned multiplicand)
  310                        	; 2nd parameter in Y (unsigned multiplier)
  311                        	; result in Y:A
  312                        	
  313    00:E4F0  84 00      	__muluchar:	sty	<multiplier
  314                        	
  315    00:E4F2  A0 08      	muluchar_a:	ldy	#8			; Loop 8 times.
  316                        	
  317    00:E4F4  4A         			lsr	a			; Divide multiplicand by 2
  318    00:E4F5  85 94      			sta	<multiplicand		; and clear the 8th bit.
  319                        	
  320    00:E4F7  62         			cla				; Clear top byte of product.
  321    00:E4F8  90 03      			bcc	.rotate
  322                        	
  323    00:E4FA  18         	.add:		clc				; Add the 8-bit multiplier to
  324    00:E4FB  65 00      			adc	<multiplier		; top 8-bits of the product.
  325                        	
  326    00:E4FD  6A         	.rotate:	ror	a			; Rotate product into the top
  327    00:E4FE  66 94      			ror	<multiplicand		; bits of the multiplicand.
  328                        	
  329    00:E500  88         			dey
  330    00:E501  B0 F7      			bcs	.add			; Add multiplier to top byte?
  331    00:E503  D0 F8      			bne	.rotate			; Completed 8 bits?
  332                        	
  333    00:E505  A8         			tay				; Return the 16-bit product.
  334    00:E506  A5 94      			lda	<multiplicand
  335                        	
  336    00:E508  60         			rts
  337                        	
  338                        	
  339                        	
  340                        	; ***************************************************************************
  341                        	; signed int
  342                        	; abs (signed int x)
  343                        	;
  344                        	; 1st parameter in Y:A (signed)
  345                        	; result in Y:A
  346                        	
  347    00:E509  C0 80      	_abs:		cpy	#$80			; Is the hi-byte -ve?
  348    00:E50B  90 0B      			bcc	!+
  349                        	
  350    00:E50D  38         	neg_ya:		sec
  351    00:E50E  49 FF      	neg_yacs:	eor	#$FF
  352    00:E510  69 00      			adc	#0
  353    00:E512  42         			say
  354    00:E513  49 FF      			eor	#$FF
  355    00:E515  69 00      			adc	#0
  356    00:E517  42         			say
  357    00:E518  60         	!:		rts
  358                        	
  359    00:E519             	_abs.1		.alias	_abs
  360                        	
  361                        	
  362                        	
  363                        	; ***************************************************************************
  364                        	; signed int
  365                        	; _mulschar (signed char x, signed char y)
  366                        	;
  367                        	; 1st parameter in A (signed multiplicand)
  368                        	; 2nd parameter in Y (signed multiplier)
  369                        	; result in Y:A
  370                        	;
  371                        	; N.B. Y and A get swapped to make the code shorter.
  372                        	
  373    00:E519  85 94      	__mulschar:	sta	<multiplicand		; Remember multiplicand sign.
  374                        	
  375    00:E51B  C9 80      			cmp	#$80			; Is the multiplicand -ve?
  376    00:E51D  90 03      			bcc	!+
  377    00:E51F  49 FF      			eor	#$FF			; Negate the multiplicand.
  378    00:E521  1A         			inc	a
  379    00:E522  85 00      	!:		sta	<multiplier		; Then save it as multiplier.
  380                        	
  381    00:E524  98         			tya				; Product -ve if multiplicand
  382    00:E525  45 94      			eor	<multiplicand		; and multiplier signs differ.
  383    00:E527  08         			php				; Remember product sign.
  384                        	
  385    00:E528  98         			tya				; Is the multiplicand -ve?
  386    00:E529  10 03      			bpl	!+
  387    00:E52B  49 FF      			eor	#$FF			; Negate the multiplicand.
  388    00:E52D  1A         			inc	a
  389                        	
  390    00:E52E  20 F2 E4   	!:		jsr	muluchar_a		; Multiplier already saved.
  391                        	
  392    00:E531  28         			plp				; Is the product -ve?
  393    00:E532  30 D9      			bmi	neg_ya
  394    00:E534  60         			rts
  395                        	
  396                        	
  397                        	
  398                        	; ***************************************************************************
  399                        	; unsigned int
  400                        	; _mulsuchar (signed char x, signed char y)
  401                        	;
  402                        	; 1st parameter in A (unsigned multiplicand)
  403                        	; 2nd parameter in Y (signed multiplier)
  404                        	; result in Y:A
  405                        	;
  406                        	; N.B. Y and A get swapped to make the code shorter.
  407                        	
  408    00:E535  42         	__mulsuchar:	say				; Put the signed param in A.
  409                        			; drop through to __muluschar
  410                        	
  411                        	
  412                        	
  413                        	; ***************************************************************************
  414                        	; signed int
  415                        	; _muluschar (unsigned char x, unsigned char y)
  416                        	;
  417                        	; 1st parameter in A (signed multiplicand)
  418                        	; 2nd parameter in Y (unsigned multiplier)
  419                        	; result in Y:A
  420                        	
  421    00:E536  C9 80      	__muluschar:	cmp	#$80			; Is multiplicand -ve?
  422    00:E538  08         			php				; Remember the sign.
  423    00:E539  90 03      			bcc	!+
  424    00:E53B  49 FF      			eor	#$FF			; Negate multiplicand.
  425    00:E53D  1A         			inc	a
  426                        	
  427    00:E53E  20 F0 E4   	!:		jsr	__muluchar		; Do the unsigned multiply.
  428                        	
  429    00:E541  28         			plp				; Was multiplicand -ve?
  430    00:E542  B0 CA      			bcs	neg_yacs		; Then negate the product.
  431    00:E544  60         			rts
  432                        	
  433                        	
  434                        	
  435                        	; ***************************************************************************
  436                        	; unsigned int
  437                        	; _moduchar (unsigned char x, unsigned char y)
  438                        	;
  439                        	; 1st parameter in A (unsigned dividend)
  440                        	; 2nd parameter in Y (unsigned divisor)
  441                        	; result in Y:A
  442                        	
  443    00:E545  84 00      	__moduchar:	sty.l	<divisor
  444                        	
  445    00:E547  0A         	divmodu8_a:	asl	a			; Rotate dividend, MSB -> C.
  446    00:E548  85 94      			sta.l	<dividend
  447    00:E54A  64 95      			stz.h	<dividend		; Clear quotient hi-byte.
  448                        	
  449    00:E54C  A0 08      			ldy	#8
  450    00:E54E  62         			cla				; Clear remainder.
  451    00:E54F  2A         	.loop:		rol	a			; Rotate C into remainder.
  452    00:E550  C5 00      			cmp	<divisor		; Test divisor.
  453    00:E552  90 02      			bcc	.skip			; CC if divisor > remainder.
  454    00:E554  E5 00      			sbc	<divisor		; Subtract divisor.
  455    00:E556  26 94      	.skip:		rol	<dividend		; Quotient bit -> dividend LSB.
  456    00:E558  88         			dey
  457    00:E559  D0 F4      			bne	.loop
  458                        	
  459    00:E55B  C2         			cly				; Clear hi-byte of return.
  460    00:E55C  60         			rts				; Return the 16-bit remainder.
  461                        	
  462                        	
  463                        	
  464                        	; ***************************************************************************
  465                        	; unsigned int
  466                        	; _divuchar (unsigned char x, unsigned char y)
  467                        	;
  468                        	; 1st parameter in A (unsigned dividend)
  469                        	; 2nd parameter in Y (unsigned divisor)
  470                        	; result in Y:A
  471                        	
  472    00:E55D  20 45 E5   	__divuchar:	jsr	__moduchar
  473                        	
  474    00:E560  A5 94      			lda	<dividend		; Get the dividend lo-byte.
  475    00:E562  60         			rts				; Return the 16-bit dividend.
  476                        	
  477                        	
  478                        	
  479                        	; ***************************************************************************
  480                        	; signed int
  481                        	; _modschar (signed char x, signed char y)
  482                        	;
  483                        	; 1st parameter in A (signed dividend)
  484                        	; 2nd parameter in Y (signed divisor)
  485                        	; result in Y:A
  486                        	
  487    00:E563  AA         	__modschar:	tax				; Preserve the dividend.
  488    00:E564  08         			php				; Remember remainder sign.
  489                        	
  490    00:E565  84 00      			sty	<divisor		; Quotient negative if divisor
  491    00:E567  45 00      			eor	<divisor		; and dividend signs differ.
  492    00:E569  08         			php				; Remember the quotient sign.
  493                        	
  494    00:E56A  98         			tya				; Is the divisor -ve?
  495    00:E56B  10 05      			bpl	!+
  496    00:E56D  49 FF      			eor	#$FF			; Negate the divisor.
  497    00:E56F  1A         			inc	a
  498    00:E570  85 00      			sta	<divisor
  499                        	
  500    00:E572  8A         	!:		txa				; Is the dividend -ve?
  501    00:E573  10 03      			bpl	divmods8_a
  502                        	
  503    00:E575  49 FF      	divmods8_neg:	eor	#$FF			; Negate the dividend.
  504    00:E577  1A         			inc	a
  505                        	
  506    00:E578  20 47 E5   	divmods8_a:	jsr	divmodu8_a		; Do the unsigned division.
  507                        	
  508    00:E57B  28         			plp				; Should the quotient be -ve?
  509    00:E57C  10 0C      			bpl	!+
  510                        	
  511    00:E57E  AA         			tax				; Preserve remainder lo-byte.
  512                        	
  513    00:E57F  38         			sec				; Negate the quotient.
  514    00:E580  62         			cla
  515    00:E581  E5 94      			sbc.l	<dividend
  516    00:E583  85 94      			sta.l	<dividend
  517    00:E585  A9 FF      			lda	#$FF
  518    00:E587  85 95      			sta.h	<dividend
  519                        	
  520    00:E589  8A         			txa				; Restore remainder lo-byte.
  521                        	
  522    00:E58A  28         	!:		plp				; Was the dividend -ve?
  523    00:E58B  10 05      			bpl	!+
  524                        	
  525    00:E58D  49 FF      			eor	#$FF			; Then negate the remainder.
  526    00:E58F  1A         			inc	a
  527    00:E590  A0 FF      			ldy	#$FF
  528                        	
  529    00:E592  60         	!:		rts
  530                        	
  531                        	
  532                        	
  533                        	; ***************************************************************************
  534                        	; signed int
  535                        	; _moduschar (unsigned char x, unsigned char y)
  536                        	;
  537                        	; 1st parameter in A (signed dividend)
  538                        	; 2nd parameter in Y (unsigned divisor)
  539                        	; result in Y:A
  540                        	
  541    00:E593  84 00      	__moduschar:	sty.l	<divisor
  542                        	
  543    00:E595  A8         			tay				; Is the dividend -ve?
  544    00:E596  08         			php				; Remember remainder sign.
  545    00:E597  08         			php				; Remember quotient sign.
  546    00:E598  30 DB      			bmi	divmods8_neg
  547    00:E59A  80 DC      			bra	divmods8_a
  548                        	
  549                        	
  550                        	
  551                        	; ***************************************************************************
  552                        	; unsigned int
  553                        	; _modsuchar (signed char x, signed char y)
  554                        	;
  555                        	; 1st parameter in A (unsigned dividend)
  556                        	; 2nd parameter in Y (signed divisor)
  557                        	; result in Y:A
  558                        	
  559    00:E59C  AA         	__modsuchar:	tax				; Preserve the dividend.
  560    00:E59D  08         			php				; Remember remainder sign.
  561                        	
  562    00:E59E  98         			tya				; Check the divisor sign.
  563    00:E59F  08         			php				; Remember quotient sign.
  564    00:E5A0  10 03      			bpl	!+
  565    00:E5A2  49 FF      			eor	#$FF			; Negate the divisor.
  566    00:E5A4  1A         			inc	a
  567    00:E5A5  85 00      	!:		sta.l	<divisor
  568                        	
  569    00:E5A7  8A         			txa				; Restore the dividend.
  570    00:E5A8  80 CE      			bra	divmods8_a
  571                        	
  572                        	
  573                        	
  574                        	; ***************************************************************************
  575                        	; signed int
  576                        	; _divschar (signed char x, signed char y)
  577                        	;
  578                        	; 1st parameter in A (signed dividend)
  579                        	; 2nd parameter in Y (signed divisor)
  580                        	; result in Y:A
  581                        	
  582    00:E5AA  20 63 E5   	__divschar:	jsr	__modschar
  583                        	
  584    00:E5AD  A5 94      			lda.l	<dividend
  585    00:E5AF  A4 95      			ldy.h	<dividend
  586    00:E5B1  60         			rts
  587                        	
  588                        	
  589                        	
  590                        	; ***************************************************************************
  591                        	; signed int
  592                        	; _divuschar (unsigned char x, unsigned char y)
  593                        	;
  594                        	; 1st parameter in A (signed dividend)
  595                        	; 2nd parameter in Y (unsigned divisor)
  596                        	; result in Y:A
  597                        	
  598    00:E5B2  20 93 E5   	__divuschar:	jsr	__moduschar
  599                        	
  600    00:E5B5  A5 94      			lda.l	<dividend
  601    00:E5B7  A4 95      			ldy.h	<dividend
  602    00:E5B9  60         			rts
  603                        	
  604                        	
  605                        	
  606                        	; ***************************************************************************
  607                        	; unsigned int
  608                        	; _divsuchar (signed char x, signed char y)
  609                        	;
  610                        	; 1st parameter in A (unsigned dividend)
  611                        	; 2nd parameter in Y (signed divisor)
  612                        	; result in Y:A
  613                        	
  614    00:E5BA  20 9C E5   	__divsuchar:	jsr	__modsuchar
  615                        	
  616    00:E5BD  A5 94      			lda.l	<dividend
  617    00:E5BF  A4 95      			ldy.h	<dividend
  618    00:E5C1  60         			rts
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
   43                        	
   44                        			; Define in hucc-config.inc to remove this.
   45                        	
   46               0001     		.ifndef	HUCC_NO_DEFAULT_RANDOM
                             #[3]   "..\..\..\include\hucc\random.asm"
   47                        			include	"random.asm"		; Random number generator.
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; random.asm
    5                        	;
    6                        	; Pseudo-random number generator (https://github.com/bbbradsmith/prng_6502)
    7                        	;
    8                        	; Copyright Brad Smith 2019.
    9                        	;
   10                        	; License:
   11                        	;
   12                        	; This code and may be used, reused, and modified for any purpose, commercial
   13                        	; or non-commercial.
   14                        	;
   15                        	; Attribution in released binaries or documentation is appreciated but not
   16                        	; required.
   17                        	;
   18                        	; ***************************************************************************
   19                        	; ***************************************************************************
   20                        	;
   21                        	; This is a linear feedback shift register (LFSR) in Galois form, which is
   22                        	; iterated 8 times to produce an 8-bit pseudo-random number.
   23                        	;
   24                        	; Two widths of LFSR are provided:
   25                        	;
   26                        	;  24-bit requires 3 bytes, and repeats after 16777215 calls.
   27                        	;  32-bit requires 4 bytes, and repeats after 4294967295 calls.
   28                        	;
   29                        	; Usage:
   30                        	;
   31                        	;  Initialize the zero-page "random" variable to any value other than 0.
   32                        	;  The size of "random" is 3 or 4 bytes, depending on the width of LFSR
   33                        	;  chosen.
   34                        	;
   35                        	;  Call one of the RNG functions and an 8-bit result will be returned in the
   36                        	;  A-register (with flags), and the Y-register will be clobbered.
   37                        	;
   38                        	;  Do not mix RNGs of different width in the same program, unless you can
   39                        	;  give them each separate "random" state storage.
   40                        	;
   41                        	; ***************************************************************************
   42                        	; ***************************************************************************
   43                        	
   44                        	
   45               0001     		.ifndef	_KICKC				; Variables defined in C?
   46               2098     			.zp
   47    F8:2098             	random:		.ds	4			; Seed is 3 or 4 bytes.
   48               E5C2     			.code
   49                        		.endif	_KICKC
   50                        	
   51                        	
   52                        	
   53                        	; ***************************************************************************
   54                        	; ***************************************************************************
   55                        	;
   56                        	; init_random - Initialize a 32-bit LFSR using an 8-bit seed value in Y.
   57                        	;
   58                        	; The LFSR is initialized to n'th entry of a standard CRC-32 lookup-table,
   59                        	; which gives it a decent distribution of bits.
   60                        	;
   61                        	; Since seed is an 8-bit value, there are 255 (256-1) possible starting
   62                        	; states for the LFSR, because 0 would generate a 0 state.
   63                        	;
   64                        	; CRC-32 code by Paul Guertin. See http://6502.org/source/integers/crc.htm
   65                        	;
   66                        	
   67    02:DCA5             	init_random	.proc
   68                        	
   69    02:DCA5  A9 01      			lda	#1			; Init CRC-32 table value.
   70    02:DCA7  85 98      			sta	<random + 0
   71    02:DCA9  98         			tya				; Get and check the seed value.
   72    02:DCAA  D0 01      			bne	.reverse_seed
   73    02:DCAC  3A         			dec	a			; Which must be non-zero!
   74    02:DCAD  4A         	.reverse_seed:	lsr	a			; Reverse the bits so that small changes
   75    02:DCAE  26 98      			rol	<random + 0		; in the seed make larger differences in
   76    02:DCB0  90 FB      			bcc	.reverse_seed		; the initial state.
   77                        	
   78    02:DCB2  64 99      			stz	<random + 1		; A contains the high byte of the CRC-32.
   79    02:DCB4  64 9A      			stz	<random + 2		; The other three bytes are in memory.
   80    02:DCB6  62         			cla
   81                        	
   82    02:DCB7  A0 08      			ldy	#8			; Y counts bits in a byte.
   83    02:DCB9  4A         	.bit_loop:	lsr	a			; The CRC-32 algorithm is similar to CRC-16
   84    02:DCBA  66 9A      			ror	<random + 2		; except that it is reversed (originally for
   85    02:DCBC  66 99      			ror	<random + 1		; hardware reasons). This is why we shift
   86    02:DCBE  66 98      			ror	<random + 0		; right instead of left here.
   87    02:DCC0  90 16      			bcc	.no_add			; Do nothing if no overflow,
   88    02:DCC2  49 ED      			eor	#$ED			; else add CRC-32 polynomial $EDB88320.
   89                        	
   90    02:DCC4  48         			pha				; Save high byte while we do others.
   91    02:DCC5  A5 9A      			lda	<random + 2
   92    02:DCC7  49 B8      			eor	#$B8			; Most reference books give the CRC-32 poly
   93    02:DCC9  85 9A      			sta	<random + 2		; as $04C11DB7. This is actually the same if
   94    02:DCCB  A5 99      			lda	<random + 1		; you write it in binary and read it right-
   95    02:DCCD  49 83      			eor	#$83			; to-left instead of left-to-right. Doing it
   96    02:DCCF  85 99      			sta	<random + 1		; this way means we won't have to explicitly
   97    02:DCD1  A5 98      			lda	<random + 0		; reverse things afterwards.
   98    02:DCD3  49 20      			eor	#$20
   99    02:DCD5  85 98      			sta	<random + 0
  100    02:DCD7  68         			pla				; Restore high byte.
  101                        	
  102    02:DCD8  88         	.no_add:	dey				; Do next bit.
  103    02:DCD9  D0 DE      			bne	.bit_loop
  104                        	
  105    02:DCDB  85 9B      			sta	<random + 3		; Save CRC-32 high-byte.
  106                        	
  107                        			leave				; All done!
         02:DCDD  4C EF FF   			jmp	leave_proc
  108                        	
  109                        			.endp
  110                        	
  111                        	
  112                        	
  113                        	; ***************************************************************************
  114                        	; ***************************************************************************
  115                        	;
  116                        	; get_random - 8-bit LFSR pseudo-random number with a 24-bit cycle.
  117                        	;
  118                        	; The pseudo-random sequence repeats after (2^24)-1 calls.
  119                        	;
  120                        	; Written by Wim Couwenberg, see ...
  121                        	;
  122                        	; "https://wimcouwenberg.wordpress.com/2020/11/15/ ...
  123                        	;  a-fast-24-bit-prng-algorithm-for-the-6502-processor/"
  124                        	;
  125                        	; Takes 68 cycles on the HuC6280, incl JSR & RTS.
  126                        	;
  127                        	; N.B. HuCC library code relies on this preserving X and Y!
  128                        	;
  129                        	
  130    00:E5C2  C2         	_rand8:		cly				; Entry point for HuCC.
  131                        	
  132    00:E5C3  A5 98      	get_random:	lda	<random + 0		; Operation 7 (with carry clear).
  133    00:E5C5  0A         			asl	a
  134    00:E5C6  45 99      			eor	<random + 1
  135    00:E5C8  85 99      			sta	<random + 1
  136    00:E5CA  2A         			rol	a             		; Operation 9.
  137    00:E5CB  45 9A      			eor	<random + 2
  138    00:E5CD  85 9A      			sta	<random + 2
  139    00:E5CF  45 98      			eor	<random + 0		; Operation 5.
  140    00:E5D1  85 98      			sta	<random + 0
  141    00:E5D3  A5 99      			lda	<random + 1		; Operation 15.
  142    00:E5D5  6A         			ror	a
  143    00:E5D6  45 9A      			eor	<random + 2
  144    00:E5D8  85 9A      			sta	<random + 2
  145    00:E5DA  45 99      			eor	<random + 1		; Operation 6.
  146    00:E5DC  85 99      			sta	<random + 1
  147    00:E5DE  60         			rts
  148                        	
  149                        	
  150                        	
  151               0000     		.if	0
  316                        		.endif
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
   48                        		.endif
   49                        	
   50                        			; Optional libraries that get used when their header files
   51                        			; are included in a HuCC project.
   52                        			;
   53                        			; When the HuCC compiler is invoked with the "--legacy"
   54                        			; option to compile old projects, then the "huc.h" file
   55                        			; is automatically included, which then includes a list
   56                        			; of specific headers corresponding to HuC's library.
   57                        	
   58               0001     		.ifdef	HUCC_USES_GFX
                             #[3]   "..\..\..\include\hucc\hucc-gfx.asm"
   59                        			include	"hucc-gfx.asm"		; Set in hucc_gfx.h
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; huc-gfx.asm
    5                        	;
    6                        	; Based on the original HuC and MagicKit functions by David Michel and the
    7                        	; other original HuC developers.
    8                        	;
    9                        	; Modifications copyright John Brandwood 2024-2025.
   10                        	;
   11                        	; Distributed under the Boost Software License, Version 1.0.
   12                        	; (See accompanying file LICENSE_1_0.txt or copy at
   13                        	;  http://www.boost.org/LICENSE_1_0.txt)
   14                        	;
   15                        	; ***************************************************************************
   16                        	; ***************************************************************************
   17                        	
   18                        	;
   19                        	; Include dependancies ...
   20                        	;
   21                        	
   22                        			include "common.asm"		; Common helpers.
   23                        			include "vce.asm"		; Useful VCE routines.
   24                        			include "vdc.asm"		; Useful VCE routines.
   25                        	
   26                        	
   27                        	
   28                        	; ***************************************************************************
   29                        	; ***************************************************************************
   30                        	;
   31                        	; void __fastcall disp_on( void );
   32                        	; void __fastcall disp_off( void );
   33                        	
   34    00:E5DF             			.alias	_disp_on		= set_dspon
   35    00:E5DF             			.alias	_disp_off		= set_dspoff
   36                        	
   37                        	
   38                        	
   39                        	; ***************************************************************************
   40                        	; ***************************************************************************
   41                        	;
   42                        	; void __fastcall set_screen_size( unsigned char value<_al> );
   43                        	; void __fastcall sgx_set_screen_size( unsigned char value<_al> );
   44                        	;
   45                        	
   46    00:E5DF             			.alias	_set_screen_size.1	= set_bat_vdc
   47    00:E5DF             			.alias	_sgx_set_screen_size.1	= set_bat_sgx
   48                        	
   49                        	
   50                        	
   51                        	; ***************************************************************************
   52                        	; ***************************************************************************
   53                        	;
   54                        	; void __fastcall init_256x224( void );
   55                        	
   56    02:DAF5             	_init_256x224	.proc
   57                        	
   58               0800     	.BAT_SIZE	=	64 * 32
   59               0080     	.CHR_0x20	=	.BAT_SIZE / 16		; 1st tile # after the BAT.
   60               7F00     	.SAT_ADDR	=	$7F00			; SAT takes 16 tiles of VRAM.
   61                        	
   62    02:DAF5  08         			php				; Disable interrupts.
   63    02:DAF6  78         			sei
   64                        	
   65    02:DAF7  20 D3 FD   			call	clear_vce		; Clear all palettes.
   66                        	
   67    02:DAFA  A9 80      			lda.l	#.CHR_0x20		; CHR # of ASCII ' '.
   68    02:DAFC  85 F8      			sta.l	<_ax
   69    02:DAFE  A9 00      			lda.h	#.CHR_0x20
   70    02:DB00  85 F9      			sta.h	<_ax
   71                        	
   72    02:DB02  A9 08      			lda	#>.BAT_SIZE		; Size of BAT in words.
   73    02:DB04  85 FA      			sta	<_bl
   74                        	
   75    02:DB06  20 E7 FD   			call	clear_vram_vdc		; Clear VRAM.
   76               0001     		.if	SUPPORT_SGX
   77    02:DB09  20 C9 FD   			call	clear_vram_sgx
   78                        		.endif
   79                        	
   80    02:DB0C  A9 30      			lda	#<.mode_256x224		; Disable BKG & SPR layers but
   81    02:DB0E  85 EC      			sta.l	<_bp			; enable RCR & VBLANK IRQ.
   82    02:DB10  A9 DB      			lda	#>.mode_256x224
   83    02:DB12  85 ED      			sta.h	<_bp
   84                        	
   85               0001     		.if	SUPPORT_SGX
   86    02:DB14  20 BF FD   			call	sgx_detect		; Are we really on an SGX?
   87    02:DB17  90 05      			bcc	!+
   88    02:DB19  A0 02      			ldy	#^.mode_256x224		; Set SGX 1st, with no VBL.
   89    02:DB1B  20 B5 FD   			call	set_mode_sgx
   90                        		.endif
   91    02:DB1E  A0 02      	!:		ldy	#^.mode_256x224		; Set VDC 2nd, VBL allowed.
   92    02:DB20  20 AB FD   			call	set_mode_vdc
   93                        	
   94               0001     		.if	SUPPORT_SGX
   95    02:DB23  2C 10 02   			bit	SGX_SR			; Purge any overdue RCR.
   96                        		.endif
   97    02:DB26  2C 00 02   			bit	VDC_SR			; Purge any overdue VBL.
   98    02:DB29  28         			plp				; Restore interrupts.
   99                        	
  100    02:DB2A  20 09 E3   			call	wait_vsync		; Wait for the next VBLANK.
  101                        	
  102                        			leave				; All done, phew!
         02:DB2D  4C EF FF   			jmp	leave_proc
  103                        	
  104                        			; A standard 256x224 screen with overscan.
  105                        	
  106    02:DB30  80         	.mode_256x224:	db	$80			; VCE Control Register.
  107    02:DB31  04         			db	VCE_CR_5MHz + XRES_SOFT	;   Video Clock + Artifact Reduction
  108                        	
  109    02:DB32  09         			db	VDC_MWR			; Memory-access Width Register
  110    02:DB33  10 00      			dw	VDC_MWR_64x32 + VDC_MWR_1CYCLE
  111    02:DB35  0A         			db	VDC_HSR			; Horizontal Sync Register
  112    02:DB36  02 02      			dw	VDC_HSR_256
  113    02:DB38  0B         			db	VDC_HDR			; Horizontal Display Register
  114    02:DB39  1F 04      			dw	VDC_HDR_256
  115    02:DB3B  0C         			db	VDC_VPR			; Vertical Sync Register
  116    02:DB3C  02 17      			dw	VDC_VPR_224
  117    02:DB3E  0D         			db	VDC_VDW			; Vertical Display Register
  118    02:DB3F  DF 00      			dw	VDC_VDW_224
  119    02:DB41  0E         			db	VDC_VCR			; Vertical Display END position Register
  120    02:DB42  FF 00      			dw	VDC_VCR_224
  121    02:DB44  0F         			db	VDC_DCR			; DMA Control Register
  122    02:DB45  10 00      			dw	$0010			;   Enable automatic VRAM->SATB
  123    02:DB47  13         			db	VDC_DVSSR		; VRAM->SATB address $7F00
  124    02:DB48  00 7F      			dw	.SAT_ADDR
  125    02:DB4A  07         			db	VDC_BXR			; Background X-Scroll Register
  126    02:DB4B  00 00      			dw	$0000
  127    02:DB4D  08         			db	VDC_BYR			; Background Y-Scroll Register
  128    02:DB4E  00 00      			dw	$0000
  129    02:DB50  06         			db	VDC_RCR			; Raster Counter Register
  130    02:DB51  00 00      			dw	$0000			;   Never occurs!
  131    02:DB53  05         			db	VDC_CR			; Control Register
  132    02:DB54  0C 00      			dw	$000C			;   Enable VSYNC & RCR IRQ
  133    02:DB56  00         			db	0
  134                        	
  135                        			.endp
  136                        	
  137                        	
  138                        	
  139                        	; ***************************************************************************
  140                        	; ***************************************************************************
  141                        	;
  142                        	; void __fastcall init_240x208( void );
  143                        	
  144                        	_init_240x208	.proc
  223                        			.endp
  224                        	
  225                        	
  226                        	
  227                        	; ***************************************************************************
  228                        	; ***************************************************************************
  229                        	;
  230                        	; void __fastcall _macro set_xres( unsigned int x_pixels<_ax> );
  231                        	; void __fastcall _macro sgx_set_xres( unsigned int x_pixels<_ax> );
  232                        	;
  233                        	; void __fastcall set_xres( unsigned int x_pixels<_ax>, unsigned char blur_flag<_bl> );
  234                        	; void __fastcall sgx_set_xres( unsigned int x_pixels<_ax>, unsigned char blur_flag<_bl> );
  235                        	;
  236                        	; blur_flag = XRES_SOFT (default if not specified), XRES_SHARP or XRES_KEEP
  237                        	
  238                        	set_xres_group	.procgroup			; These routines share code!
  337                        			.endprocgroup	; set_xres_group
  338                        	
  339                        	
  340                        	
  341                        	; ***************************************************************************
  342                        	; ***************************************************************************
  343                        	;
  344                        	; HuC VRAM Functions
  345                        	;
  346                        	; ***************************************************************************
  347                        	; ***************************************************************************
  348                        	
  349                        	
  350    02:DA27             	load_vram_group	.procgroup			; These routines share code!
  351                        	
  352                        	; ***************************************************************************
  353                        	; ***************************************************************************
  354                        	;
  355                        	; void __fastcall load_vram( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_words<_ax> );
  356                        	; void __fastcall sgx_load_vram( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned int num_words<_ax> );
  357                        	;
  358                        	; void __fastcall far_load_vram( unsigned int vram<_di>, unsigned int num_words<_ax> );
  359                        	; void __fastcall sgx_far_load_vram( unsigned int vram<_di>, unsigned int num_words<_ax> );
  360                        	;
  361                        	; load_vram_sgx -  copy a block of memory to VRAM
  362                        	; load_vram_vdc -  copy a block of memory to VRAM
  363                        	;
  364                        	; _bp		= BAT memory location
  365                        	; _bp_bank	= BAT bank
  366                        	; _di		= VRAM base address
  367                        	; _ax		= nb of words to copy
  368                        	; ----
  369                        	; N.B. BAT data *must* be word-aligned!
  370                        	
  371               0000     		.ifndef	VRAM_XFER_SIZE
  373                        		.endif
  374                        	
  375    02:DA27             	load_vram_x	.proc
  376                        	
  377    02:DA27  43 08      			tma3
  378    02:DA29  48         			pha
  379    02:DA2A  43 10      			tma4
  380    02:DA2C  48         			pha
  381                        	
  382    02:DA2D  A4 02      			ldy	<_bp_bank
  383    02:DA2F  20 3B E3   			jsr	map_bp_to_mpr34		; Map data to MPR3 & MPR4.
  384                        	
  385    02:DA32  20 7F E3   			jsr	set_di_to_mawr
  386                        	
  387                        	;		tii	.vdc_tai, ram_tia, 8
  388                        	
  389               0001     		.if	SUPPORT_SGX
  390    02:DA35  8A         			txa				; Select which VDC to write
  391    02:DA36  1A         			inc	a			; to.
  392    02:DA37  1A         			inc	a
  393    02:DA38  8D F3 22   			sta.l	ram_tia_dst
  394                        		.endif
  395                        	
  396    02:DA3B  A9 10      			lda	#VRAM_XFER_SIZE		; Split into 16-byte chunks
  397    02:DA3D  8D F5 22   			sta.l	ram_tia_len		; for stable IRQ response.
  398                        	
  399    02:DA40  A6 EC      			ldx.l	<_bp
  400    02:DA42  8E F1 22   			stx.l	ram_tia_src
  401    02:DA45  A4 ED      			ldy.h	<_bp
  402    02:DA47  8C F2 22   			sty.h	ram_tia_src
  403                        	
  404    02:DA4A  A5 F8      			lda.l	<_ax			; Length in words.
  405    02:DA4C  48         			pha				; Preserve length.l
  406                        	
  407    02:DA4D  46 F9      			lsr.h	<_ax
  408    02:DA4F  6A         			ror	a
  409    02:DA50  46 F9      			lsr.h	<_ax
  410    02:DA52  6A         			ror	a
  411    02:DA53  46 F9      			lsr.h	<_ax
  412    02:DA55  6A         			ror	a
  413               0000     		.if	VRAM_XFER_SIZE == 32
  416                        		.endif
  417                        	
  418    02:DA56  22         			sax				; x=chunks-lo
  419    02:DA57  F0 1F      			beq	.next_block		; a=source-lo, y=source-hi
  420                        	
  421    02:DA59  20 F0 22   	.chunk_loop:	jsr	ram_tia			; transfer 16-bytes
  422                        	
  423    02:DA5C  18         			clc				; increment source
  424    02:DA5D  69 10      			adc	#VRAM_XFER_SIZE
  425    02:DA5F  8D F1 22   			sta.l	ram_tia_src
  426    02:DA62  90 11      			bcc	.same_page
  427    02:DA64  C8         			iny
  428    02:DA65  10 0B      			bpl	.same_bank		; remap_data
  429                        	
  430    02:DA67  42         			say
  431    02:DA68  43 10      			tma4
  432    02:DA6A  53 08      			tam3
  433    02:DA6C  1A         			inc	a
  434    02:DA6D  53 10      			tam4
  435    02:DA6F  A9 60      			lda	#$60
  436    02:DA71  42         			say
  437                        	
  438    02:DA72  8C F2 22   	.same_bank:	sty.h	ram_tia_src
  439                        	
  440    02:DA75  CA         	.same_page:	dex
  441    02:DA76  D0 E1      			bne	.chunk_loop
  442                        	
  443    02:DA78  C6 F9      	.next_block:	dec.h	<_ax
  444    02:DA7A  10 DD      			bpl	.chunk_loop
  445                        	
  446    02:DA7C  68         			pla				; Restore length.l
  447    02:DA7D  29 07      			and	#VRAM_XFER_SIZE / 2 - 1
  448    02:DA7F  F0 07      			beq	.done
  449                        	
  450    02:DA81  0A         			asl	a			; Convert words to bytes.
  451    02:DA82  8D F5 22   			sta.l	ram_tia_len
  452                        	
  453    02:DA85  20 F0 22   			jsr	ram_tia			; transfer remainder
  454                        	
  455    02:DA88  68         	.done:		pla
  456    02:DA89  53 10      			tam4
  457    02:DA8B  68         			pla
  458    02:DA8C  53 08      			tam3
  459                        	
  460                        			leave
         02:DA8E  4C EF FF   			jmp	leave_proc
  461                        	
  462                        			.endp
  463                        	
  464                        			.endprocgroup	; load_vram_group
  465                        	
  466                        	
  467                        	
  468                        	; ***************************************************************************
  469                        	; ***************************************************************************
  470                        	;
  471                        	; void __fastcall load_bat( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned char tiles_w<_al>, unsigned char tiles_h<_ah> );
  472                        	; void __fastcall sgx_load_bat( unsigned int vram<_di>, unsigned char __far *data<_bp_bank:_bp>, unsigned char tiles_w<_al>, unsigned char tiles_h<_ah> );
  473                        	;
  474                        	; void __fastcall far_load_bat( unsigned int vram<_di>, unsigned char tiles_w<_al>, unsigned char tiles_h<_ah> );
  475                        	; void __fastcall sgx_far_load_bat( unsigned int vram<_di>, unsigned char tiles_w<_al>, unsigned char tiles_h<_ah> );
  476                        	;
  477                        	; load_bat_sgx - transfer a BAT to VRAM
  478                        	; load_bat_vdc - transfer a BAT to VRAM
  479                        	;
  480                        	; transfer a BAT to VRAM
  481                        	; ----
  482                        	; _bp		= BAT memory location
  483                        	; _bp_bank	= BAT bank
  484                        	; _di		= VRAM base address
  485                        	; _al		= nb of column to copy
  486                        	; _ah		= nb of row
  487                        	; ----
  488                        	; N.B. BAT data *must* be word-aligned!
  489                        	
  490               20EC     	_gfx_load_bat_PARM_2	=	_bp
  491               20F0     	_gfx_load_bat_PARM_3	=	_di
  492               20F8     	_gfx_load_bat_PARM_4	=	_al
  493               20F9     	_gfx_load_bat_PARM_5	=	_ah
  494                        	
  495    02:DC28             	load_bat_group	.procgroup			; These routines share code!
  496                        	
  497               0001     		.if	SUPPORT_SGX
  498                        			.proc	_sgx_load_bat.4
  505                        			.endp
  506                        		.endif
  507                        	
  508    02:DC28             			.proc	_load_bat.4
  509    02:DC28             			.alias	_far_load_bat.3		= _load_bat.4
  510                        	
  511    02:DC28  82         			clx				; Offset to PCE VDC.
  512                        	
  513    02:DC29  43 08      			tma3
  514    02:DC2B  48         			pha
  515                        	
  516    02:DC2C  A4 02      			ldy	<_bp_bank
  517    02:DC2E  20 2D E3   			jsr	map_bp_to_mpr3		; Map data to MPR3.
  518                        	
  519    02:DC31  A4 EC      			ldy.l	<_bp
  520    02:DC33  64 EC      			stz.l	<_bp
  521                        	
  522    02:DC35  20 7F E3   	.line_loop:	jsr	set_di_to_mawr
  523                        	
  524    02:DC38  A5 F8      			lda	<_al
  525    02:DC3A  85 00      			sta	<__temp
  526    02:DC3C  B1 EC      	.tile_loop:	lda	[_bp], y
  527    02:DC3E  9D 02 02   			sta	VDC_DL, x
  528    02:DC41  C8         			iny
  529    02:DC42  B1 EC      			lda	[_bp], y
  530    02:DC44  9D 03 02   			sta	VDC_DH, x
  531    02:DC47  C8         			iny
  532    02:DC48  D0 03      			bne	!+
  533    02:DC4A  20 4C E3   			jsr	inc.h_bp_mpr3
  534    02:DC4D  C6 00      	!:		dec	<__temp
  535    02:DC4F  D0 EB      			bne	.tile_loop
  536                        	
  537    02:DC51  BD 71 26   			lda	vdc_bat_width, x
  538    02:DC54  18         			clc
  539    02:DC55  65 F0      			adc.l	<_di
  540    02:DC57  85 F0      			sta.l	<_di
  541    02:DC59  90 02      			bcc	!+
  542    02:DC5B  E6 F1      			inc.h	<_di
  543                        	
  544    02:DC5D  C6 F9      	!:		dec	<_ah
  545    02:DC5F  D0 D4      			bne	.line_loop
  546                        	
  547    02:DC61  68         			pla
  548    02:DC62  53 08      			tam3
  549                        	
  550                        			leave
         02:DC64  4C EF FF   			jmp	leave_proc
  551                        	
  552                        			.endp
  553                        	
  554                        			.endprocgroup	; load_bat_group
  555                        	
  556                        	
  557                        	
  558                        	; ***************************************************************************
  559                        	; ***************************************************************************
  560                        	;
  561                        	; void __fastcall load_palette( unsigned char palette<_al>, unsigned char __far *data<_bp_bank:_bp>, unsigned char num_palettes<_ah> );
  562                        	;
  563                        	; void __fastcall far_load_palette( unsigned char palette<_al>, unsigned char num_palettes<_ah> );
  564                        	
  565    02:DD73             			.proc	_load_palette.3
  566    02:DD73             			.alias	_far_load_palette.2	= _load_palette.3
  567                        	
  568    02:DD73  AC 48 26   			ldy	color_queue_w		; Get the queue's write index.
  569                        	
  570    02:DD76  A5 EC      			lda.l	<_bp			; Add this set of palettes to
  571    02:DD78  99 59 26   			sta	color_addr_l, y		; the queue.
  572    02:DD7B  A5 ED      			lda.h	<_bp
  573    02:DD7D  99 61 26   			sta	color_addr_h, y
  574    02:DD80  A5 02      			lda	<_bp_bank
  575    02:DD82  99 69 26   			sta	color_bank, y
  576    02:DD85  A5 F8      			lda	<_al
  577    02:DD87  99 49 26   			sta	color_index, y
  578    02:DD8A  A5 F9      			lda	<_ah
  579    02:DD8C  99 51 26   			sta	color_count, y
  580                        	
  581    02:DD8F  C8         			iny				; Increment the queue index.
  582    02:DD90  98         			tya
  583    02:DD91  29 07      			and	#7
  584                        	
  585    02:DD93  CD 47 26   	.wait:		cmp	color_queue_r		; If the queue is full, wait
  586    02:DD96  F0 FB      			beq	.wait			; for the next VBLANK.
  587                        	
  588    02:DD98  8D 48 26   			sta	color_queue_w		; Signal item is in the queue.
  589                        	
  590                        			leave				; All done, phew!
         02:DD9B  4C EF FF   			jmp	leave_proc
  591                        	
  592                        			.endp
  593                        	
  594                        	
  595                        	
  596               0000     		.if	0
  620                        		.endif
  621                        	
  622                        	
  623                        	
  624                        	; ***************************************************************************
  625                        	; ***************************************************************************
  626                        	;
  627                        	; void __fastcall load_background( unsigned char __far *tiles<_bp_bank:_bp>, unsigned char __far *palettes<__fbank:__fptr>, unsigned char __far *bat<_cl:_bx>, unsigned char w<_dl>, unsigned char w<_dh> );
  628                        	
  629                        			.proc	_load_background.5
  667                        			.endp
  668                        	
  669                        	
  670                        	
  671                        	; ***************************************************************************
  672                        	; ***************************************************************************
  673                        	;
  674                        	; void __fastcall vram2vram( unsigned int vram_dst<_ax>, unsigned int vram_src<_bx>, unsigned int word_len<_cx> );
  675                        	; void __fastcall sgx_vram2vram( unsigned int vram_dst<_ax>, unsigned int vram_src<_bx>, unsigned int word_len<_cx> );
  676                        	;
  677                        	
  678               0001     		.if	SUPPORT_SGX
  679                        			.proc	_sgx_vram2vram.3
  685                        			.endp
  686                        		.endif
  687                        	
  688    02:DC67             			.proc	_vram2vram.3
  689                        	
  690    02:DC67  82         			clx				; Offset to PCE VDC.
  691                        	
  692    02:DC68  08         			php
  693    02:DC69  78         			sei
  694    02:DC6A  A9 11      			lda	#VDC_DESR
  695    02:DC6C  9D 00 02   			sta	VDC_AR, x
  696    02:DC6F  A5 F8      			lda.l	<_ax
  697    02:DC71  9D 02 02   			sta	VDC_DL, x
  698    02:DC74  A5 F9      			lda.h	<_ax
  699    02:DC76  9D 03 02   			sta	VDC_DH, x
  700                        	
  701    02:DC79  A9 10      			lda	#VDC_SOUR
  702    02:DC7B  9D 00 02   			sta	VDC_AR, x
  703    02:DC7E  A5 FA      			lda.l	<_bx
  704    02:DC80  9D 02 02   			sta	VDC_DL, x
  705    02:DC83  A5 FB      			lda.h	<_bx
  706    02:DC85  9D 03 02   			sta	VDC_DH, x
  707                        	
  708    02:DC88  A9 12      			lda	#VDC_LENR
  709    02:DC8A  9D 00 02   			sta	VDC_AR, x
  710    02:DC8D  18         			clc
  711    02:DC8E  A5 FC      			lda.l	<_cx
  712    02:DC90  69 FF      			adc	#$FF
  713    02:DC92  9D 02 02   			sta	VDC_DL, x
  714    02:DC95  A5 FD      			lda.h	<_cx
  715    02:DC97  69 FF      			adc	#$FF
  716    02:DC99  9D 03 02   			sta	VDC_DH, x
  717                        	
  718    02:DC9C  B5 F7      			lda	<vdc_reg, x
  719    02:DC9E  8D 00 02   			sta	VDC_AR
  720    02:DCA1  28         			plp
  721                        	
  722                        			leave
         02:DCA2  4C EF FF   			jmp	leave_proc
  723                        	
  724                        			.endp
  725                        	
  726                        	
  727                        	
  728                        	; ***************************************************************************
  729                        	; ***************************************************************************
  730                        	;
  731                        	; HuC Font Functions
  732                        	;
  733                        	; ***************************************************************************
  734                        	; ***************************************************************************
  735                        	
  736                        	
  737                        	
  738               2691     			.bss
  739                        	
  740                        	; **************
  741                        	; 16-bytes of VDC BAT information.
  742                        	;
  743                        	; N.B. MUST be 16-bytes before the SGX versions to use PCE_VDC_OFFSET.
  744                        	
  745    F8:2691             	_vdc_font_base:	ds	2	; Tile number of ASCII '\0'.
  746                        	
  747                        	; From hucc-printf.asm just to avoid wasting .bss space with padding.
  748    F8:2693             	_vdc_tty_x_lhs:	ds	1	; TTY minimum X position.
  749    F8:2694             	_vdc_tty_y_top:	ds	1	; TTY minimum Y position.
  750    F8:2695             	_vdc_tty_x:	ds	1	; TTY current X position.
  751    F8:2696             	_vdc_tty_y:	ds	1	; TTY current Y position.
  752                        	
  753               0001     		.if	SUPPORT_SGX
  754                        	
  755                        	; **************
  756                        	; 16-bytes of SGX BAT information.
  757                        	;
  758                        	; N.B. MUST be 16-bytes after the VDC versions to use SGX_VDC_OFFSET.
  759                        	
  760    F8:2697             			ds	10	; Padding to ensure the 16-byte delta.
  761                        	
  762    F8:26A1             	_sgx_font_base:	ds	2	; Tile number of ASCII '\0'.
  763                        	
  764                        	; From hucc-printf.asm just to avoid wasting .bss space with padding.
  765    F8:26A3             	_sgx_tty_x_lhs:	ds	1	; TTY minimum X position.
  766    F8:26A4             	_sgx_tty_y_top:	ds	1	; TTY minimum Y position.
  767    F8:26A5             	_sgx_tty_x:	ds	1	; TTY current X position.
  768    F8:26A6             	_sgx_tty_y:	ds	1	; TTY current Y position.
  769                        	
  770                        		.endif
  771                        	
  772                        	;_font_base	.alias	vdc_font_base
  773                        	
  774               E5DF     			.code
  775                        	
  776                        	
  777                        	
  778                        	; ***************************************************************************
  779                        	; ***************************************************************************
  780                        	;
  781                        	; void __fastcall set_font_addr( unsigned int vram<acc> );
  782                        	; void __fastcall sgx_set_font_addr( unsigned int vram<acc> );
  783                        	
  784               0001     		.if	SUPPORT_SGX
  785    00:E5DF             	_sgx_set_font_addr.1:
  786    00:E5DF  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  787    00:E5E1  F0         			db	$F0			; Turn "clx" into a "beq".
  788                        		.endif
  789                        	
  790    00:E5E2             	_set_font_addr.1:
  791    00:E5E2  82         			clx				; Offset to PCE VDC.
  792                        	
  793    00:E5E3  84 00      	set_font_addr:	sty	<__temp
  794    00:E5E5  46 00      			lsr	<__temp
  795    00:E5E7  6A         			ror	a
  796    00:E5E8  46 00      			lsr	<__temp
  797    00:E5EA  6A         			ror	a
  798    00:E5EB  46 00      			lsr	<__temp
  799    00:E5ED  6A         			ror	a
  800    00:E5EE  46 00      			lsr	<__temp
  801    00:E5F0  6A         			ror	a
  802    00:E5F1  38         			sec
  803    00:E5F2  E9 20      			sbc	#$20
  804    00:E5F4  9D 91 26   			sta.l	_vdc_font_base,x
  805    00:E5F7  B0 02      			bcs	!+
  806    00:E5F9  C6 00      			dec	<__temp
  807                        	
  808    00:E5FB  BD 92 26   	!:		lda.h	_vdc_font_base, x
  809    00:E5FE  29 F0      			and	#$F0
  810    00:E600  05 00      			ora	<__temp
  811    00:E602  9D 92 26   			sta.h	_vdc_font_base, x
  812    00:E605  60         			rts
  813                        	
  814                        	
  815                        	
  816                        	; ***************************************************************************
  817                        	; ***************************************************************************
  818                        	;
  819                        	; void __fastcall set_font_pal( unsigned char palette<acc> );
  820                        	; void __fastcall sgx_set_font_pal( unsigned char palette<acc> );
  821                        	
  822               0001     		.if	SUPPORT_SGX
  823    00:E606             	_sgx_set_font_pal.1:
  824    00:E606  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  825    00:E608  F0         			db	$F0			; Turn "clx" into a "beq".
  826                        		.endif
  827                        	
  828    00:E609             	_set_font_pal:					; For compatibility with HuC.
  829    00:E609             	_set_font_pal.1:
  830    00:E609  82         			clx				; Offset to PCE VDC.
  831    00:E60A  0A         			asl	a
  832    00:E60B  0A         			asl	a
  833    00:E60C  0A         			asl	a
  834    00:E60D  0A         			asl	a
  835    00:E60E  85 00      			sta	<__temp
  836                        	
  837    00:E610  BD 92 26   			lda.h	_vdc_font_base, x
  838    00:E613  29 0F      			and	#$0F
  839    00:E615  05 00      			ora	<__temp
  840    00:E617  9D 92 26   			sta.h	_vdc_font_base, x
  841    00:E61A  60         			rts
  842                        	
  843                        	
  844                        	
  845                        	; ***************************************************************************
  846                        	; ***************************************************************************
  847                        	;
  848                        	; void __fastcall load_font( char far *font<_bp_bank:_bp>, unsigned char count<_al> );
  849                        	;
  850                        	; void __fastcall load_font( char far *font<_bp_bank:_bp>, unsigned char count<_al>, unsigned int vram<acc> );
  851                        	; void __fastcall sgx_load_font( char far *font<_bp_bank:_bp>, unsigned char count<_al>, unsigned int vram<acc> );
  852                        	;
  853                        	; void __fastcall far_load_font( unsigned char count<_al>, unsigned int vram<acc> );
  854                        	; void __fastcall sgx_far_load_font( unsigned char count<_al>, unsigned int vram<acc> );
  855                        	
  856    00:E61B  AC 75 26   	_load_font.2:	ldy	vdc_bat_limit		; Load the font directly
  857    00:E61E  C8         			iny				; after the BAT (stupid!).
  858    00:E61F  62         			cla
  859    00:E620  80 03      			bra	_load_font.3
  860                        	
  861               0001     		.if	SUPPORT_SGX
  862    00:E622             	_sgx_load_font.3:
  863    00:E622  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  864    00:E624  F0         			db	$F0			; Turn "clx" into a "beq".
  865                        		.endif
  866                        	
  867    00:E625  82         	_load_font.3:	clx				; Offset to PCE VDC.
  868                        	
  869    00:E626  85 F0      			sta.l	<_di			; Load the font directly
  870    00:E628  84 F1      			sty.h	<_di			; after the BAT (stupid!).
  871                        	
  872    00:E62A  20 E3 E5   			jsr	set_font_addr		; Set xxx_font_base from addr.
  873                        	
  874    00:E62D  A5 F8      			lda	<__al			; Convert #tiles into #words.
  875    00:E62F  64 F9      			stz	<__ah
  876    00:E631  0A         			asl	a
  877    00:E632  26 F9      			rol	<__ah
  878    00:E634  0A         			asl	a
  879    00:E635  26 F9      			rol	<__ah
  880    00:E637  0A         			asl	a
  881    00:E638  26 F9      			rol	<__ah
  882    00:E63A  0A         			asl	a
  883    00:E63B  26 F9      			rol	<__ah
  884    00:E63D  85 F8      			sta	<__al
  885    00:E63F  4C 63 FF   			jmp	load_vram_x
  886                        	
  887    00:E642             			.alias	_far_load_font.2	= _load_font.3
  888    00:E642             			.alias	_sgx_far_load_font.2	= _sgx_load_font.3
  889                        	
  890                        	
  891                        	
  892                        	; ***************************************************************************
  893                        	; ***************************************************************************
  894                        	;
  895                        	; void __fastcall cls();
  896                        	; void __fastcall sgx_cls();
  897                        	;
  898                        	; void __fastcall cls( int tile<acc> );
  899                        	; void __fastcall sgx_cls( int tile<acc> );
  900                        	
  901               0001     		.if	SUPPORT_SGX
  902    00:E642  A2 10      	_sgx_cls:	ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  903    00:E644  F0         			db	$F0			; Turn "clx" into a "beq".
  904                        		.endif
  905                        	
  906    00:E645  82         	_cls:		clx				; Offset to PCE VDC.
  907                        	
  908    00:E646  BD 91 26   	clear_tty_x:	lda.l	_vdc_font_base, x
  909    00:E649  BC 92 26   			ldy.h	_vdc_font_base, x
  910    00:E64C  18         			clc
  911    00:E64D  69 20      			adc	#' '
  912    00:E64F  90 07      			bcc	!+
  913    00:E651  C8         			iny
  914    00:E652  80 04      			bra	!+
  915                        	
  916               0001     		.if	SUPPORT_SGX
  917    00:E654  A2 10      	_sgx_cls.1:	ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  918    00:E656  F0         			db	$F0			; Turn "clx" into a "beq".
  919                        		.endif
  920                        	
  921    00:E657  82         	_cls.1:		clx
  922                        	
  923    00:E658  85 F8      	!:		sta.l	<_ax			; VRAM word to write.
  924    00:E65A  84 F9      			sty.h	<_ax
  925    00:E65C  BD 75 26   			lda	vdc_bat_limit, x	; BAT size hi-byte.
  926    00:E65F  1A         			inc	a
  927    00:E660  85 FA      			sta	<_bl
  928    00:E662  4C DD FD   			jmp	clear_bat_x
  929                        	
  930                        	
  931                        	
  932                        	; ***************************************************************************
  933                        	; ***************************************************************************
  934                        	;
  935                        	; void __fastcall __macro load_default_font( void );
  936                        	; void __fastcall __macro sgx_load_default_font( void );
  937                        	;
  938                        	; Args: _bp, _bp_bank = _farptr to font data mapped into MPR3 & MPR4.
  939                        	; Args: _di = VRAM destination address.
  940                        	; Args: monofont_fg = font color (0..15)
  941                        	; Args: monofont_bg = background color (0..15)
  942                        	; Args: _al = number of tiles (aka characters) 0==256
  943                        	
  944    01:D7F0             	huc_monofont_x	.proc
  945                        	
  946               26A7     			.bss
  947    F8:26A7             	monofont_fg:	.ds	1
  948    F8:26A8             	monofont_bg:	.ds	1
  949               D7F0     			.code
  950                        	
  951    01:D7F0  BC 75 26   			ldy	vdc_bat_limit, x	; BAT limit mask hi-byte.
  952    01:D7F3  C8         			iny
  953    01:D7F4  62         			cla
  954    01:D7F5  85 F0      			sta.l	<_di			; Load the font directly
  955    01:D7F7  84 F1      			sty.h	<_di			; after the BAT (stupid!).
  956                        	
  957    01:D7F9  20 E3 E5   			jsr	set_font_addr		; Set xxx_font_base from addr.
  958                        	
  959    01:D7FC  A9 80      			lda.l	#.font
  960    01:D7FE  85 EC      			sta.l	<_bp
  961    01:D800  A9 D8      			lda.h	#.font
  962    01:D802  85 ED      			sta.h	<_bp
  963                        	
  964    01:D804  A9 60      			lda	#$60			; #characters.
  965    01:D806  85 F8      			sta	<_al
  966                        	
  967    01:D808  20 7F E3   			jsr	set_di_to_mawr
  968                        	
  969    01:D80B  AD A7 26   			lda	monofont_fg		; Foreground pixel color.
  970    01:D80E  85 00      			sta	<__temp
  971    01:D810  AD A8 26   			lda	monofont_bg		; Background pixel color.
  972    01:D813  DA         			phx
  973    01:D814  A2 FC      			ldx.l	#_cx			; Create a bit mask for each
  974    01:D816  9E 00 20   	.bg_loop:	stz	$2000, x		; plane of the background.
  975    01:D819  4A         			lsr	a
  976    01:D81A  90 03      			bcc	.bg_plane
  977    01:D81C  DE 00 20   			dec	$2000, x
  978    01:D81F  E8         	.bg_plane:	inx
  979    01:D820  D0 F4      			bne	.bg_loop
  980    01:D822  FA         			plx
  981                        	
  982    01:D823  C2         	.tile_loop:	cly
  983                        	
  984    01:D824  B1 EC      	.plane01:	lda	[_bp], y		; Get font byte.
  985    01:D826  8F 00 06   			bbs0	<__temp, .set_plane0
  986    01:D829  49 FF      	.clr_plane0:	eor	#$FF			; Clr font bits in background.
  987    01:D82B  25 FC      			and	<_cx + 0
  988    01:D82D  80 02      			bra	.put_plane0
  989    01:D82F  05 FC      	.set_plane0:	ora	<_cx + 0		; Set font bits in background.
  990    01:D831  9D 02 02   	.put_plane0:	sta	VDC_DL, x
  991                        	
  992    01:D834  B1 EC      			lda	[_bp], y		; Get font byte.
  993    01:D836  9F 00 06   			bbs1	<__temp, .set_plane1
  994    01:D839  49 FF      	.clr_plane1:	eor	#$FF			; Clr font bits in background.
  995    01:D83B  25 FD      			and	<_cx + 1
  996    01:D83D  80 02      			bra	.put_plane1
  997    01:D83F  05 FD      	.set_plane1:	ora	<_cx + 1		; Set font bits in background.
  998    01:D841  9D 03 02   	.put_plane1:	sta	VDC_DH, x
  999                        	
 1000    01:D844  C8         			iny
 1001    01:D845  C0 08      			cpy	#8
 1002    01:D847  90 DB      			bcc	.plane01
 1003                        	
 1004    01:D849  C2         			cly
 1005                        	
 1006    01:D84A  B1 EC      	.plane23:	lda	[_bp], y		; Get font byte.
 1007    01:D84C  AF 00 06   			bbs2	<__temp, .set_plane2
 1008    01:D84F  49 FF      	.clr_plane2:	eor	#$FF			; Clr font bits in background.
 1009    01:D851  25 FE      			and	<_cx + 2
 1010    01:D853  80 02      			bra	.put_plane2
 1011    01:D855  05 FE      	.set_plane2:	ora	<_cx + 2		; Set font bits in background.
 1012    01:D857  9D 02 02   	.put_plane2:	sta	VDC_DL, x
 1013                        	
 1014    01:D85A  B1 EC      			lda	[_bp], y		; Get font byte.
 1015    01:D85C  BF 00 06   			bbs3	<__temp, .set_plane3
 1016    01:D85F  49 FF      	.clr_plane3:	eor	#$FF			; Clr font bits in background.
 1017    01:D861  25 FF      			and	<_cx + 3
 1018    01:D863  80 02      			bra	.put_plane3
 1019    01:D865  05 FF      	.set_plane3:	ora	<_cx + 3		; Set font bits in background.
 1020    01:D867  9D 03 02   	.put_plane3:	sta	VDC_DH, x
 1021                        	
 1022    01:D86A  C8         			iny
 1023    01:D86B  C0 08      			cpy	#8
 1024    01:D86D  90 DB      			bcc	.plane23
 1025                        	
 1026    01:D86F  A5 EC      			lda.l	<_bp
 1027    01:D871  69 07      			adc	#8-1
 1028    01:D873  85 EC      			sta.l	<_bp
 1029    01:D875  90 02      			bcc	!+
 1030    01:D877  E6 ED      			inc.h	<_bp
 1031                        	
 1032    01:D879  C6 F8      	!:		dec	<_al
 1033    01:D87B  D0 A6      			bne	.tile_loop
 1034                        	
 1035                        			leave				; All done, phew!
         01:D87D  4C EF FF   			jmp	leave_proc
 1036                        	
 1037    01:D880             	.font:		incbin	"data/font8x8-bold-short-iso646-fr.dat", 128
 1038                        	
 1039                        			.endp
 1040                        	
 1041                        	
 1042                        	
 1043                        	; ***************************************************************************
 1044                        	; ***************************************************************************
 1045                        	;
 1046                        	; HuC Text Output
 1047                        	;
 1048                        	; ***************************************************************************
 1049                        	; ***************************************************************************
 1050                        	
 1051                        	
 1052                        	
 1053    02:D62E             	vdc_tty_out	.procgroup			; These routines share code!
 1054                        	
 1055                        	; ***************************************************************************
 1056                        	; ***************************************************************************
 1057                        	;
 1058                        	; void __fastcall put_char( unsigned char digit<_bl>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
 1059                        	
 1060               0001     		.if	SUPPORT_SGX
 1061                        	put_char_sgx	.proc
 1067                        			.endp
 1068                        		.endif
 1069                        	
 1070    02:D62E             	put_char_vdc	.proc
 1071                        	
 1072    02:D62E  82         			clx				; Offset to PCE VDC.
 1073                        	
 1074    02:D62F  20 34 E4   			jsr	set_di_xy_mawr
 1075                        	
 1076    02:D632  62         			cla				; Push EOL marker.
 1077    02:D633  48         			pha
 1078                        	
 1079    02:D634  A5 FA      			lda	<_bl
 1080    02:D636  48         			pha				; Push character to output.
 1081    02:D637  80 58      			bra	!output+
 1082                        	
 1083    02:D639             			.ref	put_hex_vdc		; Need put_number_vdc
 1084                        			.endp
 1085                        	
 1086    02:D639             			.alias	_put_char.3		= put_char_vdc
 1087                        	
 1088                        	
 1089                        	
 1090                        	; ***************************************************************************
 1091                        	; ***************************************************************************
 1092                        	;
 1093                        	; void __fastcall put_digit( unsigned char digit<_bl>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
 1094                        	
 1095               0001     		.if	SUPPORT_SGX
 1096                        	put_digit_sgx	.proc
 1102                        			.endp
 1103                        		.endif
 1104                        	
 1105    02:D639             	put_digit_vdc	.proc
 1106                        	
 1107    02:D639  82         			clx				; Offset to PCE VDC.
 1108                        	
 1109    02:D63A  20 34 E4   			jsr	set_di_xy_mawr
 1110                        	
 1111    02:D63D  62         			cla				; Push EOL marker.
 1112    02:D63E  48         			pha
 1113                        	
 1114    02:D63F  A5 FA      			lda	<_bl			; Convert hex digit to ASCII.
 1115    02:D641  29 0F      			and	#$0F
 1116    02:D643  C9 0A      			cmp	#10
 1117    02:D645  90 02      			bcc	!+
 1118    02:D647  69 06      			adc	#6
 1119    02:D649  69 30      	!:		adc	#'0'
 1120    02:D64B  48         			pha				; Push character to output.
 1121    02:D64C  80 43      			bra	!output+
 1122                        	
 1123    02:D64E             			.ref	put_hex_vdc		; Need put_number_vdc
 1124                        			.endp
 1125                        	
 1126    02:D64E             			.alias	_put_digit.3		= put_digit_vdc
 1127                        	
 1128                        	
 1129                        	
 1130                        	; ***************************************************************************
 1131                        	; ***************************************************************************
 1132                        	;
 1133                        	; void __fastcall put_hex( unsigned int number<_bx>, unsigned char length<_cl>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
 1134                        	
 1135               0001     		.if	SUPPORT_SGX
 1136                        	put_hex_sgx	.proc
 1141                        			.endp
 1142                        		.endif
 1143                        	
 1144    02:D64E             	put_hex_vdc	.proc
 1145                        	
 1146    02:D64E  82         			clx				; Offset to PCE VDC.
 1147                        	
 1148    02:D64F  20 34 E4   			jsr	set_di_xy_mawr
 1149                        	
 1150    02:D652  A4 FC      			ldy	<_cl			; Total #characters to print,
 1151    02:D654  F0 3E      			beq	!exit+			; NOT minimum #characters!
 1152                        	
 1153    02:D656  86 00      			stx	<__temp			; Preserve which VDC.
 1154                        	
 1155    02:D658  82         			clx				; Push EOL marker.
 1156    02:D659  DA         			phx
 1157                        	
 1158    02:D65A  B5 FA      	.hex_byte:	lda.l	<_bx, x			; Convert hex digit to ASCII.
 1159    02:D65C  29 0F      			and	#$0F
 1160    02:D65E  C9 0A      			cmp	#10
 1161    02:D660  90 02      			bcc	!+
 1162    02:D662  69 06      			adc	#6
 1163    02:D664  69 30      	!:		adc	#'0'
 1164    02:D666  48         			pha				; Push character to output.
 1165    02:D667  88         			dey
 1166    02:D668  F0 15      			beq	.hex_done
 1167                        	
 1168    02:D66A  B5 FA      			lda.l	<_bx, x			; Convert hex digit to ASCII.
 1169    02:D66C  4A         			lsr	a
 1170    02:D66D  4A         			lsr	a
 1171    02:D66E  4A         			lsr	a
 1172    02:D66F  4A         			lsr	a
 1173    02:D670  C9 0A      			cmp	#10
 1174    02:D672  90 02      			bcc	!+
 1175    02:D674  69 06      			adc	#6
 1176    02:D676  69 30      	!:		adc	#'0'
 1177    02:D678  48         			pha				; Push character to output.
 1178    02:D679  88         			dey
 1179    02:D67A  F0 03      			beq	.hex_done
 1180                        	
 1181    02:D67C  E8         			inx
 1182    02:D67D  80 DB      			bra	.hex_byte
 1183                        	
 1184    02:D67F  A6 00      	.hex_done:	ldx	<__temp			; Restore which VDC.
 1185    02:D681  80 0E      			bra	!output+
 1186                        	
 1187    02:D683  18         	.write:		clc
 1188    02:D684  7D 91 26   			adc.l	_vdc_font_base, x
 1189    02:D687  9D 02 02   			sta	VDC_DL, x
 1190    02:D68A  62         			cla
 1191    02:D68B  7D 92 26   			adc.h	_vdc_font_base, x
 1192    02:D68E  9D 03 02   			sta	VDC_DH, x
 1193                        	
 1194    02:D691  68         	!output:	pla				; Pop the digits and output.
 1195    02:D692  D0 EF      			bne	.write
 1196                        	
 1197                        	!exit:		leave				; All done!
         02:D694  4C EF FF   			jmp	leave_proc
 1198                        	
 1199                        			.endp
 1200                        	
 1201    02:D697             			.alias	_put_hex.4 = put_hex_vdc
 1202                        	
 1203                        	
 1204                        	
 1205                        	; ***************************************************************************
 1206                        	; ***************************************************************************
 1207                        	;
 1208                        	; void __fastcall put_number( unsigned int number<_bx>, unsigned char length<_cl>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
 1209                        	
 1210               0001     		.if	SUPPORT_SGX
 1211                        	put_number_sgx	.proc
 1216                        			.endp
 1217                        		.endif
 1218                        	
 1219    02:D697             	put_number_vdc	.proc
 1220                        	
 1221    02:D697  82         			clx				; Offset to PCE VDC.
 1222                        	
 1223    02:D698  20 34 E4   			jsr	set_di_xy_mawr
 1224                        	
 1225    02:D69B  A4 FC      			ldy	<_cl			; Total #characters to print,
 1226    02:D69D  F0 F5      			beq	!exit-			; NOT minimum #characters!
 1227                        	
 1228    02:D69F  86 00      			stx	<__temp			; Preserve which VDC.
 1229                        	
 1230    02:D6A1  82         			clx				; Push EOL marker.
 1231    02:D6A2  DA         			phx
 1232                        	
 1233    02:D6A3  A6 FB      			ldx.h	<_bx			; Is the number -ve?
 1234    02:D6A5  86 FC      			stx	<_cl			; Remember this.
 1235    02:D6A7  10 10      			bpl	.divide_by_ten
 1236                        	
 1237    02:D6A9  38         			sec				; Make the number +ve.
 1238    02:D6AA  A5 FA      			lda.l	<_bx
 1239    02:D6AC  49 FF      			eor	#$FF
 1240    02:D6AE  69 00      			adc	#0
 1241    02:D6B0  85 FA      			sta.l	<_bx
 1242    02:D6B2  8A         			txa
 1243    02:D6B3  49 FF      			eor	#$FF
 1244    02:D6B5  69 00      			adc	#0
 1245    02:D6B7  85 FB      			sta.h	<_bx
 1246                        	
 1247    02:D6B9  A2 10      	.divide_by_ten:	ldx	#16
 1248    02:D6BB  62         			cla				; Clear Remainder.
 1249    02:D6BC  06 FA      			asl.l	<_bx			; Rotate Dividend, MSB -> C.
 1250    02:D6BE  26 FB      			rol.h	<_bx
 1251    02:D6C0  2A         	.divide_loop:	rol	a			; Rotate C into Remainder.
 1252    02:D6C1  C9 0A      			cmp	#10			; Test Divisor.
 1253    02:D6C3  90 02      			bcc	.divide_less		; CC if Divisor > Remainder.
 1254    02:D6C5  E9 0A      			sbc	#10			; Subtract Divisor.
 1255    02:D6C7  26 FA      	.divide_less:	rol.l	<_bx			; Quotient bit -> Dividend LSB.
 1256    02:D6C9  26 FB      			rol.h	<_bx			; Rotate Dividend, MSB -> C.
 1257    02:D6CB  CA         			dex
 1258    02:D6CC  D0 F2      			bne	.divide_loop
 1259                        	
 1260    02:D6CE  18         			clc
 1261    02:D6CF  69 30      			adc	#'0'			; Always leaves C clr.
 1262    02:D6D1  48         			pha				; Push character to output.
 1263    02:D6D2  88         			dey
 1264    02:D6D3  F0 10      			beq	!pad+
 1265    02:D6D5  A5 FA      			lda.l	<_bx			; Repeat while non-zero.
 1266    02:D6D7  05 FB      			ora.h	<_bx
 1267    02:D6D9  D0 DE      			bne	.divide_by_ten
 1268                        	
 1269    02:D6DB  A6 00      			ldx	<__temp			; Restore which VDC.
 1270                        	
 1271    02:D6DD  A5 FC      			lda	<_cl			; Was the number -ve?
 1272    02:D6DF  10 04      			bpl	!pad+
 1273    02:D6E1  A9 2D      			lda	#'-'			; Output a leading '-'.
 1274    02:D6E3  48         			pha
 1275    02:D6E4  88         			dey
 1276                        	
 1277    02:D6E5  A9 20      	!pad:		lda	#' '			; Add padding characters.
 1278    02:D6E7  88         	.loop:		dey
 1279    02:D6E8  30 A7      			bmi	!output-
 1280    02:D6EA  48         			pha
 1281    02:D6EB  80 FA      			bra	.loop
 1282                        	
 1283    02:D6ED             			.ref	put_hex_vdc		; Need put_number_vdc
 1284                        	
 1285                        			.endp
 1286                        	
 1287    02:D6ED             			.alias	_put_number.4 = put_number_vdc
 1288                        	
 1289                        	
 1290                        	
 1291                        	; ***************************************************************************
 1292                        	; ***************************************************************************
 1293                        	;
 1294                        	; void __fastcall put_raw( unsigned int data<_bx>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
 1295                        	
 1296               0001     		.if	SUPPORT_SGX
 1297                        	put_raw_sgx	.proc
 1302                        			.endp
 1303                        		.endif
 1304                        	
 1305                        	put_raw_vdc	.proc
 1318                        			.endp
 1319                        	
 1320    02:D6ED             			.alias	_put_raw.3		= put_raw_vdc
 1321                        	
 1322                        			.endprocgroup			; vdc_tty_out
 1323                        	
 1324                        	
 1325                        	
 1326                        	; ***************************************************************************
 1327                        	; ***************************************************************************
 1328                        	;
 1329                        	; void __fastcall put_string( unsigned char *string<_bp>, unsigned char bat_x<_dil>, unsigned char bat_y<_dih> );
 1330                        	;
 1331                        	; N.B. This is not a .proc right now because it is called from procedures
 1332                        	; that contain embedded strings, and the string aren't banked in before
 1333                        	; printing (yet).
 1334                        	
 1335               0001     		.if	SUPPORT_SGX
 1336    00:E665             	_sgx_put_string.3:
 1337    00:E665  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
 1338    00:E667  F0         			db	$F0			; Turn "clx" into a "beq".
 1339                        		.endif
 1340                        	
 1341    00:E668  82         	_put_string.3:	clx				; Offset to PCE VDC.
 1342                        	
 1343    00:E669  20 34 E4   			jsr	set_di_xy_mawr
 1344                        	
 1345    00:E66C  C2         			cly
 1346    00:E66D  B1 EC      	.chr_loop:	lda	[_bp], y
 1347    00:E66F  F0 15      			beq	.done
 1348                        	
 1349    00:E671  18         			clc
 1350    00:E672  7D 91 26   			adc.l	_vdc_font_base, x
 1351    00:E675  9D 02 02   			sta	VDC_DL, x
 1352    00:E678  62         			cla
 1353    00:E679  7D 92 26   			adc.h	_vdc_font_base, x
 1354    00:E67C  9D 03 02   			sta	VDC_DH, x
 1355                        	
 1356    00:E67F  C8         			iny
 1357    00:E680  D0 EB      			bne	.chr_loop
 1358    00:E682  E6 ED      			inc.h	<_bp
 1359    00:E684  80 E7      			bra	.chr_loop
 1360                        	
 1361    00:E686  60         	.done:		rts
 1362                        	
 1363                        	
 1364                        	
 1365                        	; ***************************************************************************
 1366                        	; ***************************************************************************
 1367                        	;
 1368                        	; void __fastcall set_color_rgb( unsigned int index<VCE_CTA>, unsigned char r<_al>, unsigned char g<_ah>, unsigned char b<acc> );
 1369                        	;
 1370                        	; r:	red	RED:	bit 3-5
 1371                        	; g:	green	GREEN:	bit 6-8
 1372                        	; b:	blue	BLUE:	bit 0-2
 1373                        	
 1374    00:E687             	_set_color_rgb.4:
 1375                        	;		and	#7
 1376    00:E687  85 00      			sta	<__temp
 1377    00:E689  A5 F8      			lda	<_al
 1378                        	;		and	#7
 1379    00:E68B  0A         			asl	a
 1380    00:E68C  0A         			asl	a
 1381    00:E68D  0A         			asl	a
 1382    00:E68E  05 00      			ora	<__temp
 1383    00:E690  0A         			asl	a
 1384    00:E691  0A         			asl	a
 1385    00:E692  85 00      			sta	<__temp
 1386    00:E694  A5 F9      			lda	<_ah
 1387                        	;		and	#7
 1388    00:E696  4A         			lsr	a
 1389    00:E697  66 00      			ror	<__temp
 1390    00:E699  4A         			lsr	a
 1391    00:E69A  66 00      			ror	<__temp
 1392    00:E69C  A8         			tay
 1393    00:E69D  A5 00      			lda	<__temp
 1394    00:E69F  8D 04 04   			sta.l	VCE_CTW
 1395    00:E6A2  8C 05 04   			sty.h	VCE_CTW
 1396    00:E6A5  60         			rts
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
   60                        		.endif
   61                        	
   62               0001     		.ifdef	HUCC_USES_STRING		; Set in hucc_string.h
                             #[3]   "..\..\..\include\hucc\hucc-string.asm"
   63                        			include	"hucc-string.asm"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; hucc-string.asm
    5                        	;
    6                        	; Not-quite-standard, but fast, replacements for <string.h>.
    7                        	;
    8                        	; Copyright John Brandwood 2024.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	;
   17                        	; !!! WARNING : non-standard return values !!!
   18                        	;
   19                        	; Strings are limited to a maximum of 255 characters (+ the terminator)!
   20                        	;
   21                        	; The memcpy(), strcpy() and strcat() functions do NOT return the destination
   22                        	; address, and they are declared "void" to check that the value is not used.
   23                        	;
   24                        	; mempcpy() is provided which returns the end address instead of the starting
   25                        	; address, because this is typically more useful.
   26                        	;
   27                        	; Please note that both memcpy() and memset() are implemented using a TII for
   28                        	; speed, and so the length should be < 16 bytes if used in time-critical bits
   29                        	; of code (such as when using a split screen) because they delay interrupts.
   30                        	;
   31                        	; strncpy() and strncat() are not provided, because strncpy() was not created
   32                        	; for the purpose of avoiding string overruns, and strncat() is just a poorly
   33                        	; designed function.
   34                        	;
   35                        	; POSIX strlcpy() and strlcat() are provided instead, but once again they are
   36                        	; slightly non-standard in that the return value when there is an overflow is
   37                        	; the buffer size (so that the overflow can be detected), instead of the full
   38                        	; size of the destination string that was too big to fit in the buffer.
   39                        	;
   40                        	; ***************************************************************************
   41                        	; ***************************************************************************
   42                        	
   43                        	
   44                        	
   45                        	; ***************************************************************************
   46                        	; ***************************************************************************
   47                        	;
   48                        	; void __fastcall strcpy( char *destination<_di>, char *source<_bp> );
   49                        	; void __fastcall strcat( char *destination<_di>, char *source<_bp> );
   50                        	;
   51                        	; unsigned int __fastcall strlcpy( char *destination<_di>, char *source<_bp>, unsigned char size<acc> );
   52                        	; unsigned int __fastcall strlcat( char *destination<_di>, char *source<_bp>, unsigned char size<acc> );
   53                        	; unsigned int __fastcall strlen( char *source<_bp> );
   54                        	;
   55                        	; NOT WORKING YET (needs compiler changes) ...
   56                        	;
   57                        	; void __fastcall strcpy( char *destination<_di>, char __far *source<_bp_bank:_bp> );
   58                        	; void __fastcall strcat( char *destination<_di>, char __far *source<_bp_bank:_bp> );
   59                        	;
   60                        	; unsigned int __fastcall strlcpy( char *destination<_di>, char __far *source<_bp_bank:_bp>, unsigned char size<acc> );
   61                        	; unsigned int __fastcall strlcat( char *destination<_di>, char __far *source<_bp_bank:_bp>, unsigned char size<acc> );
   62                        	; unsigned int __fastcall strlen( char __far *source<_bp_bank:_bp> );
   63                        	
   64    00:E6A6  62         	_strcat:	cla				; Max string length == 256!
   65    00:E6A7  A0 01      			ldy.h	#256
   66                        	
   67    00:E6A9  AA         	_strlcat:	tax				; X = buffer length (1..256).
   68                        	
   69               0000     		.ifdef	_DEBUG
   74                        		.endif
   75                        	
   76    00:E6AA  43 08      			tma3				; Preserve MPR3 and MPR4.
   77    00:E6AC  48         			pha
   78    00:E6AD  43 10      			tma4
   79    00:E6AF  48         			pha
   80                        	
   81                        	;		ldy	<_bp_bank		; Map the source string.
   82                        	;		beq	.no_bank
   83                        	;		jsr	map_bp_to_mpr34
   84                        	
   85    00:E6B0  C2         	.no_bank:	cly
   86                        	
   87    00:E6B1  B1 F0      	.find:		lda	[_di], y		; Find the end of the string.
   88    00:E6B3  F0 08      			beq	.adjust
   89    00:E6B5  C8         			iny
   90    00:E6B6  CA         			dex
   91    00:E6B7  D0 F8      			bne	.find
   92    00:E6B9  98         			tya				; A:Y = buffer length.
   93    00:E6BA  62         			cla
   94    00:E6BB  80 28      			bra	str_overflow
   95                        	
   96    00:E6BD  98         	.adjust:	tya				; Subtract Y from _bp so that
   97    00:E6BE  49 FF      			eor	#$FF			; _bp and _di use the same Y.
   98    00:E6C0  38         			sec
   99    00:E6C1  65 EC      			adc.l	<_bp
  100    00:E6C3  85 EC      			sta.l	<_bp
  101    00:E6C5  B0 0F      			bcs	str_copy
  102    00:E6C7  C6 ED      			dec.h	<_bp
  103    00:E6C9  80 0B      			bra	str_copy
  104                        	
  105                        			;
  106                        	
  107    00:E6CB  62         	_strcpy:	cla				; Max string length == 256!
  108    00:E6CC  A0 01      			ldy.h	#256
  109                        	
  110    00:E6CE  AA         	_strlcpy:	tax				; X = buffer length (1..256).
  111                        	
  112               0000     		.ifdef	_DEBUG
  117                        		.endif
  118                        	
  119    00:E6CF  43 08      			tma3				; Preserve MPR3 and MPR4.
  120    00:E6D1  48         			pha
  121    00:E6D2  43 10      			tma4
  122    00:E6D4  48         			pha
  123                        	
  124                        	;		ldy	<_bp_bank		; Map the source string.
  125                        	;		beq	.no_bank
  126                        	;		jsr	map_bp_to_mpr34
  127                        	
  128    00:E6D5  C2         	.no_bank:	cly
  129                        	
  130    00:E6D6  B1 EC      	str_copy:	lda	[_bp], y
  131    00:E6D8  91 F0      			sta	[_di], y
  132    00:E6DA  F0 1E      			beq	str_exit		; A:Y = string length.
  133    00:E6DC  C8         			iny
  134    00:E6DD  CA         			dex
  135    00:E6DE  D0 F6      			bne	str_copy
  136                        	
  137    00:E6E0  88         			dey
  138    00:E6E1  62         			cla
  139    00:E6E2  91 F0      			sta	[_di], y
  140    00:E6E4  C8         			iny				; A:Y = buffer length.
  141    00:E6E5  D0 13      	str_overflow:	bne	str_exit
  142    00:E6E7  1A         			inc	a			; A:Y = buffer length = 256.
  143    00:E6E8  80 10      			bra	str_exit
  144                        	
  145                        			;
  146                        	
  147    00:E6EA  43 08      	_strlen:	tma3
  148    00:E6EC  48         			pha
  149    00:E6ED  43 10      			tma4
  150    00:E6EF  48         			pha
  151                        	
  152                        	;		ldy	<_bp_bank
  153                        	;		beq	.no_bank
  154                        	;		jsr	map_bp_to_mpr34
  155                        	
  156    00:E6F0  C2         	.no_bank:	cly
  157                        	
  158    00:E6F1  B1 EC      	.find:		lda	[_bp], y
  159    00:E6F3  F0 05      			beq	str_exit
  160    00:E6F5  C8         			iny
  161    00:E6F6  D0 F9      			bne	.find
  162    00:E6F8  A9 01      			lda.h	#256			; A:Y = overflow length = 256.
  163                        	
  164    00:E6FA  AA         	str_exit:	tax				; X:Y = string or buffer length.
  165                        	
  166    00:E6FB  68         			pla				; Restore MPR3 and MPR4.
  167    00:E6FC  53 10      			tam4
  168    00:E6FE  68         			pla
  169    00:E6FF  53 08      			tam3
  170                        	
  171    00:E701  8A         			txa				; A:Y = string or buffer length.
  172    00:E702  42         			say				; Y:A = string or buffer length.
  173                        	
  174    00:E703  60         			rts
  175                        	
  176    00:E704             			.alias	_strlen.1		= _strlen
  177    00:E704             			.alias	_strcpy.2		= _strcpy
  178    00:E704             			.alias	_strcat.2		= _strcat
  179    00:E704             			.alias	_strlcpy.3		= _strlcpy
  180    00:E704             			.alias	_strlcat.3		= _strlcat
  181                        	
  182                        	
  183                        	
  184                        	; ***************************************************************************
  185                        	; ***************************************************************************
  186                        	;
  187                        	; void __fastcall memcpy( unsigned char *destination<ram_tii_dst>, unsigned char  *source<ram_tii_src>, unsigned int count<acc> );
  188                        	; unsigned char * __fastcall mempcpy( unsigned char *destination<ram_tii_dst>, unsigned char  *source<ram_tii_src>, unsigned int count<acc> );
  189                        	;
  190                        	; void __fastcall farmemcpy( unsigned char *destination<ram_tii_dst>, unsigned char __far *source<_bp_bank:ram_tii_src>, unsigned int count<acc> );
  191                        	; unsigned char * __fastcall farmempcpy( unsigned char *destination<ram_tii_dst>, unsigned char __far *source<_bp_bank:ram_tii_src>, unsigned int count<acc> );
  192                        	;
  193                        	; void __fastcall far_memcpy( unsigned char *destination<ram_tii_dst>, unsigned int count<acc> );
  194                        	; unsigned char * __fastcall far_mempcpy( unsigned char *destination<ram_tii_dst>, unsigned int count<acc> );
  195                        	;
  196                        	
  197    00:E704             	_memcpy.3:
  198    00:E704  64 02      	_mempcpy.3:	stz	<_bp_bank		; Map the source memory.
  199                        	
  200    00:E706             	_farmemcpy.3:
  201    00:E706  8C FE 22   	_farmempcpy.3:	sty.h	ram_tii_len		; Check for zero length.
  202    00:E709  8D FD 22   			sta.l	ram_tii_len
  203    00:E70C  0D FE 22   			ora.h	ram_tii_len
  204    00:E70F  F0 18      			beq	.zero_length
  205                        	
  206    00:E711  43 08      			tma3				; Preserve MPR3 and MPR4.
  207    00:E713  48         			pha
  208    00:E714  43 10      			tma4
  209    00:E716  48         			pha
  210                        	
  211    00:E717  A5 02      			lda	<_bp_bank		; Map the source memory.
  212    00:E719  F0 05      			beq	.no_bank
  213                        	
  214    00:E71B  53 08      			tam3				; Put bank into MPR3.
  215    00:E71D  1A         			inc	a
  216    00:E71E  53 10      			tam4				; Put next into MPR4.
  217                        	
  218                        	;		lda.h	ram_tii_src		; Remap ptr to MPR3.
  219                        	;		and	#$1F
  220                        	;		ora	#$60
  221                        	;		sta.h	ram_tii_src
  222                        	
  223    00:E720  20 F8 22   	.no_bank:	jsr	ram_tii			; Copy the memory.
  224                        	
  225    00:E723  68         			pla				; Restore MPR3 and MPR4.
  226    00:E724  53 10      			tam4
  227    00:E726  68         			pla
  228    00:E727  53 08      			tam3
  229                        	
  230    00:E729  18         	.zero_length:	clc				; Return the end address
  231    00:E72A  AD FB 22   			lda.l	ram_tii_dst		; like mempcpy().
  232    00:E72D  6D FD 22   			adc.l	ram_tii_len
  233    00:E730  A8         			tay
  234    00:E731  AD FC 22   			lda.h	ram_tii_dst
  235    00:E734  6D FE 22   			adc.h	ram_tii_len
  236    00:E737  42         			say
  237                        	
  238    00:E738  60         			rts
  239                        	
  240    00:E739             			.alias	_far_memcpy.2		= _farmemcpy.3
  241    00:E739             			.alias	_far_mempcpy.2		= _farmempcpy.3
  242                        	
  243                        	
  244                        	
  245                        	; ***************************************************************************
  246                        	; ***************************************************************************
  247                        	;
  248                        	; void __fastcall memset( unsigned char *destination<ram_tii_src>, unsigned char value<_al>, unsigned int count<acc> );
  249                        	
  250    00:E739  C9 00      	_memset:	cmp	#0			; Decrement the length, check
  251    00:E73B  D0 05      			bne	!+			; for zero and set C. 
  252    00:E73D  C0 00      			cpy	#0
  253    00:E73F  F0 23      			beq	.zero_length
  254    00:E741  88         			dey
  255    00:E742  3A         	!:		dec	a
  256    00:E743  8D FD 22   			sta.l	ram_tii_len
  257    00:E746  8C FE 22   			sty.h	ram_tii_len
  258                        	
  259    00:E749  AD F9 22   			lda.l	ram_tii_src		; ram_tii_dst = ram_tii_src + 1
  260    00:E74C  85 88      			sta.l	<__ptr
  261    00:E74E  69 00      			adc	#0
  262    00:E750  8D FB 22   			sta.l	ram_tii_dst
  263    00:E753  AD FA 22   			lda.h	ram_tii_src
  264    00:E756  85 89      			sta.h	<__ptr
  265    00:E758  69 00      			adc	#0
  266    00:E75A  8D FC 22   			sta.h	ram_tii_dst
  267                        	
  268    00:E75D  A5 F8      			lda	<_al			; Set the fill value.
  269    00:E75F  92 88      			sta	[__ptr]
  270                        	
  271    00:E761  4C F8 22   			jmp	ram_tii			; Copy the memory.
  272                        	
  273    00:E764  60         	.zero_length:	rts
  274                        	
  275    00:E765             			.alias	_memset.3		= _memset
  276                        	
  277                        	
  278                        	
  279                        	; ***************************************************************************
  280                        	; ***************************************************************************
  281                        	;
  282                        	; int __fastcall strcmp( char *string1<_di>, char *string2<_bp> );
  283                        	; int __fastcall strncmp( char *string1<_di>, char *string2<_bp>, unsigned int count<_ax> );
  284                        	;
  285                        	; int __fastcall __macro memcmp( unsigned char *string1<_di>, unsigned char *string2<_bp>, unsigned int count<_ax> );
  286                        	; int __fastcall farmemcmp( unsigned char *string1<_di>, unsigned char __far *string2<_bp_bank:_bp>, unsigned int count<_ax> );
  287                        	; int __fastcall far_memcmp( unsigned char *string1<_di>, unsigned int count<_ax> );
  288                        	;
  289                        	;  0 	if strings are equal
  290                        	;  1 	if the first non-matching character in string1 > string2 (in ASCII).
  291                        	; -1 	if the first non-matching character in string1 < string2 (in ASCII).
  292                        	
  293    12:DFA5             	hucc_memcmp	.procgroup
  294                        	
  295                        	_strcmp.2	.proc
  300                        			.endp				; Fall through.
  301                        	
  302    12:DFA5             	_strncmp.3	.proc
  303    12:DFA5  64 02      			stz	<_bp_bank		; Assume strings are mapped.
  304    12:DFA7  89 40      			bit	#$40			; Set the V bit for strcmp.
  305    12:DFA9  50         			db	$50			; Turn "clv" into "bvc".
  306    12:DFAA             			.ref	_farmemcmp.3		; Don't strip _farmemcmp.3!
  307                        			.endp				; Fall through.
  308                        	
  309    12:DFAA             	_farmemcmp.3	.proc
  310    12:DFAA  B8         			clv				; Clr the V bit for memcmp.
  311                        	
  312    12:DFAB  43 08      			tma3				; Preserve MPR3 and MPR4.
  313    12:DFAD  48         			pha
  314    12:DFAE  43 10      			tma4
  315    12:DFB0  48         			pha
  316                        	
  317    12:DFB1  A4 02      			ldy	<_bp_bank		; Map string2.
  318    12:DFB3  F0 03      			beq	.no_bank
  319                        	
  320    12:DFB5  20 3B E3   			jsr	map_bp_to_mpr34
  321                        	
  322    12:DFB8  C2         	.no_bank:	cly
  323                        	
  324    12:DFB9  A6 F8      			ldx.l	<_ax			; Increment length.l
  325    12:DFBB  E8         			inx
  326    12:DFBC  CA         	.loop:		dex				; Decrement length.l
  327    12:DFBD  F0 17      			beq	.page
  328    12:DFBF  B1 F0      	.test:		lda	[_di], y		; string1 - string2
  329    12:DFC1  D1 EC      			cmp	[_bp], y
  330    12:DFC3  90 1E      			bcc	.return_neg		; string1 < string2 
  331    12:DFC5  D0 17      			bne	.return_pos		; string1 > string2
  332    12:DFC7  50 04      			bvc	!+			; Only check for end-of-string
  333    12:DFC9  C9 00      			cmp	#0			; if the V flag is set.
  334    12:DFCB  F0 0D      			beq	.return_same
  335    12:DFCD  C8         	!:		iny
  336    12:DFCE  D0 EC      			bne	.loop
  337    12:DFD0  E6 F1      			inc.h	<_di
  338    12:DFD2  E6 ED      			inc.h	<_bp			; Limited to 8KB maximum!
  339                        	;		jsr	inc.h_bp_mpr34
  340    12:DFD4  80 E6      			bra	.loop
  341                        	
  342    12:DFD6  C6 F9      	.page:		dec.h	<_ax			; Decrement length.h 
  343    12:DFD8  10 E5      			bpl	.test			; Limit comparison to 32KB.
  344                        	;		bra	cmp_same
  345                        	
  346    12:DFDA  82         	.return_same:	clx				; Return code in Y:X, X -> A.
  347    12:DFDB  C2         			cly
  348    12:DFDC  80 09      			bra	!+
  349                        	
  350    12:DFDE  A2 01      	.return_pos:	ldx	#$01			; Return code in Y:X, X -> A.
  351    12:DFE0  C2         			cly
  352    12:DFE1  80 04      			bra	!+
  353                        	
  354    12:DFE3  A2 FF      	.return_neg:	ldx	#$FF			; Return code in Y:X, X -> A.
  355    12:DFE5  A0 FF      			ldy	#$FF
  356                        	
  357    12:DFE7  68         	!:		pla				; Restore MPR3 and MPR4.
  358    12:DFE8  53 10      			tam4
  359    12:DFEA  68         			pla
  360    12:DFEB  53 08      			tam3
  361                        	
  362                        			leave				; Return and copy X -> A.
         12:DFED  4C EF FF   			jmp	leave_proc
  363                        	
  364                        			.endp
  365                        	
  366                        			.endprocgroup			; hucc_memcmp
  367                        	
  368    00:E765             			.alias	_far_memcmp.2		= _farmemcmp.3
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
   64                        		.endif
   65                        	
   66               0001     		.ifdef	HUCC_USES_NEW_SCROLL		; Set in hucc_scroll.h
                             #[3]   "..\..\..\include\hucc\hucc-scroll.asm"
   67                        			include	"hucc-scroll.asm"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; hucc-scroll.asm
    5                        	;
    6                        	; Routines for a fast split-screen scrolling system.
    7                        	;
    8                        	; Copyright John Brandwood 2024.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	;
   17                        	; The maximum number of splits for each screen layer is set in your project's
   18                        	; "hucc-config.inc" file, with the library having a limit of 128-per-layer.
   19                        	;
   20                        	; Your first active split must be defined to start at screen line 0, and then
   21                        	; the rest of the active splits must be in increasing line order to match the
   22                        	; way that the PC Engine displays the output image.
   23                        	;
   24                        	; You can have disabled splits interleaved with your active splits.
   25                        	;
   26                        	; Splits that are normally disabled can be used to create full screen effects
   27                        	; such as bouncing the screen up and down by adding blank areas at the top or
   28                        	; bottom of the screen, and then rapidly changing the height of those areas.
   29                        	;
   30                        	; ***************************************************************************
   31                        	; ***************************************************************************
   32                        	
   33                        	
   34                        	
   35               0000     		.ifndef	HUCC_PCE_SPLITS
   37                        		.endif
   38                        	
   39               0000     		.ifndef	HUCC_SGX_SPLITS
   41                        		.endif
   42                        	
   43               0000     		.if	(HUCC_PCE_SPLITS < 2) || (HUCC_PCE_SPLITS > 128)
   45                        		.endif
   46                        	
   47               0000     		.if	(HUCC_SGX_SPLITS < 2) || (HUCC_SGX_SPLITS > 128)
   49                        		.endif
   50                        	
   51               0144     	HUCC_1ST_RCR	=	$144
   52               00E0     	HUCC_SCR_HEIGHT	=	224
   53                        	
   54               E765     			.code
   55                        	
   56                        	
   57                        	
   58                        	; ***************************************************************************
   59                        	; ***************************************************************************
   60                        	;
   61                        	; void __fastcall scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
   62                        	; void __fastcall sgx_scroll_split( unsigned char index<_al>, unsigned char screen_line<_ah>, unsigned int bat_x<_bx>, unsigned int bat_y<_cx>, unsigned char display_flags<_dl> );
   63                        	;
   64                        	; set screen scrolling
   65                        	
   66                        			.proc	_scroll_split.5
  143                        			.endp
  144                        	
  145               0001     		.if	SUPPORT_SGX
  146                        	
  147    02:D82F             			.proc	_sgx_scroll_split.5
  148                        	
  149    02:D82F  08         			php				; Disable interrupts while
  150    02:D830  78         			sei				; updating this structure.
  151                        	
  152    02:D831  A6 F8      			ldx	<_al			; Region number.
  153    02:D833  E0 08      			cpx	#HUCC_SGX_SPLITS
  154    02:D835  B0 FE      	.hang:		bcs	.hang			; Better a hang than a crash!
  155                        	
  156    02:D837  BD 2A 27   			lda	sgx_region_sel, x	; Update the parameter copy
  157    02:D83A  5D 32 27   			eor	sgx_region_new, x	; that is not displayed now.
  158    02:D83D  D0 3B      			bne	.regionA
  159                        	
  160    02:D83F  A5 F9      	.regionB:	lda	<_ah			; Scanline (i.e. top).
  161    02:D841  C9 E0      			cmp	#HUCC_SCR_HEIGHT	; Skip if offscreen.
  162    02:D843  B0 31      			bcs	!done+
  163    02:D845  9D 52 27   			sta	sgx_regionB_rcr, x
  164                        	
  165    02:D848  C9 00      			cmp	#0			; Either Y at top of the frame
  166    02:D84A  F0 01      			beq	!+			; or Y-1 because the RCR code
  167    02:D84C  18         			clc				; sets it on the line before.
  168    02:D84D  A5 FC      	!:		lda.l	<_cx
  169    02:D84F  E9 00      			sbc	#0
  170    02:D851  9D 82 27   			sta	sgx_regionB_yl, x
  171    02:D854  A5 FD      			lda.h	<_cx
  172    02:D856  E9 00      			sbc	#0
  173    02:D858  9D 92 27   			sta	sgx_regionB_yh, x
  174                        	
  175    02:D85B  A5 FA      			lda.l	<_bx
  176    02:D85D  9D 62 27   			sta	sgx_regionB_xl, x
  177    02:D860  A5 FB      			lda.h	<_bx
  178    02:D862  9D 72 27   			sta	sgx_regionB_xh, x
  179                        	
  180    02:D865  A5 FE      			lda	<_dl
  181    02:D867  29 C0      			and	#$C0			; Flags (mark it as enabled).
  182    02:D869  09 0C      			ora	#$0C
  183    02:D86B  9D 42 27   			sta	sgx_regionB_crl, x
  184                        	
  185    02:D86E  A9 01      			lda	#1			; Mark that we've changed the
  186    02:D870  9D 32 27   			sta	sgx_region_new, x	; selected region.
  187    02:D873  9D 2A 27   			sta	sgx_region_sel, x
  188                        	
  189    02:D876  28         	!done:		plp				; Restore interrupts.
  190                        			leave				; All done!
         02:D877  4C EF FF   			jmp	leave_proc
  191                        	
  192    02:D87A  A5 F9      	.regionA:	lda	<_ah			; Scanline (i.e. top).
  193    02:D87C  C9 E0      			cmp	#HUCC_SCR_HEIGHT	; Skip if offscreen.
  194    02:D87E  B0 31      			bcs	!done+
  195    02:D880  9D 4A 27   			sta	sgx_regionA_rcr, x
  196                        	
  197    02:D883  C9 00      			cmp	#0			; Either Y at top of the frame
  198    02:D885  F0 01      			beq	!+			; or Y-1 because the RCR code
  199    02:D887  18         			clc				; sets it on the line before.
  200    02:D888  A5 FC      	!:		lda.l	<_cx
  201    02:D88A  E9 00      			sbc	#0
  202    02:D88C  9D 7A 27   			sta	sgx_regionA_yl, x
  203    02:D88F  A5 FD      			lda.h	<_cx
  204    02:D891  E9 00      			sbc	#0
  205    02:D893  9D 8A 27   			sta	sgx_regionA_yh, x
  206                        	
  207    02:D896  A5 FA      			lda.l	<_bx
  208    02:D898  9D 5A 27   			sta	sgx_regionA_xl, x
  209    02:D89B  A5 FB      			lda.h	<_bx
  210    02:D89D  9D 6A 27   			sta	sgx_regionA_xh, x
  211                        	
  212    02:D8A0  A5 FE      			lda	<_dl
  213    02:D8A2  29 C0      			and	#$C0			; Flags (mark it as enabled).
  214    02:D8A4  09 0C      			ora	#$0C
  215    02:D8A6  9D 3A 27   			sta	sgx_regionA_crl, x
  216                        	
  217    02:D8A9  A9 01      			lda	#1			; Mark that we've changed the
  218    02:D8AB  9D 32 27   			sta	sgx_region_new, x	; selected region.
  219    02:D8AE  9E 2A 27   			stz	sgx_region_sel, x
  220                        	
  221    02:D8B1  28         	!done:		plp				; Restore interrupts.
  222                        			leave				; All done!
         02:D8B2  4C EF FF   			jmp	leave_proc
  223                        	
  224                        			.endp
  225                        	
  226                        		.endif	SUPPORT_SGX
  227                        	
  228                        	
  229                        	
  230                        	; ***************************************************************************
  231                        	; ***************************************************************************
  232                        	;
  233                        	; void __fastcall disable_split( unsigned char index<acc> );
  234                        	; void __fastcall sgx_disable_split( unsigned char index<acc> );
  235                        	;
  236                        	; disable screen scrolling for a scroll region
  237                        	
  238    00:E765             	_disable_split.1:
  239    00:E765  08         			php				; Disable interrupts while
  240    00:E766  78         			sei				; updating this structure.
  241                        	
  242    00:E767  C9 08      			cmp	#HUCC_PCE_SPLITS	; Better a hang than a crash!
  243    00:E769  B0 FE      	.hang:		bcs	.hang
  244    00:E76B  AA         			tax
  245                        	
  246    00:E76C  BD A9 26   			lda	vdc_region_sel, x	; Update the parameter copy
  247    00:E76F  5D B1 26   			eor	vdc_region_new, x	; that is not displayed now.
  248    00:E772  D0 0D      			bne	.regionA
  249                        	
  250    00:E774  9E C1 26   	.regionB:	stz	vdc_regionB_crl, x	; Region disabled if $00.
  251                        	
  252    00:E777  A9 01      			lda	#1			; Mark that we've changed the
  253    00:E779  9D B1 26   			sta	vdc_region_new, x	; selected region.
  254    00:E77C  9D A9 26   			sta	vdc_region_sel, x
  255                        	
  256    00:E77F  28         			plp				; Restore interrupts.
  257    00:E780  60         			rts
  258                        	
  259    00:E781  9E B9 26   	.regionA:	stz	vdc_regionA_crl, x	; Region disabled if $00.
  260                        	
  261    00:E784  A9 01      			lda	#1			; Mark that we've changed the
  262    00:E786  9D B1 26   			sta	vdc_region_new, x	; selected region.
  263    00:E789  9E A9 26   			stz	vdc_region_sel, x
  264                        	
  265    00:E78C  28         			plp				; Restore interrupts.
  266    00:E78D  60         			rts
  267                        	
  268               0001     		.if	SUPPORT_SGX
  269                        	
  270    00:E78E             	_sgx_disable_split.1:
  271    00:E78E  08         			php				; Disable interrupts while
  272    00:E78F  78         			sei				; updating this structure.
  273                        	
  274    00:E790  C9 08      			cmp	#HUCC_SGX_SPLITS	; Better a hang than a crash!
  275    00:E792  B0 FE      	.hang:		bcs	.hang
  276    00:E794  AA         			tax
  277                        	
  278    00:E795  BD 2A 27   			lda	sgx_region_sel, x	; Update the parameter copy
  279    00:E798  5D 32 27   			eor	sgx_region_new, x	; that is not displayed now.
  280    00:E79B  D0 0D      			bne	.regionA
  281                        	
  282    00:E79D  9E 42 27   	.regionB:	stz	sgx_regionB_crl, x	; Region disabled if $00.
  283                        	
  284    00:E7A0  A9 01      			lda	#1			; Mark that we've changed the
  285    00:E7A2  9D 32 27   			sta	sgx_region_new, x	; selected region.
  286    00:E7A5  9D 2A 27   			sta	sgx_region_sel, x
  287                        	
  288    00:E7A8  28         			plp				; Restore interrupts.
  289    00:E7A9  60         			rts
  290                        	
  291    00:E7AA  9E 3A 27   	.regionA:	stz	sgx_regionA_crl, x	; Region disabled if $00.
  292                        	
  293    00:E7AD  A9 01      			lda	#1			; Mark that we've changed the
  294    00:E7AF  9D 32 27   			sta	sgx_region_new, x	; selected region.
  295    00:E7B2  9E 2A 27   			stz	sgx_region_sel, x
  296                        	
  297    00:E7B5  28         			plp				; Restore interrupts.
  298    00:E7B6  60         			rts
  299                        	
  300                        		.endif	SUPPORT_SGX
  301                        	
  302                        	
  303                        	
  304                        	; ***************************************************************************
  305                        	; ***************************************************************************
  306                        	;
  307                        	; vbl_init_scroll
  308                        	;
  309                        	; From Charles MacDonald's pcetech.txt ...
  310                        	;
  311                        	;  Raster Compare Register (RCR):
  312                        	;
  313                        	;  The range of the RCR is 263 lines, relative to the start of the active
  314                        	;  display period. (defined by VSW, VDS, and VCR) The VDC treats the first
  315                        	;  scanline of the active display period as $0040, so the valid ranges for
  316                        	;  the RCR register are $0040 to $0146.
  317                        	;
  318                        	;  For example, assume VSW=$02, VDS=$17. This positions the first line of
  319                        	;  the active display period at line 25 of the frame. An RCR value of $0040
  320                        	;  (zero) causes an interrupt at line 25, and a value of $0146 (262) causes an
  321                        	;  interrupt at line 24 of the next frame.
  322                        	;
  323                        	;  Any other RCR values that are out of range ($00-$3F, $147-$3FF) will never
  324                        	;  result in a successful line compare.
  325                        	;
  326                        	; Processing time:
  327                        	;
  328                        	; Old HuC rcr_init: 2148 cycles if all 8 regions pre-sorted
  329                        	; Old HuC rcr_init: 4346 cycles if all 8 regions need sorting
  330                        	;
  331                        	; New HuCC vbl_init_scroll:   8 disabled splits:  290 cycles
  332                        	; New HuCC vbl_init_scroll:   8  enabled splits:  384 cycles
  333                        	;
  334                        	; New HuCC vbl_init_scroll:  16 disabled splits:  506 cycles
  335                        	; New HuCC vbl_init_scroll:  16  enabled splits:  672 cycles
  336                        	;
  337                        	; New HuCC vbl_init_scroll:  32 disabled splits:  953 cycles
  338                        	; New HuCC vbl_init_scroll:  32  enabled splits: 1263 cycles
  339                        	;
  340                        	; New HuCC vbl_init_scroll:  64 disabled splits: 1802 cycles
  341                        	; New HuCC vbl_init_scroll:  64  enabled splits: 2400 cycles
  342                        	;
  343                        	; New HuCC vbl_init_scroll: 128 disabled splits: 3530 cycles
  344                        	; New HuCC vbl_init_scroll: 128  enabled splits: 4704 cycles
  345                        	;
  346                        	; Memory used is 16 bytes per scroll per VDC!
  347                        	
  348               26A9     			.bss
  349                        	
  350    F8:26A9             	vdc_region_sel:	.ds	HUCC_PCE_SPLITS		; Use A or B region next frame?
  351    F8:26B1             	vdc_region_new:	.ds	HUCC_PCE_SPLITS		; 1 if vdc_region_sel modified.
  352                        	
  353    F8:26B9             	vdc_regionA_crl:.ds	HUCC_PCE_SPLITS		; Two copies of each setting
  354    F8:26C1             	vdc_regionB_crl:.ds	HUCC_PCE_SPLITS		; HUCC_PCE_SPLITS bytes apart,
  355    F8:26C9             	vdc_regionA_rcr:.ds	HUCC_PCE_SPLITS		; one setting for the current
  356    F8:26D1             	vdc_regionB_rcr:.ds	HUCC_PCE_SPLITS		; frame, and one setting that
  357    F8:26D9             	vdc_regionA_xl:	.ds	HUCC_PCE_SPLITS		; gets modified and then used
  358    F8:26E1             	vdc_regionB_xl:	.ds	HUCC_PCE_SPLITS		; on the next frame after the
  359    F8:26E9             	vdc_regionA_xh:	.ds	HUCC_PCE_SPLITS		; change is made.
  360    F8:26F1             	vdc_regionB_xh:	.ds	HUCC_PCE_SPLITS		; Regions will have different
  361    F8:26F9             	vdc_regionA_yl:	.ds	HUCC_PCE_SPLITS		; A or B currently active!
  362    F8:2701             	vdc_regionB_yl:	.ds	HUCC_PCE_SPLITS
  363    F8:2709             	vdc_regionA_yh:	.ds	HUCC_PCE_SPLITS
  364    F8:2711             	vdc_regionB_yh:	.ds	HUCC_PCE_SPLITS
  365                        	
  366    F8:2719             	vdc_next_region:.ds	1			; Linked list of region indexes
  367    F8:271A             	vdc_regionA_nxt:.ds	HUCC_PCE_SPLITS		; for the current frame.
  368    F8:2722             	vdc_regionB_nxt:.ds	HUCC_PCE_SPLITS
  369                        	
  370               0001     		.if	SUPPORT_SGX
  371                        	
  372    F8:272A             	sgx_region_sel:	.ds	HUCC_SGX_SPLITS		; Use A or B region next frame?
  373    F8:2732             	sgx_region_new:	.ds	HUCC_SGX_SPLITS		; 1 if sgx_region_sel modified.
  374                        	
  375    F8:273A             	sgx_regionA_crl:.ds	HUCC_SGX_SPLITS		; Two copies of each setting
  376    F8:2742             	sgx_regionB_crl:.ds	HUCC_SGX_SPLITS		; HUCC_SGX_SPLITS bytes apart,
  377    F8:274A             	sgx_regionA_rcr:.ds	HUCC_SGX_SPLITS		; one setting for the current
  378    F8:2752             	sgx_regionB_rcr:.ds	HUCC_SGX_SPLITS		; frame, and one setting that
  379    F8:275A             	sgx_regionA_xl:	.ds	HUCC_SGX_SPLITS		; gets modified and then used
  380    F8:2762             	sgx_regionB_xl:	.ds	HUCC_SGX_SPLITS		; on the next frame after the
  381    F8:276A             	sgx_regionA_xh:	.ds	HUCC_SGX_SPLITS		; change is made.
  382    F8:2772             	sgx_regionB_xh:	.ds	HUCC_SGX_SPLITS		; Regions will have different
  383    F8:277A             	sgx_regionA_yl:	.ds	HUCC_SGX_SPLITS		; A or B currently active!
  384    F8:2782             	sgx_regionB_yl:	.ds	HUCC_SGX_SPLITS
  385    F8:278A             	sgx_regionA_yh:	.ds	HUCC_SGX_SPLITS
  386    F8:2792             	sgx_regionB_yh:	.ds	HUCC_SGX_SPLITS
  387                        	
  388    F8:279A             	sgx_next_region:.ds	1			; Linked list of region indexes
  389    F8:279B             	sgx_regionA_nxt:.ds	HUCC_SGX_SPLITS		; for the current frame.
  390    F8:27A3             	sgx_regionB_nxt:.ds	HUCC_SGX_SPLITS
  391                        	
  392                        		.endif
  393                        	
  394               E7B7     			.code
  395                        	
  396    02:D8B5             	vbl_init_scroll	.proc
  397                        	
  398    02:D8B5  62         			cla				; A = previous active index
  399    02:D8B6  A2 08      			ldx	#HUCC_PCE_SPLITS	; so $00 for end-of-screen.
  400                        	
  401    02:D8B8  18         			clc				; For regionB indexes.
  402                        	
  403    02:D8B9  CA         	!next_region:	dex				; All regions updated?
  404    02:D8BA  30 20      			bmi	!save_first+
  405                        	
  406    02:D8BC  9E B1 26   			stz	vdc_region_new, x	; Clear region modified flag.
  407                        	
  408    02:D8BF  BC A9 26   			ldy	vdc_region_sel, x	; 0=regionA or 1=regionB.
  409    02:D8C2  F0 0D      			beq	!use_regionA+
  410                        	
  411    02:D8C4  BC C1 26   	!use_regionB:	ldy	vdc_regionB_crl, x	; Region disabled if $00.
  412    02:D8C7  F0 F0      			beq	!next_region-
  413    02:D8C9  9D 22 27   			sta	vdc_regionB_nxt, x	; Save index of next region.
  414    02:D8CC  8A         			txa				; A = current region index.
  415    02:D8CD  69 08      			adc	#HUCC_PCE_SPLITS	; Always leaves CC!
  416    02:D8CF  80 E8      			bra	!next_region-
  417                        	
  418    02:D8D1  BC B9 26   	!use_regionA:	ldy	vdc_regionA_crl, x	; Region disabled if $00.
  419    02:D8D4  F0 E3      			beq	!next_region-
  420    02:D8D6  9D 1A 27   			sta	vdc_regionA_nxt, x	; Save index of next region.
  421    02:D8D9  8A         			txa				; A = current region index.
  422    02:D8DA  80 DD      			bra	!next_region-
  423                        	
  424    02:D8DC  8D 19 27   	!save_first:	sta	vdc_next_region		; Save index of 1st region.
  425                        	
  426    02:D8DF  AA         			tax				; NZ if first active region
  427    02:D8E0  D0 03      			bne	!init_first+		; is not region 0.
  428    02:D8E2  98         			tya				; NZ if region 0 is active.
  429    02:D8E3  F0 0F      			beq	!+			; If no active leave RCR=0.
  430                        	
  431    02:D8E5  A9 06      	!init_first:	lda	#VDC_RCR		; 1st RCR always happens just
  432    02:D8E7  8D 00 02   			sta	VDC_AR			; before the display starts.
  433    02:D8EA  A9 44      			lda.l	#HUCC_1ST_RCR
  434    02:D8EC  8D 02 02   			sta	VDC_DL
  435    02:D8EF  A9 01      			lda.h	#HUCC_1ST_RCR
  436    02:D8F1  8D 03 02   			sta	VDC_DH
  437                        	
  438               0001     		.if	SUPPORT_SGX
  439                        	
  440    02:D8F4  62         	!:		cla				; A = previous active index
  441    02:D8F5  A2 08      			ldx	#HUCC_SGX_SPLITS	; so $00 for end-of-screen.
  442                        	
  443    02:D8F7  18         			clc				; For regionB indexes.
  444                        	
  445    02:D8F8  CA         	!next_region:	dex				; All regions updated?
  446    02:D8F9  30 20      			bmi	!save_first+
  447                        	
  448    02:D8FB  9E 32 27   			stz	sgx_region_new, x	; Clear region modified flag.
  449                        	
  450    02:D8FE  BC 2A 27   			ldy	sgx_region_sel, x	; 0=regionA or 1=regionB.
  451    02:D901  F0 0D      			beq	!use_regionA+
  452                        	
  453    02:D903  BC 42 27   	!use_regionB:	ldy	sgx_regionB_crl, x	; Region disabled if $00.
  454    02:D906  F0 F0      			beq	!next_region-
  455    02:D908  9D A3 27   			sta	sgx_regionB_nxt, x	; Save index of next region.
  456    02:D90B  8A         			txa				; A = current region index.
  457    02:D90C  69 08      			adc	#HUCC_SGX_SPLITS	; Always leaves CC!
  458    02:D90E  80 E8      			bra	!next_region-
  459                        	
  460    02:D910  BC 3A 27   	!use_regionA:	ldy	sgx_regionA_crl, x	; Region disabled if $00.
  461    02:D913  F0 E3      			beq	!next_region-
  462    02:D915  9D 9B 27   			sta	sgx_regionA_nxt, x	; Save index of next region.
  463    02:D918  8A         			txa				; A = current region index.
  464    02:D919  80 DD      			bra	!next_region-
  465                        	
  466    02:D91B  8D 9A 27   	!save_first:	sta	sgx_next_region		; Save index of 1st region.
  467                        	
  468    02:D91E  AA         			tax				; NZ if first active region
  469    02:D91F  D0 03      			bne	!init_first+		; is not region 0.
  470    02:D921  98         			tya				; NZ if region 0 is active.
  471    02:D922  F0 0F      			beq	!+			; If no active leave RCR=0.
  472                        	
  473    02:D924  A9 06      	!init_first:	lda	#VDC_RCR		; 1st RCR always happens just
  474    02:D926  8D 10 02   			sta	SGX_AR			; before the display starts.
  475    02:D929  A9 44      			lda.l	#HUCC_1ST_RCR
  476    02:D92B  8D 12 02   			sta	SGX_DL
  477    02:D92E  A9 01      			lda.h	#HUCC_1ST_RCR
  478    02:D930  8D 13 02   			sta	SGX_DH
  479                        	
  480                        		.endif	SUPPORT_SGX
  481                        	
  482                        	!:		leave				; All done!
         02:D933  4C EF FF   			jmp	leave_proc
  483                        	
  484                        			.endp
  485                        	
  486                        	
  487                        	
  488               0001     		.if	SUPPORT_SGX
  489                        	
  490                        	; ***************************************************************************
  491                        	; ***************************************************************************
  492                        	;
  493                        	; VDC_RCR_MACRO and SGX_RCR_MACRO
  494                        	;
  495                        	; A 16-byte TIA takes 142..234 cycles in 5MHz, 128..200 cycles in 7MHz.
  496                        	; A 32-byte TIA takes 270..364 cycles in 5MHz, 242..312 cycles in 7MHz. (527 DUO)
  497                        	;
  498                        	; You need to write the last RCR setting within 540 cycles in order to catch
  499                        	; the next line (at 256/336/512 resolution).
  500                        	;
  501                        	; That gives 305 cycles from the RCR to write the last setting, or there
  502                        	; will be a visible glitch on the screen.
  503                        	
  504               0000     		.ifndef	USING_RCR_MACROS
  506                        		.endif
  507                        	
  508                        	;		;;;				; 8 (cycles for the INT)
  509                        	;		bbs1	<irq_vec, .hook		; 8
  510                        	;		jmp	[irq1_hook]		; 7
  511                        	
  512                        	;		;;;				; 8 (cycles for the INT)
  513                        	;		jmp	irq1_handler		; 4
  514                        	
  515                        	;irq1_handler:	pha				; 3 Save all registers.
  516                        	;		phx				; 3
  517                        	;		phy				; 3
  518                        	;
  519                        	;		lda	VDC_SR			; 6 Acknowledge the VDC's IRQ.
  520                        	;		sta	<vdc_sr			; 4 Remember what caused it.
  521                        	;
  522                        	;		ldx	SGX_SR			; 6 Read SGX_SR after VDC_SR in
  523                        	;		stx	<sgx_sr			; 4 case this is not an SGX!
  524                        	;
  525                        	;!:		and	#$04			; 2 Is this an HSYNC interrupt?
  526                        	;		beq	!+			; 2
  527                        	
  528                        			.macro	VDC_RCR_MACRO
  529                        	
  530                        			st0	#VDC_RCR		; 5
  531                        	
  532                        			ldx	vdc_next_region		; 5 X and Y can be greater than
  533                        			ldy	vdc_regionA_nxt, x	; 5 HUCC_PCE_SPLITS if regionB!
  534                        			clc				; 2
  535                        			bne	!set_next_rcr+		; 4 Stop RCR if next line is 0.
  536                        	
  537                        			and	const_0000		; 5 A=$00 with the same #cycles
  538                        			bra	!clr_next_rcr+		; 4 as if the branch were taken.
  539                        	
  540                        	!set_next_rcr:	lda	vdc_regionA_rcr, y	; 5 Set next RCR 1 line before
  541                        			adc	#64-1			; 2 the region begins, or 0 to
  542                        	!clr_next_rcr:	sta	VDC_DL			; 6 disable.
  543                        			cla				; 2
  544                        			rol	a			; 2
  545                        			sta	VDC_DH			; 6
  546                        	
  547                        			st0	#VDC_BYR		; 5 Do BYR first to mitigate the
  548                        			lda	vdc_regionA_yl, x	; 5 glitch if the IRQ is delayed.
  549                        			sta	VDC_DL			; 6 = 105 cycles from RCR on SGX
  550                        			lda	vdc_regionA_yh, x	; 5
  551                        			sta	VDC_DH			; 6
  552                        	
  553                        			st0	#VDC_CR			; 5
  554                        			lda	vdc_regionA_crl, x	; 5
  555                        	;		asl	a
  556                        			sta	VDC_DL			; 6
  557                        	
  558                        			st0	#VDC_BXR		; 2
  559                        			lda	vdc_regionA_xl, x	; 5
  560                        			sta	VDC_DL			; 6
  561                        			lda	vdc_regionA_xh, x	; 5
  562                        			sta	VDC_DH			; 6 = 156 cycles from RCR if DUO
  563                        	
  564                        	;		bcc	!+
  565                        	;		lda	vdc_regionA_yh, x	; 5
  566                        	;		sta.l	VCE_CTW			; 6
  567                        	
  568                        			sty	vdc_next_region		; 5
  569                        	
  570                        			.endm
  571                        	
  572                        	;!:		bbr2	<sgx_sr, !+		; 6 Is this an HSYNC interrupt?
  573                        	
  574                        			.macro	SGX_RCR_MACRO
  575                        	
  576                        			lda	#VDC_RCR		; 2
  577                        			sta	SGX_AR			; 6
  578                        	
  579                        			ldx	sgx_next_region		; 5 X and Y can be greater than
  580                        			ldy	sgx_regionA_nxt, x	; 5 HUCC_SGX_SPLITS if regionB!
  581                        			clc				; 2
  582                        			bne	!set_next_rcr+		; 4 Stop RCR if next line is 0.
  583                        	
  584                        			and	const_0000		; 5 A=$00 with the same #cycles
  585                        			bra	!clr_next_rcr+		; 4 as if the branch were taken.
  586                        	
  587                        	!set_next_rcr:	lda	sgx_regionA_rcr, y	; 5 Set next RCR 1 line before
  588                        			adc	#64-1			; 2 the region begins, or 0 to
  589                        	!clr_next_rcr:	sta	SGX_DL			; 6 disable.
  590                        			cla				; 2
  591                        			rol	a			; 2
  592                        			sta	SGX_DH			; 6
  593                        	
  594                        			lda	#VDC_BYR		; 2 Do BYR first to mitigate the
  595                        			sta	SGX_AR			; 6 glitch if the IRQ is delayed.
  596                        			lda	sgx_regionA_yl, x	; 5
  597                        			sta	SGX_DL			; 6
  598                        			lda	sgx_regionA_yh, x	; 5
  599                        			sta	SGX_DH			; 6
  600                        	
  601                        			lda	#VDC_CR			; 2
  602                        			sta	SGX_AR			; 6
  603                        			lda	sgx_regionA_crl, x	; 5
  604                        			sta	SGX_DL			; 6
  605                        	
  606                        			lda	#VDC_BXR		; 2
  607                        			sta	SGX_AR			; 6
  608                        			lda	sgx_regionA_xl, x	; 5
  609                        			sta	SGX_DL			; 6
  610                        			lda	sgx_regionA_xh, x	; 5
  611                        			sta	SGX_DH			; 6 = 293 cycles (282 if no YH)
  612                        	
  613                        			sty	sgx_next_region		; 5
  614                        	
  615                        			.endm
  616                        	
  617                        		.else	SUPPORT_SGX
  697                        		.endif	SUPPORT_SGX
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
   68                        		.else
   72                        		.endif	HUCC_USES_NEW_SCROLL
   73                        	
   74               0001     		.ifdef	HUCC_USES_OLD_SPR		; Set in hucc_old_spr.h
                             #[3]   "..\..\..\include\hucc\hucc-old-spr.asm"
   75                        			include	"hucc-old-spr.asm"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; hucc-old-spr.asm
    5                        	;
    6                        	; Based on the original HuC and MagicKit functions by David Michel and the
    7                        	; other original HuC developers.
    8                        	;
    9                        	; Modifications copyright John Brandwood 2024.
   10                        	;
   11                        	; Distributed under the Boost Software License, Version 1.0.
   12                        	; (See accompanying file LICENSE_1_0.txt or copy at
   13                        	;  http://www.boost.org/LICENSE_1_0.txt)
   14                        	;
   15                        	; ***************************************************************************
   16                        	; ***************************************************************************
   17                        	
   18                        	;
   19                        	; Include dependancies ...
   20                        	;
   21                        	
   22                        			include "common.asm"		; Common helpers.
   23                        			include "vce.asm"		; Useful VCE routines.
   24                        			include "vdc.asm"		; Useful VCE routines.
   25                        	
   26                        	
   27                        	
   28                        	; ***************************************************************************
   29                        	; ***************************************************************************
   30                        	;
   31                        	; HuC Sprite Functions
   32                        	;
   33                        	; ***************************************************************************
   34                        	; ***************************************************************************
   35                        	
   36               209C     			.zp
   37    F8:209C             	spr_ptr:	ds	2
   38               27AB     			.bss
   39    F8:27AB             	spr_sat:	ds	512
   40               E7B7     			.code
   41                        	
   42               0001     		.if	SUPPORT_SGX
   43               209E     			.zp
   44    F8:209E             	sgx_spr_ptr:	ds	2
   45               29AB     			.bss
   46    F8:29AB             	sgx_spr_sat:	ds	512	; N.B. Directly after spr_sat!
   47               E7B7     			.code
   48                        		.endif
   49                        	
   50                        	; Moved to hucc-old-map.asm just to save space. This NEEDS to be changed!
   51                        	;
   52                        	;		.bss
   53                        	;spr_max:	ds	1
   54                        	;spr_clr:	ds	1
   55                        	;	.if	SUPPORT_SGX
   56                        	;sgx_spr_max:	ds	1
   57                        	;sgx_spr_clr:	ds	1
   58                        	;	.endif
   59                        	;		.code
   60                        	
   61                        	
   62                        	
   63                        	; ***************************************************************************
   64                        	; ***************************************************************************
   65                        	;
   66                        	; void __fastcall init_satb( void );
   67                        	; void __fastcall reset_satb( void );
   68                        	;
   69                        	; void __fastcall sgx_init_satb( void );
   70                        	; void __fastcall sgx_reset_satb( void );
   71                        	
   72    00:E7B7             	_reset_satb:
   73    00:E7B7  C2         	_init_satb:	cly
   74    00:E7B8  62         			cla
   75    00:E7B9  99 AB 27   	!:		sta	spr_sat + $0000, y
   76    00:E7BC  99 AB 28   			sta	spr_sat + $0100, y
   77    00:E7BF  C8         			iny
   78    00:E7C0  D0 F7      			bne	!-
   79    00:E7C2  8C 7F 26   			sty	spr_max
   80    00:E7C5  C8         			iny
   81    00:E7C6  8C 80 26   			sty	spr_clr
   82    00:E7C9  60         			rts
   83                        	
   84               0001     		.if	SUPPORT_SGX
   85    00:E7CA             	_sgx_reset_satb:
   86    00:E7CA  C2         	_sgx_init_satb:	cly
   87    00:E7CB  62         			cla
   88    00:E7CC  99 AB 29   	!:		sta	sgx_spr_sat + $0000, y
   89    00:E7CF  99 AB 2A   			sta	sgx_spr_sat + $0100, y
   90    00:E7D2  C8         			iny
   91    00:E7D3  D0 F7      			bne	!-
   92    00:E7D5  8C 8F 26   			sty	sgx_spr_max
   93    00:E7D8  C8         			iny
   94    00:E7D9  8C 90 26   			sty	sgx_spr_clr
   95    00:E7DC  60         			rts
   96                        		.endif
   97                        	
   98                        	
   99                        	
  100                        	; ***************************************************************************
  101                        	; ***************************************************************************
  102                        	;
  103                        	; void __fastcall satb_update( void );
  104                        	; void __fastcall sgx_satb_update( void );
  105                        	
  106    02:DB57             	old_satb_group	.procgroup
  107                        	
  108               0001     		.if	SUPPORT_SGX
  109                        			.proc	_sgx_satb_update
  115                        			.endp
  116                        		.endif
  117                        	
  118    02:DB57             			.proc	_satb_update
  119                        	
  120    02:DB57  82         			clx				; Offset to PCE VDC.
  121                        	
  122    02:DB58  A9 7F      			lda.h	#$7F00			; HuC puts the SAT here in VRAM
  123                        	;		lda.h	#$0800			; but we put it here instead
  124    02:DB5A  64 F0      			stz.l	<_di
  125    02:DB5C  85 F1      			sta.h	<_di
  126    02:DB5E  20 7F E3   			jsr	set_di_to_mawr
  127                        	
  128               0001     		.if	SUPPORT_SGX
  129    02:DB61  8A         			txa				; Select which VDC to write
  130    02:DB62  1A         			inc	a			; to.
  131    02:DB63  1A         			inc	a
  132    02:DB64  8D F3 22   			sta.l	ram_tia_dst
  133                        		.endif
  134                        	
  135    02:DB67  A9 10      			lda	#VRAM_XFER_SIZE		; Split into 16-byte chunks
  136    02:DB69  8D F5 22   			sta.l	ram_tia_len		; for stable IRQ response.
  137                        	
  138    02:DB6C  BC 7F 26   			ldy	spr_max, x		; Highest sprite that was set.
  139    02:DB6F  C8         			iny
  140                        	
  141    02:DB70  BD 80 26   			lda	spr_clr, x
  142    02:DB73  F0 05      			beq	!+
  143    02:DB75  9E 80 26   			stz	spr_clr, x
  144    02:DB78  A0 40      			ldy	#64
  145                        	
  146    02:DB7A  98         	!:		tya
  147    02:DB7B  F0 22      			beq	.exit
  148                        	
  149    02:DB7D  3A         			dec	a			; round up to the next group of 2 sprites
  150    02:DB7E  4A         			lsr	a
  151               0000     		.if	VRAM_XFER_SIZE == 32
  153                        		.endif
  154    02:DB7F  1A         			inc	a
  155    02:DB80  A8         			tay
  156                        	
  157    02:DB81  A9 27      			lda.h	#spr_sat
  158                        	
  159               0001     		.if	SUPPORT_SGX
  160    02:DB83  E0 00      			cpx	#0
  161    02:DB85  F0 02      			beq	!+
  162                        	
  163    02:DB87  A9 29      			lda.h	#sgx_spr_sat
  164                        		.endif
  165                        	
  166    02:DB89  8D F2 22   	!:		sta.h	ram_tia_src
  167                        	
  168    02:DB8C  A9 AB      			lda.l	#spr_sat		; Same for SGX and PCE!
  169    02:DB8E  8D F1 22   	.chunk_loop:	sta.l	ram_tia_src
  170                        	
  171    02:DB91  20 F0 22   			jsr	ram_tia			; transfer 16-bytes
  172                        	
  173    02:DB94  18         			clc				; increment source
  174    02:DB95  69 10      			adc	#VRAM_XFER_SIZE
  175    02:DB97  90 03      			bcc	.same_page
  176    02:DB99  EE F2 22   			inc.h	ram_tia_src
  177                        	
  178    02:DB9C  88         	.same_page:	dey
  179    02:DB9D  D0 EF      			bne	.chunk_loop
  180                        	
  181                        	.exit:		leave
         02:DB9F  4C EF FF   			jmp	leave_proc
  182                        	
  183                        			.endp
  184                        	
  185                        			.endprocgroup	; old_satb_group
  186                        	
  187                        	
  188                        	
  189                        	; ***************************************************************************
  190                        	; ***************************************************************************
  191                        	;
  192                        	; void __fastcall spr_set( unsigned char num<acc> );
  193                        	
  194    00:E7DD  CD 7F 26   	_spr_set.1:	cmp	spr_max
  195    00:E7E0  90 03      			bcc	!+
  196    00:E7E2  8D 7F 26   			sta	spr_max
  197    00:E7E5  A0 27      	!:		ldy.h	#spr_sat
  198    00:E7E7  0A         			asl	a
  199    00:E7E8  0A         			asl	a
  200    00:E7E9  0A         			asl	a
  201    00:E7EA  90 02      			bcc	!+
  202    00:E7EC  C8         			iny
  203    00:E7ED  18         			clc
  204    00:E7EE  69 AB      	!:		adc.l	#spr_sat
  205    00:E7F0  85 9C      			sta.l	<spr_ptr
  206    00:E7F2  90 01      			bcc	!+
  207    00:E7F4  C8         			iny
  208    00:E7F5  84 9D      	!:		sty.h	<spr_ptr
  209    00:E7F7  60         			rts
  210                        	
  211                        	
  212                        	
  213                        	; ***************************************************************************
  214                        	; ***************************************************************************
  215                        	;
  216                        	; void __fastcall spr_hide( void );
  217                        	
  218    00:E7F8  A0 01      	_spr_hide:	ldy	#1
  219    00:E7FA  B1 9C      			lda	[spr_ptr], y
  220    00:E7FC  09 02      			ora	#2
  221    00:E7FE  91 9C      			sta	[spr_ptr], y
  222    00:E800  60         			rts
  223                        	
  224                        	
  225                        	
  226                        	; ***************************************************************************
  227                        	; ***************************************************************************
  228                        	;
  229                        	; void __fastcall spr_show( void );
  230                        	
  231    00:E801  A0 01      	_spr_show:	ldy	#1
  232    00:E803  B1 9C      			lda	[spr_ptr], y
  233    00:E805  29 01      			and	#1
  234    00:E807  91 9C      			sta	[spr_ptr], y
  235    00:E809  60         			rts
  236                        	
  237                        	
  238                        	
  239                        	; ***************************************************************************
  240                        	; ***************************************************************************
  241                        	;
  242                        	; void __fastcall spr_x( unsigned int value<acc> );
  243                        	
  244    00:E80A  02         	_spr_x.1:	sxy
  245    00:E80B  18         			clc
  246    00:E80C  69 20      			adc	#32
  247    00:E80E  A0 02      			ldy	#2
  248    00:E810  91 9C      			sta	[spr_ptr], y
  249    00:E812  8A         			txa
  250    00:E813  69 00      			adc	#0
  251    00:E815  C8         			iny
  252    00:E816  91 9C      			sta	[spr_ptr], y
  253    00:E818  60         			rts
  254                        	
  255                        	
  256                        	
  257                        	; ***************************************************************************
  258                        	; ***************************************************************************
  259                        	;
  260                        	; void __fastcall spr_y( unsigned int value<acc> );
  261                        	
  262    00:E819  18         	_spr_y.1:	clc
  263    00:E81A  69 40      			adc	#64
  264    00:E81C  92 9C      			sta	[spr_ptr]
  265    00:E81E  98         			tya
  266    00:E81F  69 00      			adc	#0
  267    00:E821  A0 01      			ldy	#1
  268    00:E823  91 9C      			sta	[spr_ptr], y
  269    00:E825  60         			rts
  270                        			
  271                        	
  272                        	
  273                        	; ***************************************************************************
  274                        	; ***************************************************************************
  275                        	;
  276                        	; void __fastcall spr_pattern( unsigned int vaddr<acc> );
  277                        	
  278    00:E826  84 00      	_spr_pattern.1:	sty	<__temp		;     zp=fedcba98 a=76543210
  279    00:E828  0A         			asl	a		; c=f zp=edcba987 a=6543210_
  280    00:E829  26 00      			rol	<__temp
  281    00:E82B  2A         			rol	a		; c=e zp=dcba9876 a=543210_f
  282    00:E82C  26 00      			rol	<__temp
  283    00:E82E  2A         			rol	a		; c=d zp=cba98765 a=43210_fe
  284    00:E82F  26 00      			rol	<__temp
  285    00:E831  2A         			rol	a		; c=4 zp=cba98765 a=3210_fed
  286    00:E832  A0 05      			ldy	#5
  287    00:E834  91 9C      			sta	[spr_ptr], y
  288    00:E836  A5 00      			lda	<__temp
  289    00:E838  88         			dey
  290    00:E839  91 9C      			sta	[spr_ptr], y
  291    00:E83B  60         			rts
  292                        	
  293                        	
  294                        	
  295                        	; ***************************************************************************
  296                        	; ***************************************************************************
  297                        	;
  298                        	; void __fastcall spr_ctrl( unsigned char mask<_al>, unsigned char value<acc> );
  299                        	
  300    00:E83C  25 F8      	_spr_ctrl.2:	and	<_al
  301    00:E83E  85 00      			sta	<__temp
  302    00:E840  A5 F8      			lda	<_al
  303    00:E842  49 FF      			eor	#$FF
  304    00:E844  A0 07      			ldy	#7
  305    00:E846  31 9C      			and	[spr_ptr], y
  306    00:E848  05 00      			ora	<__temp
  307    00:E84A  91 9C      			sta	[spr_ptr], y
  308    00:E84C  60         			rts
  309                        	
  310                        	
  311                        	
  312                        	; ***************************************************************************
  313                        	; ***************************************************************************
  314                        	;
  315                        	; void __fastcall spr_pal( unsigned char palette<acc> )
  316                        	
  317    00:E84D  29 0F      	_spr_pal.1:	and	#$0F
  318    00:E84F  85 00      			sta	<__temp
  319    00:E851  A0 06      			ldy	#6
  320    00:E853  B1 9C      			lda	[spr_ptr], y
  321    00:E855  29 F0      			and	#$F0
  322    00:E857  05 00      			ora	<__temp
  323    00:E859  91 9C      			sta	[spr_ptr], y
  324    00:E85B  60         			rts
  325                        	
  326                        	
  327                        	
  328                        	; ***************************************************************************
  329                        	; ***************************************************************************
  330                        	;
  331                        	; void __fastcall spr_pri( unsigned char priority<acc> )
  332                        	
  333    00:E85C  C9 01      	_spr_pri.1:	cmp	#1
  334    00:E85E  A0 06      			ldy	#6
  335    00:E860  B1 9C      			lda	[spr_ptr], y
  336    00:E862  29 7F      			and	#$7F
  337    00:E864  90 02      			bcc	!+
  338    00:E866  09 80      			ora	#$80
  339    00:E868  91 9C      	!:		sta	[spr_ptr], y
  340    00:E86A  60         			rts
  341                        	
  342                        	
  343                        	
  344                        	; ***************************************************************************
  345                        	; ***************************************************************************
  346                        	;
  347                        	; unsigned int __fastcall spr_get_x( void );
  348                        	
  349    00:E86B  38         	_spr_get_x:	sec
  350    00:E86C  A0 02      			ldy	#2
  351    00:E86E  B1 9C      			lda	[spr_ptr], y
  352    00:E870  E9 20      			sbc	#32
  353    00:E872  AA         			tax
  354    00:E873  C8         			iny
  355    00:E874  B1 9C      			lda	[spr_ptr], y
  356    00:E876  E9 00      			sbc	#0
  357    00:E878  A8         			tay
  358    00:E879  8A         			txa
  359    00:E87A  60         			rts
  360                        	
  361                        	
  362                        	
  363                        	; ***************************************************************************
  364                        	; ***************************************************************************
  365                        	;
  366                        	; unsigned int __fastcall spr_get_y( void );
  367                        	
  368    00:E87B  38         	_spr_get_y:	sec
  369    00:E87C  B2 9C      			lda	[spr_ptr]
  370    00:E87E  E9 40      			sbc	#64
  371    00:E880  AA         			tax
  372    00:E881  A0 01      			ldy	#1
  373    00:E883  B1 9C      			lda	[spr_ptr], y
  374    00:E885  E9 00      			sbc	#0
  375    00:E887  A8         			tay
  376    00:E888  8A         			txa
  377    00:E889  60         			rts
  378                        	
  379                        	
  380                        	
  381               0001     		.if	SUPPORT_SGX
  382                        	
  383                        	; ***************************************************************************
  384                        	; ***************************************************************************
  385                        	;
  386                        	; void __fastcall sgx_spr_set( unsigned char num<acc> );
  387                        	
  388    00:E88A  CD 8F 26   	_sgx_spr_set.1:	cmp	sgx_spr_max
  389    00:E88D  90 03      			bcc	!+
  390    00:E88F  8D 8F 26   			sta	sgx_spr_max
  391    00:E892  A0 29      	!:		ldy.h	#sgx_spr_sat
  392    00:E894  0A         			asl	a
  393    00:E895  0A         			asl	a
  394    00:E896  0A         			asl	a
  395    00:E897  90 02      			bcc	!+
  396    00:E899  C8         			iny
  397    00:E89A  18         			clc
  398    00:E89B  69 AB      	!:		adc.l	#sgx_spr_sat
  399    00:E89D  85 9E      			sta.l	<sgx_spr_ptr
  400    00:E89F  90 01      			bcc	!+
  401    00:E8A1  C8         			iny
  402    00:E8A2  84 9F      	!:		sty.h	<sgx_spr_ptr
  403    00:E8A4  60         			rts
  404                        	
  405                        	
  406                        	
  407                        	; ***************************************************************************
  408                        	; ***************************************************************************
  409                        	;
  410                        	; void __fastcall sgx_spr_hide( void );
  411                        	
  412    00:E8A5  A0 01      	_sgx_spr_hide:	ldy	#1
  413    00:E8A7  B1 9E      			lda	[sgx_spr_ptr], y
  414    00:E8A9  09 02      			ora	#2
  415    00:E8AB  91 9E      			sta	[sgx_spr_ptr], y
  416    00:E8AD  60         			rts
  417                        	
  418                        	
  419                        	
  420                        	; ***************************************************************************
  421                        	; ***************************************************************************
  422                        	;
  423                        	; void __fastcall sgx_spr_show( void );
  424                        	
  425    00:E8AE  A0 01      	_sgx_spr_show:	ldy	#1
  426    00:E8B0  B1 9E      			lda	[sgx_spr_ptr], y
  427    00:E8B2  29 01      			and	#1
  428    00:E8B4  91 9E      			sta	[sgx_spr_ptr], y
  429    00:E8B6  60         			rts
  430                        	
  431                        	
  432                        	
  433                        	; ***************************************************************************
  434                        	; ***************************************************************************
  435                        	;
  436                        	; void __fastcall sgx_spr_x( unsigned int value<acc> );
  437                        	
  438    00:E8B7  02         	_sgx_spr_x.1:	sxy
  439    00:E8B8  18         			clc
  440    00:E8B9  69 20      			adc	#32
  441    00:E8BB  A0 02      			ldy	#2
  442    00:E8BD  91 9E      			sta	[sgx_spr_ptr], y
  443    00:E8BF  8A         			txa
  444    00:E8C0  69 00      			adc	#0
  445    00:E8C2  C8         			iny
  446    00:E8C3  91 9E      			sta	[sgx_spr_ptr], y
  447    00:E8C5  60         			rts
  448                        	
  449                        	
  450                        	
  451                        	; ***************************************************************************
  452                        	; ***************************************************************************
  453                        	;
  454                        	; void __fastcall sgx_spr_y( unsigned int value<acc> );
  455                        	
  456    00:E8C6  18         	_sgx_spr_y.1:	clc
  457    00:E8C7  69 40      			adc	#64
  458    00:E8C9  92 9E      			sta	[sgx_spr_ptr]
  459    00:E8CB  98         			tya
  460    00:E8CC  69 00      			adc	#0
  461    00:E8CE  A0 01      			ldy	#1
  462    00:E8D0  91 9E      			sta	[sgx_spr_ptr], y
  463    00:E8D2  60         			rts
  464                        			
  465                        	
  466                        	
  467                        	; ***************************************************************************
  468                        	; ***************************************************************************
  469                        	;
  470                        	; void __fastcall sgx_spr_pattern( unsigned int vaddr<acc> );
  471                        	
  472    00:E8D3             	_sgx_spr_pattern.1:
  473    00:E8D3  84 00      			sty	<__temp		;     zp=fedcba98 a=76543210
  474    00:E8D5  0A         			asl	a		; c=f zp=edcba987 a=6543210_
  475    00:E8D6  26 00      			rol	<__temp
  476    00:E8D8  2A         			rol	a		; c=e zp=dcba9876 a=543210_f
  477    00:E8D9  26 00      			rol	<__temp
  478    00:E8DB  2A         			rol	a		; c=d zp=cba98765 a=43210_fe
  479    00:E8DC  26 00      			rol	<__temp
  480    00:E8DE  2A         			rol	a		; c=4 zp=cba98765 a=3210_fed
  481    00:E8DF  A0 05      			ldy	#5
  482    00:E8E1  91 9E      			sta	[sgx_spr_ptr], y
  483    00:E8E3  A5 00      			lda	<__temp
  484    00:E8E5  88         			dey
  485    00:E8E6  91 9E      			sta	[sgx_spr_ptr], y
  486    00:E8E8  60         			rts
  487                        	
  488                        	
  489                        	
  490                        	; ***************************************************************************
  491                        	; ***************************************************************************
  492                        	;
  493                        	; void __fastcall sgx_spr_ctrl( unsigned char mask<_al>, unsigned char value<acc> );
  494                        	
  495    00:E8E9  25 F8      	_sgx_spr_ctrl.2:and	<_al
  496    00:E8EB  85 00      			sta	<__temp
  497    00:E8ED  A5 F8      			lda	<_al
  498    00:E8EF  49 FF      			eor	#$FF
  499    00:E8F1  A0 07      			ldy	#7
  500    00:E8F3  31 9E      			and	[sgx_spr_ptr], y
  501    00:E8F5  05 00      			ora	<__temp
  502    00:E8F7  91 9E      			sta	[sgx_spr_ptr], y
  503    00:E8F9  60         			rts
  504                        	
  505                        	
  506                        	
  507                        	; ***************************************************************************
  508                        	; ***************************************************************************
  509                        	;
  510                        	; void __fastcall sgx_spr_pal( unsigned char palette<acc> )
  511                        	
  512    00:E8FA  29 0F      	_sgx_spr_pal.1:	and	#$0F
  513    00:E8FC  85 00      			sta	<__temp
  514    00:E8FE  A0 06      			ldy	#6
  515    00:E900  B1 9E      			lda	[sgx_spr_ptr], y
  516    00:E902  29 F0      			and	#$F0
  517    00:E904  05 00      			ora	<__temp
  518    00:E906  91 9E      			sta	[sgx_spr_ptr], y
  519    00:E908  60         			rts
  520                        	
  521                        	
  522                        	
  523                        	; ***************************************************************************
  524                        	; ***************************************************************************
  525                        	;
  526                        	; void __fastcall sgx_spr_pri( unsigned char priority<acc> )
  527                        	
  528    00:E909  C9 01      	_sgx_spr_pri.1:	cmp	#1
  529    00:E90B  A0 06      			ldy	#6
  530    00:E90D  B1 9E      			lda	[sgx_spr_ptr], y
  531    00:E90F  29 7F      			and	#$7F
  532    00:E911  90 02      			bcc	!+
  533    00:E913  09 80      			ora	#$80
  534    00:E915  91 9E      	!:		sta	[sgx_spr_ptr], y
  535    00:E917  60         			rts
  536                        	
  537                        	
  538                        	
  539                        	; ***************************************************************************
  540                        	; ***************************************************************************
  541                        	;
  542                        	; unsigned int __fastcall sgx_spr_get_x( void );
  543                        	
  544    00:E918  38         	_sgx_spr_get_x:	sec
  545    00:E919  A0 02      			ldy	#2
  546    00:E91B  B1 9E      			lda	[sgx_spr_ptr], y
  547    00:E91D  E9 20      			sbc	#32
  548    00:E91F  AA         			tax
  549    00:E920  C8         			iny
  550    00:E921  B1 9E      			lda	[sgx_spr_ptr], y
  551    00:E923  E9 00      			sbc	#0
  552    00:E925  A8         			tay
  553    00:E926  8A         			txa
  554    00:E927  60         			rts
  555                        	
  556                        	
  557                        	
  558                        	; ***************************************************************************
  559                        	; ***************************************************************************
  560                        	;
  561                        	; unsigned int __fastcall sgx_spr_get_y( void );
  562                        	
  563    00:E928  38         	_sgx_spr_get_y:	sec
  564    00:E929  B2 9E      			lda	[sgx_spr_ptr]
  565    00:E92B  E9 40      			sbc	#64
  566    00:E92D  AA         			tax
  567    00:E92E  A0 01      			ldy	#1
  568    00:E930  B1 9E      			lda	[sgx_spr_ptr], y
  569    00:E932  E9 00      			sbc	#0
  570    00:E934  A8         			tay
  571    00:E935  8A         			txa
  572    00:E936  60         			rts
  573                        	
  574                        		.endif	SUPPORT_SGX
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
   76                        		.endif
   77                        	
   78               0001     		.ifdef	HUCC_USES_BLKMAP		; Set in hucc_blkmap.h
                             #[3]   "..\..\..\include\hucc\blkmap.asm"
   79                        			include	"blkmap.asm"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; blkmap.asm
    5                        	;
    6                        	; A map system based on 16x16 meta-tiles (aka "blocks", aka CHR/BLK/MAP).
    7                        	;
    8                        	; Copyright John Brandwood 2025.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	;
   17                        	; The maximum X and Y size for blkmaps is 128 blocks (2048 pixels).
   18                        	;
   19                        	; The maximum total size for a blkmap is 16KBytes, which allows for maps up
   20                        	; to 128x128 blocks (2048x2048 pixels).
   21                        	;
   22                        	; Huge multi-screen blkmaps are also supported (optionally).
   23                        	;
   24                        	; The maximum X and Y for multi-screen maps is 128 screens (32768 pixels).
   25                        	;
   26                        	; The maximum total size for a multi-screen map is 8KBytes, which allows for
   27                        	; a total of 1024 screens.
   28                        	;
   29                        	; ***************************************************************************
   30                        	; ***************************************************************************
   31                        	
   32                        	;
   33                        	; Include dependancies ...
   34                        	;
   35                        	
   36                        			include "common.asm"		; Common helpers.
   37                        			include "vce.asm"		; Useful VCE routines.
   38                        			include "vdc.asm"		; Useful VCE routines.
   39                        	
   40                        	;
   41                        	; Support large blkmaps up to 16KBytes instead of the regular 8KBytes?
   42                        	;
   43                        	; The maximum X and Y size for regular blkmaps is 128 tiles (2048 pixels).
   44                        	;
   45                        	; This allows for individual maps up to 128x128 tiles (2048x2048 pixels) vs
   46                        	; default limit of 128x64 or 64x128.
   47                        	;
   48                        	
   49               0000     		.ifndef	BLKMAP_LARGEMAP
   51                        		.endif
   52                        	
   53                        	;
   54                        	; Support huge multi-screen maps, up to 32768 pixels wide/high?
   55                        	;
   56                        	; These are sectorized maps split into individual BAT-sized "screens", with
   57                        	; a maximum of 1024 screens per map.
   58                        	;
   59                        	; The BAT size that is used when drawing *must* be the same as the BAT size
   60                        	; that was chosen when creating the multi-screen map.
   61                        	;
   62                        	; Each screen can use a unique set of block definitions, or it might choose
   63                        	; to share the same block definitions that are used on another screen.
   64                        	;
   65                        	; Each screen may choose which 8KByte banks of character data to select for
   66                        	; the 4 banks (32KBytes) of VRAM that its block definitions use, with a max
   67                        	; of 16 banks of characters per multi-screen map.
   68                        	;
   69                        	; Loading those character banks dynamically is an exercise for the user!
   70                        	;
   71                        	; Enabling support adds extra library code, and slightly slows down the use
   72                        	; of regular blkmaps.
   73                        	;
   74                        	
   75               0000     		.ifndef	BLKMAP_MULTISCR
   77                        		.endif
   78                        	
   79                        	;
   80                        	; Block definitions can either use character data from VRAM $1000..$7FFF or
   81                        	; they can be limited to use the 32KByte of characters in VRAM $1000..$4FFF
   82                        	; which then frees up 2-bits for flag information for each character in the
   83                        	; block.
   84                        	;
   85                        	; These 2-bits are perfect for using as collision information in game maps,
   86                        	; allowing storage of states like transparent, solid, up-slope, down-slope.
   87                        	;
   88                        	; Typically this flag information is set by the map conversion tools from a
   89                        	; seperate "collision" map layer.
   90                        	;
   91                        	
   92               0000     		.ifndef	BLKDEF_CHR_FLAG
   94                        		.endif
   95                        	
   96                        	;
   97                        	; Block definitions are accessed in MPR2 ($4000..$5FFF), and must not cross
   98                        	; the bank boundary.
   99                        	;
  100                        	; When working this way, 8 pointers in ZP are used to access the individual
  101                        	; bytes in the block definition. This is fine when using a regular map on a
  102                        	; PC Engine, but it is awfully slow when using multi-screen maps or drawing
  103                        	; maps on both VDC chips in a SuperGRAFX because the pointer values must be
  104                        	; constantly changed.
  105                        	;
  106                        	; When using multi-screen maps, or when developing a SuperGRAFX game, or if
  107                        	; developing a CDROM game, then it is usually preferable to store the block
  108                        	; definitions with 2KByte alignment, especially if they are normally stored
  109                        	; compressed and then decompressed into a 2KByte buffer in RAM when needed.
  110                        	;
  111                        	; This option controls whether the definitions are stored 2KByte aligned or
  112                        	; if pointers should be used instead.
  113                        	;
  114                        	
  115               0000     		.ifndef	BLKDEF_POINTERS
  117                        		.endif
  118                        	
  119                        	;
  120                        	; Add a timing bar to the scroll_map() to see how long the drawing takes?
  121                        	;
  122                        	
  123               0000     		.ifndef	BLKMAP_TIMETEST
  125                        		.endif
  126                        	
  127                        	;
  128                        	;
  129                        	;
  130                        	
  131               0000     		.if	BLKDEF_POINTERS
  144                        		.else
  145                        	
  146                        		; If the block definititions are 2KByte aligned.
  147                        	
  148               4000     	BLK_4000_TL_L	=	$4000
  149               4100     	BLK_4000_TR_L	=	$4100
  150               4200     	BLK_4000_BL_L	=	$4200
  151               4300     	BLK_4000_BR_L	=	$4300
  152               4400     	BLK_4000_TL_H	=	$4400
  153               4500     	BLK_4000_TR_H	=	$4500
  154               4600     	BLK_4000_BL_H	=	$4600
  155               4700     	BLK_4000_BR_H	=	$4700
  156                        	
  157               4800     	BLK_4800_TL_L	=	$4800
  158               4900     	BLK_4800_TR_L	=	$4900
  159               4A00     	BLK_4800_BL_L	=	$4A00
  160               4B00     	BLK_4800_BR_L	=	$4B00
  161               4C00     	BLK_4800_TL_H	=	$4C00
  162               4D00     	BLK_4800_TR_H	=	$4D00
  163               4E00     	BLK_4800_BL_H	=	$4E00
  164               4F00     	BLK_4800_BR_H	=	$4F00
  165                        	
  166               5000     	BLK_5000_TL_L	=	$5000
  167               5100     	BLK_5000_TR_L	=	$5100
  168               5200     	BLK_5000_BL_L	=	$5200
  169               5300     	BLK_5000_BR_L	=	$5300
  170               5400     	BLK_5000_TL_H	=	$5400
  171               5500     	BLK_5000_TR_H	=	$5500
  172               5600     	BLK_5000_BL_H	=	$5600
  173               5700     	BLK_5000_BR_H	=	$5700
  174                        	
  175               5800     	BLK_5800_TL_L	=	$5800
  176               5900     	BLK_5800_TR_L	=	$5900
  177               5A00     	BLK_5800_BL_L	=	$5A00
  178               5B00     	BLK_5800_BR_L	=	$5B00
  179               5C00     	BLK_5800_TL_H	=	$5C00
  180               5D00     	BLK_5800_TR_H	=	$5D00
  181               5E00     	BLK_5800_BL_H	=	$5E00
  182               5F00     	BLK_5800_BR_H	=	$5F00
  183                        	
  184                        		.endif
  185                        	
  186               0080     	MAP_UNALIGNED_X	=	$80
  187               0040     	MAP_UNALIGNED_Y	=	$40
  188                        	
  189                        	;
  190                        	;
  191                        	;
  192                        	
  193               2BAB     			.bss
  194                        	
  195                        	; **************
  196                        	; 8-byte (or 2-byte) entry for each SCREEN in the MULTI_MAP.
  197                        	
  198               0000     			.rsset	0
  199               0000     		.if	BLKDEF_POINTERS
  202                        		.else
  203               0000     	SCR_MAP_PAGE	.rs	1	; 256-byte aligned.
  204               0001     	SCR_MAP_BANK	.rs	1
  205               0002     	SCR_BLK_PAGE	.rs	1	; >$4000, >$4800, >$5000, or >$5800.
  206               0003     	SCR_BLK_BANK	.rs	1
  207               0004     	SCR_TBL_PAGE	.rs	1	; 256-byte aligned.
  208               0005     	SCR_TBL_BANK	.rs	1
  209               0006     	SCR_CHR_12	.rs	1	; Which CHR banks are used by the BLK, with
  210               0007     	SCR_CHR_34	.rs	1	; a max of 16 CHR banks per MULTI_MAP.
  211                        		.endif
  212                        	
  213                        			; A simple macro to help build a multi-screen map.
  214                        	
  215               0000     		.ifndef	SCREEN
  224                        		.endif
  225                        	
  226    F8:2BAB             	map_blk_flag:	ds	1	; Returned from _get_map_block().
  227    F8:2BAC             	map_blk_mask:	ds	1	; Returned from _get_map_block().
  228                        	
  229                        	; **************
  230                        	; 16-bytes of VDC blkmap info.
  231                        	;
  232                        	; N.B. MUST be 16-bytes before the SGX versions to use PCE_VDC_OFFSET.
  233                        	
  234    F8:2BAD             	vdc_old_chr_x:	ds	1	; Previous top-left X in CHR (lo-byte only).
  235    F8:2BAE             	vdc_old_chr_y:	ds	1	; Previous top-left Y in CHR (lo-byte only).
  236                        	
  237    F8:2BAF             	vdc_tbl_addr:	ds	2	; 256-byte aligned.
  238    F8:2BB1             	vdc_tbl_bank:	ds	1
  239                        	
  240    F8:2BB2             	vdc_blk_addr:	ds	2	; 2KBytes of data, 256-byte aligned.
  241    F8:2BB4             	vdc_blk_bank:	ds	1
  242                        	
  243    F8:2BB5             	vdc_map_addr:	ds	2	; Mapped into MPR3..MPR5, max 16KBytes.
  244    F8:2BB7             	vdc_map_bank:	ds	1
  245                        	
  246    F8:2BB8             	vdc_scr_addr:	ds	2	; 8KByte maximum size.
  247    F8:2BBA             	vdc_scr_bank:	ds	1
  248    F8:2BBB             	vdc_scr_chr12:	ds	1	; Which CHR banks are used by the BLK, with
  249    F8:2BBC             	vdc_scr_chr34:	ds	1	; a max of 16 banks per multi-screen map.
  250                        	
  251               0001     		.if	SUPPORT_SGX
  252                        	
  253                        	; **************
  254                        	; 16-bytes of SGX blkmap info.
  255                        	;
  256                        	; N.B. MUST be 16-bytes after the VDC versions to use SGX_VDC_OFFSET.
  257                        	
  258    F8:2BBD             	sgx_old_chr_x:	ds	1	; Previous top-left X in CHR (lo-byte only).
  259    F8:2BBE             	sgx_old_chr_y:	ds	1	; Previous top-left Y in CHR (lo-byte only).
  260                        	
  261    F8:2BBF             	sgx_tbl_addr:	ds	2	; 256-byte aligned.
  262    F8:2BC1             	sgx_tbl_bank:	ds	1
  263                        	
  264    F8:2BC2             	sgx_blk_addr:	ds	2	; 2KBytes of data, 256-byte aligned.
  265    F8:2BC4             	sgx_blk_bank:	ds	1
  266                        	
  267    F8:2BC5             	sgx_map_addr:	ds	2	; Mapped into MPR3..MPR4, max 8KBytes.
  268    F8:2BC7             	sgx_map_bank:	ds	1
  269                        	
  270    F8:2BC8             	sgx_scr_addr:	ds	2	; 8KByte maximum size.
  271    F8:2BCA             	sgx_scr_bank:	ds	1
  272    F8:2BCB             	sgx_scr_chr12:	ds	1	; Which CHR banks are used by the BLK, with
  273    F8:2BCC             	sgx_scr_chr34:	ds	1	; a max of 16 banks per multi-screen map.
  274                        	
  275                        		.endif	SUPPORT_SGX
  276                        	
  277               0000     		.if	0
  310                        		.endif	0
  311                        	
  312                        	; **************
  313                        	; Aliases for the asm variable names in HuCC.
  314                        	;
  315                        	
  316               0001     		.ifdef	HUCC
  317                        	
  318    F8:2BCD             	_map_blk_flag	.alias	map_blk_flag
  319    F8:2BCD             	_map_blk_mask	.alias	map_blk_mask
  320                        	
  321    F8:2BCD             	_vdc_map_draw_w	.alias	vdc_map_draw_w
  322    F8:2BCD             	_vdc_map_draw_h	.alias	vdc_map_draw_h
  323    F8:2BCD             	_vdc_map_pxl_x	.alias	vdc_map_pxl_x
  324    F8:2BCD             	_vdc_map_pxl_y	.alias	vdc_map_pxl_y
  325    F8:2BCD             	_vdc_old_chr_x	.alias	vdc_old_chr_x
  326    F8:2BCD             	_vdc_old_chr_y	.alias	vdc_old_chr_y
  327    F8:2BCD             	_vdc_tbl_addr	.alias	vdc_tbl_addr
  328    F8:2BCD             	_vdc_tbl_bank	.alias	vdc_tbl_bank
  329    F8:2BCD             	_vdc_blk_addr	.alias	vdc_blk_addr
  330    F8:2BCD             	_vdc_blk_bank	.alias	vdc_blk_bank
  331    F8:2BCD             	_vdc_map_line_w	.alias	vdc_map_line_w
  332    F8:2BCD             	_vdc_map_scrn_w	.alias	vdc_map_scrn_w
  333    F8:2BCD             	_vdc_map_addr	.alias	vdc_map_addr
  334    F8:2BCD             	_vdc_map_bank	.alias	vdc_map_bank
  335    F8:2BCD             	_vdc_scr_addr	.alias	vdc_scr_addr
  336    F8:2BCD             	_vdc_scr_bank	.alias	vdc_scr_bank
  337    F8:2BCD             	_vdc_scr_chr12	.alias	vdc_scr_chr12
  338    F8:2BCD             	_vdc_scr_chr34	.alias	vdc_scr_chr34
  339                        	
  340               0001     		.if	SUPPORT_SGX
  341    F8:2BCD             	_sgx_map_draw_w	.alias	sgx_map_draw_w
  342    F8:2BCD             	_sgx_map_draw_h	.alias	sgx_map_draw_h
  343    F8:2BCD             	_sgx_map_pxl_x	.alias	sgx_map_pxl_x
  344    F8:2BCD             	_sgx_map_pxl_y	.alias	sgx_map_pxl_y
  345    F8:2BCD             	_sgx_old_chr_x	.alias	sgx_old_chr_x
  346    F8:2BCD             	_sgx_old_chr_y	.alias	sgx_old_chr_y
  347    F8:2BCD             	_sgx_tbl_addr	.alias	sgx_tbl_addr
  348    F8:2BCD             	_sgx_tbl_bank	.alias	sgx_tbl_bank
  349    F8:2BCD             	_sgx_blk_addr	.alias	sgx_blk_addr
  350    F8:2BCD             	_sgx_blk_bank	.alias	sgx_blk_bank
  351    F8:2BCD             	_sgx_map_line_w	.alias	sgx_map_line_w
  352    F8:2BCD             	_sgx_map_scrn_w	.alias	sgx_map_scrn_w
  353    F8:2BCD             	_sgx_map_addr	.alias	sgx_map_addr
  354    F8:2BCD             	_sgx_map_bank	.alias	sgx_map_bank
  355    F8:2BCD             	_sgx_scr_addr	.alias	sgx_scr_addr
  356    F8:2BCD             	_sgx_scr_bank	.alias	sgx_scr_bank
  357    F8:2BCD             	_sgx_scr_chr12	.alias	sgx_scr_chr12
  358    F8:2BCD             	_sgx_scr_chr34	.alias	sgx_scr_chr34
  359                        		.endif	SUPPORT_SGX
  360                        	
  361                        		.endif	HUCC
  362                        	
  363                        	; **************
  364                        	; Temporary variables for drawing, using common zero-page locations.
  365                        	;
  366                        	
  367               20F8     	map_bat_x	=	_al	; Set by draw_map(), scroll_map() if drawing
  368               20F9     	map_bat_y	=	_ah	; aligned, or as parameters to blit_map().
  369                        	
  370               20FA     	map_draw_w	=	_bl	; Set by draw_map(), scroll_map(), but given
  371               20FB     	map_draw_h	=	_bh	; as parameters to blit_map().
  372                        	
  373               20FC     	map_pxl_x	=	_cx	; Set by draw_map(), scroll_map() and also by
  374               20FC     	map_chr_x	=	_cl	; blit__map(), from current vdc_map_pxl_x.
  375               20FD     	map_scrn_x	=	_ch
  376                        	
  377               20FE     	map_pxl_y	=	_dx	; Set by draw_map(), scroll_map() and also by
  378               20FE     	map_chr_y	=	_dl	; blit__map(), from current vdc_map_pxl_y.
  379               20FF     	map_scrn_y	=	_dh
  380                        	
  381               20EE     	map_line	=	_si	; Start of map data line being drawn.
  382                        	
  383               2000     	map_count	=	__temp + 0
  384               2001     	map_drawn	=	__temp + 1
  385                        	
  386               E937     			.code
  387                        	
  388                        	
  389                        	
  390    01:C196             	blkmap_group	.procgroup
  391                        	
  392                        	; ***************************************************************************
  393                        	; ***************************************************************************
  394                        	;
  395                        	; _set_blocks - Initialize the block definition pointers.
  396                        	; _sgx_set_blocks - Initialize the block definition pointers.
  397                        	;
  398                        	; void __fastcall set_blocks( unsigned char __far *blk_def<vdc_blk_bank:vdc_blk_addr>, unsigned char __far *flg_def<vdc_tbl_bank:vdc_tbl_addr>, unsigned char number_of_blk<_al> );
  399                        	; void __fastcall sgx_set_blocks( unsigned char __far *blk_def<sgx_blk_bank:sgx_blk_addr>, unsigned char __far *flg_def<sgx_tbl_bank:sgx_tbl_addr>, unsigned char number_of_blk<_al> );
  400                        	;
  401                        	
  402               0001     		.if	SUPPORT_SGX
  403                        	
  404    01:C196             			.proc	_sgx_set_blocks.3
  405                        	
  406    01:C196  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  407    01:C198  F0         			db	$F0			; Turn "clx" into a "beq".
  408                        	
  409    01:C199             			.ref	_set_blocks.3
  410                        			.endp
  411                        		.endif
  412                        	
  413    01:C199             			.proc	_set_blocks.3
  414                        	
  415    01:C199  82         			clx				; Offset to PCE VDC.
  416                        	
  417    01:C19A  BD B0 2B   			lda.h	vdc_tbl_addr, x		; Remap the address to MPR2.
  418    01:C19D  29 1F      			and	#$1F
  419    01:C19F  09 40      			ora	#$40
  420    01:C1A1  9D B0 2B   			sta.h	vdc_tbl_addr, x
  421                        	
  422    01:C1A4  BD B3 2B   			lda.h	vdc_blk_addr, x		; Remap the address to MPR2.
  423    01:C1A7  29 1F      			and	#$1F
  424    01:C1A9  09 40      			ora	#$40
  425    01:C1AB  9D B3 2B   			sta.h	vdc_blk_addr, x
  426                        	
  427               0000     		.if	BLKDEF_POINTERS
  479                        		.endif	BLKDEF_POINTERS
  480                        	
  481                        			leave
         01:C1AE  4C EF FF   			jmp	leave_proc
  482                        	
  483                        			.endp
  484                        	
  485                        	
  486                        	
  487                        	; ***************************************************************************
  488                        	; ***************************************************************************
  489                        	;
  490                        	; _draw_map - Draw the entire screen at the current coordinates.
  491                        	; _sgx_draw_map - Draw the entire screen at the current coordinates.
  492                        	;
  493                        	; void __fastcall draw_map( void );
  494                        	; void __fastcall sgx_draw_map( void );
  495                        	;
  496                        	
  497               0001     		.if	SUPPORT_SGX
  498                        	
  499    01:C1B1             	_sgx_draw_map	.proc
  500                        	
  501    01:C1B1  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  502    01:C1B3  F0         			db	$F0			; Turn "clx" into a "beq".
  503                        	
  504    01:C1B4             			.ref	_draw_map
  505                        			.endp
  506                        		.endif
  507                        	
  508    01:C1B4             	_draw_map	.proc
  509                        	
  510    01:C1B4  82         			clx				; Offset to PCE VDC.
  511                        	
  512    01:C1B5  43 04      			tma2				; Preserve MPR2..MPR4.
  513    01:C1B7  48         			pha
  514    01:C1B8  43 08      			tma3
  515    01:C1BA  48         			pha
  516    01:C1BB  43 10      			tma4
  517    01:C1BD  48         			pha
  518               0000     		.if	BLKMAP_LARGEMAP
  521                        		.endif
  522                        	
  523    01:C1BE  20 C0 C2   			jsr	map_pxl_2_chr		; Set up the draw coordinates.
  524                        	
  525    01:C1C1  A5 FC      			lda	<map_chr_x		; Reset previous X position.
  526    01:C1C3  9D AD 2B   			sta	vdc_old_chr_x, x
  527                        	
  528    01:C1C6  A5 FE      			lda	<map_chr_y		; Reset previous Y position,
  529    01:C1C8  1A         			inc	a			; ready to draw multiple rows.
  530    01:C1C9  9D AE 2B   			sta	vdc_old_chr_y, x
  531                        	
  532    01:C1CC  BD 76 26   			lda	vdc_map_draw_w, x	; Draw the whole screen.
  533    01:C1CF  85 FA      			sta	<map_draw_w
  534    01:C1D1  BD 77 26   			lda	vdc_map_draw_h, x
  535    01:C1D4  85 FB      			sta	<map_draw_h
  536                        	
  537    01:C1D6  20 16 C5   			jsr	map_scroll_y		; Draw N row of CHR to the BAT.
  538                        	
  539               0000     		.if	BLKMAP_LARGEMAP
  542                        		.endif
  543    01:C1D9  68         			pla				; Restore MPR2..MPR4.
  544    01:C1DA  53 10      			tam4
  545    01:C1DC  68         			pla
  546    01:C1DD  53 08      			tam3
  547    01:C1DF  68         			pla
  548    01:C1E0  53 04      			tam2
  549                        	
  550                        			leave
         01:C1E2  4C EF FF   			jmp	leave_proc
  551                        	
  552                        			.endp
  553                        	
  554                        	
  555                        	
  556                        	; ***************************************************************************
  557                        	; ***************************************************************************
  558                        	;
  559                        	; _scroll_map - Draw a single row of CHR into the BAT to update the edge.
  560                        	; _sgx_scroll_map - Draw a single row of CHR into the BAT to update the edge.
  561                        	;
  562                        	; void __fastcall scroll_map( void );
  563                        	; void __fastcall sgx_scroll_map( void );
  564                        	;
  565                        	
  566               0001     		.if	SUPPORT_SGX
  567                        	
  568    01:C1E5             	_sgx_scroll_map	.proc
  569                        	
  570    01:C1E5  A2 10      			ldx	#SGX_VDC_OFFSET		; Offset to SGX VDC.
  571    01:C1E7  F0         			db	$F0			; Turn "clx" into a "beq".
  572                        	
  573    01:C1E8             			.ref	_scroll_map
  574                        			.endp
  575                        		.endif
  576                        	
  577    01:C1E8             	_scroll_map	.proc
  578                        	
  579    01:C1E8  82         			clx				; Offset to PCE VDC.
  580                        	
  581               0000     		.if	BLKMAP_TIMETEST
  587                        		.endif
  588                        	
  589    01:C1E9  43 04      			tma2				; Preserve MPR2..MPR4.
  590    01:C1EB  48         			pha
  591    01:C1EC  43 08      			tma3
  592    01:C1EE  48         			pha
  593    01:C1EF  43 10      			tma4
  594    01:C1F1  48         			pha
  595               0000     		.if	BLKMAP_LARGEMAP
  598                        		.endif
  599                        	
  600    01:C1F2  20 C0 C2   			jsr	map_pxl_2_chr		; Set up the draw coordinates.
  601                        	
  602               0001     		.if	BLKMAP_MULTISCR
  603    01:C1F5  A5 FD      			lda	<map_scrn_x		; map_scroll_x can change this!
  604    01:C1F7  48         			pha
  605                        		.endif
  606                        	
  607    01:C1F8  BD 77 26   			lda	vdc_map_draw_h, x	; Draw new LHS or RHS if needed.
  608    01:C1FB  85 FB      			sta	<map_draw_h
  609                        	;		lda	#1			; map_scroll_x only ever draws a
  610                        	;		sta	<map_draw_w		; single column.
  611    01:C1FD  20 F7 C3   			jsr	map_scroll_x
  612                        	
  613    01:C200  BD AD 2B   			lda	vdc_old_chr_x, x	; Restore map_chr_x which could
  614    01:C203  85 FC      			sta	<map_chr_x		; be changed by map_scroll_x.
  615                        	
  616               0001     		.if	BLKMAP_MULTISCR
  617    01:C205  68         			pla				; Restore before map_scroll_y.
  618    01:C206  85 FD      			sta	<map_scrn_x
  619                        		.endif
  620                        	
  621    01:C208  BD 76 26   			lda	vdc_map_draw_w, x	; Draw new TOP or BTM if needed.
  622    01:C20B  85 FA      			sta	<map_draw_w
  623    01:C20D  A9 01      			lda	#1
  624    01:C20F  85 FB      			sta	<map_draw_h
  625    01:C211  20 16 C5   			jsr	map_scroll_y
  626                        	
  627               0000     		.if	BLKMAP_LARGEMAP
  630                        		.endif
  631    01:C214  68         			pla				; Restore MPR2..MPR4.
  632    01:C215  53 10      			tam4
  633    01:C217  68         			pla
  634    01:C218  53 08      			tam3
  635    01:C21A  68         			pla
  636    01:C21B  53 04      			tam2
  637                        	
  638               0000     		.if	BLKMAP_TIMETEST
  640                        		.endif
  641                        	
  642                        			leave
         01:C21D  4C EF FF   			jmp	leave_proc
  643                        	
  644                        			.endp
  645                        	
  646                        	
  647                        	
  648                        	; ***************************************************************************
  649                        	; ***************************************************************************
  650                        	;
  651                        	; _blit_map - Draw a map rectangle to specific BAT coordinates.
  652                        	; _sgx_blit_map - Draw a map rectangle to specific BAT coordinates.
  653                        	;
  654                        	; void __fastcall blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
  655                        	; void __fastcall sgx_blit_map( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
  656                        	;
  657                        	; Normally you'd just use _draw_map() and _scroll_map(), but for those folks
  658                        	; who really wish to take manual control, you can use this.
  659                        	;
  660                        	
  661               0001     		.if	SUPPORT_SGX
  662                        	
  663                        	_sgx_blit_map	.proc
  669                        			.endp
  670                        		.endif
  671                        	
  672    01:C220             	_blit_map	.proc
  673                        	
  674    01:C220  82         			clx				; Offset to PCE VDC.
  675                        	
  676    01:C221  BD BA 2B   			lda	vdc_scr_bank, x		; Skip this if a multi-screen
  677    01:C224  D0 36      			bne	.exit			; blkmap.
  678                        	
  679    01:C226  43 04      			tma2				; Preserve MPR2..MPR4.
  680    01:C228  48         			pha
  681    01:C229  43 08      			tma3
  682    01:C22B  48         			pha
  683    01:C22C  43 10      			tma4
  684    01:C22E  48         			pha
  685               0000     		.if	BLKMAP_LARGEMAP
  688                        		.endif
  689                        	
  690    01:C22F  BD 7E 26   			lda	vdc_map_option, x	; Preserve current map options.
  691    01:C232  48         			pha
  692    01:C233  09 C0      			ora	#MAP_UNALIGNED_X | MAP_UNALIGNED_Y
  693    01:C235  9D 7E 26   			sta	vdc_map_option, x
  694                        	
  695    01:C238  20 C0 C2   			jsr	map_pxl_2_chr		; Set up the draw coordinates.
  696                        	
  697    01:C23B  A5 FA      			lda	<map_draw_w		; Are we drawing just 1 column?
  698    01:C23D  C9 01      			cmp	#1
  699    01:C23F  F0 1E      			beq	.draw_column
  700                        	
  701                        			; Draw N rows.
  702                        	
  703    01:C241  A5 FC      	.draw_rows:	lda	<map_chr_x		; Reset previous X position.
  704    01:C243  9D AD 2B   			sta	vdc_old_chr_x, x
  705                        	
  706    01:C246  A5 FE      			lda	<map_chr_y		; Reset previous Y position,
  707    01:C248  1A         			inc	a			; ready to draw rows upwards.
  708    01:C249  9D AE 2B   			sta	vdc_old_chr_y, x
  709                        	
  710    01:C24C  20 16 C5   			jsr	map_scroll_y		; Draw a row of CHR to the BAT.
  711                        	
  712                        			; Drawing completed.
  713                        	
  714    01:C24F  68         	.finished:	pla				; Restore previous map options.
  715    01:C250  9D 7E 26   			sta	vdc_map_option, x
  716                        	
  717               0000     		.if	BLKMAP_LARGEMAP
  720                        		.endif
  721    01:C253  68         			pla				; Restore MPR2..MPR4.
  722    01:C254  53 10      			tam4
  723    01:C256  68         			pla
  724    01:C257  53 08      			tam3
  725    01:C259  68         			pla
  726    01:C25A  53 04      			tam2
  727                        	
  728                        	.exit:		leave
         01:C25C  4C EF FF   			jmp	leave_proc
  729                        	
  730                        			; Draw 1 column.
  731                        	
  732    01:C25F  A5 FC      	.draw_column:	lda	<map_chr_x		; Reset previous X position.
  733    01:C261  1A         			inc	a			; ready to draw 1 column.
  734    01:C262  9D AD 2B   			sta	vdc_old_chr_x, x
  735                        	
  736    01:C265  A5 FE      			lda	<map_chr_y		; Reset previous Y position.
  737    01:C267  9D AE 2B   			sta	vdc_old_chr_y, x
  738                        	
  739    01:C26A  20 F7 C3   			jsr	map_scroll_x		; Draw a single column of CHR.
  740                        	
  741    01:C26D  80 E0      			bra	.finished
  742                        	
  743                        			.endp
  744                        	
  745                        	
  746                        	
  747                        	; ***************************************************************************
  748                        	; ***************************************************************************
  749                        	;
  750                        	; _get_map_block - Get the block number used at a map pixel coordinate.
  751                        	; _sgx_get_map_block - Get the block number used at a map pixel coordinate.
  752                        	;
  753                        	; unsigned char __fastcall _get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
  754                        	; unsigned char __fastcall _sgx_get_map_block( unsigned int x<map_pxl_x>, unsigned int y<map_pxl_y> );
  755                        	;
  756                        	
  757               0001     		.if	SUPPORT_SGX
  758                        	
  759                        			.proc	_sgx_get_map_block.2
  765                        			.endp
  766                        		.endif
  767                        	
  768    01:C26F             			.proc	_get_map_block.2
  769                        	
  770    01:C26F  82         			clx				; Offset to PCE VDC.
  771                        	
  772    01:C270  43 04      			tma2				; Preserve MPR2..MPR4.
  773    01:C272  48         			pha
  774    01:C273  43 08      			tma3
  775    01:C275  48         			pha
  776    01:C276  43 10      			tma4
  777    01:C278  48         			pha
  778               0000     		.if	BLKMAP_LARGEMAP
  781                        		.endif
  782                        	
  783    01:C279  20 D4 C2   			jsr	xvt_pxl_2_chr		; Set up the query coordinates.
  784                        	
  785    01:C27C  20 02 C3   			jsr	map_chr_2_data		; Page in the map address.
  786                        	
  787    01:C27F  B2 EC      			lda	[_bp]			; Read the BLK from the map.
  788    01:C281  A8         			tay
  789                        	
  790    01:C282  A5 FC      			lda	<map_chr_x		; Calc the BLK address offset
  791    01:C284  4A         			lsr	a			; use depending upon even/odd
  792    01:C285  A5 FE      			lda	<map_chr_y		; CHR coordinates (not BAT to
  793    01:C287  29 01      			and	#1			; support unaligned drawing).
  794    01:C289  2A         			rol	a
  795    01:C28A  09 04      			ora	#4			; Offset to BLK table top byte.
  796    01:C28C  7D B3 2B   			adc.h	vdc_blk_addr, x		; What is the BLK data address?
  797    01:C28F  85 ED      			sta.h	<_bp			; $4000, $4800, $5000 or $5800.
  798    01:C291  64 EC      			stz.l	<_bp
  799    01:C293  B1 EC      			lda	[_bp], y		; Read the collision flags from
  800    01:C295  29 0C      			and	#%00001100		; the top byte of the CHR.
  801    01:C297  4A         			lsr	a
  802    01:C298  4A         			lsr	a
  803    01:C299  4A         			lsr	a			; Swizzle the bottom bit to get
  804    01:C29A  90 02      			bcc	!+			; the same bit order as used in
  805    01:C29C  09 02      			ora	#2			; .HALTMAP layer.
  806    01:C29E  8D AB 2B   	!:		sta	map_blk_flag
  807                        	
  808    01:C2A1  BD B1 2B   			lda	vdc_tbl_bank, x		; Is there a table of flags?
  809    01:C2A4  F0 09      			beq	!+
  810    01:C2A6  53 08      			tam3
  811                        	;		inc	a
  812                        	;		tam4
  813                        	;		lda.l	vdc_tbl_addr, x
  814                        	;		sta.l	<_bp
  815    01:C2A8  BD B0 2B   			lda.h	vdc_tbl_addr, x		; If so, it must be aligned!
  816    01:C2AB  85 ED      			sta.h	<_bp
  817    01:C2AD  B1 EC      			lda	[_bp], y		; Read the .MASKMAP/.OVERMAP
  818    01:C2AF  8D AC 2B   	!:		sta	map_blk_mask		; flag value for this BLK.
  819                        	
  820               0000     		.if	BLKMAP_LARGEMAP
  823                        		.endif
  824    01:C2B2  68         			pla				; Restore MPR2..MPR4.
  825    01:C2B3  53 10      			tam4
  826    01:C2B5  68         			pla
  827    01:C2B6  53 08      			tam3
  828    01:C2B8  68         			pla
  829    01:C2B9  53 04      			tam2
  830                        	
  831    01:C2BB  02         			sxy				; Put the BLK number in X.
  832    01:C2BC  C2         			cly
  833                        	
  834                        			leave				; All done!
         01:C2BD  4C EF FF   			jmp	leave_proc
  835                        	
  836                        			.endp
  837                        	
  838                        	
  839                        	
  840                        	; ***************************************************************************
  841                        	; ***************************************************************************
  842                        	;
  843                        	; map_pxl_2_chr - Convert PXL to CHR, BLK and SCR coordinates.
  844                        	;
  845                        	
  846    01:C2C0  BD 7C 26   	map_pxl_2_chr:	lda.l	vdc_map_pxl_y, x	; Get current map Y coordinate.
  847    01:C2C3  85 FE      			sta.l	<map_pxl_y
  848    01:C2C5  BD 7D 26   			lda.h	vdc_map_pxl_y, x
  849    01:C2C8  85 FF      			sta.h	<map_pxl_y
  850                        	
  851    01:C2CA  BD 7A 26   			lda.l	vdc_map_pxl_x, x	; Get current map X coordinate.
  852    01:C2CD  85 FC      			sta.l	<map_pxl_x
  853    01:C2CF  BD 7B 26   			lda.h	vdc_map_pxl_x, x
  854    01:C2D2  85 FD      			sta.h	<map_pxl_x
  855                        	
  856    01:C2D4  A5 FD      	xvt_pxl_2_chr:	lda.h	<map_pxl_x		; Xvert map_pxl_x to map_chr_x.
  857               0001     		.if	BLKMAP_MULTISCR
  858    01:C2D6  A8         			tay				; Xvert map_pxl_x to map_scrn_x.
  859    01:C2D7  3C 71 26   			bit	vdc_bat_width, x
  860    01:C2DA  70 03      			bvs	.w64
  861    01:C2DC  10 02      			bpl	.w32
  862    01:C2DE  4A         	.w128:		lsr	a
  863    01:C2DF  4A         	.w64:		lsr	a
  864    01:C2E0  85 FD      	.w32:		sta	<map_scrn_x
  865    01:C2E2  98         			tya
  866                        		.endif
  867    01:C2E3  4A         			lsr	a
  868    01:C2E4  66 FC      			ror.l	<map_pxl_x
  869    01:C2E6  4A         			lsr	a
  870    01:C2E7  66 FC      			ror.l	<map_pxl_x
  871    01:C2E9  4A         			lsr	a
  872    01:C2EA  66 FC      			ror.l	<map_pxl_x		; Max map width is 256 CHR.
  873                        	
  874    01:C2EC  A5 FF      			lda.h	<map_pxl_y		; Xvert map_pxl_y to map_chr_y.
  875               0001     		.if	BLKMAP_MULTISCR
  876    01:C2EE  A8         			tay				; Xvert map_pxl_y to map_scrn_y.
  877    01:C2EF  3C 72 26   			bit	vdc_bat_height, x
  878    01:C2F2  50 01      			bvc	.h32
  879    01:C2F4  4A         	.h64:		lsr	a
  880    01:C2F5  85 FF      	.h32:		sta	<map_scrn_y
  881    01:C2F7  98         			tya
  882                        		.endif
  883    01:C2F8  4A         			lsr	a
  884    01:C2F9  66 FE      			ror.l	<map_pxl_y
  885    01:C2FB  4A         			lsr	a
  886    01:C2FC  66 FE      			ror.l	<map_pxl_y
  887    01:C2FE  4A         			lsr	a
  888    01:C2FF  66 FE      			ror.l	<map_pxl_y		; Max map width is 256 CHR.
  889                        	
  890    01:C301  60         			rts
  891                        	
  892                        	
  893                        	
  894                        	; ***************************************************************************
  895                        	; ***************************************************************************
  896                        	;
  897                        	; map_chr_2_data - Page in the MAP address for the CHR coordinates.
  898                        	;
  899                        	
  900    01:C302             	map_chr_2_data:
  901                        	
  902               0001     		.if	BLKMAP_MULTISCR
  903                        	
  904                        			; Initialization for a multi-screen map.
  905                        	
  906    01:C302  BD BA 2B   			lda	vdc_scr_bank, x		; Skip this if regular blkmap.
  907    01:C305  F0 3A      			beq	.regular
  908                        	
  909    01:C307  A5 FC      	.multiscreen:	lda	<map_chr_x		; Compare old_x with cur_x.
  910    01:C309  3D 73 26   			and	vdc_bat_x_mask, x
  911    01:C30C  85 F8      			sta	<map_bat_x		; Save BAT X chr coordinate.
  912                        	
  913    01:C30E  A5 FE      			lda	<map_chr_y		; Save BAT Y chr coordinate.
  914    01:C310  3D 74 26   			and	vdc_bat_y_mask, x
  915    01:C313  85 F9      			sta	<map_bat_y
  916    01:C315  4A         			lsr	a			; Map BLK Y coordinate.
  917    01:C316  85 EF      			sta.h	<map_line
  918    01:C318  62         			cla
  919    01:C319  3C 71 26   			bit	vdc_bat_width, x
  920    01:C31C  30 08      			bmi	.w128
  921    01:C31E  70 03      			bvs	.w64
  922    01:C320  46 EF      	.w32:		lsr.h	<map_line
  923    01:C322  6A         			ror	a
  924    01:C323  46 EF      	.w64:		lsr.h	<map_line
  925    01:C325  6A         			ror	a
  926    01:C326  46 EF      	.w128:		lsr.h	<map_line
  927    01:C328  6A         			ror	a
  928    01:C329  46 EF      			lsr.h	<map_line		; Hi-byte of (BLK Y * width).
  929    01:C32B  6A         			ror	a
  930    01:C32C  85 EE      			sta.l	<map_line		; Lo-byte of (BLK Y * width).
  931                        	
  932    01:C32E  20 82 C3   			jsr	map_set_screen		; Put BLK & MAP in MPR2-MPR5.
  933                        	
  934    01:C331  A5 F8      			lda	<map_bat_x		; Calc map data pointer.
  935    01:C333  4A         			lsr	a			; Map BLK X coordinate.
  936    01:C334  05 EE      			ora.l	<map_line
  937    01:C336  85 EC      			sta.l	<_bp
  938    01:C338  A5 EF      			lda.h	<map_line
  939    01:C33A  18         			clc
  940    01:C33B  7D B6 2B   			adc.h	vdc_map_addr, x		; N.B. 256-byte aligned!
  941    01:C33E  85 ED      			sta.h	<_bp
  942                        	
  943    01:C340  60         			rts
  944                        	
  945                        		.endif	BLKMAP_MULTISCR
  946                        	
  947                        			; Initialization for a regular map.
  948                        	
  949    01:C341  A5 FC      	.regular:	lda	<map_chr_x		; Compare old_x with cur_x.
  950                        	;		bit	vdc_map_option, x	; Set bit7 to disable aligning
  951                        	;		bmi	!+			; BAT X with the map X.
  952    01:C343  3D 73 26   			and	vdc_bat_x_mask, x
  953    01:C346  85 F8      			sta	<map_bat_x		; Save BAT X chr coordinate.
  954                        	
  955    01:C348  A5 FE      	!:		lda	<map_chr_y		; A = map CHR Y coordinate.
  956    01:C34A  A8         			tay
  957    01:C34B  4A         			lsr	a
  958    01:C34C  42         			say				; Y = map BLK Y coordinate.
  959                        	
  960                        	;		bit	vdc_map_option, x	; Set bit6 to disable aligning
  961                        	;		bvs	!+			; BAT Y with the map Y.
  962    01:C34D  3D 74 26   			and	vdc_bat_y_mask, x
  963    01:C350  85 F9      			sta	<map_bat_y		; Save BAT Y chr coordinate.
  964                        	
  965               0000     		.if	BLKMAP_LARGEMAP
  970                        		.endif
  971                        	
  972    01:C352  BD 78 26   	!:		lda	vdc_map_line_w, x	; Map width in BLK.
  973               0000     		.if	FAST_MULTIPLY
  986                        		.else
  987    01:C355  84 EF      			sty.h	<map_line		; Takes 144..176 cycles.
  988    01:C357  A0 08      			ldy	#8
  989    01:C359  4A         			lsr	a
  990    01:C35A  85 EE      			sta.l	<map_line
  991    01:C35C  62         			cla
  992    01:C35D  90 03      			bcc	.rotate
  993    01:C35F  18         	.add:		clc
  994    01:C360  65 EF      			adc.h	<map_line
  995    01:C362  6A         	.rotate:	ror	a
  996    01:C363  66 EE      			ror.l	<map_line		; Lo-byte of (BLK Y * width).
  997    01:C365  88         			dey
  998    01:C366  B0 F7      			bcs	.add
  999    01:C368  D0 F8      			bne	.rotate
 1000    01:C36A  A8         			tay				; Hi-byte of (BLK Y * width).
 1001                        		.endif
 1002                        	
 1003    01:C36B  A5 FC      	!:		lda	<map_chr_x		; Map CHR X coordinate.
 1004    01:C36D  4A         			lsr	a			; Map BLK X coordinate.
 1005    01:C36E  18         			clc
 1006    01:C36F  65 EE      			adc.l	<map_line		; Lo-byte of (BLK Y * width).
 1007    01:C371  90 01      			bcc	!+
 1008    01:C373  C8         			iny				; Hi-byte of (BLK Y * width).
 1009                        	
 1010    01:C374  18         	!:		clc				; Calc map data pointer.
 1011    01:C375  7D B5 2B   			adc.l	vdc_map_addr, x
 1012    01:C378  85 EC      			sta.l	<_bp			; Maximum map size is 16KBytes
 1013    01:C37A  98         			tya				; so we don't need to consider
 1014    01:C37B  7D B6 2B   			adc.h	vdc_map_addr, x		; bank overflow.
 1015    01:C37E  85 ED      			sta.h	<_bp
 1016                        	
 1017    01:C380  80 66      			bra	map_set_banks		; Put BLK & MAP in MPR2-MPR5.
 1018                        	
 1019                        	
 1020                        	
 1021               0001     		.if	BLKMAP_MULTISCR
 1022                        	
 1023                        	; ***************************************************************************
 1024                        	; ***************************************************************************
 1025                        	;
 1026                        	; map_set_screen -
 1027                        	;
 1028                        	; Maximum X and Y dimension of 128 screens (32768 pixels).
 1029                        	; Maximum 8KByte total size of screen data (1024 screens).
 1030                        	;
 1031                        	
 1032    01:C382  A4 FF      	map_set_screen:	ldy	<map_scrn_y		; Map SCR Y coordinate.
 1033    01:C384  BD 79 26   			lda	vdc_map_scrn_w, x	; Map width in SCREENS.
 1034                        	
 1035               0000     		.if	FAST_MULTIPLY
 1048                        		.else
 1049    01:C387  84 ED      			sty.h	<_bp			; Takes 144..176 cycles.
 1050    01:C389  A0 08      			ldy	#8
 1051    01:C38B  4A         			lsr	a
 1052    01:C38C  85 EC      			sta.l	<_bp
 1053    01:C38E  62         			cla
 1054    01:C38F  90 03      			bcc	.rotate
 1055    01:C391  18         	.add:		clc
 1056    01:C392  65 ED      			adc.h	<_bp
 1057    01:C394  6A         	.rotate:	ror	a
 1058    01:C395  66 EC      			ror.l	<_bp			; Lo-byte of (SCR Y * width).
 1059    01:C397  88         			dey
 1060    01:C398  B0 F7      			bcs	.add
 1061    01:C39A  D0 F8      			bne	.rotate
 1062    01:C39C  A8         			tay				; Hi-byte of (SCR Y * width).
 1063                        		.endif
 1064                        	
 1065    01:C39D  A5 FD      			lda	<map_scrn_x		; Map SCR X coordinate.
 1066    01:C39F  18         			clc
 1067    01:C3A0  65 EC      			adc.l	<_bp
 1068    01:C3A2  90 01      			bcc	!+
 1069    01:C3A4  C8         			iny
 1070                        	
 1071    01:C3A5  84 ED      	!:		sty.h	<_bp			; 2 bytes per screen entry, max
 1072    01:C3A7  0A         			asl	a			; 8KByte screen table.
 1073    01:C3A8  26 ED      			rol.h	<_bp
 1074               0001     		.if	BLKDEF_POINTERS == 0
 1075    01:C3AA  0A         			asl	a			; 8 bytes per screen entry when
 1076    01:C3AB  26 ED      			rol.h	<_bp			; not using BLK pointers.
 1077    01:C3AD  0A         			asl	a
 1078    01:C3AE  26 ED      			rol.h	<_bp
 1079                        		.endif
 1080                        	
 1081    01:C3B0  7D B8 2B   			adc.l	vdc_scr_addr, x		; Calc screen data pointer.
 1082    01:C3B3  85 EC      			sta.l	<_bp			; Maximum data size is 8KBytes
 1083    01:C3B5  A5 ED      			lda.h	<_bp			; so we don't need to consider
 1084    01:C3B7  7D B9 2B   			adc.h	vdc_scr_addr, x		; bank overflow.
 1085    01:C3BA  85 ED      			sta.h	<_bp
 1086                        	
 1087    01:C3BC  BD BA 2B   			lda	vdc_scr_bank, x		; Map the SCR data in MPR3..MPR4.
 1088    01:C3BF  53 08      			tam3
 1089    01:C3C1  1A         			inc	a
 1090    01:C3C2  53 10      			tam4
 1091                        	
 1092    01:C3C4  C2         			cly
 1093    01:C3C5  B1 EC      			lda	[_bp], y		; Get SCR_MAP_PAGE.
 1094    01:C3C7  9D B6 2B   			sta.h	vdc_map_addr, x
 1095    01:C3CA  C8         			iny
 1096    01:C3CB  B1 EC      			lda	[_bp], y		; Get SCR_MAP_BANK.
 1097    01:C3CD  9D B7 2B   			sta	vdc_map_bank, x
 1098                        	
 1099               0001     		.if	BLKDEF_POINTERS == 0
 1100    01:C3D0  C8         			iny
 1101    01:C3D1  B1 EC      			lda	[_bp], y		; Get SCR_BLK_PAGE.
 1102    01:C3D3  9D B3 2B   			sta.h	vdc_blk_addr, x
 1103    01:C3D6  C8         			iny
 1104    01:C3D7  B1 EC      			lda	[_bp], y		; Get SCR_BLK_BANK.
 1105    01:C3D9  9D B4 2B   			sta	vdc_blk_bank, x
 1106    01:C3DC  C8         			iny
 1107    01:C3DD  B1 EC      			lda	[_bp], y		; Get SCR_TBL_PAGE.
 1108    01:C3DF  9D B0 2B   			sta.h	vdc_tbl_addr, x
 1109    01:C3E2  C8         			iny
 1110    01:C3E3  B1 EC      			lda	[_bp], y		; Get SCR_TBL_BANK.
 1111    01:C3E5  9D B1 2B   			sta	vdc_tbl_bank, x
 1112               0000     		.if	0				; These are not currently used.
 1119                        		.endif
 1120                        		.endif
 1121                        	
 1122                        	;		lda	vdc_bat_width, x	; Set up the map width.
 1123                        	;		lsr	a			; This should have been set
 1124                        	;		sta	vdc_map_line_w, x	; with the multi-screen map.
 1125                        	
 1126                        	;		jmp	map_set_banks		; Put BLK & MAP in MPR2-MPR5.
 1127                        	
 1128                        			; Fall through to map_set_banks.
 1129                        	
 1130                        		.endif	BLKMAP_MULTISCR
 1131                        	
 1132                        	
 1133                        	
 1134                        	; ***************************************************************************
 1135                        	; ***************************************************************************
 1136                        	;
 1137                        	; map_set_banks - Put BLK & MAP in MPR2-MPR5.
 1138                        	;
 1139                        	
 1140    01:C3E8  BD B4 2B   	map_set_banks:	lda	vdc_blk_bank, x		; Put the BLK into MPR2.
 1141    01:C3EB  53 04      			tam2
 1142                        	
 1143    01:C3ED  BD B7 2B   			lda	vdc_map_bank, x		; Put the MAP into MPR3-MPR5.
 1144    01:C3F0  53 08      			tam3
 1145    01:C3F2  1A         			inc	a
 1146    01:C3F3  53 10      			tam4
 1147               0000     		.if	BLKMAP_LARGEMAP
 1156                        		.endif
 1157                        	
 1158    01:C3F5  60         	!:		rts
 1159                        	
 1160                        	
 1161                        	
 1162                        	; ***************************************************************************
 1163                        	; ***************************************************************************
 1164                        	;
 1165                        	; map_scroll_x - Update the BAT when X coordinate changes.
 1166                        	;
 1167                        	; N.B. This will alter map_chr_x and map_scrn_x if moved in +ve direction!
 1168                        	;
 1169                        	; N.B. This only ever draws a single column!
 1170                        	;
 1171                        	
 1172    01:C3F6  60         	!no_change:	rts
 1173                        	
 1174    01:C3F7             	map_scroll_x:
 1175                        	
 1176               0001     		.if	BLKMAP_MULTISCR
 1177                        	
 1178                        			; Initialization for a multi-screen map.
 1179                        	
 1180    01:C3F7  BD BA 2B   			lda	vdc_scr_bank, x		; Skip this if regular blkmap.
 1181    01:C3FA  F0 56      			beq	.regular
 1182                        	
 1183    01:C3FC  A5 FC      	.multiscreen:	lda	<map_chr_x		; Compare old_x with cur_x.
 1184    01:C3FE  DD AD 2B   			cmp	vdc_old_chr_x, x
 1185               0001     		.if	BLKMAP_TIMETEST == 0
 1186    01:C401  F0 F3      			beq	!no_change-		; Do nothing if no change.
 1187                        		.endif
 1188    01:C403  9D AD 2B   			sta	vdc_old_chr_x, x
 1189    01:C406  30 11      			bmi	!+			; Test the sign of the change.
 1190                        	
 1191    01:C408  18         			clc				; Draw RHS if chr_x >= old_x.
 1192    01:C409  3D 73 26   			and	vdc_bat_x_mask, x
 1193    01:C40C  7D 76 26   			adc	vdc_map_draw_w, x	; Usually (SCR_WIDTH / 8) + 1.
 1194    01:C40F  3A         			dec	a
 1195    01:C410  85 FC      			sta	<map_chr_x		; Update CHR X chr coordinate.
 1196    01:C412  3C 71 26   			bit	vdc_bat_width, x
 1197    01:C415  F0 02      			beq	!+
 1198    01:C417  E6 FD      			inc	<map_scrn_x		; Wrapped to the next screen.
 1199                        	
 1200    01:C419  3D 73 26   	!:		and	vdc_bat_x_mask, x
 1201    01:C41C  85 F8      			sta	<map_bat_x		; Save BAT X chr coordinate.
 1202                        	
 1203    01:C41E  A5 FE      			lda	<map_chr_y		; Save BAT Y chr coordinate.
 1204    01:C420  3D 74 26   			and	vdc_bat_y_mask, x
 1205    01:C423  85 F9      			sta	<map_bat_y
 1206    01:C425  4A         			lsr	a			; Map BLK Y coordinate.
 1207    01:C426  85 EF      			sta.h	<map_line
 1208    01:C428  62         			cla
 1209    01:C429  3C 71 26   			bit	vdc_bat_width, x
 1210    01:C42C  30 08      			bmi	.w128
 1211    01:C42E  70 03      			bvs	.w64
 1212    01:C430  46 EF      	.w32:		lsr.h	<map_line
 1213    01:C432  6A         			ror	a
 1214    01:C433  46 EF      	.w64:		lsr.h	<map_line
 1215    01:C435  6A         			ror	a
 1216    01:C436  46 EF      	.w128:		lsr.h	<map_line
 1217    01:C438  6A         			ror	a
 1218    01:C439  46 EF      			lsr.h	<map_line		; Hi-byte of (BLK Y * width).
 1219    01:C43B  6A         			ror	a
 1220    01:C43C  85 EE      			sta.l	<map_line		; Lo-byte of (BLK Y * width).
 1221                        	
 1222    01:C43E  20 82 C3   			jsr	map_set_screen		; Put BLK & MAP in MPR2-MPR5.
 1223                        	
 1224    01:C441  A5 F8      			lda	<map_bat_x		; Calc map data pointer.
 1225    01:C443  4A         			lsr	a			; Map BLK X coordinate.
 1226    01:C444  05 EE      			ora.l	<map_line
 1227    01:C446  85 EC      			sta.l	<_bp
 1228    01:C448  A5 EF      			lda.h	<map_line
 1229    01:C44A  18         			clc
 1230    01:C44B  7D B6 2B   			adc.h	vdc_map_addr, x		; N.B. 256-byte aligned!
 1231    01:C44E  85 ED      			sta.h	<_bp
 1232                        	
 1233    01:C450  80 5D      			bra	.draw_col		; Now draw it.
 1234                        	
 1235                        		.endif	BLKMAP_MULTISCR
 1236                        	
 1237                        			; Initialization for a regular map.
 1238                        	
 1239    01:C452  A5 FC      	.regular:	lda	<map_chr_x		; Compare old_x with cur_x.
 1240    01:C454  DD AD 2B   			cmp	vdc_old_chr_x, x
 1241               0001     		.if	BLKMAP_TIMETEST == 0
 1242    01:C457  F0 9D      			beq	!no_change-		; Do nothing if no change.
 1243                        		.endif
 1244    01:C459  9D AD 2B   			sta	vdc_old_chr_x, x
 1245    01:C45C  30 07      			bmi	!+			; Test the sign of the change.
 1246                        	
 1247    01:C45E  18         			clc				; Draw RHS if chr_x >= old_x.
 1248    01:C45F  7D 76 26   			adc	vdc_map_draw_w, x	; Usually (SCR_WIDTH / 8) + 1.
 1249    01:C462  3A         			dec	a
 1250    01:C463  85 FC      			sta	<map_chr_x		; Update CHR X chr coordinate.
 1251                        	
 1252    01:C465  3C 7E 26   	!:		bit	vdc_map_option, x	; Set bit7 to disable aligning
 1253    01:C468  30 05      			bmi	!+			; BAT X with the map X.
 1254    01:C46A  3D 73 26   			and	vdc_bat_x_mask, x
 1255    01:C46D  85 F8      			sta	<map_bat_x		; Save BAT X chr coordinate.
 1256                        	
 1257    01:C46F  A5 FE      	!:		lda	<map_chr_y		; A = map CHR Y coordinate.
 1258    01:C471  A8         			tay
 1259    01:C472  4A         			lsr	a
 1260    01:C473  42         			say				; Y = map BLK Y coordinate.
 1261                        	
 1262    01:C474  3C 7E 26   			bit	vdc_map_option, x	; Set bit6 to disable aligning
 1263    01:C477  70 05      			bvs	!+			; BAT Y with the map Y.
 1264    01:C479  3D 74 26   			and	vdc_bat_y_mask, x
 1265    01:C47C  85 F9      			sta	<map_bat_y		; Save BAT Y chr coordinate.
 1266                        	
 1267               0000     		.if	BLKMAP_LARGEMAP
 1272                        		.endif
 1273                        	
 1274    01:C47E  BD 78 26   	!:		lda	vdc_map_line_w, x	; Map width in BLK.
 1275               0000     		.if	FAST_MULTIPLY
 1288                        		.else
 1289    01:C481  84 EF      			sty.h	<map_line		; Takes 144..176 cycles.
 1290    01:C483  A0 08      			ldy	#8
 1291    01:C485  4A         			lsr	a
 1292    01:C486  85 EE      			sta.l	<map_line
 1293    01:C488  62         			cla
 1294    01:C489  90 03      			bcc	.rotate
 1295    01:C48B  18         	.add:		clc
 1296    01:C48C  65 EF      			adc.h	<map_line
 1297    01:C48E  6A         	.rotate:	ror	a
 1298    01:C48F  66 EE      			ror.l	<map_line		; Lo-byte of (BLK Y * width).
 1299    01:C491  88         			dey
 1300    01:C492  B0 F7      			bcs	.add
 1301    01:C494  D0 F8      			bne	.rotate
 1302    01:C496  A8         			tay				; Hi-byte of (BLK Y * width).
 1303                        		.endif
 1304                        	
 1305    01:C497  A5 FC      	!:		lda	<map_chr_x		; Map CHR X coordinate.
 1306    01:C499  4A         			lsr	a			; Map BLK X coordinate.
 1307    01:C49A  18         			clc
 1308    01:C49B  65 EE      			adc.l	<map_line		; Lo-byte of (BLK Y * width).
 1309    01:C49D  90 01      			bcc	!+
 1310    01:C49F  C8         			iny				; Hi-byte of (BLK Y * width).
 1311                        	
 1312    01:C4A0  18         	!:		clc				; Calc map data pointer.
 1313    01:C4A1  7D B5 2B   			adc.l	vdc_map_addr, x
 1314    01:C4A4  85 EC      			sta.l	<_bp			; Maximum map size is 16KBytes
 1315    01:C4A6  98         			tya				; so we don't need to consider
 1316    01:C4A7  7D B6 2B   			adc.h	vdc_map_addr, x		; bank overflow.
 1317    01:C4AA  85 ED      			sta.h	<_bp
 1318                        	
 1319    01:C4AC  20 E8 C3   			jsr	map_set_banks		; Put BLK & MAP in MPR2-MPR5.
 1320                        	
 1321                        			; Draw the first part of the column.
 1322                        	
 1323    01:C4AF  A5 F8      	.draw_col:	lda	<map_bat_x		; Set the BAT VRAM destination
 1324    01:C4B1  85 F0      			sta.l	<_di			; coordinates.
 1325    01:C4B3  A5 F9      			lda	<map_bat_y
 1326    01:C4B5  85 F1      			sta.h	<_di
 1327                        	
 1328    01:C4B7  5D 74 26   			eor	vdc_bat_y_mask, x	; Calc CHR before wrap.
 1329    01:C4BA  1A         			inc	a
 1330    01:C4BB  DD 77 26   			cmp	vdc_map_draw_h, x	; Usually (SCR_HEIGHT / 8) + 1.
 1331    01:C4BE  90 03      			bcc	!+
 1332    01:C4C0  BD 77 26   			lda	vdc_map_draw_h, x	; Maximum CHR to draw.
 1333    01:C4C3  85 00      	!:		sta	<map_count		; Set number of CHR to draw.
 1334    01:C4C5  85 01      			sta	<map_drawn		; Preserve number of CHR drawn.
 1335                        	
 1336    01:C4C7  A9 05      			lda	#VDC_CR			; Set VDC auto-increment from
 1337    01:C4C9  95 F7      			sta	<vdc_reg, x		; the BAT width, which is set
 1338    01:C4CB  9D 00 02   			sta	VDC_AR, x		; up by set_screen_size().
 1339    01:C4CE  B5 F4      			lda	<vdc_crh, x
 1340    01:C4D0  9D 03 02   			sta	VDC_DH, x
 1341                        	
 1342    01:C4D3  20 15 C8   			jsr	blk_col_strip		; Draw top of vertical strip.
 1343                        	
 1344                        			; Wrap around and draw the rest of the column (if needed).
 1345                        	
 1346    01:C4D6  38         			sec				; Are there any more CHR that
 1347    01:C4D7  BD 77 26   			lda	vdc_map_draw_h, x	; need to be drawn?
 1348    01:C4DA  E5 01      			sbc	<map_drawn
 1349    01:C4DC  F0 2C      			beq	.done
 1350                        	
 1351    01:C4DE  85 00      			sta	<map_count		; Set number of CHR to draw.
 1352                        	
 1353    01:C4E0  A5 FE      			lda	<map_chr_y		; Update CHR Y coordinate for
 1354    01:C4E2  48         			pha				; drawing unaligned tiles.
 1355    01:C4E3  18         			clc
 1356    01:C4E4  65 01      			adc	<map_drawn
 1357    01:C4E6  85 FE      			sta	<map_chr_y
 1358                        	
 1359               0001     		.if	BLKMAP_MULTISCR
 1360    01:C4E8  BD BA 2B   			lda	vdc_scr_bank, x		; Skip this if regular blkmap.
 1361    01:C4EB  F0 0F      			beq	!+
 1362                        	
 1363    01:C4ED  E6 FF      			inc	<map_scrn_y		; Wrapped to the next screen.
 1364                        	
 1365    01:C4EF  20 82 C3   			jsr	map_set_screen		; Put BLK & MAP in MPR2-MPR5.
 1366                        	
 1367    01:C4F2  A5 F8      			lda	<map_bat_x		; Calc map data pointer.
 1368    01:C4F4  4A         			lsr	a			; Map BLK X coordinate.
 1369    01:C4F5  85 EC      			sta.l	<_bp
 1370    01:C4F7  BD B6 2B   			lda.h	vdc_map_addr, x		; N.B. 256-byte aligned!
 1371    01:C4FA  85 ED      			sta.h	<_bp
 1372                        		.endif
 1373                        	
 1374    01:C4FC  A5 F8      	!:		lda	<map_bat_x		; Set the BAT VRAM destination
 1375    01:C4FE  85 F0      			sta.l	<_di			; coordinates.
 1376    01:C500  64 F1      			stz.h	<_di			; Reset 1st row to draw.
 1377                        	
 1378    01:C502  20 15 C8   			jsr	blk_col_strip		; Draw btm of vertical strip.
 1379                        	
 1380               0001     		.if	BLKMAP_MULTISCR
 1381    01:C505  C6 FF      			dec	<map_scrn_y		; Restore, no check if should.
 1382                        		.endif
 1383                        	
 1384    01:C507  68         			pla				; Restore CHR Y coordinate, we
 1385    01:C508  85 FE      			sta	<map_chr_y		; might draw another column!
 1386                        	
 1387    01:C50A  A9 05      	.done:		lda	#VDC_CR			; Set VDC auto-increment to 1.
 1388    01:C50C  95 F7      			sta	<vdc_reg, x
 1389    01:C50E  9D 00 02   			sta	VDC_AR, x
 1390    01:C511  9E 03 02   			stz	VDC_DH, x
 1391                        	
 1392    01:C514  60         			rts
 1393                        	
 1394                        	
 1395                        	
 1396                        	; ***************************************************************************
 1397                        	; ***************************************************************************
 1398                        	;
 1399                        	; map_scroll_y - Update the BAT when Y coordinate changes.
 1400                        	;
 1401                        	; N.B. This will alter map_chr_y and map_scrn_y if moved in +ve direction!
 1402                        	;
 1403                        	; N.B. This draws multiple rows when called from _draw_map or _blit_map.
 1404                        	;
 1405                        	
 1406    01:C515  60         	!no_change:	rts
 1407                        	
 1408    01:C516             	map_scroll_y:
 1409                        	
 1410               0001     		.if	BLKMAP_MULTISCR
 1411                        	
 1412                        			; Initialization for a multi-screen map.
 1413                        	
 1414    01:C516  BD BA 2B   			lda	vdc_scr_bank, x		; Skip this if regular blkmap.
 1415    01:C519  F0 56      			beq	.regular
 1416                        	
 1417    01:C51B  A5 FE      	.multiscr:	lda	<map_chr_y		; Compare old_y with cur_y.
 1418    01:C51D  DD AE 2B   			cmp	vdc_old_chr_y, x
 1419               0001     		.if	BLKMAP_TIMETEST == 0
 1420    01:C520  F0 F3      			beq	!no_change-		; Do nothing if no change.
 1421                        		.endif
 1422    01:C522  9D AE 2B   			sta	vdc_old_chr_y, x
 1423    01:C525  30 11      			bmi	!+			; Test the sign of the change.
 1424                        	
 1425    01:C527  18         			clc				; Draw bottom if chr_y >= old_y.
 1426    01:C528  3D 74 26   			and	vdc_bat_y_mask, x
 1427    01:C52B  7D 77 26   			adc	vdc_map_draw_h, x	; Usually (SCR_HEIGHT / 8) + 1.
 1428    01:C52E  3A         			dec	a
 1429    01:C52F  85 FE      			sta	<map_chr_y		; Update CHR Y chr coordinate.
 1430    01:C531  3C 72 26   			bit	vdc_bat_height, x
 1431    01:C534  F0 02      			beq	!+
 1432    01:C536  E6 FF      			inc	<map_scrn_y		; Wrapped to the next screen.
 1433                        	
 1434    01:C538  3D 74 26   	!:		and	vdc_bat_y_mask, x
 1435    01:C53B  85 F9      			sta	<map_bat_y		; Save BAT Y chr coordinate.
 1436                        	
 1437    01:C53D  4A         			lsr	a			; Map BLK Y coordinate.
 1438    01:C53E  85 EF      			sta.h	<map_line
 1439    01:C540  62         			cla
 1440    01:C541  3C 71 26   			bit	vdc_bat_width, x
 1441    01:C544  30 08      			bmi	.w128
 1442    01:C546  70 03      			bvs	.w64
 1443    01:C548  46 EF      	.w32:		lsr.h	<map_line
 1444    01:C54A  6A         			ror	a
 1445    01:C54B  46 EF      	.w64:		lsr.h	<map_line
 1446    01:C54D  6A         			ror	a
 1447    01:C54E  46 EF      	.w128:		lsr.h	<map_line
 1448    01:C550  6A         			ror	a
 1449    01:C551  46 EF      			lsr.h	<map_line		; Hi-byte of (BLK Y * width).
 1450    01:C553  6A         			ror	a
 1451    01:C554  85 EE      			sta.l	<map_line		; Lo-byte of (BLK Y * width).
 1452                        	
 1453    01:C556  A5 FC      			lda	<map_chr_x
 1454    01:C558  3D 73 26   			and	vdc_bat_x_mask, x
 1455    01:C55B  85 F8      			sta	<map_bat_x		; Save BAT X chr coordinate.
 1456                        	
 1457                        			; Loop to here if drawing multiple multi-screen rows.
 1458                        	
 1459    01:C55D  20 82 C3   	.multiscr_row:	jsr	map_set_screen		; Put BLK & MAP in MPR2-MPR5.
 1460                        	
 1461    01:C560  A5 F8      			lda	<map_bat_x		; Calc map data pointer.
 1462    01:C562  4A         			lsr	a			; Map BLK X coordinate.
 1463    01:C563  05 EE      			ora.l	<map_line
 1464    01:C565  85 EC      			sta.l	<_bp
 1465    01:C567  A5 EF      			lda.h	<map_line
 1466    01:C569  18         			clc
 1467    01:C56A  7D B6 2B   			adc.h	vdc_map_addr, x		; N.B. 256-byte aligned!
 1468    01:C56D  85 ED      			sta.h	<_bp
 1469                        	
 1470    01:C56F  80 60      			bra	.draw_row		; Now draw it.
 1471                        	
 1472                        		.endif	BLKMAP_MULTISCR
 1473                        	
 1474                        			; Initialization for a regular blkmap.
 1475                        	
 1476    01:C571  A5 FE      	.regular:	lda	<map_chr_y		; Compare old_y with cur_y.
 1477    01:C573  DD AE 2B   			cmp	vdc_old_chr_y, x
 1478               0001     		.if	BLKMAP_TIMETEST == 0
 1479    01:C576  F0 9D      			beq	!no_change-		; Do nothing if no change.
 1480                        		.endif
 1481    01:C578  9D AE 2B   			sta	vdc_old_chr_y, x
 1482    01:C57B  30 07      			bmi	!+			; Test the sign of the change.
 1483                        	
 1484    01:C57D  18         			clc				; Draw bottom if chr_y >= old_y.
 1485    01:C57E  7D 77 26   			adc	vdc_map_draw_h, x	; Usually (SCR_HEIGHT / 8) + 1.
 1486    01:C581  3A         			dec	a
 1487    01:C582  85 FE      			sta	<map_chr_y		; Update CHR Y chr coordinate.
 1488                        	
 1489    01:C584  A8         	!:		tay				; A = map CHR Y coordinate.
 1490    01:C585  4A         			lsr	a
 1491    01:C586  42         			say				; Y = map BLK Y coordinate.
 1492                        	
 1493    01:C587  3C 7E 26   			bit	vdc_map_option, x	; Set bit6 to disable aligning
 1494    01:C58A  70 05      			bvs	!+			; BAT Y with the map Y.
 1495    01:C58C  3D 74 26   			and	vdc_bat_y_mask, x
 1496    01:C58F  85 F9      			sta	<map_bat_y		; Save BAT Y chr coordinate.
 1497                        	
 1498    01:C591  3C 7E 26   	!:		bit	vdc_map_option, x	; Set bit7 to disable aligning
 1499    01:C594  30 07      			bmi	!+			; BAT X with the map X.
 1500    01:C596  A5 FC      			lda	<map_chr_x
 1501    01:C598  3D 73 26   			and	vdc_bat_x_mask, x
 1502    01:C59B  85 F8      			sta	<map_bat_x		; Save BAT X chr coordinate.
 1503    01:C59D             	!:
 1504                        	
 1505               0000     		.if	BLKMAP_LARGEMAP
 1510                        		.endif
 1511                        	
 1512    01:C59D  BD 78 26   			lda	vdc_map_line_w, x	; Map width in BLK.
 1513               0000     		.if	FAST_MULTIPLY
 1526                        		.else
 1527    01:C5A0  84 EF      			sty.h	<map_line		; Takes 144..176 cycles.
 1528    01:C5A2  A0 08      			ldy	#8
 1529    01:C5A4  4A         			lsr	a
 1530    01:C5A5  85 EE      			sta.l	<map_line
 1531    01:C5A7  62         			cla
 1532    01:C5A8  90 03      			bcc	.rotate
 1533    01:C5AA  18         	.add:		clc
 1534    01:C5AB  65 EF      			adc.h	<map_line
 1535    01:C5AD  6A         	.rotate:	ror	a
 1536    01:C5AE  66 EE      			ror.l	<map_line		; Lo-byte of (BLK Y * width).
 1537    01:C5B0  88         			dey
 1538    01:C5B1  B0 F7      			bcs	.add
 1539    01:C5B3  D0 F8      			bne	.rotate
 1540    01:C5B5  85 EF      			sta.h	<map_line		; Hi-byte of (BLK Y * width).
 1541                        		.endif
 1542                        	
 1543    01:C5B7  20 E8 C3   			jsr	map_set_banks		; Put BLK & MAP in MPR2-MPR5.
 1544                        	
 1545                        			; Loop to here if drawing multiple regular blkmap rows.
 1546                        	
 1547    01:C5BA  A4 EF      	.regular_row:	ldy.h	<map_line		; Hi-byte of (BLK Y * width).
 1548    01:C5BC  A5 FC      			lda	<map_chr_x		; Map CHR X coordinate.
 1549    01:C5BE  4A         			lsr	a			; Map BLK X coordinate.
 1550    01:C5BF  18         			clc
 1551    01:C5C0  65 EE      			adc.l	<map_line		; Lo-byte of (BLK Y * width).
 1552    01:C5C2  90 01      			bcc	!+
 1553    01:C5C4  C8         			iny
 1554    01:C5C5  18         	!:		clc				; Calc map data pointer.
 1555    01:C5C6  7D B5 2B   			adc.l	vdc_map_addr, x
 1556    01:C5C9  85 EC      			sta.l	<_bp			; Maximum map size is 16KBytes
 1557    01:C5CB  98         			tya				; so we don't need to consider
 1558    01:C5CC  7D B6 2B   			adc.h	vdc_map_addr, x		; bank overflow.
 1559    01:C5CF  85 ED      			sta.h	<_bp
 1560                        	
 1561                        			; Draw the first part of the row.
 1562                        	
 1563    01:C5D1  A5 F9      	.draw_row:	lda	<map_bat_y		; Set the BAT VRAM destination
 1564    01:C5D3  85 F1      			sta.h	<_di			; coordinates.
 1565    01:C5D5  A5 F8      			lda	<map_bat_x
 1566    01:C5D7  85 F0      			sta.l	<_di
 1567                        	
 1568    01:C5D9  5D 73 26   			eor	vdc_bat_x_mask, x	; Calc CHR before wrap.
 1569    01:C5DC  1A         			inc	a
 1570    01:C5DD  C5 FA      			cmp	<map_draw_w		; Usually (SCR_WIDTH / 8) + 1.
 1571    01:C5DF  90 02      			bcc	!+
 1572    01:C5E1  A5 FA      			lda	<map_draw_w		; Maximum CHR to draw.
 1573    01:C5E3  85 00      	!:		sta	<map_count		; Set number of CHR to draw.
 1574    01:C5E5  85 01      			sta	<map_drawn		; Preserve number of CHR drawn.
 1575                        	
 1576    01:C5E7  20 57 C6   			jsr	blk_row_strip		; Draw lhs of horizontal strip.
 1577                        	
 1578                        			; Wrap around and draw the rest of the row (if needed).
 1579                        	
 1580    01:C5EA  38         			sec				; Are there any more CHR that
 1581    01:C5EB  A5 FA      			lda	<map_draw_w		; need to be drawn?
 1582    01:C5ED  E5 01      			sbc	<map_drawn
 1583    01:C5EF  F0 2E      			beq	.done_row
 1584                        	
 1585    01:C5F1  85 00      			sta	<map_count		; Set number of CHR to draw.
 1586                        	
 1587    01:C5F3  A5 FC      			lda	<map_chr_x		; Update CHR X coordinate for
 1588    01:C5F5  48         			pha				; drawing unaligned tiles.
 1589    01:C5F6  18         			clc
 1590    01:C5F7  65 01      			adc	<map_drawn
 1591    01:C5F9  85 FC      			sta	<map_chr_x
 1592                        	
 1593               0001     		.if	BLKMAP_MULTISCR
 1594    01:C5FB  BD BA 2B   			lda	vdc_scr_bank, x		; Skip this if regular blkmap.
 1595    01:C5FE  F0 11      			beq	!+
 1596                        	
 1597    01:C600  E6 FD      			inc	<map_scrn_x		; Wrapped to the next screen.
 1598                        	
 1599    01:C602  20 82 C3   			jsr	map_set_screen		; Locate screen's BLK and MAP.
 1600                        	
 1601    01:C605  18         			clc				; Calc map data pointer.
 1602    01:C606  A5 EE      			lda.l	<map_line
 1603    01:C608  85 EC      			sta.l	<_bp
 1604    01:C60A  A5 EF      			lda.h	<map_line
 1605    01:C60C  7D B6 2B   			adc.h	vdc_map_addr, x		; N.B. 256-byte aligned!
 1606    01:C60F  85 ED      			sta.h	<_bp
 1607                        		.endif
 1608                        	
 1609    01:C611  A5 F9      	!:		lda	<map_bat_y		; Set the BAT VRAM destination
 1610    01:C613  85 F1      			sta.h	<_di			; coordinates.
 1611    01:C615  64 F0      			stz.l	<_di			; Reset 1st column to draw.
 1612                        	
 1613    01:C617  20 57 C6   			jsr	blk_row_strip		; Draw rhs of horizontal strip.
 1614                        	
 1615               0001     		.if	BLKMAP_MULTISCR
 1616    01:C61A  C6 FD      			dec	<map_scrn_x		; Restore, no check if should.
 1617                        		.endif	BLKMAP_MULTISCR
 1618                        	
 1619    01:C61C  68         			pla				; Restore CHR X coordinate, we
 1620    01:C61D  85 FC      			sta	<map_chr_x		; might draw another row!
 1621                        	
 1622    01:C61F  C6 FB      	.done_row:	dec	<map_draw_h		; Are all desired rows drawn?
 1623    01:C621  F0 33      			beq	.finished
 1624                        	
 1625    01:C623  E6 FE      			inc	<map_chr_y		; Move CHR Y down by 1.
 1626                        	
 1627    01:C625  A5 FE      			lda	<map_chr_y		; If new BLK then ...
 1628    01:C627  4A         			lsr	a
 1629    01:C628  B0 0B      			bcs	!+
 1630    01:C62A  BD 78 26   			lda	vdc_map_line_w, x	; Move the map line pointer to
 1631    01:C62D  65 EE      			adc.l	<map_line		; the next line.
 1632    01:C62F  85 EE      			sta.l	<map_line
 1633    01:C631  90 02      			bcc	!+
 1634    01:C633  E6 EF      			inc.h	<map_line
 1635                        	
 1636    01:C635  A5 F9      	!:		lda	<map_bat_y		; Move BAT Y down by 1.
 1637    01:C637  1A         			inc	a
 1638    01:C638  3D 74 26   			and	vdc_bat_y_mask, x
 1639    01:C63B  85 F9      			sta	<map_bat_y
 1640                        	
 1641               0001     		.if	BLKMAP_MULTISCR
 1642    01:C63D  BC BA 2B   			ldy	vdc_scr_bank, x		; Skip this if regular blkmap.
 1643    01:C640  D0 03 4C BA			beq	.regular_row
         01:C644  C5          
 1644                        	
 1645    01:C645  A8         			tay				; If wrapped to the top line of
 1646    01:C646  D0 0B      			bne	!+			; of the BAT then increment the
 1647    01:C648  E6 FF      			inc	<map_scrn_y		; screen.
 1648                        	
 1649    01:C64A  BD 75 26   			lda	vdc_bat_limit, x	; The map line must wrap around
 1650    01:C64D  4A         			lsr	a			; too. This is simple since its
 1651    01:C64E  4A         			lsr	a			; size (in bytes) is 1/4 of the
 1652    01:C64F  25 EF      			and.h	<map_line		; BAT size (in words) and it is
 1653    01:C651  85 EF      			sta.h	<map_line		; a power-of-2.
 1654                        	
 1655    01:C653  4C 5D C5   	!:		jmp	.multiscr_row		; Draw next row.
 1656                        		.else
 1658                        		.endif	BLKMAP_MULTISCR
 1659                        	
 1660    01:C656  60         	.finished:	rts
 1661                        	
 1662                        	
 1663                        	
 1664               0000     		.if	BLKDEF_POINTERS
 1858                        		.else	BLKDEF_POINTERS
 1859                        	
 1860                        	
 1861                        	
 1862                        	; ***************************************************************************
 1863                        	; ***************************************************************************
 1864                        	;
 1865                        	; blk_row_strip - Draw a single row of CHR into the BAT.
 1866                        	;
 1867                        	
 1868    01:C657  20 34 E4   	blk_row_strip:	jsr	set_di_xy_mawr		; Set the BAT VRAM destination.
 1869                        	
 1870    01:C65A  A5 FC      			lda	<map_chr_x		; Select what drawing code to
 1871    01:C65C  4A         			lsr	a			; use depending upon even/odd
 1872    01:C65D  A5 FE      			lda	<map_chr_y		; CHR coordinates (not BAT to
 1873    01:C65F  29 01      			and	#1			; support unaligned drawing).
 1874    01:C661  2A         			rol	a
 1875    01:C662  0A         			asl	a
 1876    01:C663  1D B3 2B   			ora.h	vdc_blk_addr, x		; What is the BLK data address?
 1877    01:C666  29 1E      			and	#%00011110		; $4000, $4800, $5000 or $5800.
 1878    01:C668  A8         			tay
 1879    01:C669  B9 76 C6   			lda.h	.jump_table, y		; Push the address of the code.
 1880    01:C66C  48         			pha
 1881    01:C66D  B9 75 C6   			lda.l	.jump_table, y
 1882    01:C670  48         			pha
 1883                        	
 1884    01:C671  B2 EC      			lda	[_bp]			; Get the first BLK number.
 1885    01:C673  A8         			tay
 1886                        	
 1887    01:C674  60         			rts				; Jump to the drawing code.
 1888                        	
 1889    01:C675  97 C6      	.jump_table:	dw	b4000_top_even - 1
 1890    01:C677  AA C6      			dw	b4000_top_odd - 1
 1891    01:C679  C7 C6      			dw	b4000_btm_even - 1
 1892    01:C67B  DA C6      			dw	b4000_btm_odd - 1
 1893                        	
 1894    01:C67D  F7 C6      			dw	b4800_top_even - 1
 1895    01:C67F  0A C7      			dw	b4800_top_odd - 1
 1896    01:C681  27 C7      			dw	b4800_btm_even - 1
 1897    01:C683  3A C7      			dw	b4800_btm_odd - 1
 1898                        	
 1899    01:C685  57 C7      			dw	b5000_top_even - 1
 1900    01:C687  6A C7      			dw	b5000_top_odd - 1
 1901    01:C689  87 C7      			dw	b5000_btm_even - 1
 1902    01:C68B  9A C7      			dw	b5000_btm_odd - 1
 1903                        	
 1904    01:C68D  B7 C7      			dw	b5800_top_even - 1
 1905    01:C68F  CA C7      			dw	b5800_top_odd - 1
 1906    01:C691  E7 C7      			dw	b5800_btm_even - 1
 1907    01:C693  FA C7      			dw	b5800_btm_odd - 1
 1908                        	
 1909                        			; top horizontal (32+2 rept)
 1910                        			;
 1911                        			; 89 cycles per block * 17 -> 1513 cycles
 1912                        	
 1913    01:C695  B2 EC      	!repeat:	lda	[_bp]			; 7
 1914    01:C697  A8         			tay				; 2
 1915                        	
 1916    01:C698  B9 00 40   	b4000_top_even:	lda	BLK_4000_TL_L, y	; 5
 1917    01:C69B  9D 02 02   			sta	VDC_DL, x		; 6
 1918    01:C69E  B9 00 44   			lda	BLK_4000_TL_H, y	; 5
 1919               0001     		.if	BLKDEF_CHR_FLAG
 1920    01:C6A1  29 F3      			and	#%11110011		; 2
 1921                        		.endif
 1922    01:C6A3  1A         			inc	a			; 2
 1923    01:C6A4  9D 03 02   			sta	VDC_DH, x		; 6
 1924                        	
 1925    01:C6A7  C6 00      			dec	<map_count		; 6
 1926    01:C6A9  F0 19      			beq	!end+			; 2
 1927                        	
 1928    01:C6AB  B9 00 41   	b4000_top_odd:	lda	BLK_4000_TR_L, y	; 5
 1929    01:C6AE  9D 02 02   			sta	VDC_DL, x		; 6
 1930    01:C6B1  B9 00 45   			lda	BLK_4000_TR_H, y	; 5
 1931               0001     		.if	BLKDEF_CHR_FLAG
 1932    01:C6B4  29 F3      			and	#%11110011		; 2
 1933                        		.endif
 1934    01:C6B6  1A         			inc	a			; 2
 1935    01:C6B7  9D 03 02   			sta	VDC_DH, x		; 6
 1936                        	
 1937    01:C6BA  E6 EC      			inc.l	<_bp			; 6
 1938    01:C6BC  D0 02      			bne	!+			; 2/4
 1939    01:C6BE  E6 ED      			inc.h	<_bp			; 6
 1940                        	
 1941    01:C6C0  C6 00      	!:		dec	<map_count		; 6
 1942    01:C6C2  D0 D1      			bne	!repeat-		; 4
 1943                        	
 1944    01:C6C4  60         	!end:		rts
 1945                        	
 1946                        			; btm horizontal (32+2 rept)
 1947                        			;
 1948                        			; 89 cycles per block * 17 -> 1513 cycles
 1949                        	
 1950    01:C6C5  B2 EC      	!repeat:	lda	[_bp]			; 7
 1951    01:C6C7  A8         			tay				; 2
 1952                        	
 1953    01:C6C8  B9 00 42   	b4000_btm_even:	lda	BLK_4000_BL_L, y	; 5
 1954    01:C6CB  9D 02 02   			sta	VDC_DL, x		; 6
 1955    01:C6CE  B9 00 46   			lda	BLK_4000_BL_H, y	; 5
 1956               0001     		.if	BLKDEF_CHR_FLAG
 1957    01:C6D1  29 F3      			and	#%11110011		; 2
 1958                        		.endif
 1959    01:C6D3  1A         			inc	a			; 2
 1960    01:C6D4  9D 03 02   			sta	VDC_DH, x		; 6
 1961                        	
 1962    01:C6D7  C6 00      			dec	<map_count		; 6
 1963    01:C6D9  F0 19      			beq	!end+			; 2
 1964                        	
 1965    01:C6DB  B9 00 43   	b4000_btm_odd:	lda	BLK_4000_BR_L, y	; 5
 1966    01:C6DE  9D 02 02   			sta	VDC_DL, x		; 6
 1967    01:C6E1  B9 00 47   			lda	BLK_4000_BR_H, y	; 5
 1968               0001     		.if	BLKDEF_CHR_FLAG
 1969    01:C6E4  29 F3      			and	#%11110011		; 2
 1970                        		.endif
 1971    01:C6E6  1A         			inc	a			; 2
 1972    01:C6E7  9D 03 02   			sta	VDC_DH, x		; 6
 1973                        	
 1974    01:C6EA  E6 EC      			inc.l	<_bp			; 6
 1975    01:C6EC  D0 02      			bne	!+			; 2/4
 1976    01:C6EE  E6 ED      			inc.h	<_bp			; 6
 1977                        	
 1978    01:C6F0  C6 00      	!:		dec	<map_count		; 6
 1979    01:C6F2  D0 D1      			bne	!repeat-		; 4
 1980                        	
 1981    01:C6F4  60         	!end:		rts
 1982                        	
 1983                        			; top horizontal (32+2 rept)
 1984                        			;
 1985                        			; 89 cycles per block * 17 -> 1513 cycles
 1986                        	
 1987    01:C6F5  B2 EC      	!repeat:	lda	[_bp]			; 7
 1988    01:C6F7  A8         			tay				; 2
 1989                        	
 1990    01:C6F8  B9 00 48   	b4800_top_even:	lda	BLK_4800_TL_L, y	; 5
 1991    01:C6FB  9D 02 02   			sta	VDC_DL, x		; 6
 1992    01:C6FE  B9 00 4C   			lda	BLK_4800_TL_H, y	; 5
 1993               0001     		.if	BLKDEF_CHR_FLAG
 1994    01:C701  29 F3      			and	#%11110011		; 2
 1995                        		.endif
 1996    01:C703  1A         			inc	a			; 2
 1997    01:C704  9D 03 02   			sta	VDC_DH, x		; 6
 1998                        	
 1999    01:C707  C6 00      			dec	<map_count		; 6
 2000    01:C709  F0 19      			beq	!end+			; 2
 2001                        	
 2002    01:C70B  B9 00 49   	b4800_top_odd:	lda	BLK_4800_TR_L, y	; 5
 2003    01:C70E  9D 02 02   			sta	VDC_DL, x		; 6
 2004    01:C711  B9 00 4D   			lda	BLK_4800_TR_H, y	; 5
 2005               0001     		.if	BLKDEF_CHR_FLAG
 2006    01:C714  29 F3      			and	#%11110011		; 2
 2007                        		.endif
 2008    01:C716  1A         			inc	a			; 2
 2009    01:C717  9D 03 02   			sta	VDC_DH, x		; 6
 2010                        	
 2011    01:C71A  E6 EC      			inc.l	<_bp			; 6
 2012    01:C71C  D0 02      			bne	!+			; 2/4
 2013    01:C71E  E6 ED      			inc.h	<_bp			; 6
 2014                        	
 2015    01:C720  C6 00      	!:		dec	<map_count		; 6
 2016    01:C722  D0 D1      			bne	!repeat-		; 4
 2017                        	
 2018    01:C724  60         	!end:		rts
 2019                        	
 2020                        			; btm horizontal (32+2 rept)
 2021                        			;
 2022                        			; 89 cycles per block * 17 -> 1513 cycles
 2023                        	
 2024    01:C725  B2 EC      	!repeat:	lda	[_bp]			; 7
 2025    01:C727  A8         			tay				; 2
 2026                        	
 2027    01:C728  B9 00 4A   	b4800_btm_even:	lda	BLK_4800_BL_L, y	; 5
 2028    01:C72B  9D 02 02   			sta	VDC_DL, x		; 6
 2029    01:C72E  B9 00 4E   			lda	BLK_4800_BL_H, y	; 5
 2030               0001     		.if	BLKDEF_CHR_FLAG
 2031    01:C731  29 F3      			and	#%11110011		; 2
 2032                        		.endif
 2033    01:C733  1A         			inc	a			; 2
 2034    01:C734  9D 03 02   			sta	VDC_DH, x		; 6
 2035                        	
 2036    01:C737  C6 00      			dec	<map_count		; 6
 2037    01:C739  F0 19      			beq	!end+			; 2
 2038                        	
 2039    01:C73B  B9 00 4B   	b4800_btm_odd:	lda	BLK_4800_BR_L, y	; 5
 2040    01:C73E  9D 02 02   			sta	VDC_DL, x		; 6
 2041    01:C741  B9 00 4F   			lda	BLK_4800_BR_H, y	; 5
 2042               0001     		.if	BLKDEF_CHR_FLAG
 2043    01:C744  29 F3      			and	#%11110011		; 2
 2044                        		.endif
 2045    01:C746  1A         			inc	a			; 2
 2046    01:C747  9D 03 02   			sta	VDC_DH, x		; 6
 2047                        	
 2048    01:C74A  E6 EC      			inc.l	<_bp			; 6
 2049    01:C74C  D0 02      			bne	!+			; 2/4
 2050    01:C74E  E6 ED      			inc.h	<_bp			; 6
 2051                        	
 2052    01:C750  C6 00      	!:		dec	<map_count		; 6
 2053    01:C752  D0 D1      			bne	!repeat-		; 4
 2054                        	
 2055    01:C754  60         	!end:		rts
 2056                        	
 2057                        			; top horizontal (32+2 rept)
 2058                        			;
 2059                        			; 89 cycles per block * 17 -> 1513 cycles
 2060                        	
 2061    01:C755  B2 EC      	!repeat:	lda	[_bp]			; 7
 2062    01:C757  A8         			tay				; 2
 2063                        	
 2064    01:C758  B9 00 50   	b5000_top_even:	lda	BLK_5000_TL_L, y	; 5
 2065    01:C75B  9D 02 02   			sta	VDC_DL, x		; 6
 2066    01:C75E  B9 00 54   			lda	BLK_5000_TL_H, y	; 5
 2067               0001     		.if	BLKDEF_CHR_FLAG
 2068    01:C761  29 F3      			and	#%11110011		; 2
 2069                        		.endif
 2070    01:C763  1A         			inc	a			; 2
 2071    01:C764  9D 03 02   			sta	VDC_DH, x		; 6
 2072                        	
 2073    01:C767  C6 00      			dec	<map_count		; 6
 2074    01:C769  F0 19      			beq	!end+			; 2
 2075                        	
 2076    01:C76B  B9 00 51   	b5000_top_odd:	lda	BLK_5000_TR_L, y	; 5
 2077    01:C76E  9D 02 02   			sta	VDC_DL, x		; 6
 2078    01:C771  B9 00 55   			lda	BLK_5000_TR_H, y	; 5
 2079               0001     		.if	BLKDEF_CHR_FLAG
 2080    01:C774  29 F3      			and	#%11110011		; 2
 2081                        		.endif
 2082    01:C776  1A         			inc	a			; 2
 2083    01:C777  9D 03 02   			sta	VDC_DH, x		; 6
 2084                        	
 2085    01:C77A  E6 EC      			inc.l	<_bp			; 6
 2086    01:C77C  D0 02      			bne	!+			; 2/4
 2087    01:C77E  E6 ED      			inc.h	<_bp			; 6
 2088                        	
 2089    01:C780  C6 00      	!:		dec	<map_count		; 6
 2090    01:C782  D0 D1      			bne	!repeat-		; 4
 2091                        	
 2092    01:C784  60         	!end:		rts
 2093                        	
 2094                        			; btm horizontal (32+2 rept)
 2095                        			;
 2096                        			; 89 cycles per block * 17 -> 1513 cycles
 2097                        	
 2098    01:C785  B2 EC      	!repeat:	lda	[_bp]			; 7
 2099    01:C787  A8         			tay				; 2
 2100                        	
 2101    01:C788  B9 00 52   	b5000_btm_even:	lda	BLK_5000_BL_L, y	; 5
 2102    01:C78B  9D 02 02   			sta	VDC_DL, x		; 6
 2103    01:C78E  B9 00 56   			lda	BLK_5000_BL_H, y	; 5
 2104               0001     		.if	BLKDEF_CHR_FLAG
 2105    01:C791  29 F3      			and	#%11110011		; 2
 2106                        		.endif
 2107    01:C793  1A         			inc	a			; 2
 2108    01:C794  9D 03 02   			sta	VDC_DH, x		; 6
 2109                        	
 2110    01:C797  C6 00      			dec	<map_count		; 6
 2111    01:C799  F0 19      			beq	!end+			; 2
 2112                        	
 2113    01:C79B  B9 00 53   	b5000_btm_odd:	lda	BLK_5000_BR_L, y	; 5
 2114    01:C79E  9D 02 02   			sta	VDC_DL, x		; 6
 2115    01:C7A1  B9 00 57   			lda	BLK_5000_BR_H, y	; 5
 2116               0001     		.if	BLKDEF_CHR_FLAG
 2117    01:C7A4  29 F3      			and	#%11110011		; 2
 2118                        		.endif
 2119    01:C7A6  1A         			inc	a			; 2
 2120    01:C7A7  9D 03 02   			sta	VDC_DH, x		; 6
 2121                        	
 2122    01:C7AA  E6 EC      			inc.l	<_bp			; 6
 2123    01:C7AC  D0 02      			bne	!+			; 2/4
 2124    01:C7AE  E6 ED      			inc.h	<_bp			; 6
 2125                        	
 2126    01:C7B0  C6 00      	!:		dec	<map_count		; 6
 2127    01:C7B2  D0 D1      			bne	!repeat-		; 4
 2128                        	
 2129    01:C7B4  60         	!end:		rts
 2130                        	
 2131                        			; top horizontal (32+2 rept)
 2132                        			;
 2133                        			; 89 cycles per block * 17 -> 1513 cycles
 2134                        	
 2135    01:C7B5  B2 EC      	!repeat:	lda	[_bp]			; 7
 2136    01:C7B7  A8         			tay				; 2
 2137                        	
 2138    01:C7B8  B9 00 58   	b5800_top_even:	lda	BLK_5800_TL_L, y	; 5
 2139    01:C7BB  9D 02 02   			sta	VDC_DL, x		; 6
 2140    01:C7BE  B9 00 5C   			lda	BLK_5800_TL_H, y	; 5
 2141               0001     		.if	BLKDEF_CHR_FLAG
 2142    01:C7C1  29 F3      			and	#%11110011		; 2
 2143                        		.endif
 2144    01:C7C3  1A         			inc	a			; 2
 2145    01:C7C4  9D 03 02   			sta	VDC_DH, x		; 6
 2146                        	
 2147    01:C7C7  C6 00      			dec	<map_count		; 6
 2148    01:C7C9  F0 19      			beq	!end+			; 2
 2149                        	
 2150    01:C7CB  B9 00 59   	b5800_top_odd:	lda	BLK_5800_TR_L, y	; 5
 2151    01:C7CE  9D 02 02   			sta	VDC_DL, x		; 6
 2152    01:C7D1  B9 00 5D   			lda	BLK_5800_TR_H, y	; 5
 2153               0001     		.if	BLKDEF_CHR_FLAG
 2154    01:C7D4  29 F3      			and	#%11110011		; 2
 2155                        		.endif
 2156    01:C7D6  1A         			inc	a			; 2
 2157    01:C7D7  9D 03 02   			sta	VDC_DH, x		; 6
 2158                        	
 2159    01:C7DA  E6 EC      			inc.l	<_bp			; 6
 2160    01:C7DC  D0 02      			bne	!+			; 2/4
 2161    01:C7DE  E6 ED      			inc.h	<_bp			; 6
 2162                        	
 2163    01:C7E0  C6 00      	!:		dec	<map_count		; 6
 2164    01:C7E2  D0 D1      			bne	!repeat-		; 4
 2165                        	
 2166    01:C7E4  60         	!end:		rts
 2167                        	
 2168                        			; btm horizontal (32+2 rept)
 2169                        			;
 2170                        			; 89 cycles per block * 17 -> 1513 cycles
 2171                        	
 2172    01:C7E5  B2 EC      	!repeat:	lda	[_bp]		; 7
 2173    01:C7E7  A8         			tay				; 2
 2174                        	
 2175    01:C7E8  B9 00 5A   	b5800_btm_even:	lda	BLK_5800_BL_L, y	; 5
 2176    01:C7EB  9D 02 02   			sta	VDC_DL, x		; 6
 2177    01:C7EE  B9 00 5E   			lda	BLK_5800_BL_H, y	; 5
 2178               0001     		.if	BLKDEF_CHR_FLAG
 2179    01:C7F1  29 F3      			and	#%11110011		; 2
 2180                        		.endif
 2181    01:C7F3  1A         			inc	a			; 2
 2182    01:C7F4  9D 03 02   			sta	VDC_DH, x		; 6
 2183                        	
 2184    01:C7F7  C6 00      			dec	<map_count		; 6
 2185    01:C7F9  F0 19      			beq	!end+			; 2
 2186                        	
 2187    01:C7FB  B9 00 5B   	b5800_btm_odd:	lda	BLK_5800_BR_L, y	; 5
 2188    01:C7FE  9D 02 02   			sta	VDC_DL, x		; 6
 2189    01:C801  B9 00 5F   			lda	BLK_5800_BR_H, y	; 5
 2190               0001     		.if	BLKDEF_CHR_FLAG
 2191    01:C804  29 F3      			and	#%11110011		; 2
 2192                        		.endif
 2193    01:C806  1A         			inc	a			; 2
 2194    01:C807  9D 03 02   			sta	VDC_DH, x		; 6
 2195                        	
 2196    01:C80A  E6 EC      			inc.l	<_bp			; 6
 2197    01:C80C  D0 02      			bne	!+			; 2/4
 2198    01:C80E  E6 ED      			inc.h	<_bp			; 6
 2199                        	
 2200    01:C810  C6 00      	!:		dec	<map_count		; 6
 2201    01:C812  D0 D1      			bne	!repeat-		; 4
 2202                        	
 2203    01:C814  60         	!end:		rts
 2204                        	
 2205                        	
 2206                        	
 2207                        	; ***************************************************************************
 2208                        	; ***************************************************************************
 2209                        	;
 2210                        	; blk_col_strip - Draw a single column of CHR into the BAT.
 2211                        	;
 2212                        	
 2213    01:C815  20 34 E4   	blk_col_strip:	jsr	set_di_xy_mawr		; Set the BAT VRAM destination.
 2214                        	
 2215    01:C818  A5 FC      			lda	<map_chr_x		; Select what drawing code to
 2216    01:C81A  4A         			lsr	a			; use depending upon even/odd
 2217    01:C81B  A5 FE      			lda	<map_chr_y		; CHR coordinates (not BAT to
 2218    01:C81D  29 01      			and	#1			; support unaligned drawing).
 2219    01:C81F  2A         			rol	a
 2220    01:C820  0A         			asl	a			; N.B. Always leaves C clear.
 2221    01:C821  1D B3 2B   			ora.h	vdc_blk_addr, x		; What is the BLK data address?
 2222    01:C824  29 1E      			and	#%00011110		; $4000, $4800, $5000 or $5800.
 2223    01:C826  A8         			tay
 2224    01:C827  B9 34 C8   			lda.h	.jump_table, y		; Push the address of the code.
 2225    01:C82A  48         			pha
 2226    01:C82B  B9 33 C8   			lda.l	.jump_table, y
 2227    01:C82E  48         			pha
 2228                        	
 2229    01:C82F  B2 EC      			lda	[_bp]			; Get the first BLK number.
 2230    01:C831  A8         			tay
 2231                        	
 2232    01:C832  60         			rts				; Jump to the drawing code.
 2233                        	
 2234    01:C833  55 C8      	.jump_table:	dw	b4000_lhs_even - 1
 2235    01:C835  8B C8      			dw	b4000_rhs_even - 1
 2236    01:C837  68 C8      			dw	b4000_lhs_odd - 1
 2237    01:C839  9E C8      			dw	b4000_rhs_odd - 1
 2238                        	
 2239    01:C83B  C1 C8      			dw	b4800_lhs_even - 1
 2240    01:C83D  F7 C8      			dw	b4800_rhs_even - 1
 2241    01:C83F  D4 C8      			dw	b4800_lhs_odd - 1
 2242    01:C841  0A C9      			dw	b4800_rhs_odd - 1
 2243                        	
 2244    01:C843  2D C9      			dw	b5000_lhs_even - 1
 2245    01:C845  63 C9      			dw	b5000_rhs_even - 1
 2246    01:C847  40 C9      			dw	b5000_lhs_odd - 1
 2247    01:C849  76 C9      			dw	b5000_rhs_odd - 1
 2248                        	
 2249    01:C84B  99 C9      			dw	b5800_lhs_even - 1
 2250    01:C84D  CF C9      			dw	b5800_rhs_even - 1
 2251    01:C84F  AC C9      			dw	b5800_lhs_odd - 1
 2252    01:C851  E2 C9      			dw	b5800_rhs_odd - 1
 2253                        	
 2254                        			; lhs vertical (28+2 rept)
 2255                        			;
 2256                        			; N.B. C is always clear on entry.
 2257                        			;
 2258                        			; 100 cycles per block * 15 -> 1500 cycles
 2259                        	
 2260    01:C853  B2 EC      	!repeat:	lda	[_bp]			; 7
 2261    01:C855  A8         			tay				; 2
 2262                        	
 2263    01:C856  B9 00 40   	b4000_lhs_even:	lda	BLK_4000_TL_L, y	; 5
 2264    01:C859  9D 02 02   			sta	VDC_DL, x		; 6
 2265    01:C85C  B9 00 44   			lda	BLK_4000_TL_H, y	; 5
 2266               0001     		.if	BLKDEF_CHR_FLAG
 2267    01:C85F  29 F3      			and	#%11110011		; 2
 2268                        		.endif
 2269    01:C861  1A         			inc	a			; 2
 2270    01:C862  9D 03 02   			sta	VDC_DH, x		; 6
 2271                        	
 2272    01:C865  C6 00      			dec	<map_count		; 6
 2273    01:C867  F0 1F      			beq	!end+			; 2
 2274                        	
 2275    01:C869  B9 00 42   	b4000_lhs_odd:	lda	BLK_4000_BL_L, y	; 5
 2276    01:C86C  9D 02 02   			sta	VDC_DL, x		; 6
 2277    01:C86F  B9 00 46   			lda	BLK_4000_BL_H, y	; 5
 2278               0001     		.if	BLKDEF_CHR_FLAG
 2279    01:C872  29 F3      			and	#%11110011		; 2
 2280                        		.endif
 2281    01:C874  1A         			inc	a			; 2
 2282    01:C875  9D 03 02   			sta	VDC_DH, x		; 6
 2283                        	
 2284    01:C878  BD 78 26   			lda	vdc_map_line_w, x	; 5
 2285    01:C87B  65 EC      			adc.l	<_bp			; 4
 2286    01:C87D  85 EC      			sta.l	<_bp			; 4
 2287    01:C87F  90 03      			bcc	!+			; 2/4
 2288    01:C881  E6 ED      			inc.h	<_bp			; 6
 2289    01:C883  18         			clc				; 2
 2290                        	
 2291    01:C884  C6 00      	!:		dec	<map_count		; 6
 2292    01:C886  D0 CB      			bne	!repeat-		; 4
 2293                        	
 2294    01:C888  60         	!end:		rts
 2295                        	
 2296                        			; rhs vertical (28+2 rept)
 2297                        			;
 2298                        			; N.B. C is always clear on entry.
 2299                        			;
 2300                        			; 100 cycles per block * 15 -> 1500 cycles
 2301                        	
 2302    01:C889  B2 EC      	!repeat:	lda	[_bp]			; 7
 2303    01:C88B  A8         			tay				; 2
 2304                        	
 2305    01:C88C  B9 00 41   	b4000_rhs_even:	lda	BLK_4000_TR_L, y	; 5
 2306    01:C88F  9D 02 02   			sta	VDC_DL, x		; 6
 2307    01:C892  B9 00 45   			lda	BLK_4000_TR_H, y	; 5
 2308               0001     		.if	BLKDEF_CHR_FLAG
 2309    01:C895  29 F3      			and	#%11110011		; 2
 2310                        		.endif
 2311    01:C897  1A         			inc	a			; 2
 2312    01:C898  9D 03 02   			sta	VDC_DH, x		; 6
 2313                        	
 2314    01:C89B  C6 00      			dec	<map_count		; 6
 2315    01:C89D  F0 1F      			beq	!end+			; 2
 2316                        	
 2317    01:C89F  B9 00 43   	b4000_rhs_odd:	lda	BLK_4000_BR_L, y	; 5
 2318    01:C8A2  9D 02 02   			sta	VDC_DL, x		; 6
 2319    01:C8A5  B9 00 47   			lda	BLK_4000_BR_H, y	; 5
 2320               0001     		.if	BLKDEF_CHR_FLAG
 2321    01:C8A8  29 F3      			and	#%11110011		; 2
 2322                        		.endif
 2323    01:C8AA  1A         			inc	a			; 2
 2324    01:C8AB  9D 03 02   			sta	VDC_DH, x		; 6
 2325                        	
 2326    01:C8AE  BD 78 26   			lda	vdc_map_line_w, x	; 5
 2327    01:C8B1  65 EC      			adc.l	<_bp			; 4
 2328    01:C8B3  85 EC      			sta.l	<_bp			; 4
 2329    01:C8B5  90 03      			bcc	!+			; 2/4
 2330    01:C8B7  E6 ED      			inc.h	<_bp			; 6
 2331    01:C8B9  18         			clc				; 2
 2332                        	
 2333    01:C8BA  C6 00      	!:		dec	<map_count		; 6
 2334    01:C8BC  D0 CB      			bne	!repeat-		; 4
 2335                        	
 2336    01:C8BE  60         	!end:		rts
 2337                        	
 2338                        			; lhs vertical (28+2 rept)
 2339                        			;
 2340                        			; N.B. C is always clear on entry.
 2341                        			;
 2342                        			; 100 cycles per block * 15 -> 1500 cycles
 2343                        	
 2344    01:C8BF  B2 EC      	!repeat:	lda	[_bp]			; 7
 2345    01:C8C1  A8         			tay				; 2
 2346                        	
 2347    01:C8C2  B9 00 48   	b4800_lhs_even:	lda	BLK_4800_TL_L, y	; 5
 2348    01:C8C5  9D 02 02   			sta	VDC_DL, x		; 6
 2349    01:C8C8  B9 00 4C   			lda	BLK_4800_TL_H, y	; 5
 2350               0001     		.if	BLKDEF_CHR_FLAG
 2351    01:C8CB  29 F3      			and	#%11110011		; 2
 2352                        		.endif
 2353    01:C8CD  1A         			inc	a			; 2
 2354    01:C8CE  9D 03 02   			sta	VDC_DH, x		; 6
 2355                        	
 2356    01:C8D1  C6 00      			dec	<map_count		; 6
 2357    01:C8D3  F0 1F      			beq	!end+			; 2
 2358                        	
 2359    01:C8D5  B9 00 4A   	b4800_lhs_odd:	lda	BLK_4800_BL_L, y	; 5
 2360    01:C8D8  9D 02 02   			sta	VDC_DL, x		; 6
 2361    01:C8DB  B9 00 4E   			lda	BLK_4800_BL_H, y	; 5
 2362               0001     		.if	BLKDEF_CHR_FLAG
 2363    01:C8DE  29 F3      			and	#%11110011		; 2
 2364                        		.endif
 2365    01:C8E0  1A         			inc	a			; 2
 2366    01:C8E1  9D 03 02   			sta	VDC_DH, x		; 6
 2367                        	
 2368    01:C8E4  BD 78 26   			lda	vdc_map_line_w, x	; 5
 2369    01:C8E7  65 EC      			adc.l	<_bp			; 4
 2370    01:C8E9  85 EC      			sta.l	<_bp			; 4
 2371    01:C8EB  90 03      			bcc	!+			; 2/4
 2372    01:C8ED  E6 ED      			inc.h	<_bp			; 6
 2373    01:C8EF  18         			clc				; 2
 2374                        	
 2375    01:C8F0  C6 00      	!:		dec	<map_count		; 6
 2376    01:C8F2  D0 CB      			bne	!repeat-		; 4
 2377                        	
 2378    01:C8F4  60         	!end:		rts
 2379                        	
 2380                        			; rhs vertical (28+2 rept)
 2381                        			;
 2382                        			; N.B. C is always clear on entry.
 2383                        			;
 2384                        			; 100 cycles per block * 15 -> 1500 cycles
 2385                        	
 2386    01:C8F5  B2 EC      	!repeat:	lda	[_bp]			; 7
 2387    01:C8F7  A8         			tay				; 2
 2388                        	
 2389    01:C8F8  B9 00 49   	b4800_rhs_even:	lda	BLK_4800_TR_L, y	; 5
 2390    01:C8FB  9D 02 02   			sta	VDC_DL, x		; 6
 2391    01:C8FE  B9 00 4D   			lda	BLK_4800_TR_H, y	; 5
 2392               0001     		.if	BLKDEF_CHR_FLAG
 2393    01:C901  29 F3      			and	#%11110011		; 2
 2394                        		.endif
 2395    01:C903  1A         			inc	a			; 2
 2396    01:C904  9D 03 02   			sta	VDC_DH, x		; 6
 2397                        	
 2398    01:C907  C6 00      			dec	<map_count		; 6
 2399    01:C909  F0 1F      			beq	!end+			; 2
 2400                        	
 2401    01:C90B  B9 00 4B   	b4800_rhs_odd:	lda	BLK_4800_BR_L, y	; 5
 2402    01:C90E  9D 02 02   			sta	VDC_DL, x		; 6
 2403    01:C911  B9 00 4F   			lda	BLK_4800_BR_H, y	; 5
 2404               0001     		.if	BLKDEF_CHR_FLAG
 2405    01:C914  29 F3      			and	#%11110011		; 2
 2406                        		.endif
 2407    01:C916  1A         			inc	a			; 2
 2408    01:C917  9D 03 02   			sta	VDC_DH, x		; 6
 2409                        	
 2410    01:C91A  BD 78 26   			lda	vdc_map_line_w, x	; 5
 2411    01:C91D  65 EC      			adc.l	<_bp			; 4
 2412    01:C91F  85 EC      			sta.l	<_bp			; 4
 2413    01:C921  90 03      			bcc	!+			; 2/4
 2414    01:C923  E6 ED      			inc.h	<_bp			; 6
 2415    01:C925  18         			clc				; 2
 2416                        	
 2417    01:C926  C6 00      	!:		dec	<map_count		; 6
 2418    01:C928  D0 CB      			bne	!repeat-		; 4
 2419                        	
 2420    01:C92A  60         	!end:		rts
 2421                        	
 2422                        			; lhs vertical (28+2 rept)
 2423                        			;
 2424                        			; N.B. C is always clear on entry.
 2425                        			;
 2426                        			; 100 cycles per block * 15 -> 1500 cycles
 2427                        	
 2428    01:C92B  B2 EC      	!repeat:	lda	[_bp]			; 7
 2429    01:C92D  A8         			tay				; 2
 2430                        	
 2431    01:C92E  B9 00 50   	b5000_lhs_even:	lda	BLK_5000_TL_L, y	; 5
 2432    01:C931  9D 02 02   			sta	VDC_DL, x		; 6
 2433    01:C934  B9 00 54   			lda	BLK_5000_TL_H, y	; 5
 2434               0001     		.if	BLKDEF_CHR_FLAG
 2435    01:C937  29 F3      			and	#%11110011		; 2
 2436                        		.endif
 2437    01:C939  1A         			inc	a			; 2
 2438    01:C93A  9D 03 02   			sta	VDC_DH, x		; 6
 2439                        	
 2440    01:C93D  C6 00      			dec	<map_count		; 6
 2441    01:C93F  F0 1F      			beq	!end+			; 2
 2442                        	
 2443    01:C941  B9 00 52   	b5000_lhs_odd:	lda	BLK_5000_BL_L, y	; 5
 2444    01:C944  9D 02 02   			sta	VDC_DL, x		; 6
 2445    01:C947  B9 00 56   			lda	BLK_5000_BL_H, y	; 5
 2446               0001     		.if	BLKDEF_CHR_FLAG
 2447    01:C94A  29 F3      			and	#%11110011		; 2
 2448                        		.endif
 2449    01:C94C  1A         			inc	a			; 2
 2450    01:C94D  9D 03 02   			sta	VDC_DH, x		; 6
 2451                        	
 2452    01:C950  BD 78 26   			lda	vdc_map_line_w, x	; 5
 2453    01:C953  65 EC      			adc.l	<_bp			; 4
 2454    01:C955  85 EC      			sta.l	<_bp			; 4
 2455    01:C957  90 03      			bcc	!+			; 2/4
 2456    01:C959  E6 ED      			inc.h	<_bp			; 6
 2457    01:C95B  18         			clc				; 2
 2458                        	
 2459    01:C95C  C6 00      	!:		dec	<map_count		; 6
 2460    01:C95E  D0 CB      			bne	!repeat-		; 4
 2461                        	
 2462    01:C960  60         	!end:		rts
 2463                        	
 2464                        			; rhs vertical (28+2 rept)
 2465                        			;
 2466                        			; N.B. C is always clear on entry.
 2467                        			;
 2468                        			; 100 cycles per block * 15 -> 1500 cycles
 2469                        	
 2470    01:C961  B2 EC      	!repeat:	lda	[_bp]			; 7
 2471    01:C963  A8         			tay				; 2
 2472                        	
 2473    01:C964  B9 00 51   	b5000_rhs_even:	lda	BLK_5000_TR_L, y	; 5
 2474    01:C967  9D 02 02   			sta	VDC_DL, x		; 6
 2475    01:C96A  B9 00 55   			lda	BLK_5000_TR_H, y	; 5
 2476               0001     		.if	BLKDEF_CHR_FLAG
 2477    01:C96D  29 F3      			and	#%11110011		; 2
 2478                        		.endif
 2479    01:C96F  1A         			inc	a			; 2
 2480    01:C970  9D 03 02   			sta	VDC_DH, x		; 6
 2481                        	
 2482    01:C973  C6 00      			dec	<map_count		; 6
 2483    01:C975  F0 1F      			beq	!end+			; 2
 2484                        	
 2485    01:C977  B9 00 53   	b5000_rhs_odd:	lda	BLK_5000_BR_L, y	; 5
 2486    01:C97A  9D 02 02   			sta	VDC_DL, x		; 6
 2487    01:C97D  B9 00 57   			lda	BLK_5000_BR_H, y	; 5
 2488               0001     		.if	BLKDEF_CHR_FLAG
 2489    01:C980  29 F3      			and	#%11110011		; 2
 2490                        		.endif
 2491    01:C982  1A         			inc	a			; 2
 2492    01:C983  9D 03 02   			sta	VDC_DH, x		; 6
 2493                        	
 2494    01:C986  BD 78 26   			lda	vdc_map_line_w, x	; 5
 2495    01:C989  65 EC      			adc.l	<_bp			; 4
 2496    01:C98B  85 EC      			sta.l	<_bp			; 4
 2497    01:C98D  90 03      			bcc	!+			; 2/4
 2498    01:C98F  E6 ED      			inc.h	<_bp			; 6
 2499    01:C991  18         			clc				; 2
 2500                        	
 2501    01:C992  C6 00      	!:		dec	<map_count		; 6
 2502    01:C994  D0 CB      			bne	!repeat-		; 4
 2503                        	
 2504    01:C996  60         	!end:		rts
 2505                        	
 2506                        			; lhs vertical (28+2 rept)
 2507                        			;
 2508                        			; N.B. C is always clear on entry.
 2509                        			;
 2510                        			; 100 cycles per block * 15 -> 1500 cycles
 2511                        	
 2512    01:C997  B2 EC      	!repeat:	lda	[_bp]			; 7
 2513    01:C999  A8         			tay				; 2
 2514                        	
 2515    01:C99A  B9 00 58   	b5800_lhs_even:	lda	BLK_5800_TL_L, y	; 5
 2516    01:C99D  9D 02 02   			sta	VDC_DL, x		; 6
 2517    01:C9A0  B9 00 5C   			lda	BLK_5800_TL_H, y	; 5
 2518               0001     		.if	BLKDEF_CHR_FLAG
 2519    01:C9A3  29 F3      			and	#%11110011		; 2
 2520                        		.endif
 2521    01:C9A5  1A         			inc	a			; 2
 2522    01:C9A6  9D 03 02   			sta	VDC_DH, x		; 6
 2523                        	
 2524    01:C9A9  C6 00      			dec	<map_count		; 6
 2525    01:C9AB  F0 1F      			beq	!end+			; 2
 2526                        	
 2527    01:C9AD  B9 00 5A   	b5800_lhs_odd:	lda	BLK_5800_BL_L, y	; 5
 2528    01:C9B0  9D 02 02   			sta	VDC_DL, x		; 6
 2529    01:C9B3  B9 00 5E   			lda	BLK_5800_BL_H, y	; 5
 2530               0001     		.if	BLKDEF_CHR_FLAG
 2531    01:C9B6  29 F3      			and	#%11110011		; 2
 2532                        		.endif
 2533    01:C9B8  1A         			inc	a			; 2
 2534    01:C9B9  9D 03 02   			sta	VDC_DH, x		; 6
 2535                        	
 2536    01:C9BC  BD 78 26   			lda	vdc_map_line_w, x	; 5
 2537    01:C9BF  65 EC      			adc.l	<_bp			; 4
 2538    01:C9C1  85 EC      			sta.l	<_bp			; 4
 2539    01:C9C3  90 03      			bcc	!+			; 2/4
 2540    01:C9C5  E6 ED      			inc.h	<_bp			; 6
 2541    01:C9C7  18         			clc				; 2
 2542                        	
 2543    01:C9C8  C6 00      	!:		dec	<map_count		; 6
 2544    01:C9CA  D0 CB      			bne	!repeat-		; 4
 2545                        	
 2546    01:C9CC  60         	!end:		rts
 2547                        	
 2548                        			; rhs vertical (28+2 rept)
 2549                        			;
 2550                        			; N.B. C is always clear on entry.
 2551                        			;
 2552                        			; 100 cycles per block * 15 -> 1500 cycles
 2553                        	
 2554    01:C9CD  B2 EC      	!repeat:	lda	[_bp]			; 7
 2555    01:C9CF  A8         			tay				; 2
 2556                        	
 2557    01:C9D0  B9 00 59   	b5800_rhs_even:	lda	BLK_5800_TR_L, y	; 5
 2558    01:C9D3  9D 02 02   			sta	VDC_DL, x		; 6
 2559    01:C9D6  B9 00 5D   			lda	BLK_5800_TR_H, y	; 5
 2560               0001     		.if	BLKDEF_CHR_FLAG
 2561    01:C9D9  29 F3      			and	#%11110011		; 2
 2562                        		.endif
 2563    01:C9DB  1A         			inc	a			; 2
 2564    01:C9DC  9D 03 02   			sta	VDC_DH, x		; 6
 2565                        	
 2566    01:C9DF  C6 00      			dec	<map_count		; 6
 2567    01:C9E1  F0 1F      			beq	!end+			; 2
 2568                        	
 2569    01:C9E3  B9 00 5B   	b5800_rhs_odd:	lda	BLK_5800_BR_L, y	; 5
 2570    01:C9E6  9D 02 02   			sta	VDC_DL, x		; 6
 2571    01:C9E9  B9 00 5F   			lda	BLK_5800_BR_H, y	; 5
 2572               0001     		.if	BLKDEF_CHR_FLAG
 2573    01:C9EC  29 F3      			and	#%11110011		; 2
 2574                        		.endif
 2575    01:C9EE  1A         			inc	a			; 2
 2576    01:C9EF  9D 03 02   			sta	VDC_DH, x		; 6
 2577                        	
 2578    01:C9F2  BD 78 26   			lda	vdc_map_line_w, x	; 5
 2579    01:C9F5  65 EC      			adc.l	<_bp			; 4
 2580    01:C9F7  85 EC      			sta.l	<_bp			; 4
 2581    01:C9F9  90 03      			bcc	!+			; 2/4
 2582    01:C9FB  E6 ED      			inc.h	<_bp			; 6
 2583    01:C9FD  18         			clc				; 2
 2584                        	
 2585    01:C9FE  C6 00      	!:		dec	<map_count		; 6
 2586    01:CA00  D0 CB      			bne	!repeat-		; 4
 2587                        	
 2588    01:CA02  60         	!end:		rts
 2589                        	
 2590                        		.endif	BLKDEF_POINTERS
 2591                        	
 2592                        		.endprocgroup	; blkmap_group
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
   80                        		.else
   84                        		.endif	HUCC_USES_BLKMAP
   85                        	
   86               0001     		.ifdef	HUCC_USES_CHRMAP		; Set in hucc_chrmap.h
                             #[3]   "..\..\..\include\hucc\chrmap.asm"
   87                        			include	"chrmap.asm"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; chrmap.asm
    5                        	;
    6                        	; A simple map system based on 8x8 characters (aka "tiles") in BAT format.
    7                        	;
    8                        	; Copyright John Brandwood 2025.
    9                        	;
   10                        	; Distributed under the Boost Software License, Version 1.0.
   11                        	; (See accompanying file LICENSE_1_0.txt or copy at
   12                        	;  http://www.boost.org/LICENSE_1_0.txt)
   13                        	;
   14                        	; ***************************************************************************
   15                        	; ***************************************************************************
   16                        	;
   17                        	; The maximum X and Y size for chrmaps is 256 characters (2048 pixels).
   18                        	;
   19                        	; The maximum total size for a chrmap is 16KBytes, which allows for maps up
   20                        	; to 256x32 tiles (2048x256 pixels).
   21                        	;
   22                        	; ***************************************************************************
   23                        	; ***************************************************************************
   24                        	
   25                        	;
   26                        	; Include dependancies ...
   27                        	;
   28                        	
   29                        			include "blkmap.asm"		; This defines the variables.
   30                        	
   31                        	;
   32                        	; Chrmaps in BAT format normally address all of VRAM from $0400..$7FFF, but
   33                        	; they can be limited to use the 32KByte of characters in VRAM $1000..$4FFF
   34                        	; which then frees up 2-bits for flag information for each character in the
   35                        	; BAT entry.
   36                        	;
   37                        	; These 2-bits are perfect for using as collision information in game maps,
   38                        	; allowing storage of states like transparent, solid, up-slope, down-slope.
   39                        	;
   40                        	; Typically this flag information is set by the map conversion tools from a
   41                        	; seperate "collision" map layer.
   42                        	;
   43                        	
   44               0000     		.ifndef	CHRMAP_BAT_FLAG
   46                        		.endif
   47                        	
   48                        	;
   49                        	;
   50                        	;
   51                        	
   52                        	
   53                        	
   54    02:C574             	chrmap_group	.procgroup
   55                        	
   56                        	; ***************************************************************************
   57                        	; ***************************************************************************
   58                        	;
   59                        	; _draw_bat - Draw the entire screen at the current coordinates.
   60                        	; _sgx_draw_bat - Draw the entire screen at the current coordinates.
   61                        	;
   62                        	; void __fastcall draw_bat( void );
   63                        	; void __fastcall sgx_draw_bat( void );
   64                        	;
   65                        	
   66               0001     		.if	SUPPORT_SGX
   67                        	
   68                        	_sgx_draw_bat	.proc
   74                        			.endp
   75                        		.endif
   76                        	
   77    02:C574             	_draw_bat	.proc
   78                        	
   79    02:C574  82         			clx				; Offset to PCE VDC.
   80                        	
   81    02:C575  43 08      			tma3				; Preserve MPR3..MPR5.
   82    02:C577  48         			pha
   83    02:C578  43 10      			tma4
   84    02:C57A  48         			pha
   85    02:C57B  43 20      			tma5
   86    02:C57D  48         			pha
   87                        	
   88    02:C57E  20 21 C6   			jsr	bat_pxl_2_chr		; Set up the draw coordinates.
   89                        	
   90    02:C581  A5 FC      			lda	<map_chr_x		; Reset previous X position.
   91    02:C583  9D AD 2B   			sta	vdc_old_chr_x, x
   92                        	
   93    02:C586  A5 FE      			lda	<map_chr_y		; Reset previous Y position,
   94    02:C588  1A         			inc	a			; ready to draw rows upwards.
   95    02:C589  9D AE 2B   			sta	vdc_old_chr_y, x
   96                        	
   97    02:C58C  BD 76 26   			lda	vdc_map_draw_w, x	; Draw the whole screen.
   98    02:C58F  85 FA      			sta	<map_draw_w
   99    02:C591  BD 77 26   			lda	vdc_map_draw_h, x
  100    02:C594  85 FB      			sta	<map_draw_h
  101                        	
  102    02:C596  20 04 C7   			jsr	bat_scroll_y		; Draw N row of CHR to the BAT.
  103                        	
  104    02:C599  68         			pla				; Restore MPR3..MPR5.
  105    02:C59A  53 20      			tam5
  106    02:C59C  68         			pla
  107    02:C59D  53 10      			tam4
  108    02:C59F  68         			pla
  109    02:C5A0  53 08      			tam3
  110                        	
  111                        			leave
         02:C5A2  4C EF FF   			jmp	leave_proc
  112                        	
  113                        			.endp
  114                        	
  115                        	
  116                        	
  117                        	; ***************************************************************************
  118                        	; ***************************************************************************
  119                        	;
  120                        	; _scroll_bat - Draw a single row of CHR into the BAT to update the edge.
  121                        	; _sgx_scroll_bat - Draw a single row of CHR into the BAT to update the edge.
  122                        	;
  123                        	; void __fastcall scroll_bat( void );
  124                        	; void __fastcall sgx_scroll_bat( void );
  125                        	;
  126                        	
  127               0001     		.if	SUPPORT_SGX
  128                        	
  129                        	_sgx_scroll_bat	.proc
  135                        			.endp
  136                        		.endif
  137                        	
  138    02:C5A5             	_scroll_bat	.proc
  139                        	
  140    02:C5A5  82         			clx				; Offset to PCE VDC.
  141                        	
  142    02:C5A6  43 08      			tma3				; Preserve MPR3..MPR5.
  143    02:C5A8  48         			pha
  144    02:C5A9  43 10      			tma4
  145    02:C5AB  48         			pha
  146    02:C5AC  43 20      			tma5
  147    02:C5AE  48         			pha
  148                        	
  149    02:C5AF  20 21 C6   			jsr	bat_pxl_2_chr		; Set up the draw coordinates.
  150                        	
  151    02:C5B2  BD 77 26   			lda	vdc_map_draw_h, x	; Draw new LHS or RHS if needed.
  152    02:C5B5  85 FB      			sta	<map_draw_h
  153                        	;		lda	#1			; bat_scroll_x only ever draws a
  154                        	;		sta	<map_draw_w		; single column.
  155    02:C5B7  20 45 C6   			jsr	bat_scroll_x
  156                        	
  157    02:C5BA  BD AD 2B   			lda	vdc_old_chr_x, x	; Restore map_chr_x which could
  158    02:C5BD  85 FC      			sta	<map_chr_x		; be changed by bat_scroll_x.
  159                        	
  160    02:C5BF  BD 76 26   			lda	vdc_map_draw_w, x	; Draw new TOP or BTM if needed.
  161    02:C5C2  85 FA      			sta	<map_draw_w
  162    02:C5C4  A9 01      			lda	#1
  163    02:C5C6  85 FB      			sta	<map_draw_h
  164    02:C5C8  20 04 C7   			jsr	bat_scroll_y
  165                        	
  166    02:C5CB  68         			pla				; Restore MPR3..MPR5.
  167    02:C5CC  53 20      			tam5
  168    02:C5CE  68         			pla
  169    02:C5CF  53 10      			tam4
  170    02:C5D1  68         			pla
  171    02:C5D2  53 08      			tam3
  172                        	
  173                        			leave
         02:C5D4  4C EF FF   			jmp	leave_proc
  174                        	
  175                        			.endp
  176                        	
  177                        	
  178                        	
  179                        	; ***************************************************************************
  180                        	; ***************************************************************************
  181                        	;
  182                        	; _blit_bat - Draw a map rectangle to specific BAT coordinates.
  183                        	; _sgx_blit_bat - Draw a map rectangle to specific BAT coordinates.
  184                        	;
  185                        	; void __fastcall blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
  186                        	; void __fastcall sgx_blit_bat( unsigned char tile_x<map_bat_x>, unsigned char tile_y<map_bat_y>, unsigned char tile_w<map_draw_x>, unsigned char tile_h<map_draw_y> );
  187                        	;
  188                        	; Normally you'd just use _draw_bat() and _scroll_bat(), but for those folks
  189                        	; who really wish to take manual control, you can use this.
  190                        	;
  191                        	
  192               0001     		.if	SUPPORT_SGX
  193                        	
  194                        	_sgx_blit_bat	.proc
  200                        			.endp
  201                        		.endif
  202                        	
  203    02:C5D7             	_blit_bat	.proc
  204                        	
  205    02:C5D7  82         			clx				; Offset to PCE VDC.
  206                        	
  207    02:C5D8  43 08      			tma3				; Preserve MPR3..MPR5.
  208    02:C5DA  48         			pha
  209    02:C5DB  43 10      			tma4
  210    02:C5DD  48         			pha
  211    02:C5DE  43 20      			tma5
  212    02:C5E0  48         			pha
  213                        	
  214    02:C5E1  BD 7E 26   			lda	vdc_map_option, x	; Preserve current map options.
  215    02:C5E4  48         			pha
  216    02:C5E5  09 C0      			ora	#MAP_UNALIGNED_X | MAP_UNALIGNED_Y
  217    02:C5E7  9D 7E 26   			sta	vdc_map_option, x
  218                        	
  219    02:C5EA  20 21 C6   			jsr	bat_pxl_2_chr		; Set up the draw coordinates.
  220                        	
  221    02:C5ED  A5 FA      			lda	<map_draw_w		; Are we drawing just 1 column?
  222    02:C5EF  C9 01      			cmp	#1
  223    02:C5F1  F0 1E      			beq	.draw_column
  224                        	
  225                        			; Draw N rows.
  226                        	
  227    02:C5F3  A5 FC      	.draw_rows:	lda	<map_chr_x		; Reset previous X position.
  228    02:C5F5  9D AD 2B   			sta	vdc_old_chr_x, x
  229                        	
  230    02:C5F8  A5 FE      			lda	<map_chr_y		; Reset previous Y position,
  231    02:C5FA  1A         			inc	a			; ready to draw rows upwards.
  232    02:C5FB  9D AE 2B   			sta	vdc_old_chr_y, x
  233                        	
  234    02:C5FE  20 04 C7   			jsr	bat_scroll_y		; Draw a row of CHR to the BAT.
  235                        	
  236                        			; Drawing completed.
  237                        	
  238    02:C601  68         	.finished:	pla				; Restore previous map options.
  239    02:C602  9D 7E 26   			sta	vdc_map_option, x
  240                        	
  241    02:C605  68         			pla				; Restore MPR3..MPR5.
  242    02:C606  53 20      			tam5
  243    02:C608  68         			pla
  244    02:C609  53 10      			tam4
  245    02:C60B  68         			pla
  246    02:C60C  53 08      			tam3
  247                        	
  248                        	.exit:		leave
         02:C60E  4C EF FF   			jmp	leave_proc
  249                        	
  250                        			; Draw 1 column.
  251                        	
  252    02:C611  A5 FC      	.draw_column:	lda	<map_chr_x		; Reset previous X position.
  253    02:C613  1A         			inc	a			; ready to draw 1 column.
  254    02:C614  9D AD 2B   			sta	vdc_old_chr_x, x
  255                        	
  256    02:C617  A5 FE      			lda	<map_chr_y		; Reset previous Y position.
  257    02:C619  9D AE 2B   			sta	vdc_old_chr_y, x
  258                        	
  259    02:C61C  20 45 C6   			jsr	bat_scroll_x		; Draw a single column of CHR.
  260                        	
  261    02:C61F  80 E0      			bra	.finished
  262                        	
  263                        			.endp
  264                        	
  265                        	
  266                        	
  267                        	; ***************************************************************************
  268                        	; ***************************************************************************
  269                        	;
  270                        	
  271    02:C621  BD 7A 26   	bat_pxl_2_chr:	lda.l	vdc_map_pxl_x, x	; Get current map X coordinate.
  272    02:C624  85 FC      			sta.l	<map_pxl_x
  273    02:C626  BD 7B 26   			lda.h	vdc_map_pxl_x, x	; Xvert map_pxl_x to map_chr_x.
  274    02:C629  4A         			lsr	a
  275    02:C62A  66 FC      			ror.l	<map_pxl_x
  276    02:C62C  4A         			lsr	a
  277    02:C62D  66 FC      			ror.l	<map_pxl_x
  278    02:C62F  4A         			lsr	a
  279    02:C630  66 FC      			ror.l	<map_pxl_x		; Max map width is 256 CHR.
  280                        	
  281    02:C632  BD 7C 26   			lda.l	vdc_map_pxl_y, x	; Get current map Y coordinate.
  282    02:C635  85 FE      			sta.l	<map_pxl_y
  283    02:C637  BD 7D 26   			lda.h	vdc_map_pxl_y, x	; Xvert map_pxl_y to map_chr_y.
  284    02:C63A  4A         			lsr	a
  285    02:C63B  66 FE      			ror.l	<map_pxl_y
  286    02:C63D  4A         			lsr	a
  287    02:C63E  66 FE      			ror.l	<map_pxl_y
  288    02:C640  4A         			lsr	a
  289    02:C641  66 FE      			ror.l	<map_pxl_y		; Max map width is 256 CHR.
  290                        	
  291    02:C643  60         			rts
  292                        	
  293                        	
  294                        	
  295                        	; ***************************************************************************
  296                        	; ***************************************************************************
  297                        	;
  298                        	; bat_scroll_x - Update the BAT when X coordinate changes.
  299                        	;
  300                        	; N.B. This only ever draws a single column!
  301                        	;
  302                        	
  303    02:C644  60         	!no_change:	rts
  304                        	
  305    02:C645  A5 FC      	bat_scroll_x:	lda	<map_chr_x		; Compare old_x with cur_x.
  306    02:C647  DD AD 2B   			cmp	vdc_old_chr_x, x
  307    02:C64A  F0 F8      			beq	!no_change-		; Do nothing if no change.
  308    02:C64C  9D AD 2B   			sta	vdc_old_chr_x, x
  309    02:C64F  30 05      			bmi	.moved			; Test the sign of the change.
  310                        	
  311    02:C651  18         			clc				; Draw RHS if chr_x >= old_x.
  312    02:C652  7D 76 26   			adc	vdc_map_draw_w, x	; Usually (SCR_WIDTH / 8) + 1.
  313    02:C655  3A         			dec	a
  314                        	
  315    02:C656  48         	.moved:		pha				; Push chr_x in map section.
  316                        	
  317    02:C657  3C 7E 26   			bit	vdc_map_option, x	; Set bit7 to disable aligning
  318    02:C65A  30 05      			bmi	!+			; BAT X with the map X.
  319    02:C65C  3D 73 26   			and	vdc_bat_x_mask, x
  320    02:C65F  85 F8      			sta	<map_bat_x		; Save BAT X chr coordinate.
  321                        	
  322    02:C661  A5 FE      	!:		lda	<map_chr_y		; Y = chr_y in map section.
  323    02:C663  A8         			tay
  324                        	
  325    02:C664  3C 7E 26   			bit	vdc_map_option, x	; Set bit6 to disable aligning
  326    02:C667  70 05      			bvs	!+			; BAT Y with the map Y.
  327    02:C669  3D 74 26   			and	vdc_bat_y_mask, x
  328    02:C66C  85 F9      			sta	<map_bat_y		; Save BAT Y chr coordinate.
  329                        	
  330               0000     		.if	FAST_MULTIPLY
  333                        		.endif
  334                        	
  335    02:C66E  BD 78 26   	!:		lda	vdc_map_line_w, x	; Map width in CHR (0 == 256).
  336    02:C671  D0 05      			bne	!+
  337                        	
  338    02:C673  64 EE      			stz.l	<map_line		; Multiply by 256 is easy!
  339    02:C675  98         			tya
  340    02:C676  80 15      			bra	.double
  341                        	
  342               0000     		.if	FAST_MULTIPLY
  354                        		.else
  355    02:C678  84 EF      	!:		sty.h	<map_line		; Takes 144..176 cycles.
  356    02:C67A  A0 08      			ldy	#8
  357    02:C67C  4A         			lsr	a
  358    02:C67D  85 EE      			sta.l	<map_line
  359    02:C67F  62         			cla
  360    02:C680  90 03      			bcc	.rotate
  361    02:C682  18         	.add:		clc
  362    02:C683  65 EF      			adc.h	<map_line
  363    02:C685  6A         	.rotate:	ror	a
  364    02:C686  66 EE      			ror.l	<map_line		; Lo-byte of (CHR Y * width).
  365    02:C688  88         			dey
  366    02:C689  B0 F7      			bcs	.add
  367    02:C68B  D0 F8      			bne	.rotate
  368                        		.endif
  369                        	
  370    02:C68D  06 EE      	.double:	asl.l	<map_line		; Lo-byte of (CHR Y * width * 2).
  371    02:C68F  2A         			rol	a
  372    02:C690  A8         			tay				; Hi-byte of (CHR Y * width * 2).
  373                        	
  374    02:C691  BD B7 2B   			lda	vdc_map_bank, x		; Put the MAP into MPR3-MPR5.
  375    02:C694  53 08      			tam3				; Allow for 16KByte chrmap.
  376    02:C696  1A         			inc	a
  377    02:C697  53 10      			tam4
  378    02:C699  1A         			inc	a
  379    02:C69A  53 20      			tam5
  380                        	
  381    02:C69C  68         			pla				; Pop chr_x in map section.
  382    02:C69D  0A         			asl	a			; 2-bytes for a BAT value.
  383    02:C69E  90 02      			bcc	!+
  384    02:C6A0  C8         			iny				; Hi-byte of (CHR Y * width * 2).
  385    02:C6A1  18         			clc
  386    02:C6A2  65 EE      	!:		adc.l	<map_line		; Lo-byte of (CHR Y * width * 2).
  387    02:C6A4  90 01      			bcc	!+
  388    02:C6A6  C8         			iny
  389                        	
  390    02:C6A7  18         	!:		clc				; Calc map data pointer.
  391    02:C6A8  7D B5 2B   			adc.l	vdc_map_addr, x
  392    02:C6AB  85 EC      			sta.l	<_bp			; Maximum map size is 16KBytes
  393    02:C6AD  98         			tya				; so we don't need to consider
  394    02:C6AE  7D B6 2B   			adc.h	vdc_map_addr, x		; bank overflow.
  395    02:C6B1  85 ED      			sta.h	<_bp
  396                        	
  397    02:C6B3  C2         			cly				; Calculate the map line delta
  398    02:C6B4  BD 78 26   			lda	vdc_map_line_w, x	; in bytes.
  399    02:C6B7  D0 01      			bne	!+
  400    02:C6B9  C8         			iny
  401    02:C6BA  0A         	!:		asl	a
  402    02:C6BB  85 EE      			sta.l	<map_line
  403    02:C6BD  98         			tya
  404    02:C6BE  2A         			rol	a
  405    02:C6BF  85 EF      			sta.h	<map_line
  406                        	
  407                        			; Draw the first part of the column.
  408                        	
  409    02:C6C1  A5 F8      	.draw_col:	lda	<map_bat_x		; Set the BAT VRAM destination
  410    02:C6C3  85 F0      			sta.l	<_di			; coordinates.
  411    02:C6C5  A5 F9      			lda	<map_bat_y
  412    02:C6C7  85 F1      			sta.h	<_di
  413                        	
  414    02:C6C9  5D 74 26   			eor	vdc_bat_y_mask, x	; Calc CHR before wrap.
  415    02:C6CC  1A         			inc	a
  416    02:C6CD  C5 FB      			cmp	<map_draw_h		; Usually (SCR_HEIGHT / 8) + 1.
  417    02:C6CF  90 02      			bcc	!+
  418    02:C6D1  A5 FB      			lda	<map_draw_h		; Maximum CHR to draw.
  419    02:C6D3  85 00      	!:		sta	<map_count		; Set number of CHR to draw.
  420    02:C6D5  85 01      			sta	<map_drawn		; Preserve number of CHR drawn.
  421                        	
  422    02:C6D7  A9 05      			lda	#VDC_CR			; Set VDC auto-increment from
  423    02:C6D9  95 F7      			sta	<vdc_reg, x		; the BAT width, which is set
  424    02:C6DB  9D 00 02   			sta	VDC_AR, x		; up by set_screen_size().
  425    02:C6DE  B5 F4      			lda	<vdc_crh, x
  426    02:C6E0  9D 03 02   			sta	VDC_DH, x
  427                        	
  428    02:C6E3  20 E5 C7   			jsr	bat_col_strip		; Draw top of vertical strip.
  429                        	
  430                        			; Wrap around and draw the rest of the column (if needed).
  431                        	
  432    02:C6E6  38         			sec				; Are there any more CHR that
  433    02:C6E7  A5 FB      			lda	<map_draw_h		; need to be drawn?
  434    02:C6E9  E5 01      			sbc	<map_drawn
  435    02:C6EB  F0 0B      			beq	.done
  436                        	
  437    02:C6ED  85 00      			sta	<map_count		; Set number of CHR to draw.
  438                        	
  439    02:C6EF  A5 F8      			lda	<map_bat_x		; Set the BAT VRAM destination
  440    02:C6F1  85 F0      			sta.l	<_di			; coordinates.
  441    02:C6F3  64 F1      			stz.h	<_di			; Reset 1st row to draw.
  442                        	
  443    02:C6F5  20 E5 C7   			jsr	bat_col_strip		; Draw btm of vertical strip.
  444                        	
  445    02:C6F8  A9 05      	.done:		lda	#VDC_CR			; Set VDC auto-increment to 1.
  446    02:C6FA  95 F7      			sta	<vdc_reg, x
  447    02:C6FC  9D 00 02   			sta	VDC_AR, x
  448    02:C6FF  9E 03 02   			stz	VDC_DH, x
  449                        	
  450    02:C702  60         			rts
  451                        	
  452                        	
  453                        	
  454                        	; ***************************************************************************
  455                        	; ***************************************************************************
  456                        	;
  457                        	; bat_scroll_y - Update the BAT when Y coordinate changes.
  458                        	;
  459                        	; N.B. This draws multiple rows when called from _draw_bat or _blit_bat.
  460                        	;
  461                        	
  462    02:C703  60         	!no_change:	rts
  463                        	
  464    02:C704  A5 FE      	bat_scroll_y:	lda	<map_chr_y		; Compare old_y with cur_y.
  465    02:C706  DD AE 2B   			cmp	vdc_old_chr_y, x
  466    02:C709  F0 F8      			beq	!no_change-		; Do nothing if no change.
  467    02:C70B  9D AE 2B   			sta	vdc_old_chr_y, x
  468    02:C70E  30 05      			bmi	.moved			; Test the sign of the change.
  469                        	
  470    02:C710  18         			clc				; Draw bottom if chr_y >= old_y.
  471    02:C711  7D 77 26   			adc	vdc_map_draw_h, x	; Usually (SCR_HEIGHT / 8) + 1.
  472    02:C714  3A         			dec	a
  473                        	
  474    02:C715  A8         	.moved:		tay				; Y = chr_y in map section.
  475                        	
  476    02:C716  3C 7E 26   			bit	vdc_map_option, x	; Set bit6 to disable aligning
  477    02:C719  70 05      			bvs	!+			; BAT Y with the map Y.
  478    02:C71B  3D 74 26   			and	vdc_bat_y_mask, x
  479    02:C71E  85 F9      			sta	<map_bat_y		; Save BAT Y chr coordinate.
  480                        	
  481    02:C720  3C 7E 26   	!:		bit	vdc_map_option, x	; Set bit7 to disable aligning
  482    02:C723  30 07      			bmi	!+			; BAT X with the map X.
  483    02:C725  A5 FC      			lda	<map_chr_x
  484    02:C727  3D 73 26   			and	vdc_bat_x_mask, x
  485    02:C72A  85 F8      			sta	<map_bat_x		; Save BAT X chr coordinate.
  486                        	
  487               0000     		.if	FAST_MULTIPLY
  490                        		.endif
  491                        	
  492    02:C72C  BD 78 26   	!:		lda	vdc_map_line_w, x	; Map width in CHR (0 == 256).
  493    02:C72F  D0 05      			bne	!+
  494                        	
  495    02:C731  64 EE      			stz.l	<map_line		; Multiply by 256 is easy!
  496    02:C733  98         			tya
  497    02:C734  80 15      			bra	.double
  498                        	
  499               0000     		.if	FAST_MULTIPLY
  511                        		.else
  512    02:C736  84 EF      	!:		sty.h	<map_line		; Takes 144..176 cycles.
  513    02:C738  A0 08      			ldy	#8
  514    02:C73A  4A         			lsr	a
  515    02:C73B  85 EE      			sta.l	<map_line
  516    02:C73D  62         			cla
  517    02:C73E  90 03      			bcc	.rotate
  518    02:C740  18         	.add:		clc
  519    02:C741  65 EF      			adc.h	<map_line
  520    02:C743  6A         	.rotate:	ror	a
  521    02:C744  66 EE      			ror.l	<map_line		; Lo-byte of (CHR Y * width).
  522    02:C746  88         			dey
  523    02:C747  B0 F7      			bcs	.add
  524    02:C749  D0 F8      			bne	.rotate
  525                        		.endif
  526                        	
  527    02:C74B  06 EE      	.double:	asl.l	<map_line		; Lo-byte of (CHR Y * width * 2).
  528    02:C74D  2A         			rol	a
  529    02:C74E  85 EF      			sta.h	<map_line		; Hi-byte of (CHR Y * width * 2).
  530    02:C750  A8         			tay
  531                        	
  532    02:C751  BD B7 2B   			lda	vdc_map_bank, x		; Put the MAP into MPR3-MPR5.
  533    02:C754  53 08      			tam3				; Allow for 16KByte chrmap.
  534    02:C756  1A         			inc	a
  535    02:C757  53 10      			tam4
  536    02:C759  1A         			inc	a
  537    02:C75A  53 20      			tam5
  538                        	
  539                        			; Loop to here if drawing multiple rows.
  540                        	
  541    02:C75C  A5 FC      	.next_row:	lda	<map_chr_x		; Map CHR X coordinate.
  542    02:C75E  0A         			asl	a			; 2-bytes for a BAT value!
  543    02:C75F  90 02      			bcc	!+
  544    02:C761  C8         			iny				; Hi-byte of (CHR Y * width * 2).
  545    02:C762  18         			clc
  546    02:C763  65 EE      	!:		adc.l	<map_line		; Lo-byte of (CHR Y * width * 2).
  547    02:C765  90 01      			bcc	!+
  548    02:C767  C8         			iny
  549    02:C768  18         	!:		clc				; Calc map data pointer.
  550    02:C769  7D B5 2B   			adc.l	vdc_map_addr, x
  551    02:C76C  85 EC      			sta.l	<_bp			; Maximum map size is 16KBytes
  552    02:C76E  98         			tya				; so we don't need to consider
  553    02:C76F  7D B6 2B   			adc.h	vdc_map_addr, x		; bank overflow.
  554    02:C772  85 ED      			sta.h	<_bp
  555                        	
  556                        			; Draw the first part of the row.
  557                        	
  558    02:C774  A5 F9      	.draw_row:	lda	<map_bat_y		; Set the BAT VRAM destination
  559    02:C776  85 F1      			sta.h	<_di			; coordinates.
  560    02:C778  A5 F8      			lda	<map_bat_x
  561    02:C77A  85 F0      			sta.l	<_di
  562                        	
  563    02:C77C  5D 73 26   			eor	vdc_bat_x_mask, x	; Calc CHR before wrap.
  564    02:C77F  1A         			inc	a
  565    02:C780  C5 FA      			cmp	<map_draw_w		; Usually (SCR_WIDTH / 8) + 1.
  566    02:C782  90 02      			bcc	!+
  567    02:C784  A5 FA      			lda	<map_draw_w		; Maximum CHR to draw.
  568    02:C786  85 00      	!:		sta	<map_count		; Set number of CHR to draw.
  569    02:C788  85 01      			sta	<map_drawn		; Preserve number of CHR drawn.
  570                        	
  571    02:C78A  20 C4 C7   			jsr	bat_row_strip		; Draw lhs of horizontal strip.
  572                        	
  573                        			; Wrap around and draw the rest of the row (if needed).
  574                        	
  575    02:C78D  38         			sec				; Are there any more CHR that
  576    02:C78E  A5 FA      			lda	<map_draw_w		; need to be drawn?
  577    02:C790  E5 01      			sbc	<map_drawn
  578    02:C792  F0 0B      			beq	.done_row
  579                        	
  580    02:C794  85 00      			sta	<map_count		; Set number of CHR to draw.
  581                        	
  582    02:C796  A5 F9      			lda	<map_bat_y		; Set the BAT VRAM destination
  583    02:C798  85 F1      			sta.h	<_di			; coordinates.
  584    02:C79A  64 F0      			stz.l	<_di			; Reset 1st column to draw.
  585                        	
  586    02:C79C  20 C4 C7   			jsr	bat_row_strip		; Draw rhs of horizontal strip.
  587                        	
  588    02:C79F  C6 FB      	.done_row:	dec	<map_draw_h		; Are all desired rows drawn?
  589    02:C7A1  F0 20      			beq	.finished
  590                        	
  591    02:C7A3  A5 F9      			lda	<map_bat_y		; Move BAT Y down by 1.
  592    02:C7A5  1A         			inc	a
  593    02:C7A6  3D 74 26   			and	vdc_bat_y_mask, x
  594    02:C7A9  85 F9      			sta	<map_bat_y
  595                        	
  596    02:C7AB  A4 EF      			ldy.h	<map_line		; Move the map line pointer to
  597    02:C7AD  C8         			iny				; the next line.
  598    02:C7AE  BD 78 26   			lda	vdc_map_line_w, x
  599    02:C7B1  F0 0B      			beq	!++			; vdc_map_line_w == 0 == 256.
  600    02:C7B3  0A         			asl	a			; 2-bytes for a BAT value!
  601    02:C7B4  B0 01      			bcs	!+
  602    02:C7B6  88         			dey				; Fix if vdc_map_line_w <= 127.
  603    02:C7B7  18         	!:		clc
  604    02:C7B8  65 EE      			adc.l	<map_line
  605    02:C7BA  85 EE      			sta.l	<map_line
  606    02:C7BC  90 01      			bcc	!++
  607    02:C7BE  C8         	!:		iny
  608    02:C7BF  84 EF      	!:		sty.h	<map_line		; Needed for .next_row!
  609                        	
  610    02:C7C1  80 99      			bra	.next_row		; Draw next row.
  611                        	
  612    02:C7C3  60         	.finished:	rts
  613                        	
  614                        	
  615                        	
  616                        	; ***************************************************************************
  617                        	; ***************************************************************************
  618                        	;
  619                        	; bat_row_strip - Draw a single row of CHR into the BAT.
  620                        	;
  621                        	
  622    02:C7C4  20 34 E4   	bat_row_strip:	jsr	set_di_xy_mawr		; Set the BAT VRAM destination.
  623                        	
  624    02:C7C7  C2         			cly				; 2
  625    02:C7C8  B1 EC      	.repeat:	lda	[_bp], y		; 7
  626    02:C7CA  9D 02 02   			sta	VDC_DL, x		; 6
  627    02:C7CD  C8         			iny				; 2
  628    02:C7CE  B1 EC      			lda	[_bp], y		; 7
  629               0000     		.if	CHRMAP_BAT_FLAG
  634                        		.endif
  635    02:C7D0  9D 03 02   			sta	VDC_DH, x		; 6
  636    02:C7D3  C8         			iny				; 2
  637                        	
  638    02:C7D4  C6 00      	!:		dec	<map_count		; 6
  639    02:C7D6  D0 F0      			bne	.repeat			; 4
  640                        	
  641    02:C7D8  98         			tya				; 2
  642    02:C7D9  F0 07      			beq	!+			; 2/4
  643    02:C7DB  18         			clc				; 2
  644    02:C7DC  65 EC      			adc.l	<_bp			; 4
  645    02:C7DE  85 EC      			sta.l	<_bp			; 4
  646    02:C7E0  90 02      			bcc	.done			; 2/4
  647    02:C7E2  E6 ED      	!:		inc.h	<_bp			; 6
  648                        	
  649    02:C7E4  60         	.done:		rts
  650                        	
  651                        	
  652                        	
  653                        	; ***************************************************************************
  654                        	; ***************************************************************************
  655                        	;
  656                        	; bat_col_strip - Draw a single column of CHR into the BAT.
  657                        	;
  658                        	
  659    02:C7E5  20 34 E4   	bat_col_strip:	jsr	set_di_xy_mawr		; Set the BAT VRAM destination.
  660                        	
  661    02:C7E8  A0 01      			ldy	#1			; 2
  662    02:C7EA  B2 EC      	.repeat:	lda	[_bp]			; 7
  663    02:C7EC  9D 02 02   			sta	VDC_DL, x		; 6
  664    02:C7EF  B1 EC      			lda	[_bp], y		; 7
  665               0000     		.if	CHRMAP_BAT_FLAG
  670                        		.endif
  671    02:C7F1  9D 03 02   			sta	VDC_DH, x		; 6
  672                        	
  673    02:C7F4  18         			clc				; 2
  674    02:C7F5  A5 EE      			lda.l	<map_line		; 4
  675    02:C7F7  65 EC      			adc.l	<_bp			; 4
  676    02:C7F9  85 EC      			sta.l	<_bp			; 4
  677    02:C7FB  A5 EF      			lda.h	<map_line		; 4
  678    02:C7FD  65 ED      			adc.h	<_bp			; 4
  679    02:C7FF  85 ED      			sta.h	<_bp			; 4
  680                        	
  681    02:C801  C6 00      			dec	<map_count		; 6
  682    02:C803  D0 E5      			bne	.repeat			; 4
  683                        	
  684    02:C805  60         			rts
  685                        	
  686                        		.endprocgroup	; chrmap_group
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
   88                        		.endif	HUCC_USES_CHRMAP
   89                        	
   90               0001     		.ifdef	HUCC_USES_OLD_LINE		; Set in hucc_old_line.h
                             #[3]   "..\..\..\include\hucc\hucc-old-line.asm"
   91                        			include	"hucc-old-line.asm"
    1                        	; ***************************************************************************
    2                        	; ***************************************************************************
    3                        	;
    4                        	; hucc-old-line.asm
    5                        	;
    6                        	; Based on the original HuC and MagicKit functions by David Michel and the
    7                        	; other original HuC developers.
    8                        	;
    9                        	; Modifications copyright John Brandwood 2024-2025.
   10                        	;
   11                        	; Distributed under the Boost Software License, Version 1.0.
   12                        	; (See accompanying file LICENSE_1_0.txt or copy at
   13                        	;  http://www.boost.org/LICENSE_1_0.txt)
   14                        	;
   15                        	; ***************************************************************************
   16                        	; ***************************************************************************
   17                        	
   18                        	
   19                        	
   20                        	; ***************************************************************************
   21                        	; ***************************************************************************
   22                        	;
   23                        	; void __fastcall gfx_init( unsigned int start_vram_addr<_ax> );
   24                        	;
   25                        	; initialize graphics mode
   26                        	; - points graphics map to tiles at start_vram_addr
   27                        	
   28                        	_gfx_init.1	.proc
   73                        			.endp
   74                        	
   75                        	
   76                        	
   77                        	; ***************************************************************************
   78                        	; ***************************************************************************
   79                        	;
   80                        	; void __fastcall gfx_clear( unsigned int start_vram_addr<_di> );
   81                        	;
   82                        	; Clear the values in the graphics tiles
   83                        	; - places zeroes in graphics tiles at start_vram_addr
   84                        	
   85                        	_gfx_clear.1	.proc
  105                        			.endp
  106                        	
  107                        	
  108                        	
  109                        	; ***************************************************************************
  110                        	; ***************************************************************************
  111                        	;
  112                        	; void __fastcall gfx_line( unsigned int x1<_gfx_x1>, unsigned int y1<_gfx_y1>, unsigned int x2<_gfx_x2>, unsigned int y2<_gfx_y2>, unsigned char color<_gfx_color> );
  113                        	
  114                        	huc_gfx_line	.procgroup
  459                        			.endprocgroup	; huc_gfx_line
                             #[2]   "..\..\..\include\hucc\hucc-final.asm"
   92                        		.endif
   93                        	
   94               0000     		.ifdef	HUCC_USES_ZX0			; Set in hucc_zx0.h
   96                        		.endif
   97                        	
   98                        	
   99                        	
  100                        	; ***************************************************************************
  101                        	; ***************************************************************************
  102                        	;
  103                        	; Check that C "__zp" declarations aren't overwriting System Card variables.
  104                        	;
  105                        	
  106               20A0     			.zp
  107               0000     		.if	(* > zpg_sys_top) || (USING_PSGDRIVER && (* > zpg_psg_top))
  109                        		.endif
  110                        	
  111                        	
  112                        	
  113                        	; ***************************************************************************
  114                        	; ***************************************************************************
  115                        	;
  116                        	; Check that there isn't too much C "const" data in the ".RODATA" section.
  117                        	;
  118                        	
  119               6196     			.rodata
  120               0000     		.if	(bank(*) - _bank_base) >= (CONST_BANK + 2)
  122                        		.endif
  123               E937     			.code
                             #[1]   "main.s"

PROCEDURE LIST (in order of size):

Size: $1845, Addr: $12:C760,      .proc _update_PLAYER
Size: $086D, Addr: $01:C196, .procgroup blkmap_group
Size: $0580, Addr: $01:CA03,      .proc _joypad_BUTTONS_SHOP
Size: $0485, Addr: $01:CF83,      .proc _joypad_DIR
Size: $03E8, Addr: $01:D408,      .proc _init_SHOP
Size: $0390, Addr: $01:D7F0,      .proc huc_monofont_x
Size: $02F0, Addr: $01:DB80,      .proc _init_HUD
Size: $02C7, Addr: $02:C000,      .proc _init_LEVEL
Size: $02AD, Addr: $02:C2C7,      .proc _load_OBJECT_TILES
Size: $0292, Addr: $02:C574, .procgroup chrmap_group
Size: $01D2, Addr: $02:C806,      .proc _main
Size: $0184, Addr: $01:DE70,      .proc _check_OBJECT
Size: $0167, Addr: $02:C9D8,      .proc _scroll_object
Size: $0167, Addr: $02:CB3F,      .proc _scroll_chest
Size: $0167, Addr: $02:CCA6,      .proc _scroll_npc
Size: $013E, Addr: $02:CE0D,      .proc _check_NPC
Size: $013D, Addr: $02:CF4B,      .proc _init_OBJECT_LV1
Size: $011D, Addr: $02:D088,      .proc _joypad_BUTTONS
Size: $0108, Addr: $02:D1A5,      .proc read_joypads
Size: $0107, Addr: $02:D2AD,      .proc _recenter_CAMERA
Size: $00DF, Addr: $02:D3B4, .procgroup vdc_set_mode
Size: $00D4, Addr: $02:D493,      .proc _init_NPC_LV1
Size: $00C7, Addr: $02:D567,      .proc _init_CHEST_LV1
Size: $00BF, Addr: $02:D62E, .procgroup vdc_tty_out
Size: $00A5, Addr: $02:D6ED,      .proc _display_TIME_SHOP
Size: $009D, Addr: $02:D792,      .proc _display_TIME_LEVEL
Size: $0086, Addr: $02:D82F,      .proc _sgx_scroll_split.5
Size: $0081, Addr: $02:D8B5,      .proc vbl_init_scroll
Size: $007A, Addr: $02:D936,      .proc _check_TILE_DEPTH
Size: $0077, Addr: $02:D9B0,      .proc core_main
Size: $006A, Addr: $02:DA27, .procgroup load_vram_group
Size: $0064, Addr: $02:DA91,      .proc _check_BG
Size: $0062, Addr: $02:DAF5,      .proc _init_256x224
Size: $004B, Addr: $12:DFA5, .procgroup hucc_memcmp
Size: $004B, Addr: $02:DB57, .procgroup old_satb_group
Size: $0043, Addr: $02:DBA2, .procgroup vdc_clear_vram
Size: $0043, Addr: $02:DBE5,      .proc sgx_detect
Size: $003F, Addr: $02:DC28, .procgroup load_bat_group
Size: $003E, Addr: $02:DC67,      .proc _vram2vram.3
Size: $003B, Addr: $02:DCA5,      .proc init_random
Size: $0036, Addr: $02:DCE0,      .proc _init_VARIABLES
Size: $002F, Addr: $02:DD16,      .proc _init_PLAYER
Size: $002E, Addr: $02:DD45,      .proc _scroll_BG
Size: $002B, Addr: $02:DD73,      .proc _load_palette.3
Size: $0025, Addr: $02:DD9E,      .proc _load_CHEST_TILES
Size: $0025, Addr: $02:DDC3,      .proc _load_NPC_TILES
Size: $0023, Addr: $02:DDE8,      .proc _hide_LEVEL_SPRITES
Size: $001C, Addr: $02:DE0B,      .proc _display_SCORE
Size: $001C, Addr: $02:DE27,      .proc _display_ZENNY
Size: $001C, Addr: $02:DE43,      .proc clear_vce
Size: $001A, Addr: $02:DE5F,      .proc _display_KEY
Size: $001A, Addr: $02:DE79,      .proc _display_POTION
Size: $001A, Addr: $02:DE93,      .proc _init_SYSTEM
